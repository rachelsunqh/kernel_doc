% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[a4paper,8pt,english]{sphinxmanual}


\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsfonts}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}
\usepackage{multirow}
\usepackage{eqparbox}


\addto\captionsenglish{\renewcommand{\figurename}{Fig. }}
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\SetupFloatingEnvironment{literal-block}{name=Listing }


	% Use some font with UTF-8 support with XeLaTeX
        \usepackage{fontspec}
        \setsansfont{DejaVu Serif}
        \setromanfont{DejaVu Sans}
        \setmonofont{DejaVu Sans Mono}

     \usepackage[margin=0.5in, top=1in, bottom=1in]{geometry}
        \usepackage{ifthen}

        % Put notes in color and let them be inside a table
	\definecolor{NoteColor}{RGB}{204,255,255}
	\definecolor{WarningColor}{RGB}{255,204,204}
	\definecolor{AttentionColor}{RGB}{255,255,204}
	\definecolor{ImportantColor}{RGB}{192,255,204}
	\definecolor{OtherColor}{RGB}{204,204,204}
        \newlength{\mynoticelength}
        \makeatletter\newenvironment{coloredbox}[1]{%
	   \setlength{\fboxrule}{1pt}
	   \setlength{\fboxsep}{7pt}
	   \setlength{\mynoticelength}{\linewidth}
	   \addtolength{\mynoticelength}{-2\fboxsep}
	   \addtolength{\mynoticelength}{-2\fboxrule}
           \begin{lrbox}{\@tempboxa}\begin{minipage}{\mynoticelength}}{\end{minipage}\end{lrbox}%
	   \ifthenelse%
	      {\equal{\py@noticetype}{note}}%
	      {\colorbox{NoteColor}{\usebox{\@tempboxa}}}%
	      {%
	         \ifthenelse%
	         {\equal{\py@noticetype}{warning}}%
	         {\colorbox{WarningColor}{\usebox{\@tempboxa}}}%
		 {%
	            \ifthenelse%
	            {\equal{\py@noticetype}{attention}}%
	            {\colorbox{AttentionColor}{\usebox{\@tempboxa}}}%
		    {%
	               \ifthenelse%
	               {\equal{\py@noticetype}{important}}%
	               {\colorbox{ImportantColor}{\usebox{\@tempboxa}}}%
	               {\colorbox{OtherColor}{\usebox{\@tempboxa}}}%
		    }%
		 }%
	      }%
        }\makeatother

        \makeatletter
        \renewenvironment{notice}[2]{%
          \def\py@noticetype{#1}
          \begin{coloredbox}{#1}
          \bf\it
          \par\strong{#2}
          \csname py@noticestart@#1\endcsname
        }
	{
          \csname py@noticeend@\py@noticetype\endcsname
          \end{coloredbox}
        }
	\makeatother

     

\title{Linux Kernel User Documentation}
\date{March 08, 2018}
\release{4.16.0-rc4+}
\author{The kernel development community}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\setcounter{tocdepth}{0}
\makeindex

\makeatletter
\def\PYG@reset{\let\PYG@it=\relax \let\PYG@bf=\relax%
    \let\PYG@ul=\relax \let\PYG@tc=\relax%
    \let\PYG@bc=\relax \let\PYG@ff=\relax}
\def\PYG@tok#1{\csname PYG@tok@#1\endcsname}
\def\PYG@toks#1+{\ifx\relax#1\empty\else%
    \PYG@tok{#1}\expandafter\PYG@toks\fi}
\def\PYG@do#1{\PYG@bc{\PYG@tc{\PYG@ul{%
    \PYG@it{\PYG@bf{\PYG@ff{#1}}}}}}}
\def\PYG#1#2{\PYG@reset\PYG@toks#1+\relax+\PYG@do{#2}}

\expandafter\def\csname PYG@tok@gd\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gu\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@gt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PYG@tok@gs\endcsname{\let\PYG@bf=\textbf}
\expandafter\def\csname PYG@tok@gr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@cm\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@vg\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@vi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@mh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@cs\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\colorbox[rgb]{1.00,0.94,0.94}{\strut ##1}}}
\expandafter\def\csname PYG@tok@ge\endcsname{\let\PYG@it=\textit}
\expandafter\def\csname PYG@tok@vc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@il\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@go\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.20,0.20,0.20}{##1}}}
\expandafter\def\csname PYG@tok@cp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@gi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gh\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@ni\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.84,0.33,0.22}{##1}}}
\expandafter\def\csname PYG@tok@nl\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.13,0.44}{##1}}}
\expandafter\def\csname PYG@tok@nn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@no\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.38,0.68,0.84}{##1}}}
\expandafter\def\csname PYG@tok@na\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@nd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.33,0.33,0.33}{##1}}}
\expandafter\def\csname PYG@tok@ne\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\expandafter\def\csname PYG@tok@si\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.44,0.63,0.82}{##1}}}
\expandafter\def\csname PYG@tok@s2\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nt\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.45}{##1}}}
\expandafter\def\csname PYG@tok@nv\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@s1\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ch\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@m\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@gp\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@sh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ow\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@sx\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@bp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c1\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@o\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PYG@tok@kc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@mf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@err\endcsname{\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PYG@tok@mb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@ss\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.32,0.47,0.09}{##1}}}
\expandafter\def\csname PYG@tok@sr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.14,0.33,0.53}{##1}}}
\expandafter\def\csname PYG@tok@mo\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@mi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@cpf\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@kr\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@s\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@kp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@w\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PYG@tok@kt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.56,0.13,0.00}{##1}}}
\expandafter\def\csname PYG@tok@sc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@k\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@se\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sd\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}

\def\PYGZbs{\char`\\}
\def\PYGZus{\char`\_}
\def\PYGZob{\char`\{}
\def\PYGZcb{\char`\}}
\def\PYGZca{\char`\^}
\def\PYGZam{\char`\&}
\def\PYGZlt{\char`\<}
\def\PYGZgt{\char`\>}
\def\PYGZsh{\char`\#}
\def\PYGZpc{\char`\%}
\def\PYGZdl{\char`\$}
\def\PYGZhy{\char`\-}
\def\PYGZsq{\char`\'}
\def\PYGZdq{\char`\"}
\def\PYGZti{\char`\~}
% for compatibility with earlier versions
\def\PYGZat{@}
\def\PYGZlb{[}
\def\PYGZrb{]}
\makeatother

\renewcommand\PYGZsq{\textquotesingle}

\begin{document}

\maketitle
\tableofcontents
\phantomsection\label{admin-guide/index::doc}


The following is a collection of user-oriented documents that have been
added to the kernel over time.  There is, as yet, little overall order or
organization here — this material was not written to be a single, coherent
document!  With luck things will improve quickly over time.

This initial section contains overall information, including the README
file describing the kernel as a whole, documentation on kernel parameters,
etc.


\chapter{Linux kernel release 4.x \textless{}http://kernel.org/\textgreater{}}
\label{admin-guide/README:the-linux-kernel-user-s-and-administrator-s-guide}\label{admin-guide/README:linux-kernel-release-4-x-http-kernel-org}\label{admin-guide/README::doc}
These are the release notes for Linux version 4.  Read them carefully,
as they tell you what this is all about, explain how to install the
kernel, and what to do if something goes wrong.


\section{What is Linux?}
\label{admin-guide/README:what-is-linux}\begin{quote}

Linux is a clone of the operating system Unix, written from scratch by
Linus Torvalds with assistance from a loosely-knit team of hackers across
the Net. It aims towards POSIX and Single UNIX Specification compliance.

It has all the features you would expect in a modern fully-fledged Unix,
including true multitasking, virtual memory, shared libraries, demand
loading, shared copy-on-write executables, proper memory management,
and multistack networking including IPv4 and IPv6.

It is distributed under the GNU General Public License v2 - see the
accompanying COPYING file for more details.
\end{quote}


\section{On what hardware does it run?}
\label{admin-guide/README:on-what-hardware-does-it-run}\begin{quote}

Although originally developed first for 32-bit x86-based PCs (386 or higher),
today Linux also runs on (at least) the Compaq Alpha AXP, Sun SPARC and
UltraSPARC, Motorola 68000, PowerPC, PowerPC64, ARM, Hitachi SuperH, Cell,
IBM S/390, MIPS, HP PA-RISC, Intel IA-64, DEC VAX, AMD x86-64, AXIS CRIS,
Xtensa, Tilera TILE, ARC and Renesas M32R architectures.

Linux is easily portable to most general-purpose 32- or 64-bit architectures
as long as they have a paged memory management unit (PMMU) and a port of the
GNU C compiler (gcc) (part of The GNU Compiler Collection, GCC). Linux has
also been ported to a number of architectures without a PMMU, although
functionality is then obviously somewhat limited.
Linux has also been ported to itself. You can now run the kernel as a
userspace application - this is called UserMode Linux (UML).
\end{quote}


\section{Documentation}
\label{admin-guide/README:documentation}\begin{itemize}
\item {} 
There is a lot of documentation available both in electronic form on
the Internet and in books, both Linux-specific and pertaining to
general UNIX questions.  I'd recommend looking into the documentation
subdirectories on any Linux FTP site for the LDP (Linux Documentation
Project) books.  This README is not meant to be documentation on the
system: there are much better sources available.

\item {} 
There are various README files in the Documentation/ subdirectory:
these typically contain kernel-specific installation notes for some
drivers for example. See Documentation/00-INDEX for a list of what
is contained in each file.  Please read the
\DUspan{xref,std,std-ref}{Documentation/process/changes.rst} file, as it
contains information about the problems, which may result by upgrading
your kernel.

\end{itemize}


\section{Installing the kernel source}
\label{admin-guide/README:installing-the-kernel-source}\begin{itemize}
\item {} 
If you install the full sources, put the kernel tarball in a
directory where you have permissions (e.g. your home directory) and
unpack it:

\begin{Verbatim}[commandchars=\\\{\}]
xz \PYGZhy{}cd linux\PYGZhy{}4.X.tar.xz \textbar{} tar xvf \PYGZhy{}
\end{Verbatim}

Replace ``X'' with the version number of the latest kernel.

Do NOT use the /usr/src/linux area! This area has a (usually
incomplete) set of kernel headers that are used by the library header
files.  They should match the library, and not get messed up by
whatever the kernel-du-jour happens to be.

\item {} 
You can also upgrade between 4.x releases by patching.  Patches are
distributed in the xz format.  To install by patching, get all the
newer patch files, enter the top level directory of the kernel source
(linux-4.X) and execute:

\begin{Verbatim}[commandchars=\\\{\}]
xz \PYGZhy{}cd ../patch\PYGZhy{}4.x.xz \textbar{} patch \PYGZhy{}p1
\end{Verbatim}

Replace ``x'' for all versions bigger than the version ``X'' of your current
source tree, \textbf{in\_order}, and you should be ok.  You may want to remove
the backup files (some-file-name\textasciitilde{} or some-file-name.orig), and make sure
that there are no failed patches (some-file-name\# or some-file-name.rej).
If there are, either you or I have made a mistake.

Unlike patches for the 4.x kernels, patches for the 4.x.y kernels
(also known as the -stable kernels) are not incremental but instead apply
directly to the base 4.x kernel.  For example, if your base kernel is 4.0
and you want to apply the 4.0.3 patch, you must not first apply the 4.0.1
and 4.0.2 patches. Similarly, if you are running kernel version 4.0.2 and
want to jump to 4.0.3, you must first reverse the 4.0.2 patch (that is,
patch -R) \textbf{before} applying the 4.0.3 patch. You can read more on this in
\DUspan{xref,std,std-ref}{Documentation/process/applying-patches.rst}.

Alternatively, the script patch-kernel can be used to automate this
process.  It determines the current kernel version and applies any
patches found:

\begin{Verbatim}[commandchars=\\\{\}]
linux/scripts/patch\PYGZhy{}kernel linux
\end{Verbatim}

The first argument in the command above is the location of the
kernel source.  Patches are applied from the current directory, but
an alternative directory can be specified as the second argument.

\item {} 
Make sure you have no stale .o files and dependencies lying around:

\begin{Verbatim}[commandchars=\\\{\}]
cd linux
make mrproper
\end{Verbatim}

You should now have the sources correctly installed.

\end{itemize}


\section{Software requirements}
\label{admin-guide/README:software-requirements}\begin{quote}

Compiling and running the 4.x kernels requires up-to-date
versions of various software packages.  Consult
\DUspan{xref,std,std-ref}{Documentation/process/changes.rst} for the minimum version numbers
required and how to get updates for these packages.  Beware that using
excessively old versions of these packages can cause indirect
errors that are very difficult to track down, so don't assume that
you can just update packages when obvious problems arise during
build or operation.
\end{quote}


\section{Build directory for the kernel}
\label{admin-guide/README:build-directory-for-the-kernel}\begin{quote}

When compiling the kernel, all output files will per default be
stored together with the kernel source code.
Using the option \code{make O=output/dir} allows you to specify an alternate
place for the output files (including .config).
Example:

\begin{Verbatim}[commandchars=\\\{\}]
kernel source code: /usr/src/linux\PYGZhy{}4.X
build directory:    /home/name/build/kernel
\end{Verbatim}

To configure and build the kernel, use:

\begin{Verbatim}[commandchars=\\\{\}]
cd /usr/src/linux\PYGZhy{}4.X
make O=/home/name/build/kernel menuconfig
make O=/home/name/build/kernel
sudo make O=/home/name/build/kernel modules\PYGZus{}install install
\end{Verbatim}

Please note: If the \code{O=output/dir} option is used, then it must be
used for all invocations of make.
\end{quote}


\section{Configuring the kernel}
\label{admin-guide/README:configuring-the-kernel}\begin{quote}
\begin{quote}

Do not skip this step even if you are only upgrading one minor
version.  New configuration options are added in each release, and
odd problems will turn up if the configuration files are not set up
as expected.  If you want to carry your existing configuration to a
new version with minimal work, use \code{make oldconfig}, which will
only ask you for the answers to new questions.
\end{quote}
\begin{itemize}
\item {} 
Alternative configuration commands are:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}make config\PYGZdq{}      Plain text interface.

\PYGZdq{}make menuconfig\PYGZdq{}  Text based color menus, radiolists \PYGZam{} dialogs.

\PYGZdq{}make nconfig\PYGZdq{}     Enhanced text based color menus.

\PYGZdq{}make xconfig\PYGZdq{}     Qt based configuration tool.

\PYGZdq{}make gconfig\PYGZdq{}     GTK+ based configuration tool.

\PYGZdq{}make oldconfig\PYGZdq{}   Default all questions based on the contents of
                   your existing ./.config file and asking about
                   new config symbols.

\PYGZdq{}make olddefconfig\PYGZdq{}
                   Like above, but sets new symbols to their default
                   values without prompting.

\PYGZdq{}make defconfig\PYGZdq{}   Create a ./.config file by using the default
                   symbol values from either arch/\PYGZdl{}ARCH/defconfig
                   or arch/\PYGZdl{}ARCH/configs/\PYGZdl{}\PYGZob{}PLATFORM\PYGZcb{}\PYGZus{}defconfig,
                   depending on the architecture.

\PYGZdq{}make \PYGZdl{}\PYGZob{}PLATFORM\PYGZcb{}\PYGZus{}defconfig\PYGZdq{}
                   Create a ./.config file by using the default
                   symbol values from
                   arch/\PYGZdl{}ARCH/configs/\PYGZdl{}\PYGZob{}PLATFORM\PYGZcb{}\PYGZus{}defconfig.
                   Use \PYGZdq{}make help\PYGZdq{} to get a list of all available
                   platforms of your architecture.

\PYGZdq{}make allyesconfig\PYGZdq{}
                   Create a ./.config file by setting symbol
                   values to \PYGZsq{}y\PYGZsq{} as much as possible.

\PYGZdq{}make allmodconfig\PYGZdq{}
                   Create a ./.config file by setting symbol
                   values to \PYGZsq{}m\PYGZsq{} as much as possible.

\PYGZdq{}make allnoconfig\PYGZdq{} Create a ./.config file by setting symbol
                   values to \PYGZsq{}n\PYGZsq{} as much as possible.

\PYGZdq{}make randconfig\PYGZdq{}  Create a ./.config file by setting symbol
                   values to random values.

\PYGZdq{}make localmodconfig\PYGZdq{} Create a config based on current config and
                      loaded modules (lsmod). Disables any module
                      option that is not needed for the loaded modules.

                      To create a localmodconfig for another machine,
                      store the lsmod of that machine into a file
                      and pass it in as a LSMOD parameter.

              target\PYGZdl{} lsmod \PYGZgt{} /tmp/mylsmod
              target\PYGZdl{} scp /tmp/mylsmod host:/tmp

              host\PYGZdl{} make LSMOD=/tmp/mylsmod localmodconfig

                      The above also works when cross compiling.

\PYGZdq{}make localyesconfig\PYGZdq{} Similar to localmodconfig, except it will convert
                      all module options to built in (=y) options.
\end{Verbatim}

You can find more information on using the Linux kernel config tools
in Documentation/kbuild/kconfig.txt.

\item {} 
NOTES on \code{make config}:
\begin{itemize}
\item {} 
Having unnecessary drivers will make the kernel bigger, and can
under some circumstances lead to problems: probing for a
nonexistent controller card may confuse your other controllers.

\item {} 
A kernel with math-emulation compiled in will still use the
coprocessor if one is present: the math emulation will just
never get used in that case.  The kernel will be slightly larger,
but will work on different machines regardless of whether they
have a math coprocessor or not.

\item {} 
The ``kernel hacking'' configuration details usually result in a
bigger or slower kernel (or both), and can even make the kernel
less stable by configuring some routines to actively try to
break bad code to find kernel problems (kmalloc()).  Thus you
should probably answer `n' to the questions for ``development'',
``experimental'', or ``debugging'' features.

\end{itemize}

\end{itemize}
\end{quote}


\section{Compiling the kernel}
\label{admin-guide/README:compiling-the-kernel}\begin{itemize}
\item {} 
Make sure you have at least gcc 3.2 available.
For more information, refer to \DUspan{xref,std,std-ref}{Documentation/process/changes.rst}.

Please note that you can still run a.out user programs with this kernel.

\item {} 
Do a \code{make} to create a compressed kernel image. It is also
possible to do \code{make install} if you have lilo installed to suit the
kernel makefiles, but you may want to check your particular lilo setup first.

To do the actual install, you have to be root, but none of the normal
build should require that. Don't take the name of root in vain.

\item {} 
If you configured any of the parts of the kernel as \code{modules}, you
will also have to do \code{make modules\_install}.

\item {} 
Verbose kernel compile/build output:

Normally, the kernel build system runs in a fairly quiet mode (but not
totally silent).  However, sometimes you or other kernel developers need
to see compile, link, or other commands exactly as they are executed.
For this, use ``verbose'' build mode.  This is done by passing
\code{V=1} to the \code{make} command, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
make V=1 all
\end{Verbatim}

To have the build system also tell the reason for the rebuild of each
target, use \code{V=2}.  The default is \code{V=0}.

\item {} 
Keep a backup kernel handy in case something goes wrong.  This is
especially true for the development releases, since each new release
contains new code which has not been debugged.  Make sure you keep a
backup of the modules corresponding to that kernel, as well.  If you
are installing a new kernel with the same version number as your
working kernel, make a backup of your modules directory before you
do a \code{make modules\_install}.

Alternatively, before compiling, use the kernel config option
``LOCALVERSION'' to append a unique suffix to the regular kernel version.
LOCALVERSION can be set in the ``General Setup'' menu.

\item {} 
In order to boot your new kernel, you'll need to copy the kernel
image (e.g. .../linux/arch/x86/boot/bzImage after compilation)
to the place where your regular bootable kernel is found.

\item {} 
Booting a kernel directly from a floppy without the assistance of a
bootloader such as LILO, is no longer supported.

If you boot Linux from the hard drive, chances are you use LILO, which
uses the kernel image as specified in the file /etc/lilo.conf.  The
kernel image file is usually /vmlinuz, /boot/vmlinuz, /bzImage or
/boot/bzImage.  To use the new kernel, save a copy of the old image
and copy the new image over the old one.  Then, you MUST RERUN LILO
to update the loading map! If you don't, you won't be able to boot
the new kernel image.

Reinstalling LILO is usually a matter of running /sbin/lilo.
You may wish to edit /etc/lilo.conf to specify an entry for your
old kernel image (say, /vmlinux.old) in case the new one does not
work.  See the LILO docs for more information.

After reinstalling LILO, you should be all set.  Shutdown the system,
reboot, and enjoy!

If you ever need to change the default root device, video mode,
ramdisk size, etc.  in the kernel image, use the \code{rdev} program (or
alternatively the LILO boot options when appropriate).  No need to
recompile the kernel to change these parameters.

\item {} 
Reboot with the new kernel and enjoy.

\end{itemize}


\section{If something goes wrong}
\label{admin-guide/README:if-something-goes-wrong}\begin{itemize}
\item {} 
If you have problems that seem to be due to kernel bugs, please check
the file MAINTAINERS to see if there is a particular person associated
with the part of the kernel that you are having trouble with. If there
isn't anyone listed there, then the second best thing is to mail
them to me (\href{mailto:torvalds@linux-foundation.org}{torvalds@linux-foundation.org}), and possibly to any other
relevant mailing-list or to the newsgroup.

\item {} 
In all bug-reports, \emph{please} tell what kernel you are talking about,
how to duplicate the problem, and what your setup is (use your common
sense).  If the problem is new, tell me so, and if the problem is
old, please try to tell me when you first noticed it.

\item {} 
If the bug results in a message like:

\begin{Verbatim}[commandchars=\\\{\}]
unable to handle kernel paging request at address C0000010
Oops: 0002
EIP:   0010:XXXXXXXX
eax: xxxxxxxx   ebx: xxxxxxxx   ecx: xxxxxxxx   edx: xxxxxxxx
esi: xxxxxxxx   edi: xxxxxxxx   ebp: xxxxxxxx
ds: xxxx  es: xxxx  fs: xxxx  gs: xxxx
Pid: xx, process nr: xx
xx xx xx xx xx xx xx xx xx xx
\end{Verbatim}

or similar kernel debugging information on your screen or in your
system log, please duplicate it \emph{exactly}.  The dump may look
incomprehensible to you, but it does contain information that may
help debugging the problem.  The text above the dump is also
important: it tells something about why the kernel dumped code (in
the above example, it's due to a bad kernel pointer). More information
on making sense of the dump is in Documentation/admin-guide/bug-hunting.rst

\item {} 
If you compiled the kernel with CONFIG\_KALLSYMS you can send the dump
as is, otherwise you will have to use the \code{ksymoops} program to make
sense of the dump (but compiling with CONFIG\_KALLSYMS is usually preferred).
This utility can be downloaded from
\href{https://www.kernel.org/pub/linux/utils/kernel/ksymoops/}{https://www.kernel.org/pub/linux/utils/kernel/ksymoops/} .
Alternatively, you can do the dump lookup by hand:

\item {} 
In debugging dumps like the above, it helps enormously if you can
look up what the EIP value means.  The hex value as such doesn't help
me or anybody else very much: it will depend on your particular
kernel setup.  What you should do is take the hex value from the EIP
line (ignore the \code{0010:}), and look it up in the kernel namelist to
see which kernel function contains the offending address.

To find out the kernel function name, you'll need to find the system
binary associated with the kernel that exhibited the symptom.  This is
the file `linux/vmlinux'.  To extract the namelist and match it against
the EIP from the kernel crash, do:

\begin{Verbatim}[commandchars=\\\{\}]
nm vmlinux \textbar{} sort \textbar{} less
\end{Verbatim}

This will give you a list of kernel addresses sorted in ascending
order, from which it is simple to find the function that contains the
offending address.  Note that the address given by the kernel
debugging messages will not necessarily match exactly with the
function addresses (in fact, that is very unlikely), so you can't
just `grep' the list: the list will, however, give you the starting
point of each kernel function, so by looking for the function that
has a starting address lower than the one you are searching for but
is followed by a function with a higher address you will find the one
you want.  In fact, it may be a good idea to include a bit of
``context'' in your problem report, giving a few lines around the
interesting one.

If you for some reason cannot do the above (you have a pre-compiled
kernel image or similar), telling me as much about your setup as
possible will help.  Please read the {\hyperref[admin\string-guide/reporting\string-bugs:reportingbugs]{\emph{admin-guide/reporting-bugs.rst}}}
document for details.

\item {} 
Alternatively, you can use gdb on a running kernel. (read-only; i.e. you
cannot change values or set break points.) To do this, first compile the
kernel with -g; edit arch/x86/Makefile appropriately, then do a \code{make
clean}. You'll also need to enable CONFIG\_PROC\_FS (via \code{make config}).

After you've rebooted with the new kernel, do \code{gdb vmlinux /proc/kcore}.
You can now use all the usual gdb commands. The command to look up the
point where your system crashed is \code{l *0xXXXXXXXX}. (Replace the XXXes
with the EIP value.)

gdb'ing a non-running kernel currently fails because \code{gdb} (wrongly)
disregards the starting offset for which the kernel is compiled.

\end{itemize}


\chapter{The kernel's command-line parameters}
\label{admin-guide/kernel-parameters:the-kernel-s-command-line-parameters}\label{admin-guide/kernel-parameters:kernelparameters}\label{admin-guide/kernel-parameters::doc}
The following is a consolidated list of the kernel parameters as
implemented by the \_\_setup(), core\_param() and module\_param() macros
and sorted into English Dictionary order (defined as ignoring all
punctuation and sorting digits before letters in a case insensitive
manner), and with descriptions where known.

The kernel parses parameters from the kernel command line up to ``--'';
if it doesn't recognize a parameter and it doesn't contain a `.', the
parameter gets passed to init: parameters with `=' go into init's
environment, others are passed as command line arguments to init.
Everything after ``--'' is passed as an argument to init.

Module parameters can be specified in two ways: via the kernel command
line with a module name prefix, or via modprobe, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
(kernel command line) usbcore.blinkenlights=1
(modprobe command line) modprobe usbcore blinkenlights=1
\end{Verbatim}

Parameters for modules which are built into the kernel need to be
specified on the kernel command line.  modprobe looks through the
kernel command line (/proc/cmdline) and collects module parameters
when it loads a module, so the kernel command line can be used for
loadable modules too.

Hyphens (dashes) and underscores are equivalent in parameter names, so:

\begin{Verbatim}[commandchars=\\\{\}]
log\PYGZus{}buf\PYGZus{}len=1M print\PYGZhy{}fatal\PYGZhy{}signals=1
\end{Verbatim}

can also be entered as:

\begin{Verbatim}[commandchars=\\\{\}]
log\PYGZhy{}buf\PYGZhy{}len=1M print\PYGZus{}fatal\PYGZus{}signals=1
\end{Verbatim}

Double-quotes can be used to protect spaces in values, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
param=\PYGZdq{}spaces in here\PYGZdq{}
\end{Verbatim}


\section{cpu lists:}
\label{admin-guide/kernel-parameters:cpu-lists}
Some kernel parameters take a list of CPUs as a value, e.g.  isolcpus,
nohz\_full, irqaffinity, rcu\_nocbs.  The format of this list is:
\begin{quote}

\textless{}cpu number\textgreater{},...,\textless{}cpu number\textgreater{}
\end{quote}

or
\begin{quote}

\textless{}cpu number\textgreater{}-\textless{}cpu number\textgreater{}
(must be a positive range in ascending order)
\end{quote}

or a mixture

\textless{}cpu number\textgreater{},...,\textless{}cpu number\textgreater{}-\textless{}cpu number\textgreater{}

Note that for the special case of a range one can split the range into equal
sized groups and for each group use some amount from the beginning of that
group:
\begin{quote}

\textless{}cpu number\textgreater{}-cpu number\textgreater{}:\textless{}used size\textgreater{}/\textless{}group size\textgreater{}
\end{quote}

For example one can add to the command line following parameter:
\begin{quote}

isolcpus=1,2,10-20,100-2000:2/25
\end{quote}

where the final item represents CPUs 100,101,125,126,150,151,...

This document may not be entirely up to date and comprehensive. The command
``modinfo -p \$\{modulename\}'' shows a current list of all parameters of a loadable
module. Loadable modules, after being loaded into the running kernel, also
reveal their parameters in /sys/module/\$\{modulename\}/parameters/. Some of these
parameters may be changed at runtime by the command
\code{echo -n \$\{value\} \textgreater{} /sys/module/\$\{modulename\}/parameters/\$\{parm\}}.

The parameters listed below are only valid if certain kernel build options were
enabled and if respective hardware is present. The text in square brackets at
the beginning of each description states the restrictions within which a
parameter is applicable:

\begin{Verbatim}[commandchars=\\\{\}]
ACPI    ACPI support is enabled.
AGP     AGP (Accelerated Graphics Port) is enabled.
ALSA    ALSA sound support is enabled.
APIC    APIC support is enabled.
APM     Advanced Power Management support is enabled.
ARM     ARM architecture is enabled.
AX25    Appropriate AX.25 support is enabled.
BLACKFIN Blackfin architecture is enabled.
CLK     Common clock infrastructure is enabled.
CMA     Contiguous Memory Area support is enabled.
DRM     Direct Rendering Management support is enabled.
DYNAMIC\PYGZus{}DEBUG Build in debug messages and enable them at runtime
EDD     BIOS Enhanced Disk Drive Services (EDD) is enabled
EFI     EFI Partitioning (GPT) is enabled
EIDE    EIDE/ATAPI support is enabled.
EVM     Extended Verification Module
FB      The frame buffer device is enabled.
FTRACE  Function tracing enabled.
GCOV    GCOV profiling is enabled.
HW      Appropriate hardware is enabled.
IA\PYGZhy{}64   IA\PYGZhy{}64 architecture is enabled.
IMA     Integrity measurement architecture is enabled.
IOSCHED More than one I/O scheduler is enabled.
IP\PYGZus{}PNP  IP DHCP, BOOTP, or RARP is enabled.
IPV6    IPv6 support is enabled.
ISAPNP  ISA PnP code is enabled.
ISDN    Appropriate ISDN support is enabled.
ISOL    CPU Isolation is enabled.
JOY     Appropriate joystick support is enabled.
KGDB    Kernel debugger support is enabled.
KVM     Kernel Virtual Machine support is enabled.
LIBATA  Libata driver is enabled
LP      Printer support is enabled.
LOOP    Loopback device support is enabled.
M68k    M68k architecture is enabled.
                These options have more detailed description inside of
                Documentation/m68k/kernel\PYGZhy{}options.txt.
MDA     MDA console support is enabled.
MIPS    MIPS architecture is enabled.
MOUSE   Appropriate mouse support is enabled.
MSI     Message Signaled Interrupts (PCI).
MTD     MTD (Memory Technology Device) support is enabled.
NET     Appropriate network support is enabled.
NUMA    NUMA support is enabled.
NFS     Appropriate NFS support is enabled.
OSS     OSS sound support is enabled.
PV\PYGZus{}OPS  A paravirtualized kernel is enabled.
PARIDE  The ParIDE (parallel port IDE) subsystem is enabled.
PARISC  The PA\PYGZhy{}RISC architecture is enabled.
PCI     PCI bus support is enabled.
PCIE    PCI Express support is enabled.
PCMCIA  The PCMCIA subsystem is enabled.
PNP     Plug \PYGZam{} Play support is enabled.
PPC     PowerPC architecture is enabled.
PPT     Parallel port support is enabled.
PS2     Appropriate PS/2 support is enabled.
RAM     RAM disk support is enabled.
RDT     Intel Resource Director Technology.
S390    S390 architecture is enabled.
SCSI    Appropriate SCSI support is enabled.
                A lot of drivers have their options described inside
                the Documentation/scsi/ sub\PYGZhy{}directory.
SECURITY Different security models are enabled.
SELINUX SELinux support is enabled.
APPARMOR AppArmor support is enabled.
SERIAL  Serial support is enabled.
SH      SuperH architecture is enabled.
SMP     The kernel is an SMP kernel.
SPARC   Sparc architecture is enabled.
SWSUSP  Software suspend (hibernation) is enabled.
SUSPEND System suspend states are enabled.
TPM     TPM drivers are enabled.
TS      Appropriate touchscreen support is enabled.
UMS     USB Mass Storage support is enabled.
USB     USB support is enabled.
USBHID  USB Human Interface Device support is enabled.
V4L     Video For Linux support is enabled.
VMMIO   Driver for memory mapped virtio devices is enabled.
VGA     The VGA console has been enabled.
VT      Virtual terminal support is enabled.
WDT     Watchdog support is enabled.
XT      IBM PC/XT MFM hard disk support is enabled.
X86\PYGZhy{}32  X86\PYGZhy{}32, aka i386 architecture is enabled.
X86\PYGZhy{}64  X86\PYGZhy{}64 architecture is enabled.
                More X86\PYGZhy{}64 boot options can be found in
                Documentation/x86/x86\PYGZus{}64/boot\PYGZhy{}options.txt .
X86     Either 32\PYGZhy{}bit or 64\PYGZhy{}bit x86 (same as X86\PYGZhy{}32+X86\PYGZhy{}64)
X86\PYGZus{}UV  SGI UV support is enabled.
XEN     Xen support is enabled
\end{Verbatim}

In addition, the following text indicates that the option:

\begin{Verbatim}[commandchars=\\\{\}]
BUGS=   Relates to possible processor bugs on the said processor.
KNL     Is a kernel start\PYGZhy{}up parameter.
BOOT    Is a boot loader parameter.
\end{Verbatim}

Parameters denoted with BOOT are actually interpreted by the boot
loader, and have no meaning to the kernel directly.
Do not modify the syntax of boot loader parameters without extreme
need or coordination with \textless{}Documentation/x86/boot.txt\textgreater{}.

There are also arch-specific kernel-parameters not documented here.
See for example \textless{}Documentation/x86/x86\_64/boot-options.txt\textgreater{}.

Note that ALL kernel parameters listed below are CASE SENSITIVE, and that
a trailing = on the name of any parameter states that that parameter will
be entered as an environment variable, whereas its absence indicates that
it will appear as a kernel argument readable via /proc/cmdline by programs
running once the system is up.

The number of kernel parameters is not limited, but the length of the
complete command line (parameters including spaces etc.) is limited to
a fixed number of characters. This limit depends on the architecture
and is between 256 and 4096 characters. It is defined in the file
./include/asm/setup.h as COMMAND\_LINE\_SIZE.

Finally, the {[}KMG{]} suffix is commonly described after a number of kernel
parameter values. These `K', `M', and `G' letters represent the \_binary\_
multipliers `Kilo', `Mega', and `Giga', equaling 2\textasciicircum{}10, 2\textasciicircum{}20, and 2\textasciicircum{}30
bytes respectively. Such letter suffixes can also be entirely omitted:
\begin{alltt}
        acpi=           {[}HW,ACPI,X86,ARM64{]}
                        Advanced Configuration and Power Interface
                        Format: \{ force \textbar{} on \textbar{} off \textbar{} strict \textbar{} noirq \textbar{} rsdt \textbar{}
                                  copy\_dsdt \}
                        force -- enable ACPI if default was off
                        on -- enable ACPI but allow fallback to DT {[}arm64{]}
                        off -- disable ACPI if default was on
                        noirq -- do not use ACPI for IRQ routing
                        strict -- Be less tolerant of platforms that are not
                                strictly ACPI specification compliant.
                        rsdt -- prefer RSDT over (default) XSDT
                        copy\_dsdt -- copy DSDT to memory
                        For ARM64, ONLY ``acpi=off'', ``acpi=on'' or ``acpi=force''
                        are available

                        See also Documentation/power/runtime\_pm.txt, pci=noacpi

        acpi\_apic\_instance=     {[}ACPI, IOAPIC{]}
                        Format: \textless{}int\textgreater{}
                        2: use 2nd APIC table, if available
                        1,0: use 1st APIC table
                        default: 0

        acpi\_backlight= {[}HW,ACPI{]}
                        acpi\_backlight=vendor
                        acpi\_backlight=video
                        If set to vendor, prefer vendor specific driver
                        (e.g. thinkpad\_acpi, sony\_acpi, etc.) instead
                        of the ACPI video.ko driver.

        acpi\_force\_32bit\_fadt\_addr
                        force FADT to use 32 bit addresses rather than the
                        64 bit X\_* addresses. Some firmware have broken 64
                        bit addresses for force ACPI ignore these and use
                        the older legacy 32 bit addresses.

        acpica\_no\_return\_repair {[}HW, ACPI{]}
                        Disable AML predefined validation mechanism
                        This mechanism can repair the evaluation result to make
                        the return objects more ACPI specification compliant.
                        This option is useful for developers to identify the
                        root cause of an AML interpreter issue when the issue
                        has something to do with the repair mechanism.

        acpi.debug\_layer=       {[}HW,ACPI,ACPI\_DEBUG{]}
        acpi.debug\_level=       {[}HW,ACPI,ACPI\_DEBUG{]}
                        Format: \textless{}int\textgreater{}
                        CONFIG\_ACPI\_DEBUG must be enabled to produce any ACPI
                        debug output.  Bits in debug\_layer correspond to a
                        \_COMPONENT in an ACPI source file, e.g.,
                            \#define \_COMPONENT ACPI\_PCI\_COMPONENT
                        Bits in debug\_level correspond to a level in
                        ACPI\_DEBUG\_PRINT statements, e.g.,
                            ACPI\_DEBUG\_PRINT((ACPI\_DB\_INFO, ...
                        The debug\_level mask defaults to ``info''.  See
                        Documentation/acpi/debug.txt for more information about
                        debug layers and levels.

                        Enable processor driver info messages:
                            acpi.debug\_layer=0x20000000
                        Enable PCI/PCI interrupt routing info messages:
                            acpi.debug\_layer=0x400000
                        Enable AML ``Debug'' output, i.e., stores to the Debug
                        object while interpreting AML:
                            acpi.debug\_layer=0xffffffff acpi.debug\_level=0x2
                        Enable all messages related to ACPI hardware:
                            acpi.debug\_layer=0x2 acpi.debug\_level=0xffffffff

                        Some values produce so much output that the system is
                        unusable.  The ``log\_buf\_len'' parameter may be useful
                        if you need to capture more output.

        acpi\_enforce\_resources= {[}ACPI{]}
                        \{ strict \textbar{} lax \textbar{} no \}
                        Check for resource conflicts between native drivers
                        and ACPI OperationRegions (SystemIO and SystemMemory
                        only). IO ports and memory declared in ACPI might be
                        used by the ACPI subsystem in arbitrary AML code and
                        can interfere with legacy drivers.
                        strict (default): access to resources claimed by ACPI
                        is denied; legacy drivers trying to access reserved
                        resources will fail to bind to device using them.
                        lax: access to resources claimed by ACPI is allowed;
                        legacy drivers trying to access reserved resources
                        will bind successfully but a warning message is logged.
                        no: ACPI OperationRegions are not marked as reserved,
                        no further checks are performed.

        acpi\_force\_table\_verification   {[}HW,ACPI{]}
                        Enable table checksum verification during early stage.
                        By default, this is disabled due to x86 early mapping
                        size limitation.

        acpi\_irq\_balance {[}HW,ACPI{]}
                        ACPI will balance active IRQs
                        default in APIC mode

        acpi\_irq\_nobalance {[}HW,ACPI{]}
                        ACPI will not move active IRQs (default)
                        default in PIC mode

        acpi\_irq\_isa=   {[}HW,ACPI{]} If irq\_balance, mark listed IRQs used by ISA
                        Format: \textless{}irq\textgreater{},\textless{}irq\textgreater{}...

        acpi\_irq\_pci=   {[}HW,ACPI{]} If irq\_balance, clear listed IRQs for
                        use by PCI
                        Format: \textless{}irq\textgreater{},\textless{}irq\textgreater{}...

        acpi\_mask\_gpe=  {[}HW,ACPI{]}
                        Due to the existence of \_Lxx/\_Exx, some GPEs triggered
                        by unsupported hardware/firmware features can result in
                        GPE floodings that cannot be automatically disabled by
                        the GPE dispatcher.
                        This facility can be used to prevent such uncontrolled
                        GPE floodings.
                        Format: \textless{}int\textgreater{}

        acpi\_no\_auto\_serialize  {[}HW,ACPI{]}
                        Disable auto-serialization of AML methods
                        AML control methods that contain the opcodes to create
                        named objects will be marked as ``Serialized'' by the
                        auto-serialization feature.
                        This feature is enabled by default.
                        This option allows to turn off the feature.

        acpi\_no\_memhotplug {[}ACPI{]} Disable memory hotplug.  Useful for kdump
                           kernels.

        acpi\_no\_static\_ssdt     {[}HW,ACPI{]}
                        Disable installation of static SSDTs at early boot time
                        By default, SSDTs contained in the RSDT/XSDT will be
                        installed automatically and they will appear under
                        /sys/firmware/acpi/tables.
                        This option turns off this feature.
                        Note that specifying this option does not affect
                        dynamic table installation which will install SSDT
                        tables to /sys/firmware/acpi/tables/dynamic.

        acpi\_rsdp=      {[}ACPI,EFI,KEXEC{]}
                        Pass the RSDP address to the kernel, mostly used
                        on machines running EFI runtime service to boot the
                        second kernel for kdump.

        acpi\_os\_name=   {[}HW,ACPI{]} Tell ACPI BIOS the name of the OS
                        Format: To spoof as Windows 98: =''Microsoft Windows''

        acpi\_rev\_override {[}ACPI{]} Override the \_REV object to return 5 (instead
                        of 2 which is mandated by ACPI 6) as the supported ACPI
                        specification revision (when using this switch, it may
                        be necessary to carry out a cold reboot \_twice\_ in a
                        row to make it take effect on the platform firmware).

        acpi\_osi=       {[}HW,ACPI{]} Modify list of supported OS interface strings
                        acpi\_osi=''string1''      \# add string1
                        acpi\_osi=''!string2''     \# remove string2
                        acpi\_osi=!*             \# remove all strings
                        acpi\_osi=!              \# disable all built-in OS vendor
                                                  strings
                        acpi\_osi=!!             \# enable all built-in OS vendor
                                                  strings
                        acpi\_osi=               \# disable all strings

                        `acpi\_osi=!' can be used in combination with single or
                        multiple `acpi\_osi=''string1''' to support specific OS
                        vendor string(s).  Note that such command can only
                        affect the default state of the OS vendor strings, thus
                        it cannot affect the default state of the feature group
                        strings and the current state of the OS vendor strings,
                        specifying it multiple times through kernel command line
                        is meaningless.  This command is useful when one do not
                        care about the state of the feature group strings which
                        should be controlled by the OSPM.
                        Examples:
                          1. `acpi\_osi=! acpi\_osi=''Windows 2000''' is equivalent
                             to `acpi\_osi=''Windows 2000'' acpi\_osi=!', they all
                             can make `\_OSI(``Windows 2000'')' TRUE.

                        `acpi\_osi=' cannot be used in combination with other
                        `acpi\_osi=' command lines, the \_OSI method will not
                        exist in the ACPI namespace.  NOTE that such command can
                        only affect the \_OSI support state, thus specifying it
                        multiple times through kernel command line is also
                        meaningless.
                        Examples:
                          1. `acpi\_osi=' can make `CondRefOf(\_OSI, Local1)'
                             FALSE.

                        `acpi\_osi=!*' can be used in combination with single or
                        multiple `acpi\_osi=''string1''' to support specific
                        string(s).  Note that such command can affect the
                        current state of both the OS vendor strings and the
                        feature group strings, thus specifying it multiple times
                        through kernel command line is meaningful.  But it may
                        still not able to affect the final state of a string if
                        there are quirks related to this string.  This command
                        is useful when one want to control the state of the
                        feature group strings to debug BIOS issues related to
                        the OSPM features.
                        Examples:
                          1. `acpi\_osi=''Module Device'' acpi\_osi=!*' can make
                             `\_OSI(``Module Device'')' FALSE.
                          2. `acpi\_osi=!* acpi\_osi=''Module Device''' can make
                             `\_OSI(``Module Device'')' TRUE.
                          3. `acpi\_osi=! acpi\_osi=!* acpi\_osi=''Windows 2000''' is
                             equivalent to
                             `acpi\_osi=!* acpi\_osi=! acpi\_osi=''Windows 2000'''
                             and
                             `acpi\_osi=!* acpi\_osi=''Windows 2000'' acpi\_osi=!',
                             they all will make `\_OSI(``Windows 2000'')' TRUE.

        acpi\_pm\_good    {[}X86{]}
                        Override the pmtimer bug detection: force the kernel
                        to assume that this machine's pmtimer latches its value
                        and always returns good values.

        acpi\_sci=       {[}HW,ACPI{]} ACPI System Control Interrupt trigger mode
                        Format: \{ level \textbar{} edge \textbar{} high \textbar{} low \}

        acpi\_skip\_timer\_override {[}HW,ACPI{]}
                        Recognize and ignore IRQ0/pin2 Interrupt Override.
                        For broken nForce2 BIOS resulting in XT-PIC timer.

        acpi\_sleep=     {[}HW,ACPI{]} Sleep options
                        Format: \{ s3\_bios, s3\_mode, s3\_beep, s4\_nohwsig,
                                  old\_ordering, nonvs, sci\_force\_enable, nobl \}
                        See Documentation/power/video.txt for information on
                        s3\_bios and s3\_mode.
                        s3\_beep is for debugging; it makes the PC's speaker beep
                        as soon as the kernel's real-mode entry point is called.
                        s4\_nohwsig prevents ACPI hardware signature from being
                        used during resume from hibernation.
                        old\_ordering causes the ACPI 1.0 ordering of the \_PTS
                        control method, with respect to putting devices into
                        low power states, to be enforced (the ACPI 2.0 ordering
                        of \_PTS is used by default).
                        nonvs prevents the kernel from saving/restoring the
                        ACPI NVS memory during suspend/hibernation and resume.
                        sci\_force\_enable causes the kernel to set SCI\_EN directly
                        on resume from S1/S3 (which is against the ACPI spec,
                        but some broken systems don't work without it).
                        nobl causes the internal blacklist of systems known to
                        behave incorrectly in some ways with respect to system
                        suspend and resume to be ignored (use wisely).

        acpi\_use\_timer\_override {[}HW,ACPI{]}
                        Use timer override. For some broken Nvidia NF5 boards
                        that require a timer override, but don't have HPET

        add\_efi\_memmap  {[}EFI; X86{]} Include EFI memory map in
                        kernel's map of available physical RAM.

        agp=            {[}AGP{]}
                        \{ off \textbar{} try\_unsupported \}
                        off: disable AGP support
                        try\_unsupported: try to drive unsupported chipsets
                                (may crash computer or cause data corruption)

        ALSA            {[}HW,ALSA{]}
                        See Documentation/sound/alsa/alsa-parameters.txt

        alignment=      {[}KNL,ARM{]}
                        Allow the default userspace alignment fault handler
                        behaviour to be specified.  Bit 0 enables warnings,
                        bit 1 enables fixups, and bit 2 sends a segfault.

        align\_va\_addr=  {[}X86-64{]}
                        Align virtual addresses by clearing slice {[}14:12{]} when
                        allocating a VMA at process creation time. This option
                        gives you up to 3\% performance improvement on AMD F15h
                        machines (where it is enabled by default) for a
                        CPU-intensive style benchmark, and it can vary highly in
                        a microbenchmark depending on workload and compiler.

                        32: only for 32-bit processes
                        64: only for 64-bit processes
                        on: enable for both 32- and 64-bit processes
                        off: disable for both 32- and 64-bit processes

        alloc\_snapshot  {[}FTRACE{]}
                        Allocate the ftrace snapshot buffer on boot up when the
                        main buffer is allocated. This is handy if debugging
                        and you need to use tracing\_snapshot() on boot up, and
                        do not want to use tracing\_snapshot\_alloc() as it needs
                        to be done where GFP\_KERNEL allocations are allowed.

        amd\_iommu=      {[}HW,X86-64{]}
                        Pass parameters to the AMD IOMMU driver in the system.
                        Possible values are:
                        fullflush - enable flushing of IO/TLB entries when
                                    they are unmapped. Otherwise they are
                                    flushed before they will be reused, which
                                    is a lot of faster
                        off       - do not initialize any AMD IOMMU found in
                                    the system
                        force\_isolation - Force device isolation for all
                                          devices. The IOMMU driver is not
                                          allowed anymore to lift isolation
                                          requirements as needed. This option
                                          does not override iommu=pt

        amd\_iommu\_dump= {[}HW,X86-64{]}
                        Enable AMD IOMMU driver option to dump the ACPI table
                        for AMD IOMMU. With this option enabled, AMD IOMMU
                        driver will print ACPI tables for AMD IOMMU during
                        IOMMU initialization.

        amd\_iommu\_intr= {[}HW,X86-64{]}
                        Specifies one of the following AMD IOMMU interrupt
                        remapping modes:
                        legacy     - Use legacy interrupt remapping mode.
                        vapic      - Use virtual APIC mode, which allows IOMMU
                                     to inject interrupts directly into guest.
                                     This mode requires kvm-amd.avic=1.
                                     (Default when IOMMU HW support is present.)

        amijoy.map=     {[}HW,JOY{]} Amiga joystick support
                        Map of devices attached to JOY0DAT and JOY1DAT
                        Format: \textless{}a\textgreater{},\textless{}b\textgreater{}
                        See also Documentation/input/joydev/joystick.rst

        analog.map=     {[}HW,JOY{]} Analog joystick and gamepad support
                        Specifies type or capabilities of an analog joystick
                        connected to one of 16 gameports
                        Format: \textless{}type1\textgreater{},\textless{}type2\textgreater{},..\textless{}type16\textgreater{}

        apc=            {[}HW,SPARC{]}
                        Power management functions (SPARCstation-4/5 + deriv.)
                        Format: noidle
                        Disable APC CPU standby support. SPARCstation-Fox does
                        not play well with APC CPU idle - disable it if you have
                        APC and your system crashes randomly.

        apic=           {[}APIC,X86{]} Advanced Programmable Interrupt Controller
                        Change the output verbosity whilst booting
                        Format: \{ quiet (default) \textbar{} verbose \textbar{} debug \}
                        Change the amount of debugging information output
                        when initialising the APIC and IO-APIC components.
                        For X86-32, this can also be used to specify an APIC
                        driver name.
                        Format: apic=driver\_name
                        Examples: apic=bigsmp

        apic\_extnmi=    {[}APIC,X86{]} External NMI delivery setting
                        Format: \{ bsp (default) \textbar{} all \textbar{} none \}
                        bsp:  External NMI is delivered only to CPU 0
                        all:  External NMIs are broadcast to all CPUs as a
                              backup of CPU 0
                        none: External NMI is masked for all CPUs. This is
                              useful so that a dump capture kernel won't be
                              shot down by NMI

        autoconf=       {[}IPV6{]}
                        See Documentation/networking/ipv6.txt.

        show\_lapic=     {[}APIC,X86{]} Advanced Programmable Interrupt Controller
                        Limit apic dumping. The parameter defines the maximal
                        number of local apics being dumped. Also it is possible
                        to set it to ``all'' by meaning -- no limit here.
                        Format: \{ 1 (default) \textbar{} 2 \textbar{} ... \textbar{} all \}.
                        The parameter valid if only apic=debug or
                        apic=verbose is specified.
                        Example: apic=debug show\_lapic=all

        apm=            {[}APM{]} Advanced Power Management
                        See header of arch/x86/kernel/apm\_32.c.

        arcrimi=        {[}HW,NET{]} ARCnet - ``RIM I'' (entirely mem-mapped) cards
                        Format: \textless{}io\textgreater{},\textless{}irq\textgreater{},\textless{}nodeID\textgreater{}

        ataflop=        {[}HW,M68k{]}

        atarimouse=     {[}HW,MOUSE{]} Atari Mouse

        atkbd.extra=    {[}HW{]} Enable extra LEDs and keys on IBM RapidAccess,
                        EzKey and similar keyboards

        atkbd.reset=    {[}HW{]} Reset keyboard during initialization

        atkbd.set=      {[}HW{]} Select keyboard code set
                        Format: \textless{}int\textgreater{} (2 = AT (default), 3 = PS/2)

        atkbd.scroll=   {[}HW{]} Enable scroll wheel on MS Office and similar
                        keyboards

        atkbd.softraw=  {[}HW{]} Choose between synthetic and real raw mode
                        Format: \textless{}bool\textgreater{} (0 = real, 1 = synthetic (default))

        atkbd.softrepeat= {[}HW{]}
                        Use software keyboard repeat

        audit=          {[}KNL{]} Enable the audit sub-system
                        Format: \{ ``0'' \textbar{} ``1'' \} (0 = disabled, 1 = enabled)
                        0 - kernel audit is disabled and can not be enabled
                            until the next reboot
                        unset - kernel audit is initialized but disabled and
                            will be fully enabled by the userspace auditd.
                        1 - kernel audit is initialized and partially enabled,
                            storing at most audit\_backlog\_limit messages in
                            RAM until it is fully enabled by the userspace
                            auditd.
                        Default: unset

        audit\_backlog\_limit= {[}KNL{]} Set the audit queue size limit.
                        Format: \textless{}int\textgreater{} (must be \textgreater{}=0)
                        Default: 64

        bau=            {[}X86\_UV{]} Enable the BAU on SGI UV.  The default
                        behavior is to disable the BAU (i.e. bau=0).
                        Format: \{ ``0'' \textbar{} ``1'' \}
                        0 - Disable the BAU.
                        1 - Enable the BAU.
                        unset - Disable the BAU.

        baycom\_epp=     {[}HW,AX25{]}
                        Format: \textless{}io\textgreater{},\textless{}mode\textgreater{}

        baycom\_par=     {[}HW,AX25{]} BayCom Parallel Port AX.25 Modem
                        Format: \textless{}io\textgreater{},\textless{}mode\textgreater{}
                        See header of drivers/net/hamradio/baycom\_par.c.

        baycom\_ser\_fdx= {[}HW,AX25{]}
                        BayCom Serial Port AX.25 Modem (Full Duplex Mode)
                        Format: \textless{}io\textgreater{},\textless{}irq\textgreater{},\textless{}mode\textgreater{}{[},\textless{}baud\textgreater{}{]}
                        See header of drivers/net/hamradio/baycom\_ser\_fdx.c.

        baycom\_ser\_hdx= {[}HW,AX25{]}
                        BayCom Serial Port AX.25 Modem (Half Duplex Mode)
                        Format: \textless{}io\textgreater{},\textless{}irq\textgreater{},\textless{}mode\textgreater{}
                        See header of drivers/net/hamradio/baycom\_ser\_hdx.c.

        blkdevparts=    Manual partition parsing of block device(s) for
                        embedded devices based on command line input.
                        See Documentation/block/cmdline-partition.txt

        boot\_delay=     Milliseconds to delay each printk during boot.
                        Values larger than 10 seconds (10000) are changed to
                        no delay (0).
                        Format: integer

        bootmem\_debug   {[}KNL{]} Enable bootmem allocator debug messages.

        bert\_disable    {[}ACPI{]}
                        Disable BERT OS support on buggy BIOSes.

        bttv.card=      {[}HW,V4L{]} bttv (bt848 + bt878 based grabber cards)
        bttv.radio=     Most important insmod options are available as
                        kernel args too.
        bttv.pll=       See Documentation/media/v4l-drivers/bttv.rst
        bttv.tuner=

        bulk\_remove=off {[}PPC{]}  This parameter disables the use of the pSeries
                        firmware feature for flushing multiple hpte entries
                        at a time.

        c101=           {[}NET{]} Moxa C101 synchronous serial card

        cachesize=      {[}BUGS=X86-32{]} Override level 2 CPU cache size detection.
                        Sometimes CPU hardware bugs make them report the cache
                        size incorrectly. The kernel will attempt work arounds
                        to fix known problems, but for some CPUs it is not
                        possible to determine what the correct size should be.
                        This option provides an override for these situations.

        ca\_keys=        {[}KEYS{]} This parameter identifies a specific key(s) on
                        the system trusted keyring to be used for certificate
                        trust validation.
                        format: \{ id:\textless{}keyid\textgreater{} \textbar{} builtin \}

        cca=            {[}MIPS{]} Override the kernel pages' cache coherency
                        algorithm.  Accepted values range from 0 to 7
                        inclusive. See arch/mips/include/asm/pgtable-bits.h
                        for platform specific values (SB1, Loongson3 and
                        others).

        ccw\_timeout\_log {[}S390{]}
                        See Documentation/s390/CommonIO for details.

        cgroup\_disable= {[}KNL{]} Disable a particular controller
                        Format: \{name of the controller(s) to disable\}
                        The effects of cgroup\_disable=foo are:
                        - foo isn't auto-mounted if you mount all cgroups in
                          a single hierarchy
                        - foo isn't visible as an individually mountable
                          subsystem
                        \{Currently only ``memory'' controller deal with this and
                        cut the overhead, others just disable the usage. So
                        only cgroup\_disable=memory is actually worthy\}

        cgroup\_no\_v1=   {[}KNL{]} Disable one, multiple, all cgroup controllers in v1
                        Format: \{ controller{[},controller...{]} \textbar{} ``all'' \}
                        Like cgroup\_disable, but only applies to cgroup v1;
                        the blacklisted controllers remain available in cgroup2.

        cgroup.memory=  {[}KNL{]} Pass options to the cgroup memory controller.
                        Format: \textless{}string\textgreater{}
                        nosocket -- Disable socket memory accounting.
                        nokmem -- Disable kernel memory accounting.

        checkreqprot    {[}SELINUX{]} Set initial checkreqprot flag value.
                        Format: \{ ``0'' \textbar{} ``1'' \}
                        See security/selinux/Kconfig help text.
                        0 -- check protection applied by kernel (includes
                                any implied execute protection).
                        1 -- check protection requested by application.
                        Default value is set via a kernel config option.
                        Value can be changed at runtime via
                                /selinux/checkreqprot.

        cio\_ignore=     {[}S390{]}
                        See Documentation/s390/CommonIO for details.
        clk\_ignore\_unused
                        {[}CLK{]}
                        Prevents the clock framework from automatically gating
                        clocks that have not been explicitly enabled by a Linux
                        device driver but are enabled in hardware at reset or
                        by the bootloader/firmware. Note that this does not
                        force such clocks to be always-on nor does it reserve
                        those clocks in any way. This parameter is useful for
                        debug and development, but should not be needed on a
                        platform with proper driver support.  For more
                        information, see Documentation/clk.txt.

        clock=          {[}BUGS=X86-32, HW{]} gettimeofday clocksource override.
                        {[}Deprecated{]}
                        Forces specified clocksource (if available) to be used
                        when calculating gettimeofday(). If specified
                        clocksource is not available, it defaults to PIT.
                        Format: \{ pit \textbar{} tsc \textbar{} cyclone \textbar{} pmtmr \}

        clocksource=    Override the default clocksource
                        Format: \textless{}string\textgreater{}
                        Override the default clocksource and use the clocksource
                        with the name specified.
                        Some clocksource names to choose from, depending on
                        the platform:
                        {[}all{]} jiffies (this is the base, fallback clocksource)
                        {[}ACPI{]} acpi\_pm
                        {[}ARM{]} imx\_timer1,OSTS,netx\_timer,mpu\_timer2,
                                pxa\_timer,timer3,32k\_counter,timer0\_1
                        {[}X86-32{]} pit,hpet,tsc;
                                scx200\_hrt on Geode; cyclone on IBM x440
                        {[}MIPS{]} MIPS
                        {[}PARISC{]} cr16
                        {[}S390{]} tod
                        {[}SH{]} SuperH
                        {[}SPARC64{]} tick
                        {[}X86-64{]} hpet,tsc

        clocksource.arm\_arch\_timer.evtstrm=
                        {[}ARM,ARM64{]}
                        Format: \textless{}bool\textgreater{}
                        Enable/disable the eventstream feature of the ARM
                        architected timer so that code using WFE-based polling
                        loops can be debugged more effectively on production
                        systems.

        clearcpuid=BITNUM {[}X86{]}
                        Disable CPUID feature X for the kernel. See
                        arch/x86/include/asm/cpufeatures.h for the valid bit
                        numbers. Note the Linux specific bits are not necessarily
                        stable over kernel options, but the vendor specific
                        ones should be.
                        Also note that user programs calling CPUID directly
                        or using the feature without checking anything
                        will still see it. This just prevents it from
                        being used by the kernel or shown in /proc/cpuinfo.
                        Also note the kernel might malfunction if you disable
                        some critical bits.

        cma=nn{[}MG{]}@{[}start{[}MG{]}{[}-end{[}MG{]}{]}{]}
                        {[}ARM,X86,KNL{]}
                        Sets the size of kernel global memory area for
                        contiguous memory allocations and optionally the
                        placement constraint by the physical address range of
                        memory allocations. A value of 0 disables CMA
                        altogether. For more information, see
                        include/linux/dma-contiguous.h

        cmo\_free\_hint=  {[}PPC{]} Format: \{ yes \textbar{} no \}
                        Specify whether pages are marked as being inactive
                        when they are freed.  This is used in CMO environments
                        to determine OS memory pressure for page stealing by
                        a hypervisor.
                        Default: yes

        coherent\_pool=nn{[}KMG{]}   {[}ARM,KNL{]}
                        Sets the size of memory pool for coherent, atomic dma
                        allocations, by default set to 256K.

        code\_bytes      {[}X86{]} How many bytes of object code to print
                        in an oops report.
                        Range: 0 - 8192
                        Default: 64

        com20020=       {[}HW,NET{]} ARCnet - COM20020 chipset
                        Format:
                        \textless{}io\textgreater{}{[},\textless{}irq\textgreater{}{[},\textless{}nodeID\textgreater{}{[},\textless{}backplane\textgreater{}{[},\textless{}ckp\textgreater{}{[},\textless{}timeout\textgreater{}{]}{]}{]}{]}{]}

        com90io=        {[}HW,NET{]} ARCnet - COM90xx chipset (IO-mapped buffers)
                        Format: \textless{}io\textgreater{}{[},\textless{}irq\textgreater{}{]}

        com90xx=        {[}HW,NET{]}
                        ARCnet - COM90xx chipset (memory-mapped buffers)
                        Format: \textless{}io\textgreater{}{[},\textless{}irq\textgreater{}{[},\textless{}memstart\textgreater{}{]}{]}

        condev=         {[}HW,S390{]} console device
        conmode=

        console=        {[}KNL{]} Output console device and options.

                tty\textless{}n\textgreater{}  Use the virtual console device \textless{}n\textgreater{}.

                ttyS\textless{}n\textgreater{}{[},options{]}
                ttyUSB0{[},options{]}
                        Use the specified serial port.  The options are of
                        the form ``bbbbpnf'', where ``bbbb'' is the baud rate,
                        ``p'' is parity (``n'', ``o'', or ``e''), ``n'' is number of
                        bits, and ``f'' is flow control (``r'' for RTS or
                        omit it).  Default is ``9600n8''.

                        See Documentation/admin-guide/serial-console.rst for more
                        information.  See
                        Documentation/networking/netconsole.txt for an
                        alternative.

                uart{[}8250{]},io,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},mmio,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},mmio16,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},mmio32,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},0x\textless{}addr\textgreater{}{[},options{]}
                        Start an early, polled-mode console on the 8250/16550
                        UART at the specified I/O port or MMIO address,
                        switching to the matching ttyS device later.
                        MMIO inter-register address stride is either 8-bit
                        (mmio), 16-bit (mmio16), or 32-bit (mmio32).
                        If none of {[}io\textbar{}mmio\textbar{}mmio16\textbar{}mmio32{]}, \textless{}addr\textgreater{} is assumed
                        to be equivalent to `mmio'. `options' are specified in
                        the same format described for ttyS above; if unspecified,
                        the h/w is not re-initialized.

                hvc\textless{}n\textgreater{}  Use the hypervisor console device \textless{}n\textgreater{}. This is for
                        both Xen and PowerPC hypervisors.

                If the device connected to the port is not a TTY but a braille
                device, prepend ``brl,'' before the device type, for instance
                        console=brl,ttyS0
                For now, only VisioBraille is supported.

        console\_msg\_format=
                        {[}KNL{]} Change console messages format
                default
                        By default we print messages on consoles in
                        ``{[}time stamp{]} text\textbackslash{}n'' format (time stamp may not be
                        printed, depending on CONFIG\_PRINTK\_TIME or
                        {}`printk\_time' param).
                syslog
                        Switch to syslog format: ``\textless{}\%u\textgreater{}{[}time stamp{]} text\textbackslash{}n''
                        IOW, each message will have a facility and loglevel
                        prefix. The format is similar to one used by syslog()
                        syscall, or to executing ``dmesg -S --raw'' or to reading
                        from /proc/kmsg.

        consoleblank=   {[}KNL{]} The console blank (screen saver) timeout in
                        seconds. A value of 0 disables the blank timer.
                       Defaults to 0.

        coredump\_filter=
                        {[}KNL{]} Change the default value for
                        /proc/\textless{}pid\textgreater{}/coredump\_filter.
                        See also Documentation/filesystems/proc.txt.

        coresight\_cpu\_debug.enable
                        {[}ARM,ARM64{]}
                        Format: \textless{}bool\textgreater{}
                        Enable/disable the CPU sampling based debugging.
                        0: default value, disable debugging
                        1: enable debugging at boot time

        cpuidle.off=1   {[}CPU\_IDLE{]}
                        disable the cpuidle sub-system

        cpufreq.off=1   {[}CPU\_FREQ{]}
                        disable the cpufreq sub-system

        cpu\_init\_udelay=N
                        {[}X86{]} Delay for N microsec between assert and de-assert
                        of APIC INIT to start processors.  This delay occurs
                        on every CPU online, such as boot, and resume from suspend.
                        Default: 10000

        cpcihp\_generic= {[}HW,PCI{]} Generic port I/O CompactPCI driver
                        Format:
                        \textless{}first\_slot\textgreater{},\textless{}last\_slot\textgreater{},\textless{}port\textgreater{},\textless{}enum\_bit\textgreater{}{[},\textless{}debug\textgreater{}{]}

        crashkernel=size{[}KMG{]}{[}@offset{[}KMG{]}{]}
                        {[}KNL{]} Using kexec, Linux can switch to a `crash kernel'
                        upon panic. This parameter reserves the physical
                        memory region {[}offset, offset + size{]} for that kernel
                        image. If `@offset' is omitted, then a suitable offset
                        is selected automatically. Check
                        Documentation/kdump/kdump.txt for further details.

        crashkernel=range1:size1{[},range2:size2,...{]}{[}@offset{]}
                        {[}KNL{]} Same as above, but depends on the memory
                        in the running system. The syntax of range is
                        start-{[}end{]} where start and end are both
                        a memory unit (amount{[}KMG{]}). See also
                        Documentation/kdump/kdump.txt for an example.

        crashkernel=size{[}KMG{]},high
                        {[}KNL, x86\_64{]} range could be above 4G. Allow kernel
                        to allocate physical memory region from top, so could
                        be above 4G if system have more than 4G ram installed.
                        Otherwise memory region will be allocated below 4G, if
                        available.
                        It will be ignored if crashkernel=X is specified.
        crashkernel=size{[}KMG{]},low
                        {[}KNL, x86\_64{]} range under 4G. When crashkernel=X,high
                        is passed, kernel could allocate physical memory region
                        above 4G, that cause second kernel crash on system
                        that require some amount of low memory, e.g. swiotlb
                        requires at least 64M+32K low memory, also enough extra
                        low memory is needed to make sure DMA buffers for 32-bit
                        devices won't run out. Kernel would try to allocate at
                        at least 256M below 4G automatically.
                        This one let user to specify own low range under 4G
                        for second kernel instead.
                        0: to disable low allocation.
                        It will be ignored when crashkernel=X,high is not used
                        or memory reserved is below 4G.

        cryptomgr.notests
                        {[}KNL{]} Disable crypto self-tests

        cs89x0\_dma=     {[}HW,NET{]}
                        Format: \textless{}dma\textgreater{}

        cs89x0\_media=   {[}HW,NET{]}
                        Format: \{ rj45 \textbar{} aui \textbar{} bnc \}

        dasd=           {[}HW,NET{]}
                        See header of drivers/s390/block/dasd\_devmap.c.

        db9.dev{[}2\textbar{}3{]}=   {[}HW,JOY{]} Multisystem joystick support via parallel port
                        (one device per port)
                        Format: \textless{}port\#\textgreater{},\textless{}type\textgreater{}
                        See also Documentation/input/devices/joystick-parport.rst

        ddebug\_query=   {[}KNL,DYNAMIC\_DEBUG{]} Enable debug messages at early boot
                        time. See
                        Documentation/admin-guide/dynamic-debug-howto.rst for
                        details.  Deprecated, see dyndbg.

        debug           {[}KNL{]} Enable kernel debugging (events log level).

        debug\_locks\_verbose=
                        {[}KNL{]} verbose self-tests
                        Format=\textless{}0\textbar{}1\textgreater{}
                        Print debugging info while doing the locking API
                        self-tests.
                        We default to 0 (no extra messages), setting it to
                        1 will print \_a lot\_ more information - normally
                        only useful to kernel developers.

        debug\_objects   {[}KNL{]} Enable object debugging

        no\_debug\_objects
                        {[}KNL{]} Disable object debugging

        debug\_guardpage\_minorder=
                        {[}KNL{]} When CONFIG\_DEBUG\_PAGEALLOC is set, this
                        parameter allows control of the order of pages that will
                        be intentionally kept free (and hence protected) by the
                        buddy allocator. Bigger value increase the probability
                        of catching random memory corruption, but reduce the
                        amount of memory for normal system use. The maximum
                        possible value is MAX\_ORDER/2.  Setting this parameter
                        to 1 or 2 should be enough to identify most random
                        memory corruption problems caused by bugs in kernel or
                        driver code when a CPU writes to (or reads from) a
                        random memory location. Note that there exists a class
                        of memory corruptions problems caused by buggy H/W or
                        F/W or by drivers badly programing DMA (basically when
                        memory is written at bus level and the CPU MMU is
                        bypassed) which are not detectable by
                        CONFIG\_DEBUG\_PAGEALLOC, hence this option will not help
                        tracking down these problems.

        debug\_pagealloc=
                        {[}KNL{]} When CONFIG\_DEBUG\_PAGEALLOC is set, this
                        parameter enables the feature at boot time. In
                        default, it is disabled. We can avoid allocating huge
                        chunk of memory for debug pagealloc if we don't enable
                        it at boot time and the system will work mostly same
                        with the kernel built without CONFIG\_DEBUG\_PAGEALLOC.
                        on: enable the feature

        debugpat        {[}X86{]} Enable PAT debugging

        decnet.addr=    {[}HW,NET{]}
                        Format: \textless{}area\textgreater{}{[},\textless{}node\textgreater{}{]}
                        See also Documentation/networking/decnet.txt.

        default\_hugepagesz=
                        {[}same as hugepagesz={]} The size of the default
                        HugeTLB page size. This is the size represented by
                        the legacy /proc/ hugepages APIs, used for SHM, and
                        default size when mounting hugetlbfs filesystems.
                        Defaults to the default architecture's huge page size
                        if not specified.

        dhash\_entries=  {[}KNL{]}
                        Set number of hash buckets for dentry cache.

        disable\_1tb\_segments {[}PPC{]}
                        Disables the use of 1TB hash page table segments. This
                        causes the kernel to fall back to 256MB segments which
                        can be useful when debugging issues that require an SLB
                        miss to occur.

        disable=        {[}IPV6{]}
                        See Documentation/networking/ipv6.txt.

        disable\_radix   {[}PPC{]}
                        Disable RADIX MMU mode on POWER9

        disable\_cpu\_apicid= {[}X86,APIC,SMP{]}
                        Format: \textless{}int\textgreater{}
                        The number of initial APIC ID for the
                        corresponding CPU to be disabled at boot,
                        mostly used for the kdump 2nd kernel to
                        disable BSP to wake up multiple CPUs without
                        causing system reset or hang due to sending
                        INIT from AP to BSP.

        disable\_ddw     {[}PPC/PSERIES{]}
                        Disable Dynamic DMA Window support. Use this if
                        to workaround buggy firmware.

        disable\_ipv6=   {[}IPV6{]}
                        See Documentation/networking/ipv6.txt.

        disable\_mtrr\_cleanup {[}X86{]}
                        The kernel tries to adjust MTRR layout from continuous
                        to discrete, to make X server driver able to add WB
                        entry later. This parameter disables that.

        disable\_mtrr\_trim {[}X86, Intel and AMD only{]}
                        By default the kernel will trim any uncacheable
                        memory out of your available memory pool based on
                        MTRR settings.  This parameter disables that behavior,
                        possibly causing your machine to run very slowly.

        disable\_timer\_pin\_1 {[}X86{]}
                        Disable PIN 1 of APIC timer
                        Can be useful to work around chipset bugs.

        dis\_ucode\_ldr   {[}X86{]} Disable the microcode loader.

        dma\_debug=off   If the kernel is compiled with DMA\_API\_DEBUG support,
                        this option disables the debugging code at boot.

        dma\_debug\_entries=\textless{}number\textgreater{}
                        This option allows to tune the number of preallocated
                        entries for DMA-API debugging code. One entry is
                        required per DMA-API allocation. Use this if the
                        DMA-API debugging code disables itself because the
                        architectural default is too low.

        dma\_debug\_driver=\textless{}driver\_name\textgreater{}
                        With this option the DMA-API debugging driver
                        filter feature can be enabled at boot time. Just
                        pass the driver to filter for as the parameter.
                        The filter can be disabled or changed to another
                        driver later using sysfs.

        drm.edid\_firmware={[}\textless{}connector\textgreater{}:{]}\textless{}file\textgreater{}{[},{[}\textless{}connector\textgreater{}:{]}\textless{}file\textgreater{}{]}
                        Broken monitors, graphic adapters, KVMs and EDIDless
                        panels may send no or incorrect EDID data sets.
                        This parameter allows to specify an EDID data sets
                        in the /lib/firmware directory that are used instead.
                        Generic built-in EDID data sets are used, if one of
                        edid/1024x768.bin, edid/1280x1024.bin,
                        edid/1680x1050.bin, or edid/1920x1080.bin is given
                        and no file with the same name exists. Details and
                        instructions how to build your own EDID data are
                        available in Documentation/EDID/HOWTO.txt. An EDID
                        data set will only be used for a particular connector,
                        if its name and a colon are prepended to the EDID
                        name. Each connector may use a unique EDID data
                        set by separating the files with a comma.  An EDID
                        data set with no connector name will be used for
                        any connectors not explicitly specified.

        dscc4.setup=    {[}NET{]}

        dt\_cpu\_ftrs=    {[}PPC{]}
                        Format: \{``off'' \textbar{} ``known''\}
                        Control how the dt\_cpu\_ftrs device-tree binding is
                        used for CPU feature discovery and setup (if it
                        exists).
                        off: Do not use it, fall back to legacy cpu table.
                        known: Do not pass through unknown features to guests
                        or userspace, only those that the kernel is aware of.

        dump\_apple\_properties   {[}X86{]}
                        Dump name and content of EFI device properties on
                        x86 Macs.  Useful for driver authors to determine
                        what data is available or for reverse-engineering.

        dyndbg{[}=''val''{]}          {[}KNL,DYNAMIC\_DEBUG{]}
        module.dyndbg{[}=''val''{]}
                        Enable debug messages at boot time.  See
                        Documentation/admin-guide/dynamic-debug-howto.rst
                        for details.

        nompx           {[}X86{]} Disables Intel Memory Protection Extensions.
                        See Documentation/x86/intel\_mpx.txt for more
                        information about the feature.

        nopku           {[}X86{]} Disable Memory Protection Keys CPU feature found
                        in some Intel CPUs.

        module.async\_probe {[}KNL{]}
                        Enable asynchronous probe on this module.

        early\_ioremap\_debug {[}KNL{]}
                        Enable debug messages in early\_ioremap support. This
                        is useful for tracking down temporary early mappings
                        which are not unmapped.

        earlycon=       {[}KNL{]} Output early console device and options.

                        {[}ARM64{]} The early console is determined by the
                        stdout-path property in device tree's chosen node,
                        or determined by the ACPI SPCR table.

                        {[}X86{]} When used with no options the early console is
                        determined by the ACPI SPCR table.

                cdns,\textless{}addr\textgreater{}{[},options{]}
                        Start an early, polled-mode console on a Cadence
                        (xuartps) serial port at the specified address. Only
                        supported option is baud rate. If baud rate is not
                        specified, the serial port must already be setup and
                        configured.

                uart{[}8250{]},io,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},mmio,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},mmio32,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},mmio32be,\textless{}addr\textgreater{}{[},options{]}
                uart{[}8250{]},0x\textless{}addr\textgreater{}{[},options{]}
                        Start an early, polled-mode console on the 8250/16550
                        UART at the specified I/O port or MMIO address.
                        MMIO inter-register address stride is either 8-bit
                        (mmio) or 32-bit (mmio32 or mmio32be).
                        If none of {[}io\textbar{}mmio\textbar{}mmio32\textbar{}mmio32be{]}, \textless{}addr\textgreater{} is assumed
                        to be equivalent to `mmio'. `options' are specified
                        in the same format described for ``console=ttyS\textless{}n\textgreater{}''; if
                        unspecified, the h/w is not initialized.

                pl011,\textless{}addr\textgreater{}
                pl011,mmio32,\textless{}addr\textgreater{}
                        Start an early, polled-mode console on a pl011 serial
                        port at the specified address. The pl011 serial port
                        must already be setup and configured. Options are not
                        yet supported.  If `mmio32' is specified, then only
                        the driver will use only 32-bit accessors to read/write
                        the device registers.

                meson,\textless{}addr\textgreater{}
                        Start an early, polled-mode console on a meson serial
                        port at the specified address. The serial port must
                        already be setup and configured. Options are not yet
                        supported.

                msm\_serial,\textless{}addr\textgreater{}
                        Start an early, polled-mode console on an msm serial
                        port at the specified address. The serial port
                        must already be setup and configured. Options are not
                        yet supported.

                msm\_serial\_dm,\textless{}addr\textgreater{}
                        Start an early, polled-mode console on an msm serial
                        dm port at the specified address. The serial port
                        must already be setup and configured. Options are not
                        yet supported.

                owl,\textless{}addr\textgreater{}
                        Start an early, polled-mode console on a serial port
                        of an Actions Semi SoC, such as S500 or S900, at the
                        specified address. The serial port must already be
                        setup and configured. Options are not yet supported.

                smh     Use ARM semihosting calls for early console.

                s3c2410,\textless{}addr\textgreater{}
                s3c2412,\textless{}addr\textgreater{}
                s3c2440,\textless{}addr\textgreater{}
                s3c6400,\textless{}addr\textgreater{}
                s5pv210,\textless{}addr\textgreater{}
                exynos4210,\textless{}addr\textgreater{}
                        Use early console provided by serial driver available
                        on Samsung SoCs, requires selecting proper type and
                        a correct base address of the selected UART port. The
                        serial port must already be setup and configured.
                        Options are not yet supported.

                lantiq,\textless{}addr\textgreater{}
                        Start an early, polled-mode console on a lantiq serial
                        (lqasc) port at the specified address. The serial port
                        must already be setup and configured. Options are not
                        yet supported.

                lpuart,\textless{}addr\textgreater{}
                lpuart32,\textless{}addr\textgreater{}
                        Use early console provided by Freescale LP UART driver
                        found on Freescale Vybrid and QorIQ LS1021A processors.
                        A valid base address must be provided, and the serial
                        port must already be setup and configured.

                ar3700\_uart,\textless{}addr\textgreater{}
                        Start an early, polled-mode console on the
                        Armada 3700 serial port at the specified
                        address. The serial port must already be setup
                        and configured. Options are not yet supported.

        earlyprintk=    {[}X86,SH,BLACKFIN,ARM,M68k,S390{]}
                        earlyprintk=vga
                        earlyprintk=efi
                        earlyprintk=sclp
                        earlyprintk=xen
                        earlyprintk=serial{[},ttySn{[},baudrate{]}{]}
                        earlyprintk=serial{[},0x...{[},baudrate{]}{]}
                        earlyprintk=ttySn{[},baudrate{]}
                        earlyprintk=dbgp{[}debugController\#{]}
                        earlyprintk=pciserial,bus:device.function{[},baudrate{]}
                        earlyprintk=xdbc{[}xhciController\#{]}

                        earlyprintk is useful when the kernel crashes before
                        the normal console is initialized. It is not enabled by
                        default because it has some cosmetic problems.

                        Append '',keep'' to not disable it when the real console
                        takes over.

                        Only one of vga, efi, serial, or usb debug port can
                        be used at a time.

                        Currently only ttyS0 and ttyS1 may be specified by
                        name.  Other I/O ports may be explicitly specified
                        on some architectures (x86 and arm at least) by
                        replacing ttySn with an I/O port address, like this:
                                earlyprintk=serial,0x1008,115200
                        You can find the port for a given device in
                        /proc/tty/driver/serial:
                                2: uart:ST16650V2 port:00001008 irq:18 ...

                        Interaction with the standard serial driver is not
                        very good.

                        The VGA and EFI output is eventually overwritten by
                        the real console.

                        The xen output can only be used by Xen PV guests.

                        The sclp output can only be used on s390.

        edac\_report=    {[}HW,EDAC{]} Control how to report EDAC event
                        Format: \{``on'' \textbar{} ``off'' \textbar{} ``force''\}
                        on: enable EDAC to report H/W event. May be overridden
                        by other higher priority error reporting module.
                        off: disable H/W event reporting through EDAC.
                        force: enforce the use of EDAC to report H/W event.
                        default: on.

        ekgdboc=        {[}X86,KGDB{]} Allow early kernel console debugging
                        ekgdboc=kbd

                        This is designed to be used in conjunction with
                        the boot argument: earlyprintk=vga

        edd=            {[}EDD{]}
                        Format: \{``off'' \textbar{} ``on'' \textbar{} ``skip{[}mbr{]}''\}

        efi=            {[}EFI{]}
                        Format: \{ ``old\_map'', ``nochunk'', ``noruntime'', ``debug'' \}
                        old\_map {[}X86-64{]}: switch to the old ioremap-based EFI
                        runtime services mapping. 32-bit still uses this one by
                        default.
                        nochunk: disable reading files in ``chunks'' in the EFI
                        boot stub, as chunking can cause problems with some
                        firmware implementations.
                        noruntime : disable EFI runtime services support
                        debug: enable misc debug output

        efi\_no\_storage\_paranoia {[}EFI; X86{]}
                        Using this parameter you can use more than 50\% of
                        your efi variable storage. Use this parameter only if
                        you are really sure that your UEFI does sane gc and
                        fulfills the spec otherwise your board may brick.

        efi\_fake\_mem=   nn{[}KMG{]}@ss{[}KMG{]}:aa{[},nn{[}KMG{]}@ss{[}KMG{]}:aa,..{]} {[}EFI; X86{]}
                        Add arbitrary attribute to specific memory range by
                        updating original EFI memory map.
                        Region of memory which aa attribute is added to is
                        from ss to ss+nn.
                        If efi\_fake\_mem=2G@4G:0x10000,2G@0x10a0000000:0x10000
                        is specified, EFI\_MEMORY\_MORE\_RELIABLE(0x10000)
                        attribute is added to range 0x100000000-0x180000000 and
                        0x10a0000000-0x1120000000.

                        Using this parameter you can do debugging of EFI memmap
                        related feature. For example, you can do debugging of
                        Address Range Mirroring feature even if your box
                        doesn't support it.

        efivar\_ssdt=    {[}EFI; X86{]} Name of an EFI variable that contains an SSDT
                        that is to be dynamically loaded by Linux. If there are
                        multiple variables with the same name but with different
                        vendor GUIDs, all of them will be loaded. See
                        Documentation/acpi/ssdt-overlays.txt for details.


        eisa\_irq\_edge=  {[}PARISC,HW{]}
                        See header of drivers/parisc/eisa.c.

        elanfreq=       {[}X86-32{]}
                        See comment before function elanfreq\_setup() in
                        arch/x86/kernel/cpu/cpufreq/elanfreq.c.

        elevator=       {[}IOSCHED{]}
                        Format: \{``cfq'' \textbar{} ``deadline'' \textbar{} ``noop''\}
                        See Documentation/block/cfq-iosched.txt and
                        Documentation/block/deadline-iosched.txt for details.

        elfcorehdr={[}size{[}KMG{]}@{]}offset{[}KMG{]} {[}IA64,PPC,SH,X86,S390{]}
                        Specifies physical address of start of kernel core
                        image elf header and optionally the size. Generally
                        kexec loader will pass this option to capture kernel.
                        See Documentation/kdump/kdump.txt for details.

        enable\_mtrr\_cleanup {[}X86{]}
                        The kernel tries to adjust MTRR layout from continuous
                        to discrete, to make X server driver able to add WB
                        entry later. This parameter enables that.

        enable\_timer\_pin\_1 {[}X86{]}
                        Enable PIN 1 of APIC timer
                        Can be useful to work around chipset bugs
                        (in particular on some ATI chipsets).
                        The kernel tries to set a reasonable default.

        enforcing       {[}SELINUX{]} Set initial enforcing status.
                        Format: \{``0'' \textbar{} ``1''\}
                        See security/selinux/Kconfig help text.
                        0 -- permissive (log only, no denials).
                        1 -- enforcing (deny and log).
                        Default value is 0.
                        Value can be changed at runtime via /selinux/enforce.

        erst\_disable    {[}ACPI{]}
                        Disable Error Record Serialization Table (ERST)
                        support.

        ether=          {[}HW,NET{]} Ethernet cards parameters
                        This option is obsoleted by the ``netdev='' option, which
                        has equivalent usage. See its documentation for details.

        evm=            {[}EVM{]}
                        Format: \{ ``fix'' \}
                        Permit `security.evm' to be updated regardless of
                        current integrity status.

        failslab=
        fail\_page\_alloc=
        fail\_make\_request={[}KNL{]}
                        General fault injection mechanism.
                        Format: \textless{}interval\textgreater{},\textless{}probability\textgreater{},\textless{}space\textgreater{},\textless{}times\textgreater{}
                        See also Documentation/fault-injection/.

        floppy=         {[}HW{]}
                        See Documentation/blockdev/floppy.txt.

        force\_pal\_cache\_flush
                        {[}IA-64{]} Avoid check\_sal\_cache\_flush which may hang on
                        buggy SAL\_CACHE\_FLUSH implementations. Using this
                        parameter will force ia64\_sal\_cache\_flush to call
                        ia64\_pal\_cache\_flush instead of SAL\_CACHE\_FLUSH.

        forcepae {[}X86-32{]}
                        Forcefully enable Physical Address Extension (PAE).
                        Many Pentium M systems disable PAE but may have a
                        functionally usable PAE implementation.
                        Warning: use of this parameter will taint the kernel
                        and may cause unknown problems.

        ftrace={[}tracer{]}
                        {[}FTRACE{]} will set and start the specified tracer
                        as early as possible in order to facilitate early
                        boot debugging.

        ftrace\_dump\_on\_oops{[}=orig\_cpu{]}
                        {[}FTRACE{]} will dump the trace buffers on oops.
                        If no parameter is passed, ftrace will dump
                        buffers of all CPUs, but if you pass orig\_cpu, it will
                        dump only the buffer of the CPU that triggered the
                        oops.

        ftrace\_filter={[}function-list{]}
                        {[}FTRACE{]} Limit the functions traced by the function
                        tracer at boot up. function-list is a comma separated
                        list of functions. This list can be changed at run
                        time by the set\_ftrace\_filter file in the debugfs
                        tracing directory.

        ftrace\_notrace={[}function-list{]}
                        {[}FTRACE{]} Do not trace the functions specified in
                        function-list. This list can be changed at run time
                        by the set\_ftrace\_notrace file in the debugfs
                        tracing directory.

        ftrace\_graph\_filter={[}function-list{]}
                        {[}FTRACE{]} Limit the top level callers functions traced
                        by the function graph tracer at boot up.
                        function-list is a comma separated list of functions
                        that can be changed at run time by the
                        set\_graph\_function file in the debugfs tracing directory.

        ftrace\_graph\_notrace={[}function-list{]}
                        {[}FTRACE{]} Do not trace from the functions specified in
                        function-list.  This list is a comma separated list of
                        functions that can be changed at run time by the
                        set\_graph\_notrace file in the debugfs tracing directory.

        ftrace\_graph\_max\_depth=\textless{}uint\textgreater{}
                        {[}FTRACE{]} Used with the function graph tracer. This is
                        the max depth it will trace into a function. This value
                        can be changed at run time by the max\_graph\_depth file
                        in the tracefs tracing directory. default: 0 (no limit)

        gamecon.map{[}2\textbar{}3{]}=
                        {[}HW,JOY{]} Multisystem joystick and NES/SNES/PSX pad
                        support via parallel port (up to 5 devices per port)
                        Format: \textless{}port\#\textgreater{},\textless{}pad1\textgreater{},\textless{}pad2\textgreater{},\textless{}pad3\textgreater{},\textless{}pad4\textgreater{},\textless{}pad5\textgreater{}
                        See also Documentation/input/devices/joystick-parport.rst

        gamma=          {[}HW,DRM{]}

        gart\_fix\_e820=  {[}X86\_64{]} disable the fix e820 for K8 GART
                        Format: off \textbar{} on
                        default: on

        gcov\_persist=   {[}GCOV{]} When non-zero (default), profiling data for
                        kernel modules is saved and remains accessible via
                        debugfs, even when the module is unloaded/reloaded.
                        When zero, profiling data is discarded and associated
                        debugfs files are removed at module unload time.

        goldfish        {[}X86{]} Enable the goldfish android emulator platform.
                        Don't use this when you are not running on the
                        android emulator

        gpt             {[}EFI{]} Forces disk with valid GPT signature but
                        invalid Protective MBR to be treated as GPT. If the
                        primary GPT is corrupted, it enables the backup/alternate
                        GPT to be used instead.

        grcan.enable0=  {[}HW{]} Configuration of physical interface 0. Determines
                        the ``Enable 0'' bit of the configuration register.
                        Format: 0 \textbar{} 1
                        Default: 0
        grcan.enable1=  {[}HW{]} Configuration of physical interface 1. Determines
                        the ``Enable 0'' bit of the configuration register.
                        Format: 0 \textbar{} 1
                        Default: 0
        grcan.select=   {[}HW{]} Select which physical interface to use.
                        Format: 0 \textbar{} 1
                        Default: 0
        grcan.txsize=   {[}HW{]} Sets the size of the tx buffer.
                        Format: \textless{}unsigned int\textgreater{} such that (txsize \& \textasciitilde{}0x1fffc0) == 0.
                        Default: 1024
        grcan.rxsize=   {[}HW{]} Sets the size of the rx buffer.
                        Format: \textless{}unsigned int\textgreater{} such that (rxsize \& \textasciitilde{}0x1fffc0) == 0.
                        Default: 1024

        gpio-mockup.gpio\_mockup\_ranges
                        {[}HW{]} Sets the ranges of gpiochip of for this device.
                        Format: \textless{}start1\textgreater{},\textless{}end1\textgreater{},\textless{}start2\textgreater{},\textless{}end2\textgreater{}...

        hardlockup\_all\_cpu\_backtrace=
                        {[}KNL{]} Should the hard-lockup detector generate
                        backtraces on all cpus.
                        Format: \textless{}integer\textgreater{}

        hashdist=       {[}KNL,NUMA{]} Large hashes allocated during boot
                        are distributed across NUMA nodes.  Defaults on
                        for 64-bit NUMA, off otherwise.
                        Format: 0 \textbar{} 1 (for off \textbar{} on)

        hcl=            {[}IA-64{]} SGI's Hardware Graph compatibility layer

        hd=             {[}EIDE{]} (E)IDE hard drive subsystem geometry
                        Format: \textless{}cyl\textgreater{},\textless{}head\textgreater{},\textless{}sect\textgreater{}

        hest\_disable    {[}ACPI{]}
                        Disable Hardware Error Source Table (HEST) support;
                        corresponding firmware-first mode error processing
                        logic will be disabled.

        highmem=nn{[}KMG{]} {[}KNL,BOOT{]} forces the highmem zone to have an exact
                        size of \textless{}nn\textgreater{}. This works even on boxes that have no
                        highmem otherwise. This also works to reduce highmem
                        size on bigger boxes.

        highres=        {[}KNL{]} Enable/disable high resolution timer mode.
                        Valid parameters: ``on'', ``off''
                        Default: ``on''

        hisax=          {[}HW,ISDN{]}
                        See Documentation/isdn/README.HiSax.

        hlt             {[}BUGS=ARM,SH{]}

        hpet=           {[}X86-32,HPET{]} option to control HPET usage
                        Format: \{ enable (default) \textbar{} disable \textbar{} force \textbar{}
                                verbose \}
                        disable: disable HPET and use PIT instead
                        force: allow force enabled of undocumented chips (ICH4,
                                VIA, nVidia)
                        verbose: show contents of HPET registers during setup

        hpet\_mmap=      {[}X86, HPET\_MMAP{]} Allow userspace to mmap HPET
                        registers.  Default set by CONFIG\_HPET\_MMAP\_DEFAULT.

        hugepages=      {[}HW,X86-32,IA-64{]} HugeTLB pages to allocate at boot.
        hugepagesz=     {[}HW,IA-64,PPC,X86-64{]} The size of the HugeTLB pages.
                        On x86-64 and powerpc, this option can be specified
                        multiple times interleaved with hugepages= to reserve
                        huge pages of different sizes. Valid pages sizes on
                        x86-64 are 2M (when the CPU supports ``pse'') and 1G
                        (when the CPU supports the ``pdpe1gb'' cpuinfo flag).

        hvc\_iucv=       {[}S390{]} Number of z/VM IUCV hypervisor console (HVC)
                               terminal devices. Valid values: 0..8
        hvc\_iucv\_allow= {[}S390{]} Comma-separated list of z/VM user IDs.
                               If specified, z/VM IUCV HVC accepts connections
                               from listed z/VM user IDs only.

        hwthread\_map=   {[}METAG{]} Comma-separated list of Linux cpu id to
                                hardware thread id mappings.
                                Format: \textless{}cpu\textgreater{}:\textless{}hwthread\textgreater{}

        keep\_bootcon    {[}KNL{]}
                        Do not unregister boot console at start. This is only
                        useful for debugging when something happens in the window
                        between unregistering the boot console and initializing
                        the real console.

        i2c\_bus=        {[}HW{]} Override the default board specific I2C bus speed
                             or register an additional I2C bus that is not
                             registered from board initialization code.
                             Format:
                             \textless{}bus\_id\textgreater{},\textless{}clkrate\textgreater{}

        i8042.debug     {[}HW{]} Toggle i8042 debug mode
        i8042.unmask\_kbd\_data
                        {[}HW{]} Enable printing of interrupt data from the KBD port
                             (disabled by default, and as a pre-condition
                             requires that i8042.debug=1 be enabled)
        i8042.direct    {[}HW{]} Put keyboard port into non-translated mode
        i8042.dumbkbd   {[}HW{]} Pretend that controller can only read data from
                             keyboard and cannot control its state
                             (Don't attempt to blink the leds)
        i8042.noaux     {[}HW{]} Don't check for auxiliary (== mouse) port
        i8042.nokbd     {[}HW{]} Don't check/create keyboard port
        i8042.noloop    {[}HW{]} Disable the AUX Loopback command while probing
                             for the AUX port
        i8042.nomux     {[}HW{]} Don't check presence of an active multiplexing
                             controller
        i8042.nopnp     {[}HW{]} Don't use ACPIPnP / PnPBIOS to discover KBD/AUX
                             controllers
        i8042.notimeout {[}HW{]} Ignore timeout condition signalled by controller
        i8042.reset     {[}HW{]} Reset the controller during init, cleanup and
                             suspend-to-ram transitions, only during s2r
                             transitions, or never reset
                        Format: \{ 1 \textbar{} Y \textbar{} y \textbar{} 0 \textbar{} N \textbar{} n \}
                        1, Y, y: always reset controller
                        0, N, n: don't ever reset controller
                        Default: only on s2r transitions on x86; most other
                        architectures force reset to be always executed
        i8042.unlock    {[}HW{]} Unlock (ignore) the keylock
        i8042.kbdreset  {[}HW{]} Reset device connected to KBD port

        i810=           {[}HW,DRM{]}

        i8k.ignore\_dmi  {[}HW{]} Continue probing hardware even if DMI data
                        indicates that the driver is running on unsupported
                        hardware.
        i8k.force       {[}HW{]} Activate i8k driver even if SMM BIOS signature
                        does not match list of supported models.
        i8k.power\_status
                        {[}HW{]} Report power status in /proc/i8k
                        (disabled by default)
        i8k.restricted  {[}HW{]} Allow controlling fans only if SYS\_ADMIN
                        capability is set.

        i915.invert\_brightness=
                        {[}DRM{]} Invert the sense of the variable that is used to
                        set the brightness of the panel backlight. Normally a
                        brightness value of 0 indicates backlight switched off,
                        and the maximum of the brightness value sets the backlight
                        to maximum brightness. If this parameter is set to 0
                        (default) and the machine requires it, or this parameter
                        is set to 1, a brightness value of 0 sets the backlight
                        to maximum brightness, and the maximum of the brightness
                        value switches the backlight off.
                        -1 -- never invert brightness
                         0 -- machine default
                         1 -- force brightness inversion

        icn=            {[}HW,ISDN{]}
                        Format: \textless{}io\textgreater{}{[},\textless{}membase\textgreater{}{[},\textless{}icn\_id\textgreater{}{[},\textless{}icn\_id2\textgreater{}{]}{]}{]}

        ide-core.nodma= {[}HW{]} (E)IDE subsystem
                        Format: =0.0 to prevent dma on hda, =0.1 hdb =1.0 hdc
                        .vlb\_clock .pci\_clock .noflush .nohpa .noprobe .nowerr
                        .cdrom .chs .ignore\_cable are additional options
                        See Documentation/ide/ide.txt.

        ide-generic.probe-mask= {[}HW{]} (E)IDE subsystem
                        Format: \textless{}int\textgreater{}
                        Probe mask for legacy ISA IDE ports.  Depending on
                        platform up to 6 ports are supported, enabled by
                        setting corresponding bits in the mask to 1.  The
                        default value is 0x0, which has a special meaning.
                        On systems that have PCI, it triggers scanning the
                        PCI bus for the first and the second port, which
                        are then probed.  On systems without PCI the value
                        of 0x0 enables probing the two first ports as if it
                        was 0x3.

        ide-pci-generic.all-generic-ide {[}HW{]} (E)IDE subsystem
                        Claim all unknown PCI IDE storage controllers.

        idle=           {[}X86{]}
                        Format: idle=poll, idle=halt, idle=nomwait
                        Poll forces a polling idle loop that can slightly
                        improve the performance of waking up a idle CPU, but
                        will use a lot of power and make the system run hot.
                        Not recommended.
                        idle=halt: Halt is forced to be used for CPU idle.
                        In such case C2/C3 won't be used again.
                        idle=nomwait: Disable mwait for CPU C-states

        ieee754=        {[}MIPS{]} Select IEEE Std 754 conformance mode
                        Format: \{ strict \textbar{} legacy \textbar{} 2008 \textbar{} relaxed \}
                        Default: strict

                        Choose which programs will be accepted for execution
                        based on the IEEE 754 NaN encoding(s) supported by
                        the FPU and the NaN encoding requested with the value
                        of an ELF file header flag individually set by each
                        binary.  Hardware implementations are permitted to
                        support either or both of the legacy and the 2008 NaN
                        encoding mode.

                        Available settings are as follows:
                        strict  accept binaries that request a NaN encoding
                                supported by the FPU
                        legacy  only accept legacy-NaN binaries, if supported
                                by the FPU
                        2008    only accept 2008-NaN binaries, if supported
                                by the FPU
                        relaxed accept any binaries regardless of whether
                                supported by the FPU

                        The FPU emulator is always able to support both NaN
                        encodings, so if no FPU hardware is present or it has
                        been disabled with `nofpu', then the settings of
                        `legacy' and `2008' strap the emulator accordingly,
                        `relaxed' straps the emulator for both legacy-NaN and
                        2008-NaN, whereas `strict' enables legacy-NaN only on
                        legacy processors and both NaN encodings on MIPS32 or
                        MIPS64 CPUs.

                        The setting for ABS.fmt/NEG.fmt instruction execution
                        mode generally follows that for the NaN encoding,
                        except where unsupported by hardware.

        ignore\_loglevel {[}KNL{]}
                        Ignore loglevel setting - this will print /all/
                        kernel messages to the console. Useful for debugging.
                        We also add it as printk module parameter, so users
                        could change it dynamically, usually by
                        /sys/module/printk/parameters/ignore\_loglevel.

        ignore\_rlimit\_data
                        Ignore RLIMIT\_DATA setting for data mappings,
                        print warning at first misuse.  Can be changed via
                        /sys/module/kernel/parameters/ignore\_rlimit\_data.

        ihash\_entries=  {[}KNL{]}
                        Set number of hash buckets for inode cache.

        ima\_appraise=   {[}IMA{]} appraise integrity measurements
                        Format: \{ ``off'' \textbar{} ``enforce'' \textbar{} ``fix'' \textbar{} ``log'' \}
                        default: ``enforce''

        ima\_appraise\_tcb {[}IMA{]}
                        The builtin appraise policy appraises all files
                        owned by uid=0.

        ima\_canonical\_fmt {[}IMA{]}
                        Use the canonical format for the binary runtime
                        measurements, instead of host native format.

        ima\_hash=       {[}IMA{]}
                        Format: \{ md5 \textbar{} sha1 \textbar{} rmd160 \textbar{} sha256 \textbar{} sha384
                                   \textbar{} sha512 \textbar{} ... \}
                        default: ``sha1''

                        The list of supported hash algorithms is defined
                        in crypto/hash\_info.h.

        ima\_policy=     {[}IMA{]}
                        The builtin policies to load during IMA setup.
                        Format: ``tcb \textbar{} appraise\_tcb \textbar{} secure\_boot''

                        The ``tcb'' policy measures all programs exec'd, files
                        mmap'd for exec, and all files opened with the read
                        mode bit set by either the effective uid (euid=0) or
                        uid=0.

                        The ``appraise\_tcb'' policy appraises the integrity of
                        all files owned by root. (This is the equivalent
                        of ima\_appraise\_tcb.)

                        The ``secure\_boot'' policy appraises the integrity
                        of files (eg. kexec kernel image, kernel modules,
                        firmware, policy, etc) based on file signatures.

        ima\_tcb         {[}IMA{]} Deprecated.  Use ima\_policy= instead.
                        Load a policy which meets the needs of the Trusted
                        Computing Base.  This means IMA will measure all
                        programs exec'd, files mmap'd for exec, and all files
                        opened for read by uid=0.

        ima\_template=   {[}IMA{]}
                        Select one of defined IMA measurements template formats.
                        Formats: \{ ``ima'' \textbar{} ``ima-ng'' \textbar{} ``ima-sig'' \}
                        Default: ``ima-ng''

        ima\_template\_fmt=
                        {[}IMA{]} Define a custom template format.
                        Format: \{ ``field1\textbar{}...\textbar{}fieldN'' \}

        ima.ahash\_minsize= {[}IMA{]} Minimum file size for asynchronous hash usage
                        Format: \textless{}min\_file\_size\textgreater{}
                        Set the minimal file size for using asynchronous hash.
                        If left unspecified, ahash usage is disabled.

                        ahash performance varies for different data sizes on
                        different crypto accelerators. This option can be used
                        to achieve the best performance for a particular HW.

        ima.ahash\_bufsize= {[}IMA{]} Asynchronous hash buffer size
                        Format: \textless{}bufsize\textgreater{}
                        Set hashing buffer size. Default: 4k.

                        ahash performance varies for different chunk sizes on
                        different crypto accelerators. This option can be used
                        to achieve best performance for particular HW.

        init=           {[}KNL{]}
                        Format: \textless{}full\_path\textgreater{}
                        Run specified binary instead of /sbin/init as init
                        process.

        initcall\_debug  {[}KNL{]} Trace initcalls as they are executed.  Useful
                        for working out where the kernel is dying during
                        startup.

        initcall\_blacklist=  {[}KNL{]} Do not execute a comma-separated list of
                        initcall functions.  Useful for debugging built-in
                        modules and initcalls.

        initrd=         {[}BOOT{]} Specify the location of the initial ramdisk

        init\_pkru=      {[}x86{]} Specify the default memory protection keys rights
                        register contents for all processes.  0x55555554 by
                        default (disallow access to all but pkey 0).  Can
                        override in debugfs after boot.

        inport.irq=     {[}HW{]} Inport (ATI XL and Microsoft) busmouse driver
                        Format: \textless{}irq\textgreater{}

        int\_pln\_enable  {[}x86{]} Enable power limit notification interrupt

        integrity\_audit={[}IMA{]}
                        Format: \{ ``0'' \textbar{} ``1'' \}
                        0 -- basic integrity auditing messages. (Default)
                        1 -- additional integrity auditing messages.

        intel\_iommu=    {[}DMAR{]} Intel IOMMU driver (DMAR) option
                on
                        Enable intel iommu driver.
                off
                        Disable intel iommu driver.
                igfx\_off {[}Default Off{]}
                        By default, gfx is mapped as normal device. If a gfx
                        device has a dedicated DMAR unit, the DMAR unit is
                        bypassed by not enabling DMAR with this option. In
                        this case, gfx device will use physical address for
                        DMA.
                forcedac {[}x86\_64{]}
                        With this option iommu will not optimize to look
                        for io virtual address below 32-bit forcing dual
                        address cycle on pci bus for cards supporting greater
                        than 32-bit addressing. The default is to look
                        for translation below 32-bit and if not available
                        then look in the higher range.
                strict {[}Default Off{]}
                        With this option on every unmap\_single operation will
                        result in a hardware IOTLB flush operation as opposed
                        to batching them for performance.
                sp\_off {[}Default Off{]}
                        By default, super page will be supported if Intel IOMMU
                        has the capability. With this option, super page will
                        not be supported.
                ecs\_off {[}Default Off{]}
                        By default, extended context tables will be supported if
                        the hardware advertises that it has support both for the
                        extended tables themselves, and also PASID support. With
                        this option set, extended tables will not be used even
                        on hardware which claims to support them.
                tboot\_noforce {[}Default Off{]}
                        Do not force the Intel IOMMU enabled under tboot.
                        By default, tboot will force Intel IOMMU on, which
                        could harm performance of some high-throughput
                        devices like 40GBit network cards, even if identity
                        mapping is enabled.
                        Note that using this option lowers the security
                        provided by tboot because it makes the system
                        vulnerable to DMA attacks.

        intel\_idle.max\_cstate=  {[}KNL,HW,ACPI,X86{]}
                        0       disables intel\_idle and fall back on acpi\_idle.
                        1 to 9  specify maximum depth of C-state.

        intel\_pstate=  {[}X86{]}
                       disable
                         Do not enable intel\_pstate as the default
                         scaling driver for the supported processors
                       passive
                         Use intel\_pstate as a scaling driver, but configure it
                         to work with generic cpufreq governors (instead of
                         enabling its internal governor).  This mode cannot be
                         used along with the hardware-managed P-states (HWP)
                         feature.
                       force
                         Enable intel\_pstate on systems that prohibit it by default
                         in favor of acpi-cpufreq. Forcing the intel\_pstate driver
                         instead of acpi-cpufreq may disable platform features, such
                         as thermal controls and power capping, that rely on ACPI
                         P-States information being indicated to OSPM and therefore
                         should be used with caution. This option does not work with
                         processors that aren't supported by the intel\_pstate driver
                         or on platforms that use pcc-cpufreq instead of acpi-cpufreq.
                       no\_hwp
                         Do not enable hardware P state control (HWP)
                         if available.
                hwp\_only
                        Only load intel\_pstate on systems which support
                        hardware P state control (HWP) if available.
                support\_acpi\_ppc
                        Enforce ACPI \_PPC performance limits. If the Fixed ACPI
                        Description Table, specifies preferred power management
                        profile as ``Enterprise Server'' or ``Performance Server'',
                        then this feature is turned on by default.
                per\_cpu\_perf\_limits
                        Allow per-logical-CPU P-State performance control limits using
                        cpufreq sysfs interface

        intremap=       {[}X86-64, Intel-IOMMU{]}
                        on      enable Interrupt Remapping (default)
                        off     disable Interrupt Remapping
                        nosid   disable Source ID checking
                        no\_x2apic\_optout
                                BIOS x2APIC opt-out request will be ignored
                        nopost  disable Interrupt Posting

        iomem=          Disable strict checking of access to MMIO memory
                strict  regions from userspace.
                relaxed

        iommu=          {[}x86{]}
                off
                force
                noforce
                biomerge
                panic
                nopanic
                merge
                nomerge
                forcesac
                soft
                pt              {[}x86, IA-64{]}
                nobypass        {[}PPC/POWERNV{]}
                        Disable IOMMU bypass, using IOMMU for PCI devices.

        iommu.passthrough=
                        {[}ARM64{]} Configure DMA to bypass the IOMMU by default.
                        Format: \{ ``0'' \textbar{} ``1'' \}
                        0 - Use IOMMU translation for DMA.
                        1 - Bypass the IOMMU for DMA.
                        unset - Use IOMMU translation for DMA.

        io7=            {[}HW{]} IO7 for Marvel based alpha systems
                        See comment before marvel\_specify\_io7 in
                        arch/alpha/kernel/core\_marvel.c.

        io\_delay=       {[}X86{]} I/O delay method
                0x80
                        Standard port 0x80 based delay
                0xed
                        Alternate port 0xed based delay (needed on some systems)
                udelay
                        Simple two microseconds delay
                none
                        No delay

        ip=             {[}IP\_PNP{]}
                        See Documentation/filesystems/nfs/nfsroot.txt.

        irqaffinity=    {[}SMP{]} Set the default irq affinity mask
                        The argument is a cpu list, as described above.

        irqchip.gicv2\_force\_probe=
                        {[}ARM, ARM64{]}
                        Format: \textless{}bool\textgreater{}
                        Force the kernel to look for the second 4kB page
                        of a GICv2 controller even if the memory range
                        exposed by the device tree is too small.

        irqfixup        {[}HW{]}
                        When an interrupt is not handled search all handlers
                        for it. Intended to get systems with badly broken
                        firmware running.

        irqpoll         {[}HW{]}
                        When an interrupt is not handled search all handlers
                        for it. Also check all handlers each timer
                        interrupt. Intended to get systems with badly broken
                        firmware running.

        isapnp=         {[}ISAPNP{]}
                        Format: \textless{}RDP\textgreater{},\textless{}reset\textgreater{},\textless{}pci\_scan\textgreater{},\textless{}verbosity\textgreater{}

        isolcpus=       {[}KNL,SMP,ISOL{]} Isolate a given set of CPUs from disturbance.
                        {[}Deprecated - use cpusets instead{]}
                        Format: {[}flag-list,{]}\textless{}cpu-list\textgreater{}

                        Specify one or more CPUs to isolate from disturbances
                        specified in the flag list (default: domain):

                        nohz
                          Disable the tick when a single task runs.
                        domain
                          Isolate from the general SMP balancing and scheduling
                          algorithms. Note that performing domain isolation this way
                          is irreversible: it's not possible to bring back a CPU to
                          the domains once isolated through isolcpus. It's strongly
                          advised to use cpusets instead to disable scheduler load
                          balancing through the ``cpuset.sched\_load\_balance'' file.
                          It offers a much more flexible interface where CPUs can
                          move in and out of an isolated set anytime.

                          You can move a process onto or off an ``isolated'' CPU via
                          the CPU affinity syscalls or cpuset.
                          \textless{}cpu number\textgreater{} begins at 0 and the maximum value is
                          ``number of CPUs in system - 1''.

                        The format of \textless{}cpu-list\textgreater{} is described above.



        iucv=           {[}HW,NET{]}

        ivrs\_ioapic     {[}HW,X86\_64{]}
                        Provide an override to the IOAPIC-ID\textless{}-\textgreater{}DEVICE-ID
                        mapping provided in the IVRS ACPI table. For
                        example, to map IOAPIC-ID decimal 10 to
                        PCI device 00:14.0 write the parameter as:
                                ivrs\_ioapic{[}10{]}=00:14.0

        ivrs\_hpet       {[}HW,X86\_64{]}
                        Provide an override to the HPET-ID\textless{}-\textgreater{}DEVICE-ID
                        mapping provided in the IVRS ACPI table. For
                        example, to map HPET-ID decimal 0 to
                        PCI device 00:14.0 write the parameter as:
                                ivrs\_hpet{[}0{]}=00:14.0

        ivrs\_acpihid    {[}HW,X86\_64{]}
                        Provide an override to the ACPI-HID:UID\textless{}-\textgreater{}DEVICE-ID
                        mapping provided in the IVRS ACPI table. For
                        example, to map UART-HID:UID AMD0020:0 to
                        PCI device 00:14.5 write the parameter as:
                                ivrs\_acpihid{[}00:14.5{]}=AMD0020:0

        js=             {[}HW,JOY{]} Analog joystick
                        See Documentation/input/joydev/joystick.rst.

        nokaslr         {[}KNL{]}
                        When CONFIG\_RANDOMIZE\_BASE is set, this disables
                        kernel and module base offset ASLR (Address Space
                        Layout Randomization).

        kasan\_multi\_shot
                        {[}KNL{]} Enforce KASAN (Kernel Address Sanitizer) to print
                        report on every invalid memory access. Without this
                        parameter KASAN will print report only for the first
                        invalid access.

        keepinitrd      {[}HW,ARM{]}

        kernelcore=     {[}KNL,X86,IA-64,PPC{]}
                        Format: nn{[}KMGTPE{]} \textbar{} ``mirror''
                        This parameter
                        specifies the amount of memory usable by the kernel
                        for non-movable allocations.  The requested amount is
                        spread evenly throughout all nodes in the system. The
                        remaining memory in each node is used for Movable
                        pages. In the event, a node is too small to have both
                        kernelcore and Movable pages, kernelcore pages will
                        take priority and other nodes will have a larger number
                        of Movable pages.  The Movable zone is used for the
                        allocation of pages that may be reclaimed or moved
                        by the page migration subsystem.  This means that
                        HugeTLB pages may not be allocated from this zone.
                        Note that allocations like PTEs-from-HighMem still
                        use the HighMem zone if it exists, and the Normal
                        zone if it does not.

                        Instead of specifying the amount of memory (nn{[}KMGTPE{]}),
                        you can specify ``mirror'' option. In case ``mirror''
                        option is specified, mirrored (reliable) memory is used
                        for non-movable allocations and remaining memory is used
                        for Movable pages. nn{[}KMGTPE{]} and ``mirror'' are exclusive,
                        so you can NOT specify nn{[}KMGTPE{]} and ``mirror'' at the same
                        time.

        kgdbdbgp=       {[}KGDB,HW{]} kgdb over EHCI usb debug port.
                        Format: \textless{}Controller\#\textgreater{}{[},poll interval{]}
                        The controller \# is the number of the ehci usb debug
                        port as it is probed via PCI.  The poll interval is
                        optional and is the number seconds in between
                        each poll cycle to the debug port in case you need
                        the functionality for interrupting the kernel with
                        gdb or control-c on the dbgp connection.  When
                        not using this parameter you use sysrq-g to break into
                        the kernel debugger.

        kgdboc=         {[}KGDB,HW{]} kgdb over consoles.
                        Requires a tty driver that supports console polling,
                        or a supported polling keyboard driver (non-usb).
                         Serial only format: \textless{}serial\_device\textgreater{}{[},baud{]}
                         keyboard only format: kbd
                         keyboard and serial format: kbd,\textless{}serial\_device\textgreater{}{[},baud{]}
                        Optional Kernel mode setting:
                         kms, kbd format: kms,kbd
                         kms, kbd and serial format: kms,kbd,\textless{}ser\_dev\textgreater{}{[},baud{]}

        kgdbwait        {[}KGDB{]} Stop kernel execution and enter the
                        kernel debugger at the earliest opportunity.

        kmac=           {[}MIPS{]} korina ethernet MAC address.
                        Configure the RouterBoard 532 series on-chip
                        Ethernet adapter MAC address.

        kmemleak=       {[}KNL{]} Boot-time kmemleak enable/disable
                        Valid arguments: on, off
                        Default: on
                        Built with CONFIG\_DEBUG\_KMEMLEAK\_DEFAULT\_OFF=y,
                        the default is off.

        kvm.ignore\_msrs={[}KVM{]} Ignore guest accesses to unhandled MSRs.
                        Default is 0 (don't ignore, but inject \#GP)

        kvm.mmu\_audit=  {[}KVM{]} This is a R/W parameter which allows audit
                        KVM MMU at runtime.
                        Default is 0 (off)

        kvm-amd.nested= {[}KVM,AMD{]} Allow nested virtualization in KVM/SVM.
                        Default is 1 (enabled)

        kvm-amd.npt=    {[}KVM,AMD{]} Disable nested paging (virtualized MMU)
                        for all guests.
                        Default is 1 (enabled) if in 64-bit or 32-bit PAE mode.

        kvm-arm.vgic\_v3\_group0\_trap=
                        {[}KVM,ARM{]} Trap guest accesses to GICv3 group-0
                        system registers

        kvm-arm.vgic\_v3\_group1\_trap=
                        {[}KVM,ARM{]} Trap guest accesses to GICv3 group-1
                        system registers

        kvm-arm.vgic\_v3\_common\_trap=
                        {[}KVM,ARM{]} Trap guest accesses to GICv3 common
                        system registers

        kvm-arm.vgic\_v4\_enable=
                        {[}KVM,ARM{]} Allow use of GICv4 for direct injection of
                        LPIs.

        kvm-intel.ept=  {[}KVM,Intel{]} Disable extended page tables
                        (virtualized MMU) support on capable Intel chips.
                        Default is 1 (enabled)

        kvm-intel.emulate\_invalid\_guest\_state=
                        {[}KVM,Intel{]} Enable emulation of invalid guest states
                        Default is 0 (disabled)

        kvm-intel.flexpriority=
                        {[}KVM,Intel{]} Disable FlexPriority feature (TPR shadow).
                        Default is 1 (enabled)

        kvm-intel.nested=
                        {[}KVM,Intel{]} Enable VMX nesting (nVMX).
                        Default is 0 (disabled)

        kvm-intel.unrestricted\_guest=
                        {[}KVM,Intel{]} Disable unrestricted guest feature
                        (virtualized real and unpaged mode) on capable
                        Intel chips. Default is 1 (enabled)

        kvm-intel.vpid= {[}KVM,Intel{]} Disable Virtual Processor Identification
                        feature (tagged TLBs) on capable Intel chips.
                        Default is 1 (enabled)

        l2cr=           {[}PPC{]}

        l3cr=           {[}PPC{]}

        lapic           {[}X86-32,APIC{]} Enable the local APIC even if BIOS
                        disabled it.

        lapic=          {[}x86,APIC{]} ``notscdeadline'' Do not use TSC deadline
                        value for LAPIC timer one-shot implementation. Default
                        back to the programmable timer unit in the LAPIC.

        lapic\_timer\_c2\_ok       {[}X86,APIC{]} trust the local apic timer
                        in C2 power state.

        libata.dma=     {[}LIBATA{]} DMA control
                        libata.dma=0      Disable all PATA and SATA DMA
                        libata.dma=1      PATA and SATA Disk DMA only
                        libata.dma=2      ATAPI (CDROM) DMA only
                        libata.dma=4      Compact Flash DMA only
                        Combinations also work, so libata.dma=3 enables DMA
                        for disks and CDROMs, but not CFs.

        libata.ignore\_hpa=      {[}LIBATA{]} Ignore HPA limit
                        libata.ignore\_hpa=0       keep BIOS limits (default)
                        libata.ignore\_hpa=1       ignore limits, using full disk

        libata.noacpi   {[}LIBATA{]} Disables use of ACPI in libata suspend/resume
                        when set.
                        Format: \textless{}int\textgreater{}

        libata.force=   {[}LIBATA{]} Force configurations.  The format is comma
                        separated list of ``{[}ID:{]}VAL'' where ID is
                        PORT{[}.DEVICE{]}.  PORT and DEVICE are decimal numbers
                        matching port, link or device.  Basically, it matches
                        the ATA ID string printed on console by libata.  If
                        the whole ID part is omitted, the last PORT and DEVICE
                        values are used.  If ID hasn't been specified yet, the
                        configuration applies to all ports, links and devices.

                        If only DEVICE is omitted, the parameter applies to
                        the port and all links and devices behind it.  DEVICE
                        number of 0 either selects the first device or the
                        first fan-out link behind PMP device.  It does not
                        select the host link.  DEVICE number of 15 selects the
                        host link and device attached to it.

                        The VAL specifies the configuration to force.  As long
                        as there's no ambiguity shortcut notation is allowed.
                        For example, both 1.5 and 1.5G would work for 1.5Gbps.
                        The following configurations can be forced.

                        * Cable type: 40c, 80c, short40c, unk, ign or sata.
                          Any ID with matching PORT is used.

                        * SATA link speed limit: 1.5Gbps or 3.0Gbps.

                        * Transfer mode: pio{[}0-7{]}, mwdma{[}0-4{]} and udma{[}0-7{]}.
                          udma{[}/{]}{[}16,25,33,44,66,100,133{]} notation is also
                          allowed.

                        * {[}no{]}ncq: Turn on or off NCQ.

                        * {[}no{]}ncqtrim: Turn off queued DSM TRIM.

                        * nohrst, nosrst, norst: suppress hard, soft
                          and both resets.

                        * rstonce: only attempt one reset during
                          hot-unplug link recovery

                        * dump\_id: dump IDENTIFY data.

                        * atapi\_dmadir: Enable ATAPI DMADIR bridge support

                        * disable: Disable this device.

                        If there are multiple matching configurations changing
                        the same attribute, the last one is used.

        memblock=debug  {[}KNL{]} Enable memblock debug messages.

        load\_ramdisk=   {[}RAM{]} List of ramdisks to load from floppy
                        See Documentation/blockdev/ramdisk.txt.

        lockd.nlm\_grace\_period=P  {[}NFS{]} Assign grace period.
                        Format: \textless{}integer\textgreater{}

        lockd.nlm\_tcpport=N     {[}NFS{]} Assign TCP port.
                        Format: \textless{}integer\textgreater{}

        lockd.nlm\_timeout=T     {[}NFS{]} Assign timeout value.
                        Format: \textless{}integer\textgreater{}

        lockd.nlm\_udpport=M     {[}NFS{]} Assign UDP port.
                        Format: \textless{}integer\textgreater{}

        locktorture.nreaders\_stress= {[}KNL{]}
                        Set the number of locking read-acquisition kthreads.
                        Defaults to being automatically set based on the
                        number of online CPUs.

        locktorture.nwriters\_stress= {[}KNL{]}
                        Set the number of locking write-acquisition kthreads.

        locktorture.onoff\_holdoff= {[}KNL{]}
                        Set time (s) after boot for CPU-hotplug testing.

        locktorture.onoff\_interval= {[}KNL{]}
                        Set time (s) between CPU-hotplug operations, or
                        zero to disable CPU-hotplug testing.

        locktorture.shuffle\_interval= {[}KNL{]}
                        Set task-shuffle interval (jiffies).  Shuffling
                        tasks allows some CPUs to go into dyntick-idle
                        mode during the locktorture test.

        locktorture.shutdown\_secs= {[}KNL{]}
                        Set time (s) after boot system shutdown.  This
                        is useful for hands-off automated testing.

        locktorture.stat\_interval= {[}KNL{]}
                        Time (s) between statistics printk()s.

        locktorture.stutter= {[}KNL{]}
                        Time (s) to stutter testing, for example,
                        specifying five seconds causes the test to run for
                        five seconds, wait for five seconds, and so on.
                        This tests the locking primitive's ability to
                        transition abruptly to and from idle.

        locktorture.torture\_type= {[}KNL{]}
                        Specify the locking implementation to test.

        locktorture.verbose= {[}KNL{]}
                        Enable additional printk() statements.

        logibm.irq=     {[}HW,MOUSE{]} Logitech Bus Mouse Driver
                        Format: \textless{}irq\textgreater{}

        loglevel=       All Kernel Messages with a loglevel smaller than the
                        console loglevel will be printed to the console. It can
                        also be changed with klogd or other programs. The
                        loglevels are defined as follows:

                        0 (KERN\_EMERG)          system is unusable
                        1 (KERN\_ALERT)          action must be taken immediately
                        2 (KERN\_CRIT)           critical conditions
                        3 (KERN\_ERR)            error conditions
                        4 (KERN\_WARNING)        warning conditions
                        5 (KERN\_NOTICE)         normal but significant condition
                        6 (KERN\_INFO)           informational
                        7 (KERN\_DEBUG)          debug-level messages

        log\_buf\_len=n{[}KMG{]}      Sets the size of the printk ring buffer,
                        in bytes.  n must be a power of two and greater
                        than the minimal size. The minimal size is defined
                        by LOG\_BUF\_SHIFT kernel config parameter. There is
                        also CONFIG\_LOG\_CPU\_MAX\_BUF\_SHIFT config parameter
                        that allows to increase the default size depending on
                        the number of CPUs. See init/Kconfig for more details.

        logo.nologo     {[}FB{]} Disables display of the built-in Linux logo.
                        This may be used to provide more screen space for
                        kernel log messages and is useful when debugging
                        kernel boot problems.

        lp=0            {[}LP{]}    Specify parallel ports to use, e.g,
        lp=port{[},port...{]}       lp=none,parport0 (lp0 not configured, lp1 uses
        lp=reset                first parallel port). `lp=0' disables the
        lp=auto                 printer driver. `lp=reset' (which can be
                                specified in addition to the ports) causes
                                attached printers to be reset. Using
                                lp=port1,port2,... specifies the parallel ports
                                to associate lp devices with, starting with
                                lp0. A port specification may be `none' to skip
                                that lp device, or a parport name such as
                                `parport0'. Specifying `lp=auto' instead of a
                                port specification list means that device IDs
                                from each port should be examined, to see if
                                an IEEE 1284-compliant printer is attached; if
                                so, the driver will manage that printer.
                                See also header of drivers/char/lp.c.

        lpj=n           {[}KNL{]}
                        Sets loops\_per\_jiffy to given constant, thus avoiding
                        time-consuming boot-time autodetection (up to 250 ms per
                        CPU). 0 enables autodetection (default). To determine
                        the correct value for your kernel, boot with normal
                        autodetection and see what value is printed. Note that
                        on SMP systems the preset will be applied to all CPUs,
                        which is likely to cause problems if your CPUs need
                        significantly divergent settings. An incorrect value
                        will cause delays in the kernel to be wrong, leading to
                        unpredictable I/O errors and other breakage. Although
                        unlikely, in the extreme case this might damage your
                        hardware.

        ltpc=           {[}NET{]}
                        Format: \textless{}io\textgreater{},\textless{}irq\textgreater{},\textless{}dma\textgreater{}

        machvec=        {[}IA-64{]} Force the use of a particular machine-vector
                        (machvec) in a generic kernel.
                        Example: machvec=hpzx1\_swiotlb

        machtype=       {[}Loongson{]} Share the same kernel image file between different
                         yeeloong laptop.
                        Example: machtype=lemote-yeeloong-2f-7inch

        max\_addr=nn{[}KMG{]}        {[}KNL,BOOT,ia64{]} All physical memory greater
                        than or equal to this physical address is ignored.

        maxcpus=        {[}SMP{]} Maximum number of processors that an SMP kernel
                        will bring up during bootup.  maxcpus=n : n \textgreater{}= 0 limits
                        the kernel to bring up `n' processors. Surely after
                        bootup you can bring up the other plugged cpu by executing
                        ``echo 1 \textgreater{} /sys/devices/system/cpu/cpuX/online''. So maxcpus
                        only takes effect during system bootup.
                        While n=0 is a special case, it is equivalent to ``nosmp'',
                        which also disables the IO APIC.

        max\_loop=       {[}LOOP{]} The number of loop block devices that get
        (loop.max\_loop) unconditionally pre-created at init time. The default
                        number is configured by BLK\_DEV\_LOOP\_MIN\_COUNT. Instead
                        of statically allocating a predefined number, loop
                        devices can be requested on-demand with the
                        /dev/loop-control interface.

        mce             {[}X86-32{]} Machine Check Exception

        mce=option      {[}X86-64{]} See Documentation/x86/x86\_64/boot-options.txt

        md=             {[}HW{]} RAID subsystems devices and level
                        See Documentation/admin-guide/md.rst.

        mdacon=         {[}MDA{]}
                        Format: \textless{}first\textgreater{},\textless{}last\textgreater{}
                        Specifies range of consoles to be captured by the MDA.

        mem=nn{[}KMG{]}     {[}KNL,BOOT{]} Force usage of a specific amount of memory
                        Amount of memory to be used when the kernel is not able
                        to see the whole system memory or for test.
                        {[}X86{]} Work as limiting max address. Use together
                        with memmap= to avoid physical address space collisions.
                        Without memmap= PCI devices could be placed at addresses
                        belonging to unused RAM.

        mem=nopentium   {[}BUGS=X86-32{]} Disable usage of 4MB pages for kernel
                        memory.

        memchunk=nn{[}KMG{]}
                        {[}KNL,SH{]} Allow user to override the default size for
                        per-device physically contiguous DMA buffers.

        memhp\_default\_state=online/offline
                        {[}KNL{]} Set the initial state for the memory hotplug
                        onlining policy. If not specified, the default value is
                        set according to the
                        CONFIG\_MEMORY\_HOTPLUG\_DEFAULT\_ONLINE kernel config
                        option.
                        See Documentation/memory-hotplug.txt.

        memmap=exactmap {[}KNL,X86{]} Enable setting of an exact
                        E820 memory map, as specified by the user.
                        Such memmap=exactmap lines can be constructed based on
                        BIOS output or other requirements. See the memmap=nn@ss
                        option description.

        memmap=nn{[}KMG{]}@ss{[}KMG{]}
                        {[}KNL{]} Force usage of a specific region of memory.
                        Region of memory to be used is from ss to ss+nn.
                        If @ss{[}KMG{]} is omitted, it is equivalent to mem=nn{[}KMG{]},
                        which limits max address to nn{[}KMG{]}.
                        Multiple different regions can be specified,
                        comma delimited.
                        Example:
                                memmap=100M@2G,100M\#3G,1G!1024G

        memmap=nn{[}KMG{]}\#ss{[}KMG{]}
                        {[}KNL,ACPI{]} Mark specific memory as ACPI data.
                        Region of memory to be marked is from ss to ss+nn.

        memmap=nn{[}KMG{]}\$ss{[}KMG{]}
                        {[}KNL,ACPI{]} Mark specific memory as reserved.
                        Region of memory to be reserved is from ss to ss+nn.
                        Example: Exclude memory from 0x18690000-0x1869ffff
                                 memmap=64K\$0x18690000
                                 or
                                 memmap=0x10000\$0x18690000
                        Some bootloaders may need an escape character before `\$',
                        like Grub2, otherwise `\$' and the following number
                        will be eaten.

        memmap=nn{[}KMG{]}!ss{[}KMG{]}
                        {[}KNL,X86{]} Mark specific memory as protected.
                        Region of memory to be used, from ss to ss+nn.
                        The memory region may be marked as e820 type 12 (0xc)
                        and is NVDIMM or ADR memory.

        memory\_corruption\_check=0/1 {[}X86{]}
                        Some BIOSes seem to corrupt the first 64k of
                        memory when doing things like suspend/resume.
                        Setting this option will scan the memory
                        looking for corruption.  Enabling this will
                        both detect corruption and prevent the kernel
                        from using the memory being corrupted.
                        However, its intended as a diagnostic tool; if
                        repeatable BIOS-originated corruption always
                        affects the same memory, you can use memmap=
                        to prevent the kernel from using that memory.

        memory\_corruption\_check\_size=size {[}X86{]}
                        By default it checks for corruption in the low
                        64k, making this memory unavailable for normal
                        use.  Use this parameter to scan for
                        corruption in more or less memory.

        memory\_corruption\_check\_period=seconds {[}X86{]}
                        By default it checks for corruption every 60
                        seconds.  Use this parameter to check at some
                        other rate.  0 disables periodic checking.

        memtest=        {[}KNL,X86,ARM{]} Enable memtest
                        Format: \textless{}integer\textgreater{}
                        default : 0 \textless{}disable\textgreater{}
                        Specifies the number of memtest passes to be
                        performed. Each pass selects another test
                        pattern from a given set of patterns. Memtest
                        fills the memory with this pattern, validates
                        memory contents and reserves bad memory
                        regions that are detected.

        mem\_encrypt=    {[}X86-64{]} AMD Secure Memory Encryption (SME) control
                        Valid arguments: on, off
                        Default (depends on kernel configuration option):
                          on  (CONFIG\_AMD\_MEM\_ENCRYPT\_ACTIVE\_BY\_DEFAULT=y)
                          off (CONFIG\_AMD\_MEM\_ENCRYPT\_ACTIVE\_BY\_DEFAULT=n)
                        mem\_encrypt=on:         Activate SME
                        mem\_encrypt=off:        Do not activate SME

                        Refer to Documentation/x86/amd-memory-encryption.txt
                        for details on when memory encryption can be activated.

        mem\_sleep\_default=      {[}SUSPEND{]} Default system suspend mode:
                        s2idle  - Suspend-To-Idle
                        shallow - Power-On Suspend or equivalent (if supported)
                        deep    - Suspend-To-RAM or equivalent (if supported)
                        See Documentation/admin-guide/pm/sleep-states.rst.

        meye.*=         {[}HW{]} Set MotionEye Camera parameters
                        See Documentation/media/v4l-drivers/meye.rst.

        mfgpt\_irq=      {[}IA-32{]} Specify the IRQ to use for the
                        Multi-Function General Purpose Timers on AMD Geode
                        platforms.

        mfgptfix        {[}X86-32{]} Fix MFGPT timers on AMD Geode platforms when
                        the BIOS has incorrectly applied a workaround. TinyBIOS
                        version 0.98 is known to be affected, 0.99 fixes the
                        problem by letting the user disable the workaround.

        mga=            {[}HW,DRM{]}

        min\_addr=nn{[}KMG{]}        {[}KNL,BOOT,ia64{]} All physical memory below this
                        physical address is ignored.

        mini2440=       {[}ARM,HW,KNL{]}
                        Format:{[}0..2{]}{[}b{]}{[}c{]}{[}t{]}
                        Default: ``0tb''
                        MINI2440 configuration specification:
                        0 - The attached screen is the 3.5'' TFT
                        1 - The attached screen is the 7'' TFT
                        2 - The VGA Shield is attached (1024x768)
                        Leaving out the screen size parameter will not load
                        the TFT driver, and the framebuffer will be left
                        unconfigured.
                        b - Enable backlight. The TFT backlight pin will be
                        linked to the kernel VESA blanking code and a GPIO
                        LED. This parameter is not necessary when using the
                        VGA shield.
                        c - Enable the s3c camera interface.
                        t - Reserved for enabling touchscreen support. The
                        touchscreen support is not enabled in the mainstream
                        kernel as of 2.6.30, a preliminary port can be found
                        in the ``bleeding edge'' mini2440 support kernel at
                        http://repo.or.cz/w/linux-2.6/mini2440.git

        mminit\_loglevel=
                        {[}KNL{]} When CONFIG\_DEBUG\_MEMORY\_INIT is set, this
                        parameter allows control of the logging verbosity for
                        the additional memory initialisation checks. A value
                        of 0 disables mminit logging and a level of 4 will
                        log everything. Information is printed at KERN\_DEBUG
                        so loglevel=8 may also need to be specified.

        module.sig\_enforce
                        {[}KNL{]} When CONFIG\_MODULE\_SIG is set, this means that
                        modules without (valid) signatures will fail to load.
                        Note that if CONFIG\_MODULE\_SIG\_FORCE is set, that
                        is always true, so this option does nothing.

        module\_blacklist=  {[}KNL{]} Do not load a comma-separated list of
                        modules.  Useful for debugging problem modules.

        mousedev.tap\_time=
                        {[}MOUSE{]} Maximum time between finger touching and
                        leaving touchpad surface for touch to be considered
                        a tap and be reported as a left button click (for
                        touchpads working in absolute mode only).
                        Format: \textless{}msecs\textgreater{}
        mousedev.xres=  {[}MOUSE{]} Horizontal screen resolution, used for devices
                        reporting absolute coordinates, such as tablets
        mousedev.yres=  {[}MOUSE{]} Vertical screen resolution, used for devices
                        reporting absolute coordinates, such as tablets

        movablecore=nn{[}KMG{]}     {[}KNL,X86,IA-64,PPC{]} This parameter
                        is similar to kernelcore except it specifies the
                        amount of memory used for migratable allocations.
                        If both kernelcore and movablecore is specified,
                        then kernelcore will be at *least* the specified
                        value but may be more. If movablecore on its own
                        is specified, the administrator must be careful
                        that the amount of memory usable for all allocations
                        is not too small.

        movable\_node    {[}KNL{]} Boot-time switch to make hotplugable memory
                        NUMA nodes to be movable. This means that the memory
                        of such nodes will be usable only for movable
                        allocations which rules out almost all kernel
                        allocations. Use with caution!

        MTD\_Partition=  {[}MTD{]}
                        Format: \textless{}name\textgreater{},\textless{}region-number\textgreater{},\textless{}size\textgreater{},\textless{}offset\textgreater{}

        MTD\_Region=     {[}MTD{]} Format:
                        \textless{}name\textgreater{},\textless{}region-number\textgreater{}{[},\textless{}base\textgreater{},\textless{}size\textgreater{},\textless{}buswidth\textgreater{},\textless{}altbuswidth\textgreater{}{]}

        mtdparts=       {[}MTD{]}
                        See drivers/mtd/cmdlinepart.c.

        multitce=off    {[}PPC{]}  This parameter disables the use of the pSeries
                        firmware feature for updating multiple TCE entries
                        at a time.

        onenand.bdry=   {[}HW,MTD{]} Flex-OneNAND Boundary Configuration

                        Format: {[}die0\_boundary{]}{[},die0\_lock{]}{[},die1\_boundary{]}{[},die1\_lock{]}

                        boundary - index of last SLC block on Flex-OneNAND.
                                   The remaining blocks are configured as MLC blocks.
                        lock     - Configure if Flex-OneNAND boundary should be locked.
                                   Once locked, the boundary cannot be changed.
                                   1 indicates lock status, 0 indicates unlock status.

        mtdset=         {[}ARM{]}
                        ARM/S3C2412 JIVE boot control

                        See arch/arm/mach-s3c2412/mach-jive.c

        mtouchusb.raw\_coordinates=
                        {[}HW{]} Make the MicroTouch USB driver use raw coordinates
                        (`y', default) or cooked coordinates (`n')

        mtrr\_chunk\_size=nn{[}KMG{]} {[}X86{]}
                        used for mtrr cleanup. It is largest continuous chunk
                        that could hold holes aka. UC entries.

        mtrr\_gran\_size=nn{[}KMG{]} {[}X86{]}
                        Used for mtrr cleanup. It is granularity of mtrr block.
                        Default is 1.
                        Large value could prevent small alignment from
                        using up MTRRs.

        mtrr\_spare\_reg\_nr=n {[}X86{]}
                        Format: \textless{}integer\textgreater{}
                        Range: 0,7 : spare reg number
                        Default : 1
                        Used for mtrr cleanup. It is spare mtrr entries number.
                        Set to 2 or more if your graphical card needs more.

        n2=             {[}NET{]} SDL Inc. RISCom/N2 synchronous serial card

        netdev=         {[}NET{]} Network devices parameters
                        Format: \textless{}irq\textgreater{},\textless{}io\textgreater{},\textless{}mem\_start\textgreater{},\textless{}mem\_end\textgreater{},\textless{}name\textgreater{}
                        Note that mem\_start is often overloaded to mean
                        something different and driver-specific.
                        This usage is only documented in each driver source
                        file if at all.

        nf\_conntrack.acct=
                        {[}NETFILTER{]} Enable connection tracking flow accounting
                        0 to disable accounting
                        1 to enable accounting
                        Default value is 0.

        nfsaddrs=       {[}NFS{]} Deprecated.  Use ip= instead.
                        See Documentation/filesystems/nfs/nfsroot.txt.

        nfsroot=        {[}NFS{]} nfs root filesystem for disk-less boxes.
                        See Documentation/filesystems/nfs/nfsroot.txt.

        nfsrootdebug    {[}NFS{]} enable nfsroot debugging messages.
                        See Documentation/filesystems/nfs/nfsroot.txt.

        nfs.callback\_nr\_threads=
                        {[}NFSv4{]} set the total number of threads that the
                        NFS client will assign to service NFSv4 callback
                        requests.

        nfs.callback\_tcpport=
                        {[}NFS{]} set the TCP port on which the NFSv4 callback
                        channel should listen.

        nfs.cache\_getent=
                        {[}NFS{]} sets the pathname to the program which is used
                        to update the NFS client cache entries.

        nfs.cache\_getent\_timeout=
                        {[}NFS{]} sets the timeout after which an attempt to
                        update a cache entry is deemed to have failed.

        nfs.idmap\_cache\_timeout=
                        {[}NFS{]} set the maximum lifetime for idmapper cache
                        entries.

        nfs.enable\_ino64=
                        {[}NFS{]} enable 64-bit inode numbers.
                        If zero, the NFS client will fake up a 32-bit inode
                        number for the readdir() and stat() syscalls instead
                        of returning the full 64-bit number.
                        The default is to return 64-bit inode numbers.

        nfs.max\_session\_cb\_slots=
                        {[}NFSv4.1{]} Sets the maximum number of session
                        slots the client will assign to the callback
                        channel. This determines the maximum number of
                        callbacks the client will process in parallel for
                        a particular server.

        nfs.max\_session\_slots=
                        {[}NFSv4.1{]} Sets the maximum number of session slots
                        the client will attempt to negotiate with the server.
                        This limits the number of simultaneous RPC requests
                        that the client can send to the NFSv4.1 server.
                        Note that there is little point in setting this
                        value higher than the max\_tcp\_slot\_table\_limit.

        nfs.nfs4\_disable\_idmapping=
                        {[}NFSv4{]} When set to the default of `1', this option
                        ensures that both the RPC level authentication
                        scheme and the NFS level operations agree to use
                        numeric uids/gids if the mount is using the
                        `sec=sys' security flavour. In effect it is
                        disabling idmapping, which can make migration from
                        legacy NFSv2/v3 systems to NFSv4 easier.
                        Servers that do not support this mode of operation
                        will be autodetected by the client, and it will fall
                        back to using the idmapper.
                        To turn off this behaviour, set the value to `0'.
        nfs.nfs4\_unique\_id=
                        {[}NFS4{]} Specify an additional fixed unique ident-
                        ification string that NFSv4 clients can insert into
                        their nfs\_client\_id4 string.  This is typically a
                        UUID that is generated at system install time.

        nfs.send\_implementation\_id =
                        {[}NFSv4.1{]} Send client implementation identification
                        information in exchange\_id requests.
                        If zero, no implementation identification information
                        will be sent.
                        The default is to send the implementation identification
                        information.

        nfs.recover\_lost\_locks =
                        {[}NFSv4{]} Attempt to recover locks that were lost due
                        to a lease timeout on the server. Please note that
                        doing this risks data corruption, since there are
                        no guarantees that the file will remain unchanged
                        after the locks are lost.
                        If you want to enable the kernel legacy behaviour of
                        attempting to recover these locks, then set this
                        parameter to `1'.
                        The default parameter value of `0' causes the kernel
                        not to attempt recovery of lost locks.

        nfs4.layoutstats\_timer =
                        {[}NFSv4.2{]} Change the rate at which the kernel sends
                        layoutstats to the pNFS metadata server.

                        Setting this to value to 0 causes the kernel to use
                        whatever value is the default set by the layout
                        driver. A non-zero value sets the minimum interval
                        in seconds between layoutstats transmissions.

        nfsd.nfs4\_disable\_idmapping=
                        {[}NFSv4{]} When set to the default of `1', the NFSv4
                        server will return only numeric uids and gids to
                        clients using auth\_sys, and will accept numeric uids
                        and gids from such clients.  This is intended to ease
                        migration from NFSv2/v3.

        nmi\_debug=      {[}KNL,SH{]} Specify one or more actions to take
                        when a NMI is triggered.
                        Format: {[}state{]}{[},regs{]}{[},debounce{]}{[},die{]}

        nmi\_watchdog=   {[}KNL,BUGS=X86{]} Debugging features for SMP kernels
                        Format: {[}panic,{]}{[}nopanic,{]}{[}num{]}
                        Valid num: 0 or 1
                        0 - turn hardlockup detector in nmi\_watchdog off
                        1 - turn hardlockup detector in nmi\_watchdog on
                        When panic is specified, panic when an NMI watchdog
                        timeout occurs (or `nopanic' to override the opposite
                        default). To disable both hard and soft lockup detectors,
                        please see `nowatchdog'.
                        This is useful when you use a panic=... timeout and
                        need the box quickly up again.

                        These settings can be accessed at runtime via
                        the nmi\_watchdog and hardlockup\_panic sysctls.

        netpoll.carrier\_timeout=
                        {[}NET{]} Specifies amount of time (in seconds) that
                        netpoll should wait for a carrier. By default netpoll
                        waits 4 seconds.

        no387           {[}BUGS=X86-32{]} Tells the kernel to use the 387 maths
                        emulation library even if a 387 maths coprocessor
                        is present.

        no\_console\_suspend
                        {[}HW{]} Never suspend the console
                        Disable suspending of consoles during suspend and
                        hibernate operations.  Once disabled, debugging
                        messages can reach various consoles while the rest
                        of the system is being put to sleep (ie, while
                        debugging driver suspend/resume hooks).  This may
                        not work reliably with all consoles, but is known
                        to work with serial and VGA consoles.
                        To facilitate more flexible debugging, we also add
                        console\_suspend, a printk module parameter to control
                        it. Users could use console\_suspend (usually
                        /sys/module/printk/parameters/console\_suspend) to
                        turn on/off it dynamically.

        noaliencache    {[}MM, NUMA, SLAB{]} Disables the allocation of alien
                        caches in the slab allocator.  Saves per-node memory,
                        but will impact performance.

        noalign         {[}KNL,ARM{]}

        noaltinstr      {[}S390{]} Disables alternative instructions patching
                        (CPU alternatives feature).

        noapic          {[}SMP,APIC{]} Tells the kernel to not make use of any
                        IOAPICs that may be present in the system.

        noautogroup     Disable scheduler automatic task group creation.

        nobats          {[}PPC{]} Do not use BATs for mapping kernel lowmem
                        on ``Classic'' PPC cores.

        nocache         {[}ARM{]}

        noclflush       {[}BUGS=X86{]} Don't use the CLFLUSH instruction

        nodelayacct     {[}KNL{]} Disable per-task delay accounting

        nodsp           {[}SH{]} Disable hardware DSP at boot time.

        noefi           Disable EFI runtime services support.

        noexec          {[}IA-64{]}

        noexec          {[}X86{]}
                        On X86-32 available only on PAE configured kernels.
                        noexec=on: enable non-executable mappings (default)
                        noexec=off: disable non-executable mappings

        nosmap          {[}X86{]}
                        Disable SMAP (Supervisor Mode Access Prevention)
                        even if it is supported by processor.

        nosmep          {[}X86{]}
                        Disable SMEP (Supervisor Mode Execution Prevention)
                        even if it is supported by processor.

        noexec32        {[}X86-64{]}
                        This affects only 32-bit executables.
                        noexec32=on: enable non-executable mappings (default)
                                read doesn't imply executable mappings
                        noexec32=off: disable non-executable mappings
                                read implies executable mappings

        nofpu           {[}MIPS,SH{]} Disable hardware FPU at boot time.

        nofxsr          {[}BUGS=X86-32{]} Disables x86 floating point extended
                        register save and restore. The kernel will only save
                        legacy floating-point registers on task switch.

        nohugeiomap     {[}KNL,x86{]} Disable kernel huge I/O mappings.

        nosmt           {[}KNL,S390{]} Disable symmetric multithreading (SMT).
                        Equivalent to smt=1.

        nospectre\_v2    {[}X86{]} Disable all mitigations for the Spectre variant 2
                        (indirect branch prediction) vulnerability. System may
                        allow data leaks with this option, which is equivalent
                        to spectre\_v2=off.

        noxsave         {[}BUGS=X86{]} Disables x86 extended register state save
                        and restore using xsave. The kernel will fallback to
                        enabling legacy floating-point and sse state.

        noxsaveopt      {[}X86{]} Disables xsaveopt used in saving x86 extended
                        register states. The kernel will fall back to use
                        xsave to save the states. By using this parameter,
                        performance of saving the states is degraded because
                        xsave doesn't support modified optimization while
                        xsaveopt supports it on xsaveopt enabled systems.

        noxsaves        {[}X86{]} Disables xsaves and xrstors used in saving and
                        restoring x86 extended register state in compacted
                        form of xsave area. The kernel will fall back to use
                        xsaveopt and xrstor to save and restore the states
                        in standard form of xsave area. By using this
                        parameter, xsave area per process might occupy more
                        memory on xsaves enabled systems.

        nohlt           {[}BUGS=ARM,SH{]} Tells the kernel that the sleep(SH) or
                        wfi(ARM) instruction doesn't work correctly and not to
                        use it. This is also useful when using JTAG debugger.

        no\_file\_caps    Tells the kernel not to honor file capabilities.  The
                        only way then for a file to be executed with privilege
                        is to be setuid root or executed by root.

        nohalt          {[}IA-64{]} Tells the kernel not to use the power saving
                        function PAL\_HALT\_LIGHT when idle. This increases
                        power-consumption. On the positive side, it reduces
                        interrupt wake-up latency, which may improve performance
                        in certain environments such as networked servers or
                        real-time systems.

        nohibernate     {[}HIBERNATION{]} Disable hibernation and resume.

        nohz=           {[}KNL{]} Boottime enable/disable dynamic ticks
                        Valid arguments: on, off
                        Default: on

        nohz\_full=      {[}KNL,BOOT,SMP,ISOL{]}
                        The argument is a cpu list, as described above.
                        In kernels built with CONFIG\_NO\_HZ\_FULL=y, set
                        the specified list of CPUs whose tick will be stopped
                        whenever possible. The boot CPU will be forced outside
                        the range to maintain the timekeeping.  Any CPUs
                        in this list will have their RCU callbacks offloaded,
                        just as if they had also been called out in the
                        rcu\_nocbs= boot parameter.

        noiotrap        {[}SH{]} Disables trapped I/O port accesses.

        noirqdebug      {[}X86-32{]} Disables the code which attempts to detect and
                        disable unhandled interrupt sources.

        no\_timer\_check  {[}X86,APIC{]} Disables the code which tests for
                        broken timer IRQ sources.

        noisapnp        {[}ISAPNP{]} Disables ISA PnP code.

        noinitrd        {[}RAM{]} Tells the kernel not to load any configured
                        initial RAM disk.

        nointremap      {[}X86-64, Intel-IOMMU{]} Do not enable interrupt
                        remapping.
                        {[}Deprecated - use intremap=off{]}

        nointroute      {[}IA-64{]}

        noinvpcid       {[}X86{]} Disable the INVPCID cpu feature.

        nojitter        {[}IA-64{]} Disables jitter checking for ITC timers.

        no-kvmclock     {[}X86,KVM{]} Disable paravirtualized KVM clock driver

        no-kvmapf       {[}X86,KVM{]} Disable paravirtualized asynchronous page
                        fault handling.

        no-vmw-sched-clock
                        {[}X86,PV\_OPS{]} Disable paravirtualized VMware scheduler
                        clock and use the default one.

        no-steal-acc    {[}X86,KVM{]} Disable paravirtualized steal time accounting.
                        steal time is computed, but won't influence scheduler
                        behaviour

        nolapic         {[}X86-32,APIC{]} Do not enable or use the local APIC.

        nolapic\_timer   {[}X86-32,APIC{]} Do not use the local APIC timer.

        noltlbs         {[}PPC{]} Do not use large page/tlb entries for kernel
                        lowmem mapping on PPC40x and PPC8xx

        nomca           {[}IA-64{]} Disable machine check abort handling

        nomce           {[}X86-32{]} Disable Machine Check Exception

        nomfgpt         {[}X86-32{]} Disable Multi-Function General Purpose
                        Timer usage (for AMD Geode machines).

        nonmi\_ipi       {[}X86{]} Disable using NMI IPIs during panic/reboot to
                        shutdown the other cpus.  Instead use the REBOOT\_VECTOR
                        irq.

        nomodule        Disable module load

        nopat           {[}X86{]} Disable PAT (page attribute table extension of
                        pagetables) support.

        nopcid          {[}X86-64{]} Disable the PCID cpu feature.

        norandmaps      Don't use address space randomization.  Equivalent to
                        echo 0 \textgreater{} /proc/sys/kernel/randomize\_va\_space

        noreplace-smp   {[}X86-32,SMP{]} Don't replace SMP instructions
                        with UP alternatives

        nordrand        {[}X86{]} Disable kernel use of the RDRAND and
                        RDSEED instructions even if they are supported
                        by the processor.  RDRAND and RDSEED are still
                        available to user space applications.

        noresume        {[}SWSUSP{]} Disables resume and restores original swap
                        space.

        no-scroll       {[}VGA{]} Disables scrollback.
                        This is required for the Braillex ib80-piezo Braille
                        reader made by F.H. Papenmeier (Germany).

        nosbagart       {[}IA-64{]}

        nosep           {[}BUGS=X86-32{]} Disables x86 SYSENTER/SYSEXIT support.

        nosmp           {[}SMP{]} Tells an SMP kernel to act as a UP kernel,
                        and disable the IO APIC.  legacy for ``maxcpus=0''.

        nosoftlockup    {[}KNL{]} Disable the soft-lockup detector.

        nosync          {[}HW,M68K{]} Disables sync negotiation for all devices.

        notsc           {[}BUGS=X86-32{]} Disable Time Stamp Counter

        nowatchdog      {[}KNL{]} Disable both lockup detectors, i.e.
                        soft-lockup and NMI watchdog (hard-lockup).

        nowb            {[}ARM{]}

        nox2apic        {[}X86-64,APIC{]} Do not enable x2APIC mode.

        cpu0\_hotplug    {[}X86{]} Turn on CPU0 hotplug feature when
                        CONFIG\_BOOTPARAM\_HOTPLUG\_CPU0 is off.
                        Some features depend on CPU0. Known dependencies are:
                        1. Resume from suspend/hibernate depends on CPU0.
                        Suspend/hibernate will fail if CPU0 is offline and you
                        need to online CPU0 before suspend/hibernate.
                        2. PIC interrupts also depend on CPU0. CPU0 can't be
                        removed if a PIC interrupt is detected.
                        It's said poweroff/reboot may depend on CPU0 on some
                        machines although I haven't seen such issues so far
                        after CPU0 is offline on a few tested machines.
                        If the dependencies are under your control, you can
                        turn on cpu0\_hotplug.

        nps\_mtm\_hs\_ctr= {[}KNL,ARC{]}
                        This parameter sets the maximum duration, in
                        cycles, each HW thread of the CTOP can run
                        without interruptions, before HW switches it.
                        The actual maximum duration is 16 times this
                        parameter's value.
                        Format: integer between 1 and 255
                        Default: 255

        nptcg=          {[}IA-64{]} Override max number of concurrent global TLB
                        purges which is reported from either PAL\_VM\_SUMMARY or
                        SAL PALO.

        nr\_cpus=        {[}SMP{]} Maximum number of processors that an SMP kernel
                        could support.  nr\_cpus=n : n \textgreater{}= 1 limits the kernel to
                        support `n' processors. It could be larger than the
                        number of already plugged CPU during bootup, later in
                        runtime you can physically add extra cpu until it reaches
                        n. So during boot up some boot time memory for per-cpu
                        variables need be pre-allocated for later physical cpu
                        hot plugging.

        nr\_uarts=       {[}SERIAL{]} maximum number of UARTs to be registered.

        numa\_balancing= {[}KNL,X86{]} Enable or disable automatic NUMA balancing.
                        Allowed values are enable and disable

        numa\_zonelist\_order= {[}KNL, BOOT{]} Select zonelist order for NUMA.
                        `node', `default' can be specified
                        This can be set from sysctl after boot.
                        See Documentation/sysctl/vm.txt for details.

        ohci1394\_dma=early      {[}HW{]} enable debugging via the ohci1394 driver.
                        See Documentation/debugging-via-ohci1394.txt for more
                        info.

        olpc\_ec\_timeout= {[}OLPC{]} ms delay when issuing EC commands
                        Rather than timing out after 20 ms if an EC
                        command is not properly ACKed, override the length
                        of the timeout.  We have interrupts disabled while
                        waiting for the ACK, so if this is set too high
                        interrupts *may* be lost!

        omap\_mux=       {[}OMAP{]} Override bootloader pin multiplexing.
                        Format: \textless{}mux\_mode0.mode\_name=value\textgreater{}...
                        For example, to override I2C bus2:
                        omap\_mux=i2c2\_scl.i2c2\_scl=0x100,i2c2\_sda.i2c2\_sda=0x100

        oprofile.timer= {[}HW{]}
                        Use timer interrupt instead of performance counters

        oprofile.cpu\_type=      Force an oprofile cpu type
                        This might be useful if you have an older oprofile
                        userland or if you want common events.
                        Format: \{ arch\_perfmon \}
                        arch\_perfmon: {[}X86{]} Force use of architectural
                                perfmon on Intel CPUs instead of the
                                CPU specific event set.
                        timer: {[}X86{]} Force use of architectural NMI
                                timer mode (see also oprofile.timer
                                for generic hr timer mode)

        oops=panic      Always panic on oopses. Default is to just kill the
                        process, but there is a small probability of
                        deadlocking the machine.
                        This will also cause panics on machine check exceptions.
                        Useful together with panic=30 to trigger a reboot.

        OSS             {[}HW,OSS{]}
                        See Documentation/sound/oss/oss-parameters.txt

        page\_owner=     {[}KNL{]} Boot-time page\_owner enabling option.
                        Storage of the information about who allocated
                        each page is disabled in default. With this switch,
                        we can turn it on.
                        on: enable the feature

        page\_poison=    {[}KNL{]} Boot-time parameter changing the state of
                        poisoning on the buddy allocator.
                        off: turn off poisoning
                        on: turn on poisoning

        panic=          {[}KNL{]} Kernel behaviour on panic: delay \textless{}timeout\textgreater{}
                        timeout \textgreater{} 0: seconds before rebooting
                        timeout = 0: wait forever
                        timeout \textless{} 0: reboot immediately
                        Format: \textless{}timeout\textgreater{}

        panic\_on\_warn   panic() instead of WARN().  Useful to cause kdump
                        on a WARN().

        crash\_kexec\_post\_notifiers
                        Run kdump after running panic-notifiers and dumping
                        kmsg. This only for the users who doubt kdump always
                        succeeds in any situation.
                        Note that this also increases risks of kdump failure,
                        because some panic notifiers can make the crashed
                        kernel more unstable.

        parkbd.port=    {[}HW{]} Parallel port number the keyboard adapter is
                        connected to, default is 0.
                        Format: \textless{}parport\#\textgreater{}
        parkbd.mode=    {[}HW{]} Parallel port keyboard adapter mode of operation,
                        0 for XT, 1 for AT (default is AT).
                        Format: \textless{}mode\textgreater{}

        parport=        {[}HW,PPT{]} Specify parallel ports. 0 disables.
                        Format: \{ 0 \textbar{} auto \textbar{} 0xBBB{[},IRQ{[},DMA{]}{]} \}
                        Use `auto' to force the driver to use any
                        IRQ/DMA settings detected (the default is to
                        ignore detected IRQ/DMA settings because of
                        possible conflicts). You can specify the base
                        address, IRQ, and DMA settings; IRQ and DMA
                        should be numbers, or `auto' (for using detected
                        settings on that particular port), or `nofifo'
                        (to avoid using a FIFO even if it is detected).
                        Parallel ports are assigned in the order they
                        are specified on the command line, starting
                        with parport0.

        parport\_init\_mode=      {[}HW,PPT{]}
                        Configure VIA parallel port to operate in
                        a specific mode. This is necessary on Pegasos
                        computer where firmware has no options for setting
                        up parallel port mode and sets it to spp.
                        Currently this function knows 686a and 8231 chips.
                        Format: {[}spp\textbar{}ps2\textbar{}epp\textbar{}ecp\textbar{}ecpepp{]}

        pause\_on\_oops=
                        Halt all CPUs after the first oops has been printed for
                        the specified number of seconds.  This is to be used if
                        your oopses keep scrolling off the screen.

        pcbit=          {[}HW,ISDN{]}

        pcd.            {[}PARIDE{]}
                        See header of drivers/block/paride/pcd.c.
                        See also Documentation/blockdev/paride.txt.

        pci=option{[},option...{]}  {[}PCI{]} various PCI subsystem options:
                earlydump       {[}X86{]} dump PCI config space before the kernel
                                changes anything
                off             {[}X86{]} don't probe for the PCI bus
                bios            {[}X86-32{]} force use of PCI BIOS, don't access
                                the hardware directly. Use this if your machine
                                has a non-standard PCI host bridge.
                nobios          {[}X86-32{]} disallow use of PCI BIOS, only direct
                                hardware access methods are allowed. Use this
                                if you experience crashes upon bootup and you
                                suspect they are caused by the BIOS.
                conf1           {[}X86{]} Force use of PCI Configuration Access
                                Mechanism 1 (config address in IO port 0xCF8,
                                data in IO port 0xCFC, both 32-bit).
                conf2           {[}X86{]} Force use of PCI Configuration Access
                                Mechanism 2 (IO port 0xCF8 is an 8-bit port for
                                the function, IO port 0xCFA, also 8-bit, sets
                                bus number. The config space is then accessed
                                through ports 0xC000-0xCFFF).
                                See http://wiki.osdev.org/PCI for more info
                                on the configuration access mechanisms.
                noaer           {[}PCIE{]} If the PCIEAER kernel config parameter is
                                enabled, this kernel boot option can be used to
                                disable the use of PCIE advanced error reporting.
                nodomains       {[}PCI{]} Disable support for multiple PCI
                                root domains (aka PCI segments, in ACPI-speak).
                nommconf        {[}X86{]} Disable use of MMCONFIG for PCI
                                Configuration
                check\_enable\_amd\_mmconf {[}X86{]} check for and enable
                                properly configured MMIO access to PCI
                                config space on AMD family 10h CPU
                nomsi           {[}MSI{]} If the PCI\_MSI kernel config parameter is
                                enabled, this kernel boot option can be used to
                                disable the use of MSI interrupts system-wide.
                noioapicquirk   {[}APIC{]} Disable all boot interrupt quirks.
                                Safety option to keep boot IRQs enabled. This
                                should never be necessary.
                ioapicreroute   {[}APIC{]} Enable rerouting of boot IRQs to the
                                primary IO-APIC for bridges that cannot disable
                                boot IRQs. This fixes a source of spurious IRQs
                                when the system masks IRQs.
                noioapicreroute {[}APIC{]} Disable workaround that uses the
                                boot IRQ equivalent of an IRQ that connects to
                                a chipset where boot IRQs cannot be disabled.
                                The opposite of ioapicreroute.
                biosirq         {[}X86-32{]} Use PCI BIOS calls to get the interrupt
                                routing table. These calls are known to be buggy
                                on several machines and they hang the machine
                                when used, but on other computers it's the only
                                way to get the interrupt routing table. Try
                                this option if the kernel is unable to allocate
                                IRQs or discover secondary PCI buses on your
                                motherboard.
                rom             {[}X86{]} Assign address space to expansion ROMs.
                                Use with caution as certain devices share
                                address decoders between ROMs and other
                                resources.
                norom           {[}X86{]} Do not assign address space to
                                expansion ROMs that do not already have
                                BIOS assigned address ranges.
                nobar           {[}X86{]} Do not assign address space to the
                                BARs that weren't assigned by the BIOS.
                irqmask=0xMMMM  {[}X86{]} Set a bit mask of IRQs allowed to be
                                assigned automatically to PCI devices. You can
                                make the kernel exclude IRQs of your ISA cards
                                this way.
                pirqaddr=0xAAAAA        {[}X86{]} Specify the physical address
                                of the PIRQ table (normally generated
                                by the BIOS) if it is outside the
                                F0000h-100000h range.
                lastbus=N       {[}X86{]} Scan all buses thru bus \#N. Can be
                                useful if the kernel is unable to find your
                                secondary buses and you want to tell it
                                explicitly which ones they are.
                assign-busses   {[}X86{]} Always assign all PCI bus
                                numbers ourselves, overriding
                                whatever the firmware may have done.
                usepirqmask     {[}X86{]} Honor the possible IRQ mask stored
                                in the BIOS \$PIR table. This is needed on
                                some systems with broken BIOSes, notably
                                some HP Pavilion N5400 and Omnibook XE3
                                notebooks. This will have no effect if ACPI
                                IRQ routing is enabled.
                noacpi          {[}X86{]} Do not use ACPI for IRQ routing
                                or for PCI scanning.
                use\_crs         {[}X86{]} Use PCI host bridge window information
                                from ACPI.  On BIOSes from 2008 or later, this
                                is enabled by default.  If you need to use this,
                                please report a bug.
                nocrs           {[}X86{]} Ignore PCI host bridge windows from ACPI.
                                If you need to use this, please report a bug.
                routeirq        Do IRQ routing for all PCI devices.
                                This is normally done in pci\_enable\_device(),
                                so this option is a temporary workaround
                                for broken drivers that don't call it.
                skip\_isa\_align  {[}X86{]} do not align io start addr, so can
                                handle more pci cards
                noearly         {[}X86{]} Don't do any early type 1 scanning.
                                This might help on some broken boards which
                                machine check when some devices' config space
                                is read. But various workarounds are disabled
                                and some IOMMU drivers will not work.
                bfsort          Sort PCI devices into breadth-first order.
                                This sorting is done to get a device
                                order compatible with older (\textless{}= 2.4) kernels.
                nobfsort        Don't sort PCI devices into breadth-first order.
                pcie\_bus\_tune\_off       Disable PCIe MPS (Max Payload Size)
                                tuning and use the BIOS-configured MPS defaults.
                pcie\_bus\_safe   Set every device's MPS to the largest value
                                supported by all devices below the root complex.
                pcie\_bus\_perf   Set device MPS to the largest allowable MPS
                                based on its parent bus. Also set MRRS (Max
                                Read Request Size) to the largest supported
                                value (no larger than the MPS that the device
                                or bus can support) for best performance.
                pcie\_bus\_peer2peer      Set every device's MPS to 128B, which
                                every device is guaranteed to support. This
                                configuration allows peer-to-peer DMA between
                                any pair of devices, possibly at the cost of
                                reduced performance.  This also guarantees
                                that hot-added devices will work.
                cbiosize=nn{[}KMG{]}        The fixed amount of bus space which is
                                reserved for the CardBus bridge's IO window.
                                The default value is 256 bytes.
                cbmemsize=nn{[}KMG{]}       The fixed amount of bus space which is
                                reserved for the CardBus bridge's memory
                                window. The default value is 64 megabytes.
                resource\_alignment=
                                Format:
                                {[}\textless{}order of align\textgreater{}@{]}{[}\textless{}domain\textgreater{}:{]}\textless{}bus\textgreater{}:\textless{}slot\textgreater{}.\textless{}func\textgreater{}{[}; ...{]}
                                {[}\textless{}order of align\textgreater{}@{]}pci:\textless{}vendor\textgreater{}:\textless{}device\textgreater{}\textbackslash{}
                                                {[}:\textless{}subvendor\textgreater{}:\textless{}subdevice\textgreater{}{]}{[}; ...{]}
                                Specifies alignment and device to reassign
                                aligned memory resources.
                                If \textless{}order of align\textgreater{} is not specified,
                                PAGE\_SIZE is used as alignment.
                                PCI-PCI bridge can be specified, if resource
                                windows need to be expanded.
                                To specify the alignment for several
                                instances of a device, the PCI vendor,
                                device, subvendor, and subdevice may be
                                specified, e.g., 4096@pci:8086:9c22:103c:198f
                ecrc=           Enable/disable PCIe ECRC (transaction layer
                                end-to-end CRC checking).
                                bios: Use BIOS/firmware settings. This is the
                                the default.
                                off: Turn ECRC off
                                on: Turn ECRC on.
                hpiosize=nn{[}KMG{]}        The fixed amount of bus space which is
                                reserved for hotplug bridge's IO window.
                                Default size is 256 bytes.
                hpmemsize=nn{[}KMG{]}       The fixed amount of bus space which is
                                reserved for hotplug bridge's memory window.
                                Default size is 2 megabytes.
                hpbussize=nn    The minimum amount of additional bus numbers
                                reserved for buses below a hotplug bridge.
                                Default is 1.
                realloc=        Enable/disable reallocating PCI bridge resources
                                if allocations done by BIOS are too small to
                                accommodate resources required by all child
                                devices.
                                off: Turn realloc off
                                on: Turn realloc on
                realloc         same as realloc=on
                noari           do not use PCIe ARI.
                pcie\_scan\_all   Scan all possible PCIe devices.  Otherwise we
                                only look for one device below a PCIe downstream
                                port.
                big\_root\_window Try to add a big 64bit memory window to the PCIe
                                root complex on AMD CPUs. Some GFX hardware
                                can resize a BAR to allow access to all VRAM.
                                Adding the window is slightly risky (it may
                                conflict with unreported devices), so this
                                taints the kernel.

        pcie\_aspm=      {[}PCIE{]} Forcibly enable or disable PCIe Active State Power
                        Management.
                off     Disable ASPM.
                force   Enable ASPM even on devices that claim not to support it.
                        WARNING: Forcing ASPM on may cause system lockups.

        pcie\_hp=        {[}PCIE{]} PCI Express Hotplug driver options:
                nomsi   Do not use MSI for PCI Express Native Hotplug (this
                        makes all PCIe ports use INTx for hotplug services).

        pcie\_ports=     {[}PCIE{]} PCIe ports handling:
                auto    Ask the BIOS whether or not to use native PCIe services
                        associated with PCIe ports (PME, hot-plug, AER).  Use
                        them only if that is allowed by the BIOS.
                native  Use native PCIe services associated with PCIe ports
                        unconditionally.
                compat  Treat PCIe ports as PCI-to-PCI bridges, disable the PCIe
                        ports driver.

        pcie\_port\_pm=   {[}PCIE{]} PCIe port power management handling:
                off     Disable power management of all PCIe ports
                force   Forcibly enable power management of all PCIe ports

        pcie\_pme=       {[}PCIE,PM{]} Native PCIe PME signaling options:
                nomsi   Do not use MSI for native PCIe PME signaling (this makes
                        all PCIe root ports use INTx for all services).

        pcmv=           {[}HW,PCMCIA{]} BadgePAD 4

        pd\_ignore\_unused
                        {[}PM{]}
                        Keep all power-domains already enabled by bootloader on,
                        even if no driver has claimed them. This is useful
                        for debug and development, but should not be
                        needed on a platform with proper driver support.

        pd.             {[}PARIDE{]}
                        See Documentation/blockdev/paride.txt.

        pdcchassis=     {[}PARISC,HW{]} Disable/Enable PDC Chassis Status codes at
                        boot time.
                        Format: \{ 0 \textbar{} 1 \}
                        See arch/parisc/kernel/pdc\_chassis.c

        percpu\_alloc=   Select which percpu first chunk allocator to use.
                        Currently supported values are ``embed'' and ``page''.
                        Archs may support subset or none of the selections.
                        See comments in mm/percpu.c for details on each
                        allocator.  This parameter is primarily for debugging
                        and performance comparison.

        pf.             {[}PARIDE{]}
                        See Documentation/blockdev/paride.txt.

        pg.             {[}PARIDE{]}
                        See Documentation/blockdev/paride.txt.

        pirq=           {[}SMP,APIC{]} Manual mp-table setup
                        See Documentation/x86/i386/IO-APIC.txt.

        plip=           {[}PPT,NET{]} Parallel port network link
                        Format: \{ parport\textless{}nr\textgreater{} \textbar{} timid \textbar{} 0 \}
                        See also Documentation/admin-guide/parport.rst.

        pmtmr=          {[}X86{]} Manual setup of pmtmr I/O Port.
                        Override pmtimer IOPort with a hex value.
                        e.g. pmtmr=0x508

        pnp.debug=1     {[}PNP{]}
                        Enable PNP debug messages (depends on the
                        CONFIG\_PNP\_DEBUG\_MESSAGES option).  Change at run-time
                        via /sys/module/pnp/parameters/debug.  We always show
                        current resource usage; turning this on also shows
                        possible settings and some assignment information.

        pnpacpi=        {[}ACPI{]}
                        \{ off \}

        pnpbios=        {[}ISAPNP{]}
                        \{ on \textbar{} off \textbar{} curr \textbar{} res \textbar{} no-curr \textbar{} no-res \}

        pnp\_reserve\_irq=
                        {[}ISAPNP{]} Exclude IRQs for the autoconfiguration

        pnp\_reserve\_dma=
                        {[}ISAPNP{]} Exclude DMAs for the autoconfiguration

        pnp\_reserve\_io= {[}ISAPNP{]} Exclude I/O ports for the autoconfiguration
                        Ranges are in pairs (I/O port base and size).

        pnp\_reserve\_mem=
                        {[}ISAPNP{]} Exclude memory regions for the
                        autoconfiguration.
                        Ranges are in pairs (memory base and size).

        ports=          {[}IP\_VS\_FTP{]} IPVS ftp helper module
                        Default is 21.
                        Up to 8 (IP\_VS\_APP\_MAX\_PORTS) ports
                        may be specified.
                        Format: \textless{}port\textgreater{},\textless{}port\textgreater{}....

        powersave=off   {[}PPC{]} This option disables power saving features.
                        It specifically disables cpuidle and sets the
                        platform machine description specific power\_save
                        function to NULL. On Idle the CPU just reduces
                        execution priority.

        ppc\_strict\_facility\_enable
                        {[}PPC{]} This option catches any kernel floating point,
                        Altivec, VSX and SPE outside of regions specifically
                        allowed (eg kernel\_enable\_fpu()/kernel\_disable\_fpu()).
                        There is some performance impact when enabling this.

        ppc\_tm=         {[}PPC{]}
                        Format: \{``off''\}
                        Disable Hardware Transactional Memory

        print-fatal-signals=
                        {[}KNL{]} debug: print fatal signals

                        If enabled, warn about various signal handling
                        related application anomalies: too many signals,
                        too many POSIX.1 timers, fatal signals causing a
                        coredump - etc.

                        If you hit the warning due to signal overflow,
                        you might want to try ``ulimit -i unlimited''.

                        default: off.

        printk.always\_kmsg\_dump=
                        Trigger kmsg\_dump for cases other than kernel oops or
                        panics
                        Format: \textless{}bool\textgreater{}  (1/Y/y=enable, 0/N/n=disable)
                        default: disabled

        printk.devkmsg=\{on,off,ratelimit\}
                        Control writing to /dev/kmsg.
                        on - unlimited logging to /dev/kmsg from userspace
                        off - logging to /dev/kmsg disabled
                        ratelimit - ratelimit the logging
                        Default: ratelimit

        printk.time=    Show timing data prefixed to each printk message line
                        Format: \textless{}bool\textgreater{}  (1/Y/y=enable, 0/N/n=disable)

        processor.max\_cstate=   {[}HW,ACPI{]}
                        Limit processor to maximum C-state
                        max\_cstate=9 overrides any DMI blacklist limit.

        processor.nocst {[}HW,ACPI{]}
                        Ignore the \_CST method to determine C-states,
                        instead using the legacy FADT method

        profile=        {[}KNL{]} Enable kernel profiling via /proc/profile
                        Format: {[}\textless{}profiletype\textgreater{},{]}\textless{}number\textgreater{}
                        Param: \textless{}profiletype\textgreater{}: ``schedule'', ``sleep'', or ``kvm''
                                {[}defaults to kernel profiling{]}
                        Param: ``schedule'' - profile schedule points.
                        Param: ``sleep'' - profile D-state sleeping (millisecs).
                                Requires CONFIG\_SCHEDSTATS
                        Param: ``kvm'' - profile VM exits.
                        Param: \textless{}number\textgreater{} - step/bucket size as a power of 2 for
                                statistical time based profiling.

        prompt\_ramdisk= {[}RAM{]} List of RAM disks to prompt for floppy disk
                        before loading.
                        See Documentation/blockdev/ramdisk.txt.

        psmouse.proto=  {[}HW,MOUSE{]} Highest PS2 mouse protocol extension to
                        probe for; one of (bare\textbar{}imps\textbar{}exps\textbar{}lifebook\textbar{}any).
        psmouse.rate=   {[}HW,MOUSE{]} Set desired mouse report rate, in reports
                        per second.
        psmouse.resetafter=     {[}HW,MOUSE{]}
                        Try to reset the device after so many bad packets
                        (0 = never).
        psmouse.resolution=
                        {[}HW,MOUSE{]} Set desired mouse resolution, in dpi.
        psmouse.smartscroll=
                        {[}HW,MOUSE{]} Controls Logitech smartscroll autorepeat.
                        0 = disabled, 1 = enabled (default).

        pstore.backend= Specify the name of the pstore backend to use

        pt.             {[}PARIDE{]}
                        See Documentation/blockdev/paride.txt.

        pti=            {[}X86\_64{]} Control Page Table Isolation of user and
                        kernel address spaces.  Disabling this feature
                        removes hardening, but improves performance of
                        system calls and interrupts.

                        on   - unconditionally enable
                        off  - unconditionally disable
                        auto - kernel detects whether your CPU model is
                               vulnerable to issues that PTI mitigates

                        Not specifying this option is equivalent to pti=auto.

        nopti           {[}X86\_64{]}
                        Equivalent to pti=off

        pty.legacy\_count=
                        {[}KNL{]} Number of legacy pty's. Overwrites compiled-in
                        default number.

        quiet           {[}KNL{]} Disable most log messages

        r128=           {[}HW,DRM{]}

        raid=           {[}HW,RAID{]}
                        See Documentation/admin-guide/md.rst.

        ramdisk\_size=   {[}RAM{]} Sizes of RAM disks in kilobytes
                        See Documentation/blockdev/ramdisk.txt.

        ras=option{[},option,...{]} {[}KNL{]} RAS-specific options

                cec\_disable     {[}X86{]}
                                Disable the Correctable Errors Collector,
                                see CONFIG\_RAS\_CEC help text.

        rcu\_nocbs=      {[}KNL{]}
                        The argument is a cpu list, as described above.

                        In kernels built with CONFIG\_RCU\_NOCB\_CPU=y, set
                        the specified list of CPUs to be no-callback CPUs.
                        Invocation of these CPUs' RCU callbacks will
                        be offloaded to ``rcuox/N'' kthreads created for
                        that purpose, where ``x'' is ``b'' for RCU-bh, ``p''
                        for RCU-preempt, and ``s'' for RCU-sched, and ``N''
                        is the CPU number.  This reduces OS jitter on the
                        offloaded CPUs, which can be useful for HPC and
                        real-time workloads.  It can also improve energy
                        efficiency for asymmetric multiprocessors.

        rcu\_nocb\_poll   {[}KNL{]}
                        Rather than requiring that offloaded CPUs
                        (specified by rcu\_nocbs= above) explicitly
                        awaken the corresponding ``rcuoN'' kthreads,
                        make these kthreads poll for callbacks.
                        This improves the real-time response for the
                        offloaded CPUs by relieving them of the need to
                        wake up the corresponding kthread, but degrades
                        energy efficiency by requiring that the kthreads
                        periodically wake up to do the polling.

        rcutree.blimit= {[}KNL{]}
                        Set maximum number of finished RCU callbacks to
                        process in one batch.

        rcutree.dump\_tree=      {[}KNL{]}
                        Dump the structure of the rcu\_node combining tree
                        out at early boot.  This is used for diagnostic
                        purposes, to verify correct tree setup.

        rcutree.gp\_cleanup\_delay=       {[}KNL{]}
                        Set the number of jiffies to delay each step of
                        RCU grace-period cleanup.

        rcutree.gp\_init\_delay=  {[}KNL{]}
                        Set the number of jiffies to delay each step of
                        RCU grace-period initialization.

        rcutree.gp\_preinit\_delay=       {[}KNL{]}
                        Set the number of jiffies to delay each step of
                        RCU grace-period pre-initialization, that is,
                        the propagation of recent CPU-hotplug changes up
                        the rcu\_node combining tree.

        rcutree.rcu\_fanout\_exact= {[}KNL{]}
                        Disable autobalancing of the rcu\_node combining
                        tree.  This is used by rcutorture, and might
                        possibly be useful for architectures having high
                        cache-to-cache transfer latencies.

        rcutree.rcu\_fanout\_leaf= {[}KNL{]}
                        Change the number of CPUs assigned to each
                        leaf rcu\_node structure.  Useful for very
                        large systems, which will choose the value 64,
                        and for NUMA systems with large remote-access
                        latencies, which will choose a value aligned
                        with the appropriate hardware boundaries.

        rcutree.jiffies\_till\_sched\_qs= {[}KNL{]}
                        Set required age in jiffies for a
                        given grace period before RCU starts
                        soliciting quiescent-state help from
                        rcu\_note\_context\_switch().

        rcutree.jiffies\_till\_first\_fqs= {[}KNL{]}
                        Set delay from grace-period initialization to
                        first attempt to force quiescent states.
                        Units are jiffies, minimum value is zero,
                        and maximum value is HZ.

        rcutree.jiffies\_till\_next\_fqs= {[}KNL{]}
                        Set delay between subsequent attempts to force
                        quiescent states.  Units are jiffies, minimum
                        value is one, and maximum value is HZ.

        rcutree.kthread\_prio=    {[}KNL,BOOT{]}
                        Set the SCHED\_FIFO priority of the RCU per-CPU
                        kthreads (rcuc/N). This value is also used for
                        the priority of the RCU boost threads (rcub/N)
                        and for the RCU grace-period kthreads (rcu\_bh,
                        rcu\_preempt, and rcu\_sched). If RCU\_BOOST is
                        set, valid values are 1-99 and the default is 1
                        (the least-favored priority).  Otherwise, when
                        RCU\_BOOST is not set, valid values are 0-99 and
                        the default is zero (non-realtime operation).

        rcutree.rcu\_nocb\_leader\_stride= {[}KNL{]}
                        Set the number of NOCB kthread groups, which
                        defaults to the square root of the number of
                        CPUs.  Larger numbers reduces the wakeup overhead
                        on the per-CPU grace-period kthreads, but increases
                        that same overhead on each group's leader.

        rcutree.qhimark= {[}KNL{]}
                        Set threshold of queued RCU callbacks beyond which
                        batch limiting is disabled.

        rcutree.qlowmark= {[}KNL{]}
                        Set threshold of queued RCU callbacks below which
                        batch limiting is re-enabled.

        rcutree.rcu\_idle\_gp\_delay= {[}KNL{]}
                        Set wakeup interval for idle CPUs that have
                        RCU callbacks (RCU\_FAST\_NO\_HZ=y).

        rcutree.rcu\_idle\_lazy\_gp\_delay= {[}KNL{]}
                        Set wakeup interval for idle CPUs that have
                        only ``lazy'' RCU callbacks (RCU\_FAST\_NO\_HZ=y).
                        Lazy RCU callbacks are those which RCU can
                        prove do nothing more than free memory.

        rcutree.rcu\_kick\_kthreads= {[}KNL{]}
                        Cause the grace-period kthread to get an extra
                        wake\_up() if it sleeps three times longer than
                        it should at force-quiescent-state time.
                        This wake\_up() will be accompanied by a
                        WARN\_ONCE() splat and an ftrace\_dump().

        rcuperf.gp\_async= {[}KNL{]}
                        Measure performance of asynchronous
                        grace-period primitives such as call\_rcu().

        rcuperf.gp\_async\_max= {[}KNL{]}
                        Specify the maximum number of outstanding
                        callbacks per writer thread.  When a writer
                        thread exceeds this limit, it invokes the
                        corresponding flavor of rcu\_barrier() to allow
                        previously posted callbacks to drain.

        rcuperf.gp\_exp= {[}KNL{]}
                        Measure performance of expedited synchronous
                        grace-period primitives.

        rcuperf.holdoff= {[}KNL{]}
                        Set test-start holdoff period.  The purpose of
                        this parameter is to delay the start of the
                        test until boot completes in order to avoid
                        interference.

        rcuperf.nreaders= {[}KNL{]}
                        Set number of RCU readers.  The value -1 selects
                        N, where N is the number of CPUs.  A value
                        ``n'' less than -1 selects N-n+1, where N is again
                        the number of CPUs.  For example, -2 selects N
                        (the number of CPUs), -3 selects N+1, and so on.
                        A value of ``n'' less than or equal to -N selects
                        a single reader.

        rcuperf.nwriters= {[}KNL{]}
                        Set number of RCU writers.  The values operate
                        the same as for rcuperf.nreaders.
                        N, where N is the number of CPUs

        rcuperf.perf\_type= {[}KNL{]}
                        Specify the RCU implementation to test.

        rcuperf.shutdown= {[}KNL{]}
                        Shut the system down after performance tests
                        complete.  This is useful for hands-off automated
                        testing.

        rcuperf.verbose= {[}KNL{]}
                        Enable additional printk() statements.

        rcuperf.writer\_holdoff= {[}KNL{]}
                        Write-side holdoff between grace periods,
                        in microseconds.  The default of zero says
                        no holdoff.

        rcutorture.cbflood\_inter\_holdoff= {[}KNL{]}
                        Set holdoff time (jiffies) between successive
                        callback-flood tests.

        rcutorture.cbflood\_intra\_holdoff= {[}KNL{]}
                        Set holdoff time (jiffies) between successive
                        bursts of callbacks within a given callback-flood
                        test.

        rcutorture.cbflood\_n\_burst= {[}KNL{]}
                        Set the number of bursts making up a given
                        callback-flood test.  Set this to zero to
                        disable callback-flood testing.

        rcutorture.cbflood\_n\_per\_burst= {[}KNL{]}
                        Set the number of callbacks to be registered
                        in a given burst of a callback-flood test.

        rcutorture.fqs\_duration= {[}KNL{]}
                        Set duration of force\_quiescent\_state bursts
                        in microseconds.

        rcutorture.fqs\_holdoff= {[}KNL{]}
                        Set holdoff time within force\_quiescent\_state bursts
                        in microseconds.

        rcutorture.fqs\_stutter= {[}KNL{]}
                        Set wait time between force\_quiescent\_state bursts
                        in seconds.

        rcutorture.gp\_cond= {[}KNL{]}
                        Use conditional/asynchronous update-side
                        primitives, if available.

        rcutorture.gp\_exp= {[}KNL{]}
                        Use expedited update-side primitives, if available.

        rcutorture.gp\_normal= {[}KNL{]}
                        Use normal (non-expedited) asynchronous
                        update-side primitives, if available.

        rcutorture.gp\_sync= {[}KNL{]}
                        Use normal (non-expedited) synchronous
                        update-side primitives, if available.  If all
                        of rcutorture.gp\_cond=, rcutorture.gp\_exp=,
                        rcutorture.gp\_normal=, and rcutorture.gp\_sync=
                        are zero, rcutorture acts as if is interpreted
                        they are all non-zero.

        rcutorture.n\_barrier\_cbs= {[}KNL{]}
                        Set callbacks/threads for rcu\_barrier() testing.

        rcutorture.nfakewriters= {[}KNL{]}
                        Set number of concurrent RCU writers.  These just
                        stress RCU, they don't participate in the actual
                        test, hence the ``fake''.

        rcutorture.nreaders= {[}KNL{]}
                        Set number of RCU readers.  The value -1 selects
                        N-1, where N is the number of CPUs.  A value
                        ``n'' less than -1 selects N-n-2, where N is again
                        the number of CPUs.  For example, -2 selects N
                        (the number of CPUs), -3 selects N+1, and so on.

        rcutorture.object\_debug= {[}KNL{]}
                        Enable debug-object double-call\_rcu() testing.

        rcutorture.onoff\_holdoff= {[}KNL{]}
                        Set time (s) after boot for CPU-hotplug testing.

        rcutorture.onoff\_interval= {[}KNL{]}
                        Set time (s) between CPU-hotplug operations, or
                        zero to disable CPU-hotplug testing.

        rcutorture.shuffle\_interval= {[}KNL{]}
                        Set task-shuffle interval (s).  Shuffling tasks
                        allows some CPUs to go into dyntick-idle mode
                        during the rcutorture test.

        rcutorture.shutdown\_secs= {[}KNL{]}
                        Set time (s) after boot system shutdown.  This
                        is useful for hands-off automated testing.

        rcutorture.stall\_cpu= {[}KNL{]}
                        Duration of CPU stall (s) to test RCU CPU stall
                        warnings, zero to disable.

        rcutorture.stall\_cpu\_holdoff= {[}KNL{]}
                        Time to wait (s) after boot before inducing stall.

        rcutorture.stall\_cpu\_irqsoff= {[}KNL{]}
                        Disable interrupts while stalling if set.

        rcutorture.stat\_interval= {[}KNL{]}
                        Time (s) between statistics printk()s.

        rcutorture.stutter= {[}KNL{]}
                        Time (s) to stutter testing, for example, specifying
                        five seconds causes the test to run for five seconds,
                        wait for five seconds, and so on.  This tests RCU's
                        ability to transition abruptly to and from idle.

        rcutorture.test\_boost= {[}KNL{]}
                        Test RCU priority boosting?  0=no, 1=maybe, 2=yes.
                        ``Maybe'' means test if the RCU implementation
                        under test support RCU priority boosting.

        rcutorture.test\_boost\_duration= {[}KNL{]}
                        Duration (s) of each individual boost test.

        rcutorture.test\_boost\_interval= {[}KNL{]}
                        Interval (s) between each boost test.

        rcutorture.test\_no\_idle\_hz= {[}KNL{]}
                        Test RCU's dyntick-idle handling.  See also the
                        rcutorture.shuffle\_interval parameter.

        rcutorture.torture\_type= {[}KNL{]}
                        Specify the RCU implementation to test.

        rcutorture.verbose= {[}KNL{]}
                        Enable additional printk() statements.

        rcupdate.rcu\_cpu\_stall\_suppress= {[}KNL{]}
                        Suppress RCU CPU stall warning messages.

        rcupdate.rcu\_cpu\_stall\_timeout= {[}KNL{]}
                        Set timeout for RCU CPU stall warning messages.

        rcupdate.rcu\_expedited= {[}KNL{]}
                        Use expedited grace-period primitives, for
                        example, synchronize\_rcu\_expedited() instead
                        of synchronize\_rcu().  This reduces latency,
                        but can increase CPU utilization, degrade
                        real-time latency, and degrade energy efficiency.
                        No effect on CONFIG\_TINY\_RCU kernels.

        rcupdate.rcu\_normal= {[}KNL{]}
                        Use only normal grace-period primitives,
                        for example, synchronize\_rcu() instead of
                        synchronize\_rcu\_expedited().  This improves
                        real-time latency, CPU utilization, and
                        energy efficiency, but can expose users to
                        increased grace-period latency.  This parameter
                        overrides rcupdate.rcu\_expedited.  No effect on
                        CONFIG\_TINY\_RCU kernels.

        rcupdate.rcu\_normal\_after\_boot= {[}KNL{]}
                        Once boot has completed (that is, after
                        rcu\_end\_inkernel\_boot() has been invoked), use
                        only normal grace-period primitives.  No effect
                        on CONFIG\_TINY\_RCU kernels.

        rcupdate.rcu\_task\_stall\_timeout= {[}KNL{]}
                        Set timeout in jiffies for RCU task stall warning
                        messages.  Disable with a value less than or equal
                        to zero.

        rcupdate.rcu\_self\_test= {[}KNL{]}
                        Run the RCU early boot self tests

        rcupdate.rcu\_self\_test\_bh= {[}KNL{]}
                        Run the RCU bh early boot self tests

        rcupdate.rcu\_self\_test\_sched= {[}KNL{]}
                        Run the RCU sched early boot self tests

        rdinit=         {[}KNL{]}
                        Format: \textless{}full\_path\textgreater{}
                        Run specified binary instead of /init from the ramdisk,
                        used for early userspace startup. See initrd.

        rdt=            {[}HW,X86,RDT{]}
                        Turn on/off individual RDT features. List is:
                        cmt, mbmtotal, mbmlocal, l3cat, l3cdp, l2cat, l2cdp,
                        mba.
                        E.g. to turn on cmt and turn off mba use:
                                rdt=cmt,!mba

        reboot=         {[}KNL{]}
                        Format (x86 or x86\_64):
                                {[}w{[}arm{]} \textbar{} c{[}old{]} \textbar{} h{[}ard{]} \textbar{} s{[}oft{]} \textbar{} g{[}pio{]}{]} \textbackslash{}
                                {[}{[},{]}s{[}mp{]}\#\#\#\# \textbackslash{}
                                {[}{[},{]}b{[}ios{]} \textbar{} a{[}cpi{]} \textbar{} k{[}bd{]} \textbar{} t{[}riple{]} \textbar{} e{[}fi{]} \textbar{} p{[}ci{]}{]} \textbackslash{}
                                {[}{[},{]}f{[}orce{]}
                        Where reboot\_mode is one of warm (soft) or cold (hard) or gpio,
                              reboot\_type is one of bios, acpi, kbd, triple, efi, or pci,
                              reboot\_force is either force or not specified,
                              reboot\_cpu is s{[}mp{]}\#\#\#\# with \#\#\#\# being the processor
                                        to be used for rebooting.

        relax\_domain\_level=
                        {[}KNL, SMP{]} Set scheduler's default relax\_domain\_level.
                        See Documentation/cgroup-v1/cpusets.txt.

        reserve=        {[}KNL,BUGS{]} Force kernel to ignore I/O ports or memory
                        Format: \textless{}base1\textgreater{},\textless{}size1\textgreater{}{[},\textless{}base2\textgreater{},\textless{}size2\textgreater{},...{]}
                        Reserve I/O ports or memory so the kernel won't use
                        them.  If \textless{}base\textgreater{} is less than 0x10000, the region
                        is assumed to be I/O ports; otherwise it is memory.

        reservetop=     {[}X86-32{]}
                        Format: nn{[}KMG{]}
                        Reserves a hole at the top of the kernel virtual
                        address space.

        reservelow=     {[}X86{]}
                        Format: nn{[}K{]}
                        Set the amount of memory to reserve for BIOS at
                        the bottom of the address space.

        reset\_devices   {[}KNL{]} Force drivers to reset the underlying device
                        during initialization.

        resume=         {[}SWSUSP{]}
                        Specify the partition device for software suspend
                        Format:
                        \{/dev/\textless{}dev\textgreater{} \textbar{} PARTUUID=\textless{}uuid\textgreater{} \textbar{} \textless{}int\textgreater{}:\textless{}int\textgreater{} \textbar{} \textless{}hex\textgreater{}\}

        resume\_offset=  {[}SWSUSP{]}
                        Specify the offset from the beginning of the partition
                        given by ``resume='' at which the swap header is located,
                        in \textless{}PAGE\_SIZE\textgreater{} units (needed only for swap files).
                        See  Documentation/power/swsusp-and-swap-files.txt

        resumedelay=    {[}HIBERNATION{]} Delay (in seconds) to pause before attempting to
                        read the resume files

        resumewait      {[}HIBERNATION{]} Wait (indefinitely) for resume device to show up.
                        Useful for devices that are detected asynchronously
                        (e.g. USB and MMC devices).

        hibernate=      {[}HIBERNATION{]}
                noresume        Don't check if there's a hibernation image
                                present during boot.
                nocompress      Don't compress/decompress hibernation images.
                no              Disable hibernation and resume.
                protect\_image   Turn on image protection during restoration
                                (that will set all pages holding image data
                                during restoration read-only).

        retain\_initrd   {[}RAM{]} Keep initrd memory after extraction

        rfkill.default\_state=
                0       ``airplane mode''.  All wifi, bluetooth, wimax, gps, fm,
                        etc. communication is blocked by default.
                1       Unblocked.

        rfkill.master\_switch\_mode=
                0       The ``airplane mode'' button does nothing.
                1       The ``airplane mode'' button toggles between everything
                        blocked and the previous configuration.
                2       The ``airplane mode'' button toggles between everything
                        blocked and everything unblocked.

        rhash\_entries=  {[}KNL,NET{]}
                        Set number of hash buckets for route cache

        ring3mwait=disable
                        {[}KNL{]} Disable ring 3 MONITOR/MWAIT feature on supported
                        CPUs.

        ro              {[}KNL{]} Mount root device read-only on boot

        rodata=         {[}KNL{]}
                on      Mark read-only kernel memory as read-only (default).
                off     Leave read-only kernel memory writable for debugging.

        rockchip.usb\_uart
                        Enable the uart passthrough on the designated usb port
                        on Rockchip SoCs. When active, the signals of the
                        debug-uart get routed to the D+ and D- pins of the usb
                        port and the regular usb controller gets disabled.

        root=           {[}KNL{]} Root filesystem
                        See name\_to\_dev\_t comment in init/do\_mounts.c.

        rootdelay=      {[}KNL{]} Delay (in seconds) to pause before attempting to
                        mount the root filesystem

        rootflags=      {[}KNL{]} Set root filesystem mount option string

        rootfstype=     {[}KNL{]} Set root filesystem type

        rootwait        {[}KNL{]} Wait (indefinitely) for root device to show up.
                        Useful for devices that are detected asynchronously
                        (e.g. USB and MMC devices).

        rproc\_mem=nn{[}KMG{]}{[}@address{]}
                        {[}KNL,ARM,CMA{]} Remoteproc physical memory block.
                        Memory area to be used by remote processor image,
                        managed by CMA.

        rw              {[}KNL{]} Mount root device read-write on boot

        S               {[}KNL{]} Run init in single mode

        s390\_iommu=     {[}HW,S390{]}
                        Set s390 IOTLB flushing mode
                strict
                        With strict flushing every unmap operation will result in
                        an IOTLB flush. Default is lazy flushing before reuse,
                        which is faster.

        sa1100ir        {[}NET{]}
                        See drivers/net/irda/sa1100\_ir.c.

        sbni=           {[}NET{]} Granch SBNI12 leased line adapter

        sched\_debug     {[}KNL{]} Enables verbose scheduler debug messages.

        schedstats=     {[}KNL,X86{]} Enable or disable scheduled statistics.
                        Allowed values are enable and disable. This feature
                        incurs a small amount of overhead in the scheduler
                        but is useful for debugging and performance tuning.

        skew\_tick=      {[}KNL{]} Offset the periodic timer tick per cpu to mitigate
                        xtime\_lock contention on larger systems, and/or RCU lock
                        contention on all systems with CONFIG\_MAXSMP set.
                        Format: \{ ``0'' \textbar{} ``1'' \}
                        0 -- disable. (may be 1 via CONFIG\_CMDLINE=''skew\_tick=1''
                        1 -- enable.
                        Note: increases power consumption, thus should only be
                        enabled if running jitter sensitive (HPC/RT) workloads.

        security=       {[}SECURITY{]} Choose a security module to enable at boot.
                        If this boot parameter is not specified, only the first
                        security module asking for security registration will be
                        loaded. An invalid security module name will be treated
                        as if no module has been chosen.

        selinux=        {[}SELINUX{]} Disable or enable SELinux at boot time.
                        Format: \{ ``0'' \textbar{} ``1'' \}
                        See security/selinux/Kconfig help text.
                        0 -- disable.
                        1 -- enable.
                        Default value is set via kernel config option.
                        If enabled at boot time, /selinux/disable can be used
                        later to disable prior to initial policy load.

        apparmor=       {[}APPARMOR{]} Disable or enable AppArmor at boot time
                        Format: \{ ``0'' \textbar{} ``1'' \}
                        See security/apparmor/Kconfig help text
                        0 -- disable.
                        1 -- enable.
                        Default value is set via kernel config option.

        serialnumber    {[}BUGS=X86-32{]}

        shapers=        {[}NET{]}
                        Maximal number of shapers.

        simeth=         {[}IA-64{]}
        simscsi=

        slram=          {[}HW,MTD{]}

        slab\_nomerge    {[}MM{]}
                        Disable merging of slabs with similar size. May be
                        necessary if there is some reason to distinguish
                        allocs to different slabs, especially in hardened
                        environments where the risk of heap overflows and
                        layout control by attackers can usually be
                        frustrated by disabling merging. This will reduce
                        most of the exposure of a heap attack to a single
                        cache (risks via metadata attacks are mostly
                        unchanged). Debug options disable merging on their
                        own.
                        For more information see Documentation/vm/slub.txt.

        slab\_max\_order= {[}MM, SLAB{]}
                        Determines the maximum allowed order for slabs.
                        A high setting may cause OOMs due to memory
                        fragmentation.  Defaults to 1 for systems with
                        more than 32MB of RAM, 0 otherwise.

        slub\_debug{[}=options{[},slabs{]}{]}    {[}MM, SLUB{]}
                        Enabling slub\_debug allows one to determine the
                        culprit if slab objects become corrupted. Enabling
                        slub\_debug can create guard zones around objects and
                        may poison objects when not in use. Also tracks the
                        last alloc / free. For more information see
                        Documentation/vm/slub.txt.

        slub\_memcg\_sysfs=       {[}MM, SLUB{]}
                        Determines whether to enable sysfs directories for
                        memory cgroup sub-caches. 1 to enable, 0 to disable.
                        The default is determined by CONFIG\_SLUB\_MEMCG\_SYSFS\_ON.
                        Enabling this can lead to a very high number of debug
                        directories and files being created under
                        /sys/kernel/slub.

        slub\_max\_order= {[}MM, SLUB{]}
                        Determines the maximum allowed order for slabs.
                        A high setting may cause OOMs due to memory
                        fragmentation. For more information see
                        Documentation/vm/slub.txt.

        slub\_min\_objects=       {[}MM, SLUB{]}
                        The minimum number of objects per slab. SLUB will
                        increase the slab order up to slub\_max\_order to
                        generate a sufficiently large slab able to contain
                        the number of objects indicated. The higher the number
                        of objects the smaller the overhead of tracking slabs
                        and the less frequently locks need to be acquired.
                        For more information see Documentation/vm/slub.txt.

        slub\_min\_order= {[}MM, SLUB{]}
                        Determines the minimum page order for slabs. Must be
                        lower than slub\_max\_order.
                        For more information see Documentation/vm/slub.txt.

        slub\_nomerge    {[}MM, SLUB{]}
                        Same with slab\_nomerge. This is supported for legacy.
                        See slab\_nomerge for more information.

        smart2=         {[}HW{]}
                        Format: \textless{}io1\textgreater{}{[},\textless{}io2\textgreater{}{[},...,\textless{}io8\textgreater{}{]}{]}

        smsc-ircc2.nopnp        {[}HW{]} Don't use PNP to discover SMC devices
        smsc-ircc2.ircc\_cfg=    {[}HW{]} Device configuration I/O port
        smsc-ircc2.ircc\_sir=    {[}HW{]} SIR base I/O port
        smsc-ircc2.ircc\_fir=    {[}HW{]} FIR base I/O port
        smsc-ircc2.ircc\_irq=    {[}HW{]} IRQ line
        smsc-ircc2.ircc\_dma=    {[}HW{]} DMA channel
        smsc-ircc2.ircc\_transceiver= {[}HW{]} Transceiver type:
                                0: Toshiba Satellite 1800 (GP data pin select)
                                1: Fast pin select (default)
                                2: ATC IRMode

        smt             {[}KNL,S390{]} Set the maximum number of threads (logical
                        CPUs) to use per physical CPU on systems capable of
                        symmetric multithreading (SMT). Will be capped to the
                        actual hardware limit.
                        Format: \textless{}integer\textgreater{}
                        Default: -1 (no limit)

        softlockup\_panic=
                        {[}KNL{]} Should the soft-lockup detector generate panics.
                        Format: \textless{}integer\textgreater{}

                        A nonzero value instructs the soft-lockup detector
                        to panic the machine when a soft-lockup occurs. This
                        is also controlled by CONFIG\_BOOTPARAM\_SOFTLOCKUP\_PANIC
                        which is the respective build-time switch to that
                        functionality.

        softlockup\_all\_cpu\_backtrace=
                        {[}KNL{]} Should the soft-lockup detector generate
                        backtraces on all cpus.
                        Format: \textless{}integer\textgreater{}

        sonypi.*=       {[}HW{]} Sony Programmable I/O Control Device driver
                        See Documentation/laptops/sonypi.txt

        spectre\_v2=     {[}X86{]} Control mitigation of Spectre variant 2
                        (indirect branch speculation) vulnerability.

                        on   - unconditionally enable
                        off  - unconditionally disable
                        auto - kernel detects whether your CPU model is
                               vulnerable

                        Selecting `on' will, and `auto' may, choose a
                        mitigation method at run time according to the
                        CPU, the available microcode, the setting of the
                        CONFIG\_RETPOLINE configuration option, and the
                        compiler with which the kernel was built.

                        Specific mitigations can also be selected manually:

                        retpoline         - replace indirect branches
                        retpoline,generic - google's original retpoline
                        retpoline,amd     - AMD-specific minimal thunk

                        Not specifying this option is equivalent to
                        spectre\_v2=auto.

        spia\_io\_base=   {[}HW,MTD{]}
        spia\_fio\_base=
        spia\_pedr=
        spia\_peddr=

        srcutree.counter\_wrap\_check {[}KNL{]}
                        Specifies how frequently to check for
                        grace-period sequence counter wrap for the
                        srcu\_data structure's -\textgreater{}srcu\_gp\_seq\_needed field.
                        The greater the number of bits set in this kernel
                        parameter, the less frequently counter wrap will
                        be checked for.  Note that the bottom two bits
                        are ignored.

        srcutree.exp\_holdoff {[}KNL{]}
                        Specifies how many nanoseconds must elapse
                        since the end of the last SRCU grace period for
                        a given srcu\_struct until the next normal SRCU
                        grace period will be considered for automatic
                        expediting.  Set to zero to disable automatic
                        expediting.

        stack\_guard\_gap=        {[}MM{]}
                        override the default stack gap protection. The value
                        is in page units and it defines how many pages prior
                        to (for stacks growing down) resp. after (for stacks
                        growing up) the main stack are reserved for no other
                        mapping. Default value is 256 pages.

        stacktrace      {[}FTRACE{]}
                        Enabled the stack tracer on boot up.

        stacktrace\_filter={[}function-list{]}
                        {[}FTRACE{]} Limit the functions that the stack tracer
                        will trace at boot up. function-list is a comma separated
                        list of functions. This list can be changed at run
                        time by the stack\_trace\_filter file in the debugfs
                        tracing directory. Note, this enables stack tracing
                        and the stacktrace above is not needed.

        sti=            {[}PARISC,HW{]}
                        Format: \textless{}num\textgreater{}
                        Set the STI (builtin display/keyboard on the HP-PARISC
                        machines) console (graphic card) which should be used
                        as the initial boot-console.
                        See also comment in drivers/video/console/sticore.c.

        sti\_font=       {[}HW{]}
                        See comment in drivers/video/console/sticore.c.

        stifb=          {[}HW{]}
                        Format: bpp:\textless{}bpp1\textgreater{}{[}:\textless{}bpp2\textgreater{}{[}:\textless{}bpp3\textgreater{}...{]}{]}

        sunrpc.min\_resvport=
        sunrpc.max\_resvport=
                        {[}NFS,SUNRPC{]}
                        SunRPC servers often require that client requests
                        originate from a privileged port (i.e. a port in the
                        range 0 \textless{} portnr \textless{} 1024).
                        An administrator who wishes to reserve some of these
                        ports for other uses may adjust the range that the
                        kernel's sunrpc client considers to be privileged
                        using these two parameters to set the minimum and
                        maximum port values.

        sunrpc.svc\_rpc\_per\_connection\_limit=
                        {[}NFS,SUNRPC{]}
                        Limit the number of requests that the server will
                        process in parallel from a single connection.
                        The default value is 0 (no limit).

        sunrpc.pool\_mode=
                        {[}NFS{]}
                        Control how the NFS server code allocates CPUs to
                        service thread pools.  Depending on how many NICs
                        you have and where their interrupts are bound, this
                        option will affect which CPUs will do NFS serving.
                        Note: this parameter cannot be changed while the
                        NFS server is running.

                        auto        the server chooses an appropriate mode
                                    automatically using heuristics
                        global      a single global pool contains all CPUs
                        percpu      one pool for each CPU
                        pernode     one pool for each NUMA node (equivalent
                                    to global on non-NUMA machines)

        sunrpc.tcp\_slot\_table\_entries=
        sunrpc.udp\_slot\_table\_entries=
                        {[}NFS,SUNRPC{]}
                        Sets the upper limit on the number of simultaneous
                        RPC calls that can be sent from the client to a
                        server. Increasing these values may allow you to
                        improve throughput, but will also increase the
                        amount of memory reserved for use by the client.

        suspend.pm\_test\_delay=
                        {[}SUSPEND{]}
                        Sets the number of seconds to remain in a suspend test
                        mode before resuming the system (see
                        /sys/power/pm\_test). Only available when CONFIG\_PM\_DEBUG
                        is set. Default value is 5.

        swapaccount={[}0\textbar{}1{]}
                        {[}KNL{]} Enable accounting of swap in memory resource
                        controller if no parameter or 1 is given or disable
                        it if 0 is given (See Documentation/cgroup-v1/memory.txt)

        swiotlb=        {[}ARM,IA-64,PPC,MIPS,X86{]}
                        Format: \{ \textless{}int\textgreater{} \textbar{} force \textbar{} noforce \}
                        \textless{}int\textgreater{} -- Number of I/O TLB slabs
                        force -- force using of bounce buffers even if they
                                 wouldn't be automatically used by the kernel
                        noforce -- Never use bounce buffers (for debugging)

        switches=       {[}HW,M68k{]}

        sysfs.deprecated=0\textbar{}1 {[}KNL{]}
                        Enable/disable old style sysfs layout for old udev
                        on older distributions. When this option is enabled
                        very new udev will not work anymore. When this option
                        is disabled (or CONFIG\_SYSFS\_DEPRECATED not compiled)
                        in older udev will not work anymore.
                        Default depends on CONFIG\_SYSFS\_DEPRECATED\_V2 set in
                        the kernel configuration.

        sysrq\_always\_enabled
                        {[}KNL{]}
                        Ignore sysrq setting - this boot parameter will
                        neutralize any effect of /proc/sys/kernel/sysrq.
                        Useful for debugging.

        tcpmhash\_entries= {[}KNL,NET{]}
                        Set the number of tcp\_metrics\_hash slots.
                        Default value is 8192 or 16384 depending on total
                        ram pages. This is used to specify the TCP metrics
                        cache size. See Documentation/networking/ip-sysctl.txt
                        ``tcp\_no\_metrics\_save'' section for more details.

        tdfx=           {[}HW,DRM{]}

        test\_suspend=   {[}SUSPEND{]}{[},N{]}
                        Specify ``mem'' (for Suspend-to-RAM) or ``standby'' (for
                        standby suspend) or ``freeze'' (for suspend type freeze)
                        as the system sleep state during system startup with
                        the optional capability to repeat N number of times.
                        The system is woken from this state using a
                        wakeup-capable RTC alarm.

        thash\_entries=  {[}KNL,NET{]}
                        Set number of hash buckets for TCP connection

        thermal.act=    {[}HW,ACPI{]}
                        -1: disable all active trip points in all thermal zones
                        \textless{}degrees C\textgreater{}: override all lowest active trip points

        thermal.crt=    {[}HW,ACPI{]}
                        -1: disable all critical trip points in all thermal zones
                        \textless{}degrees C\textgreater{}: override all critical trip points

        thermal.nocrt=  {[}HW,ACPI{]}
                        Set to disable actions on ACPI thermal zone
                        critical and hot trip points.

        thermal.off=    {[}HW,ACPI{]}
                        1: disable ACPI thermal control

        thermal.psv=    {[}HW,ACPI{]}
                        -1: disable all passive trip points
                        \textless{}degrees C\textgreater{}: override all passive trip points to this
                        value

        thermal.tzp=    {[}HW,ACPI{]}
                        Specify global default ACPI thermal zone polling rate
                        \textless{}deci-seconds\textgreater{}: poll all this frequency
                        0: no polling (default)

        threadirqs      {[}KNL{]}
                        Force threading of all interrupt handlers except those
                        marked explicitly IRQF\_NO\_THREAD.

        tmem            {[}KNL,XEN{]}
                        Enable the Transcendent memory driver if built-in.

        tmem.cleancache=0\textbar{}1 {[}KNL, XEN{]}
                        Default is on (1). Disable the usage of the cleancache
                        API to send anonymous pages to the hypervisor.

        tmem.frontswap=0\textbar{}1 {[}KNL, XEN{]}
                        Default is on (1). Disable the usage of the frontswap
                        API to send swap pages to the hypervisor. If disabled
                        the selfballooning and selfshrinking are force disabled.

        tmem.selfballooning=0\textbar{}1 {[}KNL, XEN{]}
                        Default is on (1). Disable the driving of swap pages
                        to the hypervisor.

        tmem.selfshrinking=0\textbar{}1 {[}KNL, XEN{]}
                        Default is on (1). Partial swapoff that immediately
                        transfers pages from Xen hypervisor back to the
                        kernel based on different criteria.

        topology=       {[}S390{]}
                        Format: \{off \textbar{} on\}
                        Specify if the kernel should make use of the cpu
                        topology information if the hardware supports this.
                        The scheduler will make use of this information and
                        e.g. base its process migration decisions on it.
                        Default is on.

        topology\_updates= {[}KNL, PPC, NUMA{]}
                        Format: \{off\}
                        Specify if the kernel should ignore (off)
                        topology updates sent by the hypervisor to this
                        LPAR.

        tp720=          {[}HW,PS2{]}

        tpm\_suspend\_pcr={[}HW,TPM{]}
                        Format: integer pcr id
                        Specify that at suspend time, the tpm driver
                        should extend the specified pcr with zeros,
                        as a workaround for some chips which fail to
                        flush the last written pcr on TPM\_SaveState.
                        This will guarantee that all the other pcrs
                        are saved.

        trace\_buf\_size=nn{[}KMG{]}
                        {[}FTRACE{]} will set tracing buffer size on each cpu.

        trace\_event={[}event-list{]}
                        {[}FTRACE{]} Set and start specified trace events in order
                        to facilitate early boot debugging. The event-list is a
                        comma separated list of trace events to enable. See
                        also Documentation/trace/events.txt

        trace\_options={[}option-list{]}
                        {[}FTRACE{]} Enable or disable tracer options at boot.
                        The option-list is a comma delimited list of options
                        that can be enabled or disabled just as if you were
                        to echo the option name into

                            /sys/kernel/debug/tracing/trace\_options

                        For example, to enable stacktrace option (to dump the
                        stack trace of each event), add to the command line:

                              trace\_options=stacktrace

                        See also Documentation/trace/ftrace.txt ``trace options''
                        section.

        tp\_printk{[}FTRACE{]}
                        Have the tracepoints sent to printk as well as the
                        tracing ring buffer. This is useful for early boot up
                        where the system hangs or reboots and does not give the
                        option for reading the tracing buffer or performing a
                        ftrace\_dump\_on\_oops.

                        To turn off having tracepoints sent to printk,
                         echo 0 \textgreater{} /proc/sys/kernel/tracepoint\_printk
                        Note, echoing 1 into this file without the
                        tracepoint\_printk kernel cmdline option has no effect.

                        ** CAUTION **

                        Having tracepoints sent to printk() and activating high
                        frequency tracepoints such as irq or sched, can cause
                        the system to live lock.

        traceoff\_on\_warning
                        {[}FTRACE{]} enable this option to disable tracing when a
                        warning is hit. This turns off ``tracing\_on''. Tracing can
                        be enabled again by echoing `1' into the ``tracing\_on''
                        file located in /sys/kernel/debug/tracing/

                        This option is useful, as it disables the trace before
                        the WARNING dump is called, which prevents the trace to
                        be filled with content caused by the warning output.

                        This option can also be set at run time via the sysctl
                        option:  kernel/traceoff\_on\_warning

        transparent\_hugepage=
                        {[}KNL{]}
                        Format: {[}always\textbar{}madvise\textbar{}never{]}
                        Can be used to control the default behavior of the system
                        with respect to transparent hugepages.
                        See Documentation/vm/transhuge.txt for more details.

        tsc=            Disable clocksource stability checks for TSC.
                        Format: \textless{}string\textgreater{}
                        {[}x86{]} reliable: mark tsc clocksource as reliable, this
                        disables clocksource verification at runtime, as well
                        as the stability checks done at bootup. Used to enable
                        high-resolution timer mode on older hardware, and in
                        virtualized environment.
                        {[}x86{]} noirqtime: Do not use TSC to do irq accounting.
                        Used to run time disable IRQ\_TIME\_ACCOUNTING on any
                        platforms where RDTSC is slow and this accounting
                        can add overhead.
                        {[}x86{]} unstable: mark the TSC clocksource as unstable, this
                        marks the TSC unconditionally unstable at bootup and
                        avoids any further wobbles once the TSC watchdog notices.

        turbografx.map{[}2\textbar{}3{]}=    {[}HW,JOY{]}
                        TurboGraFX parallel port interface
                        Format:
                        \textless{}port\#\textgreater{},\textless{}js1\textgreater{},\textless{}js2\textgreater{},\textless{}js3\textgreater{},\textless{}js4\textgreater{},\textless{}js5\textgreater{},\textless{}js6\textgreater{},\textless{}js7\textgreater{}
                        See also Documentation/input/devices/joystick-parport.rst

        udbg-immortal   {[}PPC{]} When debugging early kernel crashes that
                        happen after console\_init() and before a proper
                        console driver takes over, this boot options might
                        help ``seeing'' what's going on.

        uhash\_entries=  {[}KNL,NET{]}
                        Set number of hash buckets for UDP/UDP-Lite connections

        uhci-hcd.ignore\_oc=
                        {[}USB{]} Ignore overcurrent events (default N).
                        Some badly-designed motherboards generate lots of
                        bogus events, for ports that aren't wired to
                        anything.  Set this parameter to avoid log spamming.
                        Note that genuine overcurrent events won't be
                        reported either.

        unknown\_nmi\_panic
                        {[}X86{]} Cause panic on unknown NMI.

        usbcore.authorized\_default=
                        {[}USB{]} Default USB device authorization:
                        (default -1 = authorized except for wireless USB,
                        0 = not authorized, 1 = authorized)

        usbcore.autosuspend=
                        {[}USB{]} The autosuspend time delay (in seconds) used
                        for newly-detected USB devices (default 2).  This
                        is the time required before an idle device will be
                        autosuspended.  Devices for which the delay is set
                        to a negative value won't be autosuspended at all.

        usbcore.usbfs\_snoop=
                        {[}USB{]} Set to log all usbfs traffic (default 0 = off).

        usbcore.usbfs\_snoop\_max=
                        {[}USB{]} Maximum number of bytes to snoop in each URB
                        (default = 65536).

        usbcore.blinkenlights=
                        {[}USB{]} Set to cycle leds on hubs (default 0 = off).

        usbcore.old\_scheme\_first=
                        {[}USB{]} Start with the old device initialization
                        scheme (default 0 = off).

        usbcore.usbfs\_memory\_mb=
                        {[}USB{]} Memory limit (in MB) for buffers allocated by
                        usbfs (default = 16, 0 = max = 2047).

        usbcore.use\_both\_schemes=
                        {[}USB{]} Try the other device initialization scheme
                        if the first one fails (default 1 = enabled).

        usbcore.initial\_descriptor\_timeout=
                        {[}USB{]} Specifies timeout for the initial 64-byte
                        USB\_REQ\_GET\_DESCRIPTOR request in milliseconds
                        (default 5000 = 5.0 seconds).

        usbcore.nousb   {[}USB{]} Disable the USB subsystem

        usbhid.mousepoll=
                        {[}USBHID{]} The interval which mice are to be polled at.

        usbhid.jspoll=
                        {[}USBHID{]} The interval which joysticks are to be polled at.

        usb-storage.delay\_use=
                        {[}UMS{]} The delay in seconds before a new device is
                        scanned for Logical Units (default 1).

        usb-storage.quirks=
                        {[}UMS{]} A list of quirks entries to supplement or
                        override the built-in unusual\_devs list.  List
                        entries are separated by commas.  Each entry has
                        the form VID:PID:Flags where VID and PID are Vendor
                        and Product ID values (4-digit hex numbers) and
                        Flags is a set of characters, each corresponding
                        to a common usb-storage quirk flag as follows:
                                a = SANE\_SENSE (collect more than 18 bytes
                                        of sense data);
                                b = BAD\_SENSE (don't collect more than 18
                                        bytes of sense data);
                                c = FIX\_CAPACITY (decrease the reported
                                        device capacity by one sector);
                                d = NO\_READ\_DISC\_INFO (don't use
                                        READ\_DISC\_INFO command);
                                e = NO\_READ\_CAPACITY\_16 (don't use
                                        READ\_CAPACITY\_16 command);
                                f = NO\_REPORT\_OPCODES (don't use report opcodes
                                        command, uas only);
                                g = MAX\_SECTORS\_240 (don't transfer more than
                                        240 sectors at a time, uas only);
                                h = CAPACITY\_HEURISTICS (decrease the
                                        reported device capacity by one
                                        sector if the number is odd);
                                i = IGNORE\_DEVICE (don't bind to this
                                        device);
                                j = NO\_REPORT\_LUNS (don't use report luns
                                        command, uas only);
                                l = NOT\_LOCKABLE (don't try to lock and
                                        unlock ejectable media);
                                m = MAX\_SECTORS\_64 (don't transfer more
                                        than 64 sectors = 32 KB at a time);
                                n = INITIAL\_READ10 (force a retry of the
                                        initial READ(10) command);
                                o = CAPACITY\_OK (accept the capacity
                                        reported by the device);
                                p = WRITE\_CACHE (the device cache is ON
                                        by default);
                                r = IGNORE\_RESIDUE (the device reports
                                        bogus residue values);
                                s = SINGLE\_LUN (the device has only one
                                        Logical Unit);
                                t = NO\_ATA\_1X (don't allow ATA(12) and ATA(16)
                                        commands, uas only);
                                u = IGNORE\_UAS (don't bind to the uas driver);
                                w = NO\_WP\_DETECT (don't test whether the
                                        medium is write-protected).
                                y = ALWAYS\_SYNC (issue a SYNCHRONIZE\_CACHE
                                        even if the device claims no cache)
                        Example: quirks=0419:aaf5:rl,0421:0433:rc

        user\_debug=     {[}KNL,ARM{]}
                        Format: \textless{}int\textgreater{}
                        See arch/arm/Kconfig.debug help text.
                                 1 - undefined instruction events
                                 2 - system calls
                                 4 - invalid data aborts
                                 8 - SIGSEGV faults
                                16 - SIGBUS faults
                        Example: user\_debug=31

        userpte=
                        {[}X86{]} Flags controlling user PTE allocations.

                                nohigh = do not allocate PTE pages in
                                        HIGHMEM regardless of setting
                                        of CONFIG\_HIGHPTE.

        vdso=           {[}X86,SH{]}
                        On X86\_32, this is an alias for vdso32=.  Otherwise:

                        vdso=1: enable VDSO (the default)
                        vdso=0: disable VDSO mapping

        vdso32=         {[}X86{]} Control the 32-bit vDSO
                        vdso32=1: enable 32-bit VDSO
                        vdso32=0 or vdso32=2: disable 32-bit VDSO

                        See the help text for CONFIG\_COMPAT\_VDSO for more
                        details.  If CONFIG\_COMPAT\_VDSO is set, the default is
                        vdso32=0; otherwise, the default is vdso32=1.

                        For compatibility with older kernels, vdso32=2 is an
                        alias for vdso32=0.

                        Try vdso32=0 if you encounter an error that says:
                        dl\_main: Assertion {}`(void *) ph-\textgreater{}p\_vaddr == \_rtld\_local.\_dl\_sysinfo\_dso' failed!

        vector=         {[}IA-64,SMP{]}
                        vector=percpu: enable percpu vector domain

        video=          {[}FB{]} Frame buffer configuration
                        See Documentation/fb/modedb.txt.

        video.brightness\_switch\_enabled= {[}0,1{]}
                        If set to 1, on receiving an ACPI notify event
                        generated by hotkey, video driver will adjust brightness
                        level and then send out the event to user space through
                        the allocated input device; If set to 0, video driver
                        will only send out the event without touching backlight
                        brightness level.
                        default: 1

        virtio\_mmio.device=
                        {[}VMMIO{]} Memory mapped virtio (platform) device.

                                \textless{}size\textgreater{}@\textless{}baseaddr\textgreater{}:\textless{}irq\textgreater{}{[}:\textless{}id\textgreater{}{]}
                        where:
                                \textless{}size\textgreater{}     := size (can use standard suffixes
                                                like K, M and G)
                                \textless{}baseaddr\textgreater{} := physical base address
                                \textless{}irq\textgreater{}      := interrupt number (as passed to
                                                request\_irq())
                                \textless{}id\textgreater{}       := (optional) platform device id
                        example:
                                virtio\_mmio.device=1K@0x100b0000:48:7

                        Can be used multiple times for multiple devices.

        vga=            {[}BOOT,X86-32{]} Select a particular video mode
                        See Documentation/x86/boot.txt and
                        Documentation/svga.txt.
                        Use vga=ask for menu.
                        This is actually a boot loader parameter; the value is
                        passed to the kernel using a special protocol.

        vmalloc=nn{[}KMG{]} {[}KNL,BOOT{]} Forces the vmalloc area to have an exact
                        size of \textless{}nn\textgreater{}. This can be used to increase the
                        minimum size (128MB on x86). It can also be used to
                        decrease the size and leave more room for directly
                        mapped kernel RAM.

        vmcp\_cma=nn{[}MG{]} {[}KNL,S390{]}
                        Sets the memory size reserved for contiguous memory
                        allocations for the vmcp device driver.

        vmhalt=         {[}KNL,S390{]} Perform z/VM CP command after system halt.
                        Format: \textless{}command\textgreater{}

        vmpanic=        {[}KNL,S390{]} Perform z/VM CP command after kernel panic.
                        Format: \textless{}command\textgreater{}

        vmpoff=         {[}KNL,S390{]} Perform z/VM CP command after power off.
                        Format: \textless{}command\textgreater{}

        vsyscall=       {[}X86-64{]}
                        Controls the behavior of vsyscalls (i.e. calls to
                        fixed addresses of 0xffffffffff600x00 from legacy
                        code).  Most statically-linked binaries and older
                        versions of glibc use these calls.  Because these
                        functions are at fixed addresses, they make nice
                        targets for exploits that can control RIP.

                        emulate     {[}default{]} Vsyscalls turn into traps and are
                                    emulated reasonably safely.

                        native      Vsyscalls are native syscall instructions.
                                    This is a little bit faster than trapping
                                    and makes a few dynamic recompilers work
                                    better than they would in emulation mode.
                                    It also makes exploits much easier to write.

                        none        Vsyscalls don't work at all.  This makes
                                    them quite hard to use for exploits but
                                    might break your system.

        vt.color=       {[}VT{]} Default text color.
                        Format: 0xYX, X = foreground, Y = background.
                        Default: 0x07 = light gray on black.

        vt.cur\_default= {[}VT{]} Default cursor shape.
                        Format: 0xCCBBAA, where AA, BB, and CC are the same as
                        the parameters of the \textless{}Esc\textgreater{}{[}?A;B;Cc escape sequence;
                        see VGA-softcursor.txt. Default: 2 = underline.

        vt.default\_blu= {[}VT{]}
                        Format: \textless{}blue0\textgreater{},\textless{}blue1\textgreater{},\textless{}blue2\textgreater{},...,\textless{}blue15\textgreater{}
                        Change the default blue palette of the console.
                        This is a 16-member array composed of values
                        ranging from 0-255.

        vt.default\_grn= {[}VT{]}
                        Format: \textless{}green0\textgreater{},\textless{}green1\textgreater{},\textless{}green2\textgreater{},...,\textless{}green15\textgreater{}
                        Change the default green palette of the console.
                        This is a 16-member array composed of values
                        ranging from 0-255.

        vt.default\_red= {[}VT{]}
                        Format: \textless{}red0\textgreater{},\textless{}red1\textgreater{},\textless{}red2\textgreater{},...,\textless{}red15\textgreater{}
                        Change the default red palette of the console.
                        This is a 16-member array composed of values
                        ranging from 0-255.

        vt.default\_utf8=
                        {[}VT{]}
                        Format=\textless{}0\textbar{}1\textgreater{}
                        Set system-wide default UTF-8 mode for all tty's.
                        Default is 1, i.e. UTF-8 mode is enabled for all
                        newly opened terminals.

        vt.global\_cursor\_default=
                        {[}VT{]}
                        Format=\textless{}-1\textbar{}0\textbar{}1\textgreater{}
                        Set system-wide default for whether a cursor
                        is shown on new VTs. Default is -1,
                        i.e. cursors will be created by default unless
                        overridden by individual drivers. 0 will hide
                        cursors, 1 will display them.

        vt.italic=      {[}VT{]} Default color for italic text; 0-15.
                        Default: 2 = green.

        vt.underline=   {[}VT{]} Default color for underlined text; 0-15.
                        Default: 3 = cyan.

        watchdog timers {[}HW,WDT{]} For information on watchdog timers,
                        see Documentation/watchdog/watchdog-parameters.txt
                        or other driver-specific files in the
                        Documentation/watchdog/ directory.

        workqueue.watchdog\_thresh=
                        If CONFIG\_WQ\_WATCHDOG is configured, workqueue can
                        warn stall conditions and dump internal state to
                        help debugging.  0 disables workqueue stall
                        detection; otherwise, it's the stall threshold
                        duration in seconds.  The default value is 30 and
                        it can be updated at runtime by writing to the
                        corresponding sysfs file.

        workqueue.disable\_numa
                        By default, all work items queued to unbound
                        workqueues are affine to the NUMA nodes they're
                        issued on, which results in better behavior in
                        general.  If NUMA affinity needs to be disabled for
                        whatever reason, this option can be used.  Note
                        that this also can be controlled per-workqueue for
                        workqueues visible under /sys/bus/workqueue/.

        workqueue.power\_efficient
                        Per-cpu workqueues are generally preferred because
                        they show better performance thanks to cache
                        locality; unfortunately, per-cpu workqueues tend to
                        be more power hungry than unbound workqueues.

                        Enabling this makes the per-cpu workqueues which
                        were observed to contribute significantly to power
                        consumption unbound, leading to measurably lower
                        power usage at the cost of small performance
                        overhead.

                        The default value of this parameter is determined by
                        the config option CONFIG\_WQ\_POWER\_EFFICIENT\_DEFAULT.

        workqueue.debug\_force\_rr\_cpu
                        Workqueue used to implicitly guarantee that work
                        items queued without explicit CPU specified are put
                        on the local CPU.  This guarantee is no longer true
                        and while local CPU is still preferred work items
                        may be put on foreign CPUs.  This debug option
                        forces round-robin CPU selection to flush out
                        usages which depend on the now broken guarantee.
                        When enabled, memory and cache locality will be
                        impacted.

        x2apic\_phys     {[}X86-64,APIC{]} Use x2apic physical mode instead of
                        default x2apic cluster mode on platforms
                        supporting x2apic.

        x86\_intel\_mid\_timer= {[}X86-32,APBT{]}
                        Choose timer option for x86 Intel MID platform.
                        Two valid options are apbt timer only and lapic timer
                        plus one apbt timer for broadcast timer.
                        x86\_intel\_mid\_timer=apbt\_only \textbar{} lapic\_and\_apbt

        xen\_512gb\_limit         {[}KNL,X86-64,XEN{]}
                        Restricts the kernel running paravirtualized under Xen
                        to use only up to 512 GB of RAM. The reason to do so is
                        crash analysis tools and Xen tools for doing domain
                        save/restore/migration must be enabled to handle larger
                        domains.

        xen\_emul\_unplug=                {[}HW,X86,XEN{]}
                        Unplug Xen emulated devices
                        Format: {[}unplug0,{]}{[}unplug1{]}
                        ide-disks -- unplug primary master IDE devices
                        aux-ide-disks -- unplug non-primary-master IDE devices
                        nics -- unplug network devices
                        all -- unplug all emulated devices (NICs and IDE disks)
                        unnecessary -- unplugging emulated devices is
                                unnecessary even if the host did not respond to
                                the unplug protocol
                        never -- do not unplug even if version check succeeds

        xen\_nopvspin    {[}X86,XEN{]}
                        Disables the ticketlock slowpath using Xen PV
                        optimizations.

        xen\_nopv        {[}X86{]}
                        Disables the PV optimizations forcing the HVM guest to
                        run as generic HVM guest with no PV drivers.

        xirc2ps\_cs=     {[}NET,PCMCIA{]}
                        Format:
                        \textless{}irq\textgreater{},\textless{}irq\_mask\textgreater{},\textless{}io\textgreater{},\textless{}full\_duplex\textgreater{},\textless{}do\_sound\textgreater{},\textless{}lockup\_hack\textgreater{}{[},\textless{}irq2\textgreater{}{[},\textless{}irq3\textgreater{}{[},\textless{}irq4\textgreater{}{]}{]}{]}

\end{alltt}


\section{Todo}
\label{admin-guide/kernel-parameters:todo}\begin{quote}

Add more DRM drivers.
\end{quote}


\chapter{Linux allocated devices (4.x+ version)}
\label{admin-guide/devices:linux-allocated-devices-4-x-version}\label{admin-guide/devices::doc}
This list is the Linux Device List, the official registry of allocated
device numbers and \code{/dev} directory nodes for the Linux operating
system.

The LaTeX version of this document is no longer maintained, nor is
the document that used to reside at lanana.org.  This version in the
mainline Linux kernel is the master document.  Updates shall be sent
as patches to the kernel maintainers (see the
\DUspan{xref,std,std-ref}{Documentation/process/submitting-patches.rst} document).
Specifically explore the sections titled ``CHAR and MISC DRIVERS'', and
``BLOCK LAYER'' in the MAINTAINERS file to find the right maintainers
to involve for character and block devices.

This document is included by reference into the Filesystem Hierarchy
Standard (FHS).  The FHS is available from \href{http://www.pathname.com/fhs/}{http://www.pathname.com/fhs/}.

Allocations marked (68k/Amiga) apply to Linux/68k on the Amiga
platform only.  Allocations marked (68k/Atari) apply to Linux/68k on
the Atari platform only.

This document is in the public domain.  The authors requests, however,
that semantically altered versions are not distributed without
permission of the authors, assuming the authors can be contacted without
an unreasonable effort.

\begin{notice}{attention}{Attention:}
DEVICE DRIVERS AUTHORS PLEASE READ THIS

Linux now has extensive support for dynamic allocation of device numbering
and can use \code{sysfs} and \code{udev} (\code{systemd}) to handle the naming needs.
There are still some exceptions in the serial and boot device area. Before
asking   for a device number make sure you actually need one.

To have a major number allocated, or a minor number in situations
where that applies (e.g. busmice), please submit a patch and send to
the authors as indicated above.

Keep the description of the device \emph{in the same format
as this list}. The reason for this is that it is the only way we have
found to ensure we have all the requisite information to publish your
device and avoid conflicts.

Finally, sometimes we have to play ``namespace police.''  Please don't be
offended.  We often get submissions for \code{/dev} names that would be bound
to cause conflicts down the road.  We are trying to avoid getting in a
situation where we would have to suffer an incompatible forward
change.  Therefore, please consult with us \textbf{before} you make your
device names and numbers in any way public, at least to the point
where it would be at all difficult to get them changed.

Your cooperation is appreciated.
\end{notice}
\begin{alltt}
   0            Unnamed devices (e.g. non-device mounts)
                  0 = reserved as null device number
                See block major 144, 145, 146 for expansion areas.

   1 char       Memory devices
                  1 = /dev/mem          Physical memory access
                  2 = /dev/kmem         Kernel virtual memory access
                  3 = /dev/null         Null device
                  4 = /dev/port         I/O port access
                  5 = /dev/zero         Null byte source
                  6 = /dev/core         OBSOLETE - replaced by /proc/kcore
                  7 = /dev/full         Returns ENOSPC on write
                  8 = /dev/random       Nondeterministic random number gen.
                  9 = /dev/urandom      Faster, less secure random number gen.
                 10 = /dev/aio          Asynchronous I/O notification interface
                 11 = /dev/kmsg         Writes to this come out as printk's, reads
                                        export the buffered printk records.
                 12 = /dev/oldmem       OBSOLETE - replaced by /proc/vmcore

   1 block      RAM disk
                  0 = /dev/ram0         First RAM disk
                  1 = /dev/ram1         Second RAM disk
                    ...
                250 = /dev/initrd       Initial RAM disk

                Older kernels had /dev/ramdisk (1, 1) here.
                /dev/initrd refers to a RAM disk which was preloaded
                by the boot loader; newer kernels use /dev/ram0 for
                the initrd.

   2 char       Pseudo-TTY masters
                  0 = /dev/ptyp0        First PTY master
                  1 = /dev/ptyp1        Second PTY master
                    ...
                255 = /dev/ptyef        256th PTY master

                Pseudo-tty's are named as follows:
                * Masters are ``pty'', slaves are ``tty'';
                * the fourth letter is one of pqrstuvwxyzabcde indicating
                  the 1st through 16th series of 16 pseudo-ttys each, and
                * the fifth letter is one of 0123456789abcdef indicating
                  the position within the series.

                These are the old-style (BSD) PTY devices; Unix98
                devices are on major 128 and above and use the PTY
                master multiplex (/dev/ptmx) to acquire a PTY on
                demand.

   2 block      Floppy disks
                  0 = /dev/fd0          Controller 0, drive 0, autodetect
                  1 = /dev/fd1          Controller 0, drive 1, autodetect
                  2 = /dev/fd2          Controller 0, drive 2, autodetect
                  3 = /dev/fd3          Controller 0, drive 3, autodetect
                128 = /dev/fd4          Controller 1, drive 0, autodetect
                129 = /dev/fd5          Controller 1, drive 1, autodetect
                130 = /dev/fd6          Controller 1, drive 2, autodetect
                131 = /dev/fd7          Controller 1, drive 3, autodetect

                To specify format, add to the autodetect device number:
                  0 = /dev/fd?          Autodetect format
                  4 = /dev/fd?d360      5.25''  360K in a 360K  drive(1)
                 20 = /dev/fd?h360      5.25''  360K in a 1200K drive(1)
                 48 = /dev/fd?h410      5.25''  410K in a 1200K drive
                 64 = /dev/fd?h420      5.25''  420K in a 1200K drive
                 24 = /dev/fd?h720      5.25''  720K in a 1200K drive
                 80 = /dev/fd?h880      5.25''  880K in a 1200K drive(1)
                  8 = /dev/fd?h1200     5.25'' 1200K in a 1200K drive(1)
                 40 = /dev/fd?h1440     5.25'' 1440K in a 1200K drive(1)
                 56 = /dev/fd?h1476     5.25'' 1476K in a 1200K drive
                 72 = /dev/fd?h1494     5.25'' 1494K in a 1200K drive
                 92 = /dev/fd?h1600     5.25'' 1600K in a 1200K drive(1)

                 12 = /dev/fd?u360      3.5''   360K Double Density(2)
                 16 = /dev/fd?u720      3.5''   720K Double Density(1)
                120 = /dev/fd?u800      3.5''   800K Double Density(2)
                 52 = /dev/fd?u820      3.5''   820K Double Density
                 68 = /dev/fd?u830      3.5''   830K Double Density
                 84 = /dev/fd?u1040     3.5''  1040K Double Density(1)
                 88 = /dev/fd?u1120     3.5''  1120K Double Density(1)
                 28 = /dev/fd?u1440     3.5''  1440K High Density(1)
                124 = /dev/fd?u1600     3.5''  1600K High Density(1)
                 44 = /dev/fd?u1680     3.5''  1680K High Density(3)
                 60 = /dev/fd?u1722     3.5''  1722K High Density
                 76 = /dev/fd?u1743     3.5''  1743K High Density
                 96 = /dev/fd?u1760     3.5''  1760K High Density
                116 = /dev/fd?u1840     3.5''  1840K High Density(3)
                100 = /dev/fd?u1920     3.5''  1920K High Density(1)
                 32 = /dev/fd?u2880     3.5''  2880K Extra Density(1)
                104 = /dev/fd?u3200     3.5''  3200K Extra Density
                108 = /dev/fd?u3520     3.5''  3520K Extra Density
                112 = /dev/fd?u3840     3.5''  3840K Extra Density(1)

                 36 = /dev/fd?CompaQ    Compaq 2880K drive; obsolete?

                (1) Autodetectable format
                (2) Autodetectable format in a Double Density (720K) drive only
                (3) Autodetectable format in a High Density (1440K) drive only

                NOTE: The letter in the device name (d, q, h or u)
                signifies the type of drive: 5.25'' Double Density (d),
                5.25'' Quad Density (q), 5.25'' High Density (h) or 3.5''
                (any model, u).  The use of the capital letters D, H
                and E for the 3.5'' models have been deprecated, since
                the drive type is insignificant for these devices.

   3 char       Pseudo-TTY slaves
                  0 = /dev/ttyp0        First PTY slave
                  1 = /dev/ttyp1        Second PTY slave
                    ...
                255 = /dev/ttyef        256th PTY slave

                These are the old-style (BSD) PTY devices; Unix98
                devices are on major 136 and above.

   3 block      First MFM, RLL and IDE hard disk/CD-ROM interface
                  0 = /dev/hda          Master: whole disk (or CD-ROM)
                 64 = /dev/hdb          Slave: whole disk (or CD-ROM)

                For partitions, add to the whole disk device number:
                  0 = /dev/hd?          Whole disk
                  1 = /dev/hd?1         First partition
                  2 = /dev/hd?2         Second partition
                    ...
                 63 = /dev/hd?63        63rd partition

                For Linux/i386, partitions 1-4 are the primary
                partitions, and 5 and above are logical partitions.
                Other versions of Linux use partitioning schemes
                appropriate to their respective architectures.

   4 char       TTY devices
                  0 = /dev/tty0         Current virtual console

                  1 = /dev/tty1         First virtual console
                    ...
                 63 = /dev/tty63        63rd virtual console
                 64 = /dev/ttyS0        First UART serial port
                    ...
                255 = /dev/ttyS191      192nd UART serial port

                UART serial ports refer to 8250/16450/16550 series devices.

                Older versions of the Linux kernel used this major
                number for BSD PTY devices.  As of Linux 2.1.115, this
                is no longer supported.  Use major numbers 2 and 3.

   4 block      Aliases for dynamically allocated major devices to be used
                when its not possible to create the real device nodes
                because the root filesystem is mounted read-only.

                   0 = /dev/root

   5 char       Alternate TTY devices
                  0 = /dev/tty          Current TTY device
                  1 = /dev/console      System console
                  2 = /dev/ptmx         PTY master multiplex
                  3 = /dev/ttyprintk    User messages via printk TTY device
                 64 = /dev/cua0         Callout device for ttyS0
                    ...
                255 = /dev/cua191       Callout device for ttyS191

                (5,1) is /dev/console starting with Linux 2.1.71.  See
                the section on terminal devices for more information
                on /dev/console.

   6 char       Parallel printer devices
                  0 = /dev/lp0          Parallel printer on parport0
                  1 = /dev/lp1          Parallel printer on parport1
                    ...

                Current Linux kernels no longer have a fixed mapping
                between parallel ports and I/O addresses.  Instead,
                they are redirected through the parport multiplex layer.

   7 char       Virtual console capture devices
                  0 = /dev/vcs          Current vc text contents
                  1 = /dev/vcs1         tty1 text contents
                    ...
                 63 = /dev/vcs63        tty63 text contents
                128 = /dev/vcsa         Current vc text/attribute contents
                129 = /dev/vcsa1        tty1 text/attribute contents
                    ...
                191 = /dev/vcsa63       tty63 text/attribute contents

                NOTE: These devices permit both read and write access.

   7 block      Loopback devices
                  0 = /dev/loop0        First loop device
                  1 = /dev/loop1        Second loop device
                    ...

                The loop devices are used to mount filesystems not
                associated with block devices.  The binding to the
                loop devices is handled by mount(8) or losetup(8).

   8 block      SCSI disk devices (0-15)
                  0 = /dev/sda          First SCSI disk whole disk
                 16 = /dev/sdb          Second SCSI disk whole disk
                 32 = /dev/sdc          Third SCSI disk whole disk
                    ...
                240 = /dev/sdp          Sixteenth SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

   9 char       SCSI tape devices
                  0 = /dev/st0          First SCSI tape, mode 0
                  1 = /dev/st1          Second SCSI tape, mode 0
                    ...
                 32 = /dev/st0l         First SCSI tape, mode 1
                 33 = /dev/st1l         Second SCSI tape, mode 1
                    ...
                 64 = /dev/st0m         First SCSI tape, mode 2
                 65 = /dev/st1m         Second SCSI tape, mode 2
                    ...
                 96 = /dev/st0a         First SCSI tape, mode 3
                 97 = /dev/st1a         Second SCSI tape, mode 3
                      ...
                128 = /dev/nst0         First SCSI tape, mode 0, no rewind
                129 = /dev/nst1         Second SCSI tape, mode 0, no rewind
                    ...
                160 = /dev/nst0l        First SCSI tape, mode 1, no rewind
                161 = /dev/nst1l        Second SCSI tape, mode 1, no rewind
                    ...
                192 = /dev/nst0m        First SCSI tape, mode 2, no rewind
                193 = /dev/nst1m        Second SCSI tape, mode 2, no rewind
                    ...
                224 = /dev/nst0a        First SCSI tape, mode 3, no rewind
                225 = /dev/nst1a        Second SCSI tape, mode 3, no rewind
                    ...

                ``No rewind'' refers to the omission of the default
                automatic rewind on device close.  The MTREW or MTOFFL
                ioctl()'s can be used to rewind the tape regardless of
                the device used to access it.

   9 block      Metadisk (RAID) devices
                  0 = /dev/md0          First metadisk group
                  1 = /dev/md1          Second metadisk group
                    ...

                The metadisk driver is used to span a
                filesystem across multiple physical disks.

  10 char       Non-serial mice, misc features
                  0 = /dev/logibm       Logitech bus mouse
                  1 = /dev/psaux        PS/2-style mouse port
                  2 = /dev/inportbm     Microsoft Inport bus mouse
                  3 = /dev/atibm        ATI XL bus mouse
                  4 = /dev/jbm          J-mouse
                  4 = /dev/amigamouse   Amiga mouse (68k/Amiga)
                  5 = /dev/atarimouse   Atari mouse
                  6 = /dev/sunmouse     Sun mouse
                  7 = /dev/amigamouse1  Second Amiga mouse
                  8 = /dev/smouse       Simple serial mouse driver
                  9 = /dev/pc110pad     IBM PC-110 digitizer pad
                 10 = /dev/adbmouse     Apple Desktop Bus mouse
                 11 = /dev/vrtpanel     Vr41xx embedded touch panel
                 13 = /dev/vpcmouse     Connectix Virtual PC Mouse
                 14 = /dev/touchscreen/ucb1x00  UCB 1x00 touchscreen
                 15 = /dev/touchscreen/mk712    MK712 touchscreen
                128 = /dev/beep         Fancy beep device
                129 =
                130 = /dev/watchdog     Watchdog timer port
                131 = /dev/temperature  Machine internal temperature
                132 = /dev/hwtrap       Hardware fault trap
                133 = /dev/exttrp       External device trap
                134 = /dev/apm\_bios     Advanced Power Management BIOS
                135 = /dev/rtc          Real Time Clock
                137 = /dev/vhci         Bluetooth virtual HCI driver
                139 = /dev/openprom     SPARC OpenBoot PROM
                140 = /dev/relay8       Berkshire Products Octal relay card
                141 = /dev/relay16      Berkshire Products ISO-16 relay card
                142 =
                143 = /dev/pciconf      PCI configuration space
                144 = /dev/nvram        Non-volatile configuration RAM
                145 = /dev/hfmodem      Soundcard shortwave modem control
                146 = /dev/graphics     Linux/SGI graphics device
                147 = /dev/opengl       Linux/SGI OpenGL pipe
                148 = /dev/gfx          Linux/SGI graphics effects device
                149 = /dev/input/mouse  Linux/SGI Irix emulation mouse
                150 = /dev/input/keyboard Linux/SGI Irix emulation keyboard
                151 = /dev/led          Front panel LEDs
                152 = /dev/kpoll        Kernel Poll Driver
                153 = /dev/mergemem     Memory merge device
                154 = /dev/pmu          Macintosh PowerBook power manager
                155 = /dev/isictl       MultiTech ISICom serial control
                156 = /dev/lcd          Front panel LCD display
                157 = /dev/ac           Applicom Intl Profibus card
                158 = /dev/nwbutton     Netwinder external button
                159 = /dev/nwdebug      Netwinder debug interface
                160 = /dev/nwflash      Netwinder flash memory
                161 = /dev/userdma      User-space DMA access
                162 = /dev/smbus        System Management Bus
                163 = /dev/lik          Logitech Internet Keyboard
                164 = /dev/ipmo         Intel Intelligent Platform Management
                165 = /dev/vmmon        VMware virtual machine monitor
                166 = /dev/i2o/ctl      I2O configuration manager
                167 = /dev/specialix\_sxctl Specialix serial control
                168 = /dev/tcldrv       Technology Concepts serial control
                169 = /dev/specialix\_rioctl Specialix RIO serial control
                170 = /dev/thinkpad/thinkpad    IBM Thinkpad devices
                171 = /dev/srripc       QNX4 API IPC manager
                172 = /dev/usemaclone   Semaphore clone device
                173 = /dev/ipmikcs      Intelligent Platform Management
                174 = /dev/uctrl        SPARCbook 3 microcontroller
                175 = /dev/agpgart      AGP Graphics Address Remapping Table
                176 = /dev/gtrsc        Gorgy Timing radio clock
                177 = /dev/cbm          Serial CBM bus
                178 = /dev/jsflash      JavaStation OS flash SIMM
                179 = /dev/xsvc         High-speed shared-mem/semaphore service
                180 = /dev/vrbuttons    Vr41xx button input device
                181 = /dev/toshiba      Toshiba laptop SMM support
                182 = /dev/perfctr      Performance-monitoring counters
                183 = /dev/hwrng        Generic random number generator
                184 = /dev/cpu/microcode CPU microcode update interface
                186 = /dev/atomicps     Atomic shapshot of process state data
                187 = /dev/irnet        IrNET device
                188 = /dev/smbusbios    SMBus BIOS
                189 = /dev/ussp\_ctl     User space serial port control
                190 = /dev/crash        Mission Critical Linux crash dump facility
                191 = /dev/pcl181       \textless{}information missing\textgreater{}
                192 = /dev/nas\_xbus     NAS xbus LCD/buttons access
                193 = /dev/d7s          SPARC 7-segment display
                194 = /dev/zkshim       Zero-Knowledge network shim control
                195 = /dev/elographics/e2201    Elographics touchscreen E271-2201
                196 = /dev/vfio/vfio    VFIO userspace driver interface
                197 = /dev/pxa3xx-gcu   PXA3xx graphics controller unit driver
                198 = /dev/sexec        Signed executable interface
                199 = /dev/scanners/cuecat :CueCat barcode scanner
                200 = /dev/net/tun      TAP/TUN network device
                201 = /dev/button/gulpb Transmeta GULP-B buttons
                202 = /dev/emd/ctl      Enhanced Metadisk RAID (EMD) control
                203 = /dev/cuse         Cuse (character device in user-space)
                204 = /dev/video/em8300         EM8300 DVD decoder control
                205 = /dev/video/em8300\_mv      EM8300 DVD decoder video
                206 = /dev/video/em8300\_ma      EM8300 DVD decoder audio
                207 = /dev/video/em8300\_sp      EM8300 DVD decoder subpicture
                208 = /dev/compaq/cpqphpc       Compaq PCI Hot Plug Controller
                209 = /dev/compaq/cpqrid        Compaq Remote Insight Driver
                210 = /dev/impi/bt      IMPI coprocessor block transfer
                211 = /dev/impi/smic    IMPI coprocessor stream interface
                212 = /dev/watchdogs/0  First watchdog device
                213 = /dev/watchdogs/1  Second watchdog device
                214 = /dev/watchdogs/2  Third watchdog device
                215 = /dev/watchdogs/3  Fourth watchdog device
                216 = /dev/fujitsu/apanel       Fujitsu/Siemens application panel
                217 = /dev/ni/natmotn           National Instruments Motion
                218 = /dev/kchuid       Inter-process chuid control
                219 = /dev/modems/mwave MWave modem firmware upload
                220 = /dev/mptctl       Message passing technology (MPT) control
                221 = /dev/mvista/hssdsi        Montavista PICMG hot swap system driver
                222 = /dev/mvista/hasi          Montavista PICMG high availability
                223 = /dev/input/uinput         User level driver support for input
                224 = /dev/tpm          TCPA TPM driver
                225 = /dev/pps          Pulse Per Second driver
                226 = /dev/systrace     Systrace device
                227 = /dev/mcelog       X86\_64 Machine Check Exception driver
                228 = /dev/hpet         HPET driver
                229 = /dev/fuse         Fuse (virtual filesystem in user-space)
                230 = /dev/midishare    MidiShare driver
                231 = /dev/snapshot     System memory snapshot device
                232 = /dev/kvm          Kernel-based virtual machine (hardware virtualization extensions)
                233 = /dev/kmview       View-OS A process with a view
                234 = /dev/btrfs-control        Btrfs control device
                235 = /dev/autofs       Autofs control device
                236 = /dev/mapper/control       Device-Mapper control device
                237 = /dev/loop-control Loopback control device
                238 = /dev/vhost-net    Host kernel accelerator for virtio net
                239 = /dev/uhid         User-space I/O driver support for HID subsystem
                240 = /dev/userio       Serio driver testing device
                241 = /dev/vhost-vsock  Host kernel driver for virtio vsock

                242-254                 Reserved for local use
                255                     Reserved for MISC\_DYNAMIC\_MINOR

  11 char       Raw keyboard device     (Linux/SPARC only)
                  0 = /dev/kbd          Raw keyboard device

  11 char       Serial Mux device       (Linux/PA-RISC only)
                  0 = /dev/ttyB0        First mux port
                  1 = /dev/ttyB1        Second mux port
                    ...

  11 block      SCSI CD-ROM devices
                  0 = /dev/scd0         First SCSI CD-ROM
                  1 = /dev/scd1         Second SCSI CD-ROM
                    ...

                The prefix /dev/sr (instead of /dev/scd) has been deprecated.

  12 char       QIC-02 tape
                  2 = /dev/ntpqic11     QIC-11, no rewind-on-close
                  3 = /dev/tpqic11      QIC-11, rewind-on-close
                  4 = /dev/ntpqic24     QIC-24, no rewind-on-close
                  5 = /dev/tpqic24      QIC-24, rewind-on-close
                  6 = /dev/ntpqic120    QIC-120, no rewind-on-close
                  7 = /dev/tpqic120     QIC-120, rewind-on-close
                  8 = /dev/ntpqic150    QIC-150, no rewind-on-close
                  9 = /dev/tpqic150     QIC-150, rewind-on-close

                The device names specified are proposed -- if there
                are ``standard'' names for these devices, please let me know.

  12 block

  13 char       Input core
                  0 = /dev/input/js0    First joystick
                  1 = /dev/input/js1    Second joystick
                    ...
                 32 = /dev/input/mouse0 First mouse
                 33 = /dev/input/mouse1 Second mouse
                    ...
                 63 = /dev/input/mice   Unified mouse
                 64 = /dev/input/event0 First event queue
                 65 = /dev/input/event1 Second event queue
                    ...

                Each device type has 5 bits (32 minors).

  13 block      Previously used for the XT disk (/dev/xdN)
                Deleted in kernel v3.9.

  14 char       Open Sound System (OSS)
                  0 = /dev/mixer        Mixer control
                  1 = /dev/sequencer    Audio sequencer
                  2 = /dev/midi00       First MIDI port
                  3 = /dev/dsp          Digital audio
                  4 = /dev/audio        Sun-compatible digital audio
                  6 =
                  7 = /dev/audioctl     SPARC audio control device
                  8 = /dev/sequencer2   Sequencer -- alternate device
                 16 = /dev/mixer1       Second soundcard mixer control
                 17 = /dev/patmgr0      Sequencer patch manager
                 18 = /dev/midi01       Second MIDI port
                 19 = /dev/dsp1         Second soundcard digital audio
                 20 = /dev/audio1       Second soundcard Sun digital audio
                 33 = /dev/patmgr1      Sequencer patch manager
                 34 = /dev/midi02       Third MIDI port
                 50 = /dev/midi03       Fourth MIDI port

  14 block

  15 char       Joystick
                  0 = /dev/js0          First analog joystick
                  1 = /dev/js1          Second analog joystick
                    ...
                128 = /dev/djs0         First digital joystick
                129 = /dev/djs1         Second digital joystick
                    ...
  15 block      Sony CDU-31A/CDU-33A CD-ROM
                  0 = /dev/sonycd       Sony CDU-31a CD-ROM

  16 char       Non-SCSI scanners
                  0 = /dev/gs4500       Genius 4500 handheld scanner

  16 block      GoldStar CD-ROM
                  0 = /dev/gscd         GoldStar CD-ROM

  17 char       OBSOLETE (was Chase serial card)
                  0 = /dev/ttyH0        First Chase port
                  1 = /dev/ttyH1        Second Chase port
                    ...
  17 block      Optics Storage CD-ROM
                  0 = /dev/optcd        Optics Storage CD-ROM

  18 char       OBSOLETE (was Chase serial card - alternate devices)
                  0 = /dev/cuh0         Callout device for ttyH0
                  1 = /dev/cuh1         Callout device for ttyH1
                    ...
  18 block      Sanyo CD-ROM
                  0 = /dev/sjcd         Sanyo CD-ROM

  19 char       Cyclades serial card
                  0 = /dev/ttyC0        First Cyclades port
                    ...
                 31 = /dev/ttyC31       32nd Cyclades port

  19 block      ``Double'' compressed disk
                  0 = /dev/double0      First compressed disk
                    ...
                  7 = /dev/double7      Eighth compressed disk
                128 = /dev/cdouble0     Mirror of first compressed disk
                    ...
                135 = /dev/cdouble7     Mirror of eighth compressed disk

                See the Double documentation for the meaning of the
                mirror devices.

  20 char       Cyclades serial card - alternate devices
                  0 = /dev/cub0         Callout device for ttyC0
                    ...
                 31 = /dev/cub31        Callout device for ttyC31

  20 block      Hitachi CD-ROM (under development)
                  0 = /dev/hitcd        Hitachi CD-ROM

  21 char       Generic SCSI access
                  0 = /dev/sg0          First generic SCSI device
                  1 = /dev/sg1          Second generic SCSI device
                    ...

                Most distributions name these /dev/sga, /dev/sgb...;
                this sets an unnecessary limit of 26 SCSI devices in
                the system and is counter to standard Linux
                device-naming practice.

  21 block      Acorn MFM hard drive interface
                  0 = /dev/mfma         First MFM drive whole disk
                 64 = /dev/mfmb         Second MFM drive whole disk

                This device is used on the ARM-based Acorn RiscPC.
                Partitions are handled the same way as for IDE disks
                (see major number 3).

  22 char       Digiboard serial card
                  0 = /dev/ttyD0        First Digiboard port
                  1 = /dev/ttyD1        Second Digiboard port
                    ...
  22 block      Second IDE hard disk/CD-ROM interface
                  0 = /dev/hdc          Master: whole disk (or CD-ROM)
                 64 = /dev/hdd          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  23 char       Digiboard serial card - alternate devices
                  0 = /dev/cud0         Callout device for ttyD0
                  1 = /dev/cud1         Callout device for ttyD1
                      ...
  23 block      Mitsumi proprietary CD-ROM
                  0 = /dev/mcd          Mitsumi CD-ROM

  24 char       Stallion serial card
                  0 = /dev/ttyE0        Stallion port 0 card 0
                  1 = /dev/ttyE1        Stallion port 1 card 0
                    ...
                 64 = /dev/ttyE64       Stallion port 0 card 1
                 65 = /dev/ttyE65       Stallion port 1 card 1
                      ...
                128 = /dev/ttyE128      Stallion port 0 card 2
                129 = /dev/ttyE129      Stallion port 1 card 2
                    ...
                192 = /dev/ttyE192      Stallion port 0 card 3
                193 = /dev/ttyE193      Stallion port 1 card 3
                    ...
  24 block      Sony CDU-535 CD-ROM
                  0 = /dev/cdu535       Sony CDU-535 CD-ROM

  25 char       Stallion serial card - alternate devices
                  0 = /dev/cue0         Callout device for ttyE0
                  1 = /dev/cue1         Callout device for ttyE1
                    ...
                 64 = /dev/cue64        Callout device for ttyE64
                 65 = /dev/cue65        Callout device for ttyE65
                    ...
                128 = /dev/cue128       Callout device for ttyE128
                129 = /dev/cue129       Callout device for ttyE129
                    ...
                192 = /dev/cue192       Callout device for ttyE192
                193 = /dev/cue193       Callout device for ttyE193
                      ...
  25 block      First Matsushita (Panasonic/SoundBlaster) CD-ROM
                  0 = /dev/sbpcd0       Panasonic CD-ROM controller 0 unit 0
                  1 = /dev/sbpcd1       Panasonic CD-ROM controller 0 unit 1
                  2 = /dev/sbpcd2       Panasonic CD-ROM controller 0 unit 2
                  3 = /dev/sbpcd3       Panasonic CD-ROM controller 0 unit 3

  26 char

  26 block      Second Matsushita (Panasonic/SoundBlaster) CD-ROM
                  0 = /dev/sbpcd4       Panasonic CD-ROM controller 1 unit 0
                  1 = /dev/sbpcd5       Panasonic CD-ROM controller 1 unit 1
                  2 = /dev/sbpcd6       Panasonic CD-ROM controller 1 unit 2
                  3 = /dev/sbpcd7       Panasonic CD-ROM controller 1 unit 3

  27 char       QIC-117 tape
                  0 = /dev/qft0         Unit 0, rewind-on-close
                  1 = /dev/qft1         Unit 1, rewind-on-close
                  2 = /dev/qft2         Unit 2, rewind-on-close
                  3 = /dev/qft3         Unit 3, rewind-on-close
                  4 = /dev/nqft0        Unit 0, no rewind-on-close
                  5 = /dev/nqft1        Unit 1, no rewind-on-close
                  6 = /dev/nqft2        Unit 2, no rewind-on-close
                  7 = /dev/nqft3        Unit 3, no rewind-on-close
                 16 = /dev/zqft0        Unit 0, rewind-on-close, compression
                 17 = /dev/zqft1        Unit 1, rewind-on-close, compression
                 18 = /dev/zqft2        Unit 2, rewind-on-close, compression
                 19 = /dev/zqft3        Unit 3, rewind-on-close, compression
                 20 = /dev/nzqft0       Unit 0, no rewind-on-close, compression
                 21 = /dev/nzqft1       Unit 1, no rewind-on-close, compression
                 22 = /dev/nzqft2       Unit 2, no rewind-on-close, compression
                 23 = /dev/nzqft3       Unit 3, no rewind-on-close, compression
                 32 = /dev/rawqft0      Unit 0, rewind-on-close, no file marks
                 33 = /dev/rawqft1      Unit 1, rewind-on-close, no file marks
                 34 = /dev/rawqft2      Unit 2, rewind-on-close, no file marks
                 35 = /dev/rawqft3      Unit 3, rewind-on-close, no file marks
                 36 = /dev/nrawqft0     Unit 0, no rewind-on-close, no file marks
                 37 = /dev/nrawqft1     Unit 1, no rewind-on-close, no file marks
                 38 = /dev/nrawqft2     Unit 2, no rewind-on-close, no file marks
                 39 = /dev/nrawqft3     Unit 3, no rewind-on-close, no file marks

  27 block      Third Matsushita (Panasonic/SoundBlaster) CD-ROM
                  0 = /dev/sbpcd8       Panasonic CD-ROM controller 2 unit 0
                  1 = /dev/sbpcd9       Panasonic CD-ROM controller 2 unit 1
                  2 = /dev/sbpcd10      Panasonic CD-ROM controller 2 unit 2
                  3 = /dev/sbpcd11      Panasonic CD-ROM controller 2 unit 3

  28 char       Stallion serial card - card programming
                  0 = /dev/staliomem0   First Stallion card I/O memory
                  1 = /dev/staliomem1   Second Stallion card I/O memory
                  2 = /dev/staliomem2   Third Stallion card I/O memory
                  3 = /dev/staliomem3   Fourth Stallion card I/O memory

  28 char       Atari SLM ACSI laser printer (68k/Atari)
                  0 = /dev/slm0         First SLM laser printer
                  1 = /dev/slm1         Second SLM laser printer
                    ...
  28 block      Fourth Matsushita (Panasonic/SoundBlaster) CD-ROM
                  0 = /dev/sbpcd12      Panasonic CD-ROM controller 3 unit 0
                  1 = /dev/sbpcd13      Panasonic CD-ROM controller 3 unit 1
                  2 = /dev/sbpcd14      Panasonic CD-ROM controller 3 unit 2
                  3 = /dev/sbpcd15      Panasonic CD-ROM controller 3 unit 3

  28 block      ACSI disk (68k/Atari)
                  0 = /dev/ada          First ACSI disk whole disk
                 16 = /dev/adb          Second ACSI disk whole disk
                 32 = /dev/adc          Third ACSI disk whole disk
                    ...
                240 = /dev/adp          16th ACSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15, like SCSI.

  29 char       Universal frame buffer
                  0 = /dev/fb0          First frame buffer
                  1 = /dev/fb1          Second frame buffer
                    ...
                 31 = /dev/fb31         32nd frame buffer

  29 block      Aztech/Orchid/Okano/Wearnes CD-ROM
                  0 = /dev/aztcd        Aztech CD-ROM

  30 char       iBCS-2 compatibility devices
                  0 = /dev/socksys      Socket access
                  1 = /dev/spx          SVR3 local X interface
                 32 = /dev/inet/ip      Network access
                 33 = /dev/inet/icmp
                 34 = /dev/inet/ggp
                 35 = /dev/inet/ipip
                 36 = /dev/inet/tcp
                 37 = /dev/inet/egp
                 38 = /dev/inet/pup
                 39 = /dev/inet/udp
                 40 = /dev/inet/idp
                 41 = /dev/inet/rawip

                Additionally, iBCS-2 requires the following links:

                /dev/ip -\textgreater{} /dev/inet/ip
                /dev/icmp -\textgreater{} /dev/inet/icmp
                /dev/ggp -\textgreater{} /dev/inet/ggp
                /dev/ipip -\textgreater{} /dev/inet/ipip
                /dev/tcp -\textgreater{} /dev/inet/tcp
                /dev/egp -\textgreater{} /dev/inet/egp
                /dev/pup -\textgreater{} /dev/inet/pup
                /dev/udp -\textgreater{} /dev/inet/udp
                /dev/idp -\textgreater{} /dev/inet/idp
                /dev/rawip -\textgreater{} /dev/inet/rawip
                /dev/inet/arp -\textgreater{} /dev/inet/udp
                /dev/inet/rip -\textgreater{} /dev/inet/udp
                /dev/nfsd -\textgreater{} /dev/socksys
                /dev/X0R -\textgreater{} /dev/null (? apparently not required ?)

  30 block      Philips LMS CM-205 CD-ROM
                  0 = /dev/cm205cd      Philips LMS CM-205 CD-ROM

                /dev/lmscd is an older name for this device.  This
                driver does not work with the CM-205MS CD-ROM.

  31 char       MPU-401 MIDI
                  0 = /dev/mpu401data   MPU-401 data port
                  1 = /dev/mpu401stat   MPU-401 status port

  31 block      ROM/flash memory card
                  0 = /dev/rom0         First ROM card (rw)
                      ...
                  7 = /dev/rom7         Eighth ROM card (rw)
                  8 = /dev/rrom0        First ROM card (ro)
                    ...
                 15 = /dev/rrom7        Eighth ROM card (ro)
                 16 = /dev/flash0       First flash memory card (rw)
                    ...
                 23 = /dev/flash7       Eighth flash memory card (rw)
                 24 = /dev/rflash0      First flash memory card (ro)
                    ...
                 31 = /dev/rflash7      Eighth flash memory card (ro)

                The read-write (rw) devices support back-caching
                written data in RAM, as well as writing to flash RAM
                devices.  The read-only devices (ro) support reading
                only.

  32 char       Specialix serial card
                  0 = /dev/ttyX0        First Specialix port
                  1 = /dev/ttyX1        Second Specialix port
                    ...
  32 block      Philips LMS CM-206 CD-ROM
                  0 = /dev/cm206cd      Philips LMS CM-206 CD-ROM

  33 char       Specialix serial card - alternate devices
                  0 = /dev/cux0         Callout device for ttyX0
                  1 = /dev/cux1         Callout device for ttyX1
                    ...
  33 block      Third IDE hard disk/CD-ROM interface
                  0 = /dev/hde          Master: whole disk (or CD-ROM)
                 64 = /dev/hdf          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  34 char       Z8530 HDLC driver
                  0 = /dev/scc0         First Z8530, first port
                  1 = /dev/scc1         First Z8530, second port
                  2 = /dev/scc2         Second Z8530, first port
                  3 = /dev/scc3         Second Z8530, second port
                    ...

                In a previous version these devices were named
                /dev/sc1 for /dev/scc0, /dev/sc2 for /dev/scc1, and so
                on.

  34 block      Fourth IDE hard disk/CD-ROM interface
                  0 = /dev/hdg          Master: whole disk (or CD-ROM)
                 64 = /dev/hdh          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  35 char       tclmidi MIDI driver
                  0 = /dev/midi0        First MIDI port, kernel timed
                  1 = /dev/midi1        Second MIDI port, kernel timed
                  2 = /dev/midi2        Third MIDI port, kernel timed
                  3 = /dev/midi3        Fourth MIDI port, kernel timed
                 64 = /dev/rmidi0       First MIDI port, untimed
                 65 = /dev/rmidi1       Second MIDI port, untimed
                 66 = /dev/rmidi2       Third MIDI port, untimed
                 67 = /dev/rmidi3       Fourth MIDI port, untimed
                128 = /dev/smpte0       First MIDI port, SMPTE timed
                129 = /dev/smpte1       Second MIDI port, SMPTE timed
                130 = /dev/smpte2       Third MIDI port, SMPTE timed
                131 = /dev/smpte3       Fourth MIDI port, SMPTE timed

  35 block      Slow memory ramdisk
                  0 = /dev/slram        Slow memory ramdisk

  36 char       Netlink support
                  0 = /dev/route        Routing, device updates, kernel to user
                  1 = /dev/skip         enSKIP security cache control
                  3 = /dev/fwmonitor    Firewall packet copies
                 16 = /dev/tap0         First Ethertap device
                    ...
                 31 = /dev/tap15        16th Ethertap device

  36 block      OBSOLETE (was MCA ESDI hard disk)

  37 char       IDE tape
                  0 = /dev/ht0          First IDE tape
                  1 = /dev/ht1          Second IDE tape
                    ...
                128 = /dev/nht0         First IDE tape, no rewind-on-close
                129 = /dev/nht1         Second IDE tape, no rewind-on-close
                    ...

                Currently, only one IDE tape drive is supported.

  37 block      Zorro II ramdisk
                  0 = /dev/z2ram        Zorro II ramdisk

  38 char       Myricom PCI Myrinet board
                  0 = /dev/mlanai0      First Myrinet board
                  1 = /dev/mlanai1      Second Myrinet board
                    ...

                This device is used for status query, board control
                and ``user level packet I/O.''  This board is also
                accessible as a standard networking ``eth'' device.

  38 block      OBSOLETE (was Linux/AP+)

  39 char       ML-16P experimental I/O board
                  0 = /dev/ml16pa-a0    First card, first analog channel
                  1 = /dev/ml16pa-a1    First card, second analog channel
                    ...
                 15 = /dev/ml16pa-a15   First card, 16th analog channel
                 16 = /dev/ml16pa-d     First card, digital lines
                 17 = /dev/ml16pa-c0    First card, first counter/timer
                 18 = /dev/ml16pa-c1    First card, second counter/timer
                 19 = /dev/ml16pa-c2    First card, third counter/timer
                 32 = /dev/ml16pb-a0    Second card, first analog channel
                 33 = /dev/ml16pb-a1    Second card, second analog channel
                    ...
                 47 = /dev/ml16pb-a15   Second card, 16th analog channel
                 48 = /dev/ml16pb-d     Second card, digital lines
                 49 = /dev/ml16pb-c0    Second card, first counter/timer
                 50 = /dev/ml16pb-c1    Second card, second counter/timer
                 51 = /dev/ml16pb-c2    Second card, third counter/timer
                      ...
  39 block

  40 char

  40 block

  41 char       Yet Another Micro Monitor
                  0 = /dev/yamm         Yet Another Micro Monitor

  41 block

  42 char       Demo/sample use

  42 block      Demo/sample use

                This number is intended for use in sample code, as
                well as a general ``example'' device number.  It
                should never be used for a device driver that is being
                distributed; either obtain an official number or use
                the local/experimental range.  The sudden addition or
                removal of a driver with this number should not cause
                ill effects to the system (bugs excepted.)

                IN PARTICULAR, ANY DISTRIBUTION WHICH CONTAINS A
                DEVICE DRIVER USING MAJOR NUMBER 42 IS NONCOMPLIANT.

  43 char       isdn4linux virtual modem
                  0 = /dev/ttyI0        First virtual modem
                    ...
                 63 = /dev/ttyI63       64th virtual modem

  43 block      Network block devices
                  0 = /dev/nb0          First network block device
                  1 = /dev/nb1          Second network block device
                    ...

                Network Block Device is somehow similar to loopback
                devices: If you read from it, it sends packet across
                network asking server for data. If you write to it, it
                sends packet telling server to write. It could be used
                to mounting filesystems over the net, swapping over
                the net, implementing block device in userland etc.

  44 char       isdn4linux virtual modem - alternate devices
                  0 = /dev/cui0         Callout device for ttyI0
                    ...
                 63 = /dev/cui63        Callout device for ttyI63

  44 block      Flash Translation Layer (FTL) filesystems
                  0 = /dev/ftla         FTL on first Memory Technology Device
                 16 = /dev/ftlb         FTL on second Memory Technology Device
                 32 = /dev/ftlc         FTL on third Memory Technology Device
                    ...
                240 = /dev/ftlp         FTL on 16th Memory Technology Device

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the partition
                limit is 15 rather than 63 per disk (same as SCSI.)

  45 char       isdn4linux ISDN BRI driver
                  0 = /dev/isdn0        First virtual B channel raw data
                    ...
                 63 = /dev/isdn63       64th virtual B channel raw data
                 64 = /dev/isdnctrl0    First channel control/debug
                    ...
                127 = /dev/isdnctrl63   64th channel control/debug

                128 = /dev/ippp0        First SyncPPP device
                    ...
                191 = /dev/ippp63       64th SyncPPP device

                255 = /dev/isdninfo     ISDN monitor interface

  45 block      Parallel port IDE disk devices
                  0 = /dev/pda          First parallel port IDE disk
                 16 = /dev/pdb          Second parallel port IDE disk
                 32 = /dev/pdc          Third parallel port IDE disk
                 48 = /dev/pdd          Fourth parallel port IDE disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the partition
                limit is 15 rather than 63 per disk.

  46 char       Comtrol Rocketport serial card
                  0 = /dev/ttyR0        First Rocketport port
                  1 = /dev/ttyR1        Second Rocketport port
                    ...
  46 block      Parallel port ATAPI CD-ROM devices
                  0 = /dev/pcd0         First parallel port ATAPI CD-ROM
                  1 = /dev/pcd1         Second parallel port ATAPI CD-ROM
                  2 = /dev/pcd2         Third parallel port ATAPI CD-ROM
                  3 = /dev/pcd3         Fourth parallel port ATAPI CD-ROM

  47 char       Comtrol Rocketport serial card - alternate devices
                  0 = /dev/cur0         Callout device for ttyR0
                  1 = /dev/cur1         Callout device for ttyR1
                    ...
  47 block      Parallel port ATAPI disk devices
                  0 = /dev/pf0          First parallel port ATAPI disk
                  1 = /dev/pf1          Second parallel port ATAPI disk
                  2 = /dev/pf2          Third parallel port ATAPI disk
                  3 = /dev/pf3          Fourth parallel port ATAPI disk

                This driver is intended for floppy disks and similar
                devices and hence does not support partitioning.

  48 char       SDL RISCom serial card
                  0 = /dev/ttyL0        First RISCom port
                  1 = /dev/ttyL1        Second RISCom port
                    ...
  48 block      Mylex DAC960 PCI RAID controller; first controller
                  0 = /dev/rd/c0d0      First disk, whole disk
                  8 = /dev/rd/c0d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c0d31     32nd disk, whole disk

                For partitions add:
                  0 = /dev/rd/c?d?      Whole disk
                  1 = /dev/rd/c?d?p1    First partition
                    ...
                  7 = /dev/rd/c?d?p7    Seventh partition

  49 char       SDL RISCom serial card - alternate devices
                  0 = /dev/cul0         Callout device for ttyL0
                  1 = /dev/cul1         Callout device for ttyL1
                    ...
  49 block      Mylex DAC960 PCI RAID controller; second controller
                  0 = /dev/rd/c1d0      First disk, whole disk
                  8 = /dev/rd/c1d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c1d31     32nd disk, whole disk

                Partitions are handled as for major 48.

  50 char       Reserved for GLINT

  50 block      Mylex DAC960 PCI RAID controller; third controller
                  0 = /dev/rd/c2d0      First disk, whole disk
                  8 = /dev/rd/c2d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c2d31     32nd disk, whole disk

  51 char       Baycom radio modem OR Radio Tech BIM-XXX-RS232 radio modem
                  0 = /dev/bc0          First Baycom radio modem
                  1 = /dev/bc1          Second Baycom radio modem
                    ...
  51 block      Mylex DAC960 PCI RAID controller; fourth controller
                  0 = /dev/rd/c3d0      First disk, whole disk
                  8 = /dev/rd/c3d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c3d31     32nd disk, whole disk

                Partitions are handled as for major 48.

  52 char       Spellcaster DataComm/BRI ISDN card
                  0 = /dev/dcbri0       First DataComm card
                  1 = /dev/dcbri1       Second DataComm card
                  2 = /dev/dcbri2       Third DataComm card
                  3 = /dev/dcbri3       Fourth DataComm card

  52 block      Mylex DAC960 PCI RAID controller; fifth controller
                  0 = /dev/rd/c4d0      First disk, whole disk
                  8 = /dev/rd/c4d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c4d31     32nd disk, whole disk

                Partitions are handled as for major 48.

  53 char       BDM interface for remote debugging MC683xx microcontrollers
                  0 = /dev/pd\_bdm0      PD BDM interface on lp0
                  1 = /dev/pd\_bdm1      PD BDM interface on lp1
                  2 = /dev/pd\_bdm2      PD BDM interface on lp2
                  4 = /dev/icd\_bdm0     ICD BDM interface on lp0
                  5 = /dev/icd\_bdm1     ICD BDM interface on lp1
                  6 = /dev/icd\_bdm2     ICD BDM interface on lp2

                This device is used for the interfacing to the MC683xx
                microcontrollers via Background Debug Mode by use of a
                Parallel Port interface. PD is the Motorola Public
                Domain Interface and ICD is the commercial interface
                by P\&E.

  53 block      Mylex DAC960 PCI RAID controller; sixth controller
                  0 = /dev/rd/c5d0      First disk, whole disk
                  8 = /dev/rd/c5d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c5d31     32nd disk, whole disk

                Partitions are handled as for major 48.

  54 char       Electrocardiognosis Holter serial card
                  0 = /dev/holter0      First Holter port
                  1 = /dev/holter1      Second Holter port
                  2 = /dev/holter2      Third Holter port

                A custom serial card used by Electrocardiognosis SRL
                \textless{}mseritan@ottonel.pub.ro\textgreater{} to transfer data from Holter
                24-hour heart monitoring equipment.

  54 block      Mylex DAC960 PCI RAID controller; seventh controller
                  0 = /dev/rd/c6d0      First disk, whole disk
                  8 = /dev/rd/c6d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c6d31     32nd disk, whole disk

                Partitions are handled as for major 48.

  55 char       DSP56001 digital signal processor
                  0 = /dev/dsp56k       First DSP56001

  55 block      Mylex DAC960 PCI RAID controller; eighth controller
                  0 = /dev/rd/c7d0      First disk, whole disk
                  8 = /dev/rd/c7d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c7d31     32nd disk, whole disk

                Partitions are handled as for major 48.

  56 char       Apple Desktop Bus
                  0 = /dev/adb          ADB bus control

                Additional devices will be added to this number, all
                starting with /dev/adb.

  56 block      Fifth IDE hard disk/CD-ROM interface
                  0 = /dev/hdi          Master: whole disk (or CD-ROM)
                 64 = /dev/hdj          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  57 char       Hayes ESP serial card
                  0 = /dev/ttyP0        First ESP port
                  1 = /dev/ttyP1        Second ESP port
                    ...

  57 block      Sixth IDE hard disk/CD-ROM interface
                  0 = /dev/hdk          Master: whole disk (or CD-ROM)
                 64 = /dev/hdl          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  58 char       Hayes ESP serial card - alternate devices
                  0 = /dev/cup0         Callout device for ttyP0
                  1 = /dev/cup1         Callout device for ttyP1
                    ...

  58 block      Reserved for logical volume manager

  59 char       sf firewall package
                  0 = /dev/firewall     Communication with sf kernel module

  59 block      Generic PDA filesystem device
                  0 = /dev/pda0         First PDA device
                  1 = /dev/pda1         Second PDA device
                    ...

                The pda devices are used to mount filesystems on
                remote pda's (basically slow handheld machines with
                proprietary OS's and limited memory and storage
                running small fs translation drivers) through serial /
                IRDA / parallel links.

                NAMING CONFLICT -- PROPOSED REVISED NAME /dev/rpda0 etc

  60-63 char    LOCAL/EXPERIMENTAL USE

  60-63 block   LOCAL/EXPERIMENTAL USE
                Allocated for local/experimental use.  For devices not
                assigned official numbers, these ranges should be
                used in order to avoid conflicting with future assignments.

  64 char       ENskip kernel encryption package
                  0 = /dev/enskip       Communication with ENskip kernel module

  64 block      Scramdisk/DriveCrypt encrypted devices
                  0 = /dev/scramdisk/master    Master node for ioctls
                  1 = /dev/scramdisk/1         First encrypted device
                  2 = /dev/scramdisk/2         Second encrypted device
                  ...
                255 = /dev/scramdisk/255       255th encrypted device

                The filename of the encrypted container and the passwords
                are sent via ioctls (using the sdmount tool) to the master
                node which then activates them via one of the
                /dev/scramdisk/x nodes for loop mounting (all handled
                through the sdmount tool).

                Requested by: andy@scramdisklinux.org

  65 char       Sundance ``plink'' Transputer boards (obsolete, unused)
                  0 = /dev/plink0       First plink device
                  1 = /dev/plink1       Second plink device
                  2 = /dev/plink2       Third plink device
                  3 = /dev/plink3       Fourth plink device
                 64 = /dev/rplink0      First plink device, raw
                 65 = /dev/rplink1      Second plink device, raw
                 66 = /dev/rplink2      Third plink device, raw
                 67 = /dev/rplink3      Fourth plink device, raw
                128 = /dev/plink0d      First plink device, debug
                129 = /dev/plink1d      Second plink device, debug
                130 = /dev/plink2d      Third plink device, debug
                131 = /dev/plink3d      Fourth plink device, debug
                192 = /dev/rplink0d     First plink device, raw, debug
                193 = /dev/rplink1d     Second plink device, raw, debug
                194 = /dev/rplink2d     Third plink device, raw, debug
                195 = /dev/rplink3d     Fourth plink device, raw, debug

                This is a commercial driver; contact James Howes
                \textless{}jth@prosig.demon.co.uk\textgreater{} for information.

  65 block      SCSI disk devices (16-31)
                  0 = /dev/sdq          17th SCSI disk whole disk
                 16 = /dev/sdr          18th SCSI disk whole disk
                 32 = /dev/sds          19th SCSI disk whole disk
                    ...
                240 = /dev/sdaf         32nd SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  66 char       YARC PowerPC PCI coprocessor card
                  0 = /dev/yppcpci0     First YARC card
                  1 = /dev/yppcpci1     Second YARC card
                    ...

  66 block      SCSI disk devices (32-47)
                  0 = /dev/sdag         33th SCSI disk whole disk
                 16 = /dev/sdah         34th SCSI disk whole disk
                 32 = /dev/sdai         35th SCSI disk whole disk
                    ...
                240 = /dev/sdav         48nd SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  67 char       Coda network file system
                  0 = /dev/cfs0         Coda cache manager

                See http://www.coda.cs.cmu.edu for information about Coda.

  67 block      SCSI disk devices (48-63)
                  0 = /dev/sdaw         49th SCSI disk whole disk
                 16 = /dev/sdax         50th SCSI disk whole disk
                 32 = /dev/sday         51st SCSI disk whole disk
                    ...
                240 = /dev/sdbl         64th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  68 char       CAPI 2.0 interface
                  0 = /dev/capi20       Control device
                  1 = /dev/capi20.00    First CAPI 2.0 application
                  2 = /dev/capi20.01    Second CAPI 2.0 application
                    ...
                 20 = /dev/capi20.19    19th CAPI 2.0 application

                ISDN CAPI 2.0 driver for use with CAPI 2.0
                applications; currently supports the AVM B1 card.

  68 block      SCSI disk devices (64-79)
                  0 = /dev/sdbm         65th SCSI disk whole disk
                 16 = /dev/sdbn         66th SCSI disk whole disk
                 32 = /dev/sdbo         67th SCSI disk whole disk
                    ...
                240 = /dev/sdcb         80th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  69 char       MA16 numeric accelerator card
                  0 = /dev/ma16         Board memory access

  69 block      SCSI disk devices (80-95)
                  0 = /dev/sdcc         81st SCSI disk whole disk
                 16 = /dev/sdcd         82nd SCSI disk whole disk
                 32 = /dev/sdce         83th SCSI disk whole disk
                    ...
                240 = /dev/sdcr         96th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  70 char       SpellCaster Protocol Services Interface
                  0 = /dev/apscfg       Configuration interface
                  1 = /dev/apsauth      Authentication interface
                  2 = /dev/apslog       Logging interface
                  3 = /dev/apsdbg       Debugging interface
                 64 = /dev/apsisdn      ISDN command interface
                 65 = /dev/apsasync     Async command interface
                128 = /dev/apsmon       Monitor interface

  70 block      SCSI disk devices (96-111)
                  0 = /dev/sdcs         97th SCSI disk whole disk
                 16 = /dev/sdct         98th SCSI disk whole disk
                 32 = /dev/sdcu         99th SCSI disk whole disk
                    ...
                240 = /dev/sddh         112nd SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  71 char       Computone IntelliPort II serial card
                  0 = /dev/ttyF0        IntelliPort II board 0, port 0
                  1 = /dev/ttyF1        IntelliPort II board 0, port 1
                    ...
                 63 = /dev/ttyF63       IntelliPort II board 0, port 63
                 64 = /dev/ttyF64       IntelliPort II board 1, port 0
                 65 = /dev/ttyF65       IntelliPort II board 1, port 1
                    ...
                127 = /dev/ttyF127      IntelliPort II board 1, port 63
                128 = /dev/ttyF128      IntelliPort II board 2, port 0
                129 = /dev/ttyF129      IntelliPort II board 2, port 1
                    ...
                191 = /dev/ttyF191      IntelliPort II board 2, port 63
                192 = /dev/ttyF192      IntelliPort II board 3, port 0
                193 = /dev/ttyF193      IntelliPort II board 3, port 1
                    ...
                255 = /dev/ttyF255      IntelliPort II board 3, port 63

  71 block      SCSI disk devices (112-127)
                  0 = /dev/sddi         113th SCSI disk whole disk
                 16 = /dev/sddj         114th SCSI disk whole disk
                 32 = /dev/sddk         115th SCSI disk whole disk
                    ...
                240 = /dev/sddx         128th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  72 char       Computone IntelliPort II serial card - alternate devices
                  0 = /dev/cuf0         Callout device for ttyF0
                  1 = /dev/cuf1         Callout device for ttyF1
                    ...
                 63 = /dev/cuf63        Callout device for ttyF63
                 64 = /dev/cuf64        Callout device for ttyF64
                 65 = /dev/cuf65        Callout device for ttyF65
                    ...
                127 = /dev/cuf127       Callout device for ttyF127
                128 = /dev/cuf128       Callout device for ttyF128
                129 = /dev/cuf129       Callout device for ttyF129
                    ...
                191 = /dev/cuf191       Callout device for ttyF191
                192 = /dev/cuf192       Callout device for ttyF192
                193 = /dev/cuf193       Callout device for ttyF193
                    ...
                255 = /dev/cuf255       Callout device for ttyF255

  72 block      Compaq Intelligent Drive Array, first controller
                  0 = /dev/ida/c0d0     First logical drive whole disk
                 16 = /dev/ida/c0d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c0d15    16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

  73 char       Computone IntelliPort II serial card - control devices
                  0 = /dev/ip2ipl0      Loadware device for board 0
                  1 = /dev/ip2stat0     Status device for board 0
                  4 = /dev/ip2ipl1      Loadware device for board 1
                  5 = /dev/ip2stat1     Status device for board 1
                  8 = /dev/ip2ipl2      Loadware device for board 2
                  9 = /dev/ip2stat2     Status device for board 2
                 12 = /dev/ip2ipl3      Loadware device for board 3
                 13 = /dev/ip2stat3     Status device for board 3

  73 block      Compaq Intelligent Drive Array, second controller
                  0 = /dev/ida/c1d0     First logical drive whole disk
                 16 = /dev/ida/c1d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c1d15    16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

  74 char       SCI bridge
                  0 = /dev/SCI/0        SCI device 0
                  1 = /dev/SCI/1        SCI device 1
                    ...

                Currently for Dolphin Interconnect Solutions' PCI-SCI
                bridge.

  74 block      Compaq Intelligent Drive Array, third controller
                  0 = /dev/ida/c2d0     First logical drive whole disk
                 16 = /dev/ida/c2d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c2d15    16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

  75 char       Specialix IO8+ serial card
                  0 = /dev/ttyW0        First IO8+ port, first card
                  1 = /dev/ttyW1        Second IO8+ port, first card
                    ...
                  8 = /dev/ttyW8        First IO8+ port, second card
                    ...

  75 block      Compaq Intelligent Drive Array, fourth controller
                  0 = /dev/ida/c3d0     First logical drive whole disk
                 16 = /dev/ida/c3d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c3d15    16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

  76 char       Specialix IO8+ serial card - alternate devices
                  0 = /dev/cuw0         Callout device for ttyW0
                  1 = /dev/cuw1         Callout device for ttyW1
                    ...
                  8 = /dev/cuw8         Callout device for ttyW8
                    ...

  76 block      Compaq Intelligent Drive Array, fifth controller
                  0 = /dev/ida/c4d0     First logical drive whole disk
                 16 = /dev/ida/c4d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c4d15    16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.


  77 char       ComScire Quantum Noise Generator
                  0 = /dev/qng          ComScire Quantum Noise Generator

  77 block      Compaq Intelligent Drive Array, sixth controller
                  0 = /dev/ida/c5d0     First logical drive whole disk
                 16 = /dev/ida/c5d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c5d15    16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

  78 char       PAM Software's multimodem boards
                  0 = /dev/ttyM0        First PAM modem
                  1 = /dev/ttyM1        Second PAM modem
                    ...

  78 block      Compaq Intelligent Drive Array, seventh controller
                  0 = /dev/ida/c6d0     First logical drive whole disk
                 16 = /dev/ida/c6d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c6d15    16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

  79 char       PAM Software's multimodem boards - alternate devices
                  0 = /dev/cum0         Callout device for ttyM0
                  1 = /dev/cum1         Callout device for ttyM1
                    ...

  79 block      Compaq Intelligent Drive Array, eighth controller
                  0 = /dev/ida/c7d0     First logical drive whole disk
                 16 = /dev/ida/c7d1     Second logical drive whole disk
                    ...
                240 = /dev/ida/c715     16th logical drive whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

  80 char       Photometrics AT200 CCD camera
                  0 = /dev/at200        Photometrics AT200 CCD camera

  80 block      I2O hard disk
                  0 = /dev/i2o/hda      First I2O hard disk, whole disk
                 16 = /dev/i2o/hdb      Second I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hdp      16th I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  81 char       video4linux
                  0 = /dev/video0       Video capture/overlay device
                    ...
                 63 = /dev/video63      Video capture/overlay device
                 64 = /dev/radio0       Radio device
                    ...
                127 = /dev/radio63      Radio device
                128 = /dev/swradio0     Software Defined Radio device
                    ...
                191 = /dev/swradio63    Software Defined Radio device
                224 = /dev/vbi0         Vertical blank interrupt
                    ...
                255 = /dev/vbi31        Vertical blank interrupt

                Minor numbers are allocated dynamically unless
                CONFIG\_VIDEO\_FIXED\_MINOR\_RANGES (default n)
                configuration option is set.

  81 block      I2O hard disk
                  0 = /dev/i2o/hdq      17th I2O hard disk, whole disk
                 16 = /dev/i2o/hdr      18th I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hdaf     32nd I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  82 char       WiNRADiO communications receiver card
                  0 = /dev/winradio0    First WiNRADiO card
                  1 = /dev/winradio1    Second WiNRADiO card
                    ...

                The driver and documentation may be obtained from
                http://www.winradio.com/

  82 block      I2O hard disk
                  0 = /dev/i2o/hdag     33rd I2O hard disk, whole disk
                 16 = /dev/i2o/hdah     34th I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hdav     48th I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  83 char       Matrox mga\_vid video driver
                 0 = /dev/mga\_vid0      1st video card
                 1 = /dev/mga\_vid1      2nd video card
                 2 = /dev/mga\_vid2      3rd video card
                  ...
                15 = /dev/mga\_vid15     16th video card

  83 block      I2O hard disk
                  0 = /dev/i2o/hdaw     49th I2O hard disk, whole disk
                 16 = /dev/i2o/hdax     50th I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hdbl     64th I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  84 char       Ikon 1011{[}57{]} Versatec Greensheet Interface
                  0 = /dev/ihcp0        First Greensheet port
                  1 = /dev/ihcp1        Second Greensheet port

  84 block      I2O hard disk
                  0 = /dev/i2o/hdbm     65th I2O hard disk, whole disk
                 16 = /dev/i2o/hdbn     66th I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hdcb     80th I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  85 char       Linux/SGI shared memory input queue
                  0 = /dev/shmiq        Master shared input queue
                  1 = /dev/qcntl0       First device pushed
                  2 = /dev/qcntl1       Second device pushed
                    ...

  85 block      I2O hard disk
                  0 = /dev/i2o/hdcc     81st I2O hard disk, whole disk
                 16 = /dev/i2o/hdcd     82nd I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hdcr     96th I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  86 char       SCSI media changer
                  0 = /dev/sch0         First SCSI media changer
                  1 = /dev/sch1         Second SCSI media changer
                    ...

  86 block      I2O hard disk
                  0 = /dev/i2o/hdcs     97th I2O hard disk, whole disk
                 16 = /dev/i2o/hdct     98th I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hddh     112th I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  87 char       Sony Control-A1 stereo control bus
                  0 = /dev/controla0    First device on chain
                  1 = /dev/controla1    Second device on chain
                    ...

  87 block      I2O hard disk
                  0 = /dev/i2o/hddi     113rd I2O hard disk, whole disk
                 16 = /dev/i2o/hddj     114th I2O hard disk, whole disk
                    ...
                240 = /dev/i2o/hddx     128th I2O hard disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  88 char       COMX synchronous serial card
                  0 = /dev/comx0        COMX channel 0
                  1 = /dev/comx1        COMX channel 1
                    ...

  88 block      Seventh IDE hard disk/CD-ROM interface
                  0 = /dev/hdm          Master: whole disk (or CD-ROM)
                 64 = /dev/hdn          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  89 char       I2C bus interface
                  0 = /dev/i2c-0        First I2C adapter
                  1 = /dev/i2c-1        Second I2C adapter
                    ...

  89 block      Eighth IDE hard disk/CD-ROM interface
                  0 = /dev/hdo          Master: whole disk (or CD-ROM)
                 64 = /dev/hdp          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  90 char       Memory Technology Device (RAM, ROM, Flash)
                  0 = /dev/mtd0         First MTD (rw)
                  1 = /dev/mtdr0        First MTD (ro)
                    ...
                 30 = /dev/mtd15        16th MTD (rw)
                 31 = /dev/mtdr15       16th MTD (ro)

  90 block      Ninth IDE hard disk/CD-ROM interface
                  0 = /dev/hdq          Master: whole disk (or CD-ROM)
                 64 = /dev/hdr          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  91 char       CAN-Bus devices
                  0 = /dev/can0         First CAN-Bus controller
                  1 = /dev/can1         Second CAN-Bus controller
                    ...

  91 block      Tenth IDE hard disk/CD-ROM interface
                  0 = /dev/hds          Master: whole disk (or CD-ROM)
                 64 = /dev/hdt          Slave: whole disk (or CD-ROM)

                Partitions are handled the same way as for the first
                interface (see major number 3).

  92 char       Reserved for ith Kommunikationstechnik MIC ISDN card

  92 block      PPDD encrypted disk driver
                  0 = /dev/ppdd0        First encrypted disk
                  1 = /dev/ppdd1        Second encrypted disk
                    ...

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

  93 char

  93 block      NAND Flash Translation Layer filesystem
                  0 = /dev/nftla        First NFTL layer
                 16 = /dev/nftlb        Second NFTL layer
                    ...
                240 = /dev/nftlp        16th NTFL layer

  94 char

  94 block      IBM S/390 DASD block storage
                  0 = /dev/dasda First DASD device, major
                  1 = /dev/dasda1 First DASD device, block 1
                  2 = /dev/dasda2 First DASD device, block 2
                  3 = /dev/dasda3 First DASD device, block 3
                  4 = /dev/dasdb Second DASD device, major
                  5 = /dev/dasdb1 Second DASD device, block 1
                  6 = /dev/dasdb2 Second DASD device, block 2
                  7 = /dev/dasdb3 Second DASD device, block 3
                    ...

  95 char       IP filter
                  0 = /dev/ipl          Filter control device/log file
                  1 = /dev/ipnat        NAT control device/log file
                  2 = /dev/ipstate      State information log file
                  3 = /dev/ipauth       Authentication control device/log file
                    ...

  96 char       Parallel port ATAPI tape devices
                  0 = /dev/pt0          First parallel port ATAPI tape
                  1 = /dev/pt1          Second parallel port ATAPI tape
                    ...
                128 = /dev/npt0         First p.p. ATAPI tape, no rewind
                129 = /dev/npt1         Second p.p. ATAPI tape, no rewind
                    ...

  96 block      Inverse NAND Flash Translation Layer
                  0 = /dev/inftla First INFTL layer
                 16 = /dev/inftlb Second INFTL layer
                    ...
                240 = /dev/inftlp       16th INTFL layer

  97 char       Parallel port generic ATAPI interface
                  0 = /dev/pg0          First parallel port ATAPI device
                  1 = /dev/pg1          Second parallel port ATAPI device
                  2 = /dev/pg2          Third parallel port ATAPI device
                  3 = /dev/pg3          Fourth parallel port ATAPI device

                These devices support the same API as the generic SCSI
                devices.

  98 char       Control and Measurement Device (comedi)
                  0 = /dev/comedi0      First comedi device
                  1 = /dev/comedi1      Second comedi device
                    ...

                See http://stm.lbl.gov/comedi.

  98 block      User-mode virtual block device
                  0 = /dev/ubda         First user-mode block device
                 16 = /dev/udbb         Second user-mode block device
                    ...

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

                This device is used by the user-mode virtual kernel port.

  99 char       Raw parallel ports
                  0 = /dev/parport0     First parallel port
                  1 = /dev/parport1     Second parallel port
                    ...

  99 block      JavaStation flash disk
                  0 = /dev/jsfd         JavaStation flash disk

 100 char       Telephony for Linux
                  0 = /dev/phone0       First telephony device
                  1 = /dev/phone1       Second telephony device
                    ...

 101 char       Motorola DSP 56xxx board
                  0 = /dev/mdspstat     Status information
                  1 = /dev/mdsp1        First DSP board I/O controls
                    ...
                 16 = /dev/mdsp16       16th DSP board I/O controls

 101 block      AMI HyperDisk RAID controller
                  0 = /dev/amiraid/ar0  First array whole disk
                 16 = /dev/amiraid/ar1  Second array whole disk
                    ...
                240 = /dev/amiraid/ar15 16th array whole disk

                For each device, partitions are added as:
                  0 = /dev/amiraid/ar?    Whole disk
                  1 = /dev/amiraid/ar?p1  First partition
                  2 = /dev/amiraid/ar?p2  Second partition
                    ...
                 15 = /dev/amiraid/ar?p15 15th partition

 102 char

 102 block      Compressed block device
                  0 = /dev/cbd/a        First compressed block device, whole device
                 16 = /dev/cbd/b        Second compressed block device, whole device
                    ...
                240 = /dev/cbd/p        16th compressed block device, whole device

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 103 char       Arla network file system
                  0 = /dev/nnpfs0       First NNPFS device
                  1 = /dev/nnpfs1       Second NNPFS device

                Arla is a free clone of the Andrew File System, AFS.
                The NNPFS device gives user mode filesystem
                implementations a kernel presence for caching and easy
                mounting.  For more information about the project,
                write to \textless{}arla-drinkers@stacken.kth.se\textgreater{} or see
                http://www.stacken.kth.se/project/arla/

 103 block      Audit device
                  0 = /dev/audit        Audit device

 104 char       Flash BIOS support

 104 block      Compaq Next Generation Drive Array, first controller
                  0 = /dev/cciss/c0d0   First logical drive, whole disk
                 16 = /dev/cciss/c0d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c0d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 105 char       Comtrol VS-1000 serial controller
                  0 = /dev/ttyV0        First VS-1000 port
                  1 = /dev/ttyV1        Second VS-1000 port
                    ...

 105 block      Compaq Next Generation Drive Array, second controller
                  0 = /dev/cciss/c1d0   First logical drive, whole disk
                 16 = /dev/cciss/c1d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c1d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 106 char       Comtrol VS-1000 serial controller - alternate devices
                  0 = /dev/cuv0         First VS-1000 port
                  1 = /dev/cuv1         Second VS-1000 port
                    ...

 106 block      Compaq Next Generation Drive Array, third controller
                  0 = /dev/cciss/c2d0   First logical drive, whole disk
                 16 = /dev/cciss/c2d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c2d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 107 char       3Dfx Voodoo Graphics device
                  0 = /dev/3dfx         Primary 3Dfx graphics device

 107 block      Compaq Next Generation Drive Array, fourth controller
                  0 = /dev/cciss/c3d0   First logical drive, whole disk
                 16 = /dev/cciss/c3d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c3d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 108 char       Device independent PPP interface
                  0 = /dev/ppp          Device independent PPP interface

 108 block      Compaq Next Generation Drive Array, fifth controller
                  0 = /dev/cciss/c4d0   First logical drive, whole disk
                 16 = /dev/cciss/c4d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c4d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 109 char       Reserved for logical volume manager

 109 block      Compaq Next Generation Drive Array, sixth controller
                  0 = /dev/cciss/c5d0   First logical drive, whole disk
                 16 = /dev/cciss/c5d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c5d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 110 char       miroMEDIA Surround board
                  0 = /dev/srnd0        First miroMEDIA Surround board
                  1 = /dev/srnd1        Second miroMEDIA Surround board
                    ...

 110 block      Compaq Next Generation Drive Array, seventh controller
                  0 = /dev/cciss/c6d0   First logical drive, whole disk
                 16 = /dev/cciss/c6d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c6d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 111 char

 111 block      Compaq Next Generation Drive Array, eighth controller
                  0 = /dev/cciss/c7d0   First logical drive, whole disk
                 16 = /dev/cciss/c7d1   Second logical drive, whole disk
                    ...
                240 = /dev/cciss/c7d15  16th logical drive, whole disk

                Partitions are handled the same way as for Mylex
                DAC960 (see major number 48) except that the limit on
                partitions is 15.

 112 char       ISI serial card
                  0 = /dev/ttyM0        First ISI port
                  1 = /dev/ttyM1        Second ISI port
                    ...

                There is currently a device-naming conflict between
                these and PAM multimodems (major 78).

 112 block      IBM iSeries virtual disk
                  0 = /dev/iseries/vda  First virtual disk, whole disk
                  8 = /dev/iseries/vdb  Second virtual disk, whole disk
                    ...
                200 = /dev/iseries/vdz  26th virtual disk, whole disk
                208 = /dev/iseries/vdaa 27th virtual disk, whole disk
                    ...
                248 = /dev/iseries/vdaf 32nd virtual disk, whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 7.

 113 char       ISI serial card - alternate devices
                  0 = /dev/cum0         Callout device for ttyM0
                  1 = /dev/cum1         Callout device for ttyM1
                    ...

 113 block      IBM iSeries virtual CD-ROM
                  0 = /dev/iseries/vcda First virtual CD-ROM
                  1 = /dev/iseries/vcdb Second virtual CD-ROM
                    ...

 114 char       Picture Elements ISE board
                  0 = /dev/ise0         First ISE board
                  1 = /dev/ise1         Second ISE board
                    ...
                128 = /dev/isex0        Control node for first ISE board
                129 = /dev/isex1        Control node for second ISE board
                    ...

                The ISE board is an embedded computer, optimized for
                image processing. The /dev/iseN nodes are the general
                I/O access to the board, the /dev/isex0 nodes command
                nodes used to control the board.

 114 block       IDE BIOS powered software RAID interfaces such as the
                Promise Fastrak

                   0 = /dev/ataraid/d0
                   1 = /dev/ataraid/d0p1
                   2 = /dev/ataraid/d0p2
                  ...
                  16 = /dev/ataraid/d1
                  17 = /dev/ataraid/d1p1
                  18 = /dev/ataraid/d1p2
                  ...
                 255 = /dev/ataraid/d15p15

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 115 char       TI link cable devices (115 was formerly the console driver speaker)
                  0 = /dev/tipar0    Parallel cable on first parallel port
                  ...
                  7 = /dev/tipar7    Parallel cable on seventh parallel port

                  8 = /dev/tiser0    Serial cable on first serial port
                  ...
                 15 = /dev/tiser7    Serial cable on seventh serial port

                 16 = /dev/tiusb0    First USB cable
                  ...
                 47 = /dev/tiusb31   32nd USB cable

 115 block       NetWare (NWFS) Devices (0-255)

                The NWFS (NetWare) devices are used to present a
                collection of NetWare Mirror Groups or NetWare
                Partitions as a logical storage segment for
                use in mounting NetWare volumes.  A maximum of
                 256 NetWare volumes can be supported in a single
                machine.

                http://cgfa.telepac.pt/ftp2/kernel.org/linux/kernel/people/jmerkey/nwfs/

                 0 = /dev/nwfs/v0    First NetWare (NWFS) Logical Volume
                 1 = /dev/nwfs/v1    Second NetWare (NWFS) Logical Volume
                 2 = /dev/nwfs/v2    Third NetWare (NWFS) Logical Volume
                      ...
                 255 = /dev/nwfs/v255    Last NetWare (NWFS) Logical Volume

 116 char       Advanced Linux Sound Driver (ALSA)

 116 block       MicroMemory battery backed RAM adapter (NVRAM)
                Supports 16 boards, 15 partitions each.
                Requested by neilb at cse.unsw.edu.au.

                 0 = /dev/umem/d0      Whole of first board
                 1 = /dev/umem/d0p1    First partition of first board
                 2 = /dev/umem/d0p2    Second partition of first board
                15 = /dev/umem/d0p15   15th partition of first board

                16 = /dev/umem/d1      Whole of second board
                17 = /dev/umem/d1p1    First partition of second board
                    ...
                255= /dev/umem/d15p15  15th partition of 16th board.

 117 char       COSA/SRP synchronous serial card
                  0 = /dev/cosa0c0      1st board, 1st channel
                  1 = /dev/cosa0c1      1st board, 2nd channel
                    ...
                 16 = /dev/cosa1c0      2nd board, 1st channel
                 17 = /dev/cosa1c1      2nd board, 2nd channel
                    ...

 117 block       Enterprise Volume Management System (EVMS)

                The EVMS driver uses a layered, plug-in model to provide
                unparalleled flexibility and extensibility in managing
                storage.  This allows for easy expansion or customization
                of various levels of volume management.  Requested by
                Mark Peloquin (peloquin at us.ibm.com).

                Note: EVMS populates and manages all the devnodes in
                /dev/evms.

                http://sf.net/projects/evms

                   0 = /dev/evms/block\_device   EVMS block device
                   1 = /dev/evms/legacyname1    First EVMS legacy device
                   2 = /dev/evms/legacyname2    Second EVMS legacy device
                    ...
                    Both ranges can grow (down or up) until they meet.
                    ...
                 254 = /dev/evms/EVMSname2      Second EVMS native device
                 255 = /dev/evms/EVMSname1      First EVMS native device

                Note: legacyname(s) are derived from the normal legacy
                device names.  For example, /dev/hda5 would become
                /dev/evms/hda5.

 118 char       IBM Cryptographic Accelerator
                  0 = /dev/ica  Virtual interface to all IBM Crypto Accelerators
                  1 = /dev/ica0 IBMCA Device 0
                  2 = /dev/ica1 IBMCA Device 1
                    ...

 119 char       VMware virtual network control
                  0 = /dev/vnet0        1st virtual network
                  1 = /dev/vnet1        2nd virtual network
                    ...

 120-127 char   LOCAL/EXPERIMENTAL USE

 120-127 block  LOCAL/EXPERIMENTAL USE
                Allocated for local/experimental use.  For devices not
                assigned official numbers, these ranges should be
                used in order to avoid conflicting with future assignments.

 128-135 char   Unix98 PTY masters

                These devices should not have corresponding device
                nodes; instead they should be accessed through the
                /dev/ptmx cloning interface.

 128 block       SCSI disk devices (128-143)
                   0 = /dev/sddy         129th SCSI disk whole disk
                  16 = /dev/sddz         130th SCSI disk whole disk
                  32 = /dev/sdea         131th SCSI disk whole disk
                    ...
                 240 = /dev/sden         144th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 129 block       SCSI disk devices (144-159)
                   0 = /dev/sdeo         145th SCSI disk whole disk
                  16 = /dev/sdep         146th SCSI disk whole disk
                  32 = /dev/sdeq         147th SCSI disk whole disk
                    ...
                 240 = /dev/sdfd         160th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 130 char       (Misc devices)

 130 block       SCSI disk devices (160-175)
                   0 = /dev/sdfe         161st SCSI disk whole disk
                  16 = /dev/sdff         162nd SCSI disk whole disk
                  32 = /dev/sdfg         163rd SCSI disk whole disk
                    ...
                 240 = /dev/sdft         176th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 131 block       SCSI disk devices (176-191)
                   0 = /dev/sdfu         177th SCSI disk whole disk
                  16 = /dev/sdfv         178th SCSI disk whole disk
                  32 = /dev/sdfw         179th SCSI disk whole disk
                    ...
                 240 = /dev/sdgj         192nd SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 132 block       SCSI disk devices (192-207)
                   0 = /dev/sdgk         193rd SCSI disk whole disk
                  16 = /dev/sdgl         194th SCSI disk whole disk
                  32 = /dev/sdgm         195th SCSI disk whole disk
                    ...
                 240 = /dev/sdgz         208th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 133 block       SCSI disk devices (208-223)
                   0 = /dev/sdha         209th SCSI disk whole disk
                  16 = /dev/sdhb         210th SCSI disk whole disk
                  32 = /dev/sdhc         211th SCSI disk whole disk
                    ...
                 240 = /dev/sdhp         224th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 134 block       SCSI disk devices (224-239)
                   0 = /dev/sdhq         225th SCSI disk whole disk
                  16 = /dev/sdhr         226th SCSI disk whole disk
                  32 = /dev/sdhs         227th SCSI disk whole disk
                    ...
                 240 = /dev/sdif         240th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 135 block       SCSI disk devices (240-255)
                   0 = /dev/sdig         241st SCSI disk whole disk
                  16 = /dev/sdih         242nd SCSI disk whole disk
                  32 = /dev/sdih         243rd SCSI disk whole disk
                    ...
                 240 = /dev/sdiv         256th SCSI disk whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 136-143 char   Unix98 PTY slaves
                  0 = /dev/pts/0        First Unix98 pseudo-TTY
                  1 = /dev/pts/1        Second Unix98 pseudo-TTY
                    ...

                These device nodes are automatically generated with
                the proper permissions and modes by mounting the
                devpts filesystem onto /dev/pts with the appropriate
                mount options (distribution dependent, however, on
                *most* distributions the appropriate options are
                ``mode=0620,gid=\textless{}gid of the ``tty'' group\textgreater{}''.)

 136 block      Mylex DAC960 PCI RAID controller; ninth controller
                  0 = /dev/rd/c8d0      First disk, whole disk
                  8 = /dev/rd/c8d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c8d31     32nd disk, whole disk

                Partitions are handled as for major 48.

 137 block      Mylex DAC960 PCI RAID controller; tenth controller
                  0 = /dev/rd/c9d0      First disk, whole disk
                  8 = /dev/rd/c9d1      Second disk, whole disk
                    ...
                248 = /dev/rd/c9d31     32nd disk, whole disk

                Partitions are handled as for major 48.

 138 block      Mylex DAC960 PCI RAID controller; eleventh controller
                  0 = /dev/rd/c10d0     First disk, whole disk
                  8 = /dev/rd/c10d1     Second disk, whole disk
                    ...
                248 = /dev/rd/c10d31    32nd disk, whole disk

                Partitions are handled as for major 48.

 139 block      Mylex DAC960 PCI RAID controller; twelfth controller
                  0 = /dev/rd/c11d0     First disk, whole disk
                  8 = /dev/rd/c11d1     Second disk, whole disk
                    ...
                248 = /dev/rd/c11d31    32nd disk, whole disk

                Partitions are handled as for major 48.

 140 block      Mylex DAC960 PCI RAID controller; thirteenth controller
                  0 = /dev/rd/c12d0     First disk, whole disk
                  8 = /dev/rd/c12d1     Second disk, whole disk
                    ...
                248 = /dev/rd/c12d31    32nd disk, whole disk

                Partitions are handled as for major 48.

 141 block      Mylex DAC960 PCI RAID controller; fourteenth controller
                  0 = /dev/rd/c13d0     First disk, whole disk
                  8 = /dev/rd/c13d1     Second disk, whole disk
                    ...
                248 = /dev/rd/c13d31    32nd disk, whole disk

                Partitions are handled as for major 48.

 142 block      Mylex DAC960 PCI RAID controller; fifteenth controller
                  0 = /dev/rd/c14d0     First disk, whole disk
                  8 = /dev/rd/c14d1     Second disk, whole disk
                    ...
                248 = /dev/rd/c14d31    32nd disk, whole disk

                Partitions are handled as for major 48.

 143 block      Mylex DAC960 PCI RAID controller; sixteenth controller
                  0 = /dev/rd/c15d0     First disk, whole disk
                  8 = /dev/rd/c15d1     Second disk, whole disk
                    ...
                248 = /dev/rd/c15d31    32nd disk, whole disk

                Partitions are handled as for major 48.

 144 char       Encapsulated PPP
                  0 = /dev/pppox0       First PPP over Ethernet
                    ...
                 63 = /dev/pppox63      64th PPP over Ethernet

                This is primarily used for ADSL.

                The SST 5136-DN DeviceNet interface driver has been
                relocated to major 183 due to an unfortunate conflict.

 144 block      Expansion Area \#1 for more non-device (e.g. NFS) mounts
                  0 = mounted device 256
                255 = mounted device 511

 145 char       SAM9407-based soundcard
                  0 = /dev/sam0\_mixer
                  1 = /dev/sam0\_sequencer
                  2 = /dev/sam0\_midi00
                  3 = /dev/sam0\_dsp
                  4 = /dev/sam0\_audio
                  6 = /dev/sam0\_sndstat
                 18 = /dev/sam0\_midi01
                 34 = /dev/sam0\_midi02
                 50 = /dev/sam0\_midi03
                 64 = /dev/sam1\_mixer
                    ...
                128 = /dev/sam2\_mixer
                    ...
                192 = /dev/sam3\_mixer
                    ...

                Device functions match OSS, but offer a number of
                addons, which are sam9407 specific.  OSS can be
                operated simultaneously, taking care of the codec.

 145 block      Expansion Area \#2 for more non-device (e.g. NFS) mounts
                  0 = mounted device 512
                255 = mounted device 767

 146 char       SYSTRAM SCRAMNet mirrored-memory network
                  0 = /dev/scramnet0    First SCRAMNet device
                  1 = /dev/scramnet1    Second SCRAMNet device
                    ...

 146 block      Expansion Area \#3 for more non-device (e.g. NFS) mounts
                  0 = mounted device 768
                255 = mounted device 1023

 147 char       Aureal Semiconductor Vortex Audio device
                  0 = /dev/aureal0      First Aureal Vortex
                  1 = /dev/aureal1      Second Aureal Vortex
                    ...

 147 block      Distributed Replicated Block Device (DRBD)
                  0 = /dev/drbd0        First DRBD device
                  1 = /dev/drbd1        Second DRBD device
                    ...

 148 char       Technology Concepts serial card
                  0 = /dev/ttyT0        First TCL port
                  1 = /dev/ttyT1        Second TCL port
                    ...

 149 char       Technology Concepts serial card - alternate devices
                  0 = /dev/cut0         Callout device for ttyT0
                  1 = /dev/cut0         Callout device for ttyT1
                    ...

 150 char       Real-Time Linux FIFOs
                  0 = /dev/rtf0         First RTLinux FIFO
                  1 = /dev/rtf1         Second RTLinux FIFO
                    ...

 151 char       DPT I2O SmartRaid V controller
                  0 = /dev/dpti0        First DPT I2O adapter
                  1 = /dev/dpti1        Second DPT I2O adapter
                    ...

 152 char       EtherDrive Control Device
                  0 = /dev/etherd/ctl   Connect/Disconnect an EtherDrive
                  1 = /dev/etherd/err   Monitor errors
                  2 = /dev/etherd/raw   Raw AoE packet monitor

 152 block      EtherDrive Block Devices
                  0 = /dev/etherd/0     EtherDrive 0
                    ...
                255 = /dev/etherd/255   EtherDrive 255

 153 char       SPI Bus Interface (sometimes referred to as MicroWire)
                  0 = /dev/spi0         First SPI device on the bus
                  1 = /dev/spi1         Second SPI device on the bus
                    ...
                 15 = /dev/spi15        Sixteenth SPI device on the bus

 153 block      Enhanced Metadisk RAID (EMD) storage units
                  0 = /dev/emd/0        First unit
                  1 = /dev/emd/0p1      Partition 1 on First unit
                  2 = /dev/emd/0p2      Partition 2 on First unit
                    ...
                 15 = /dev/emd/0p15     Partition 15 on First unit

                 16 = /dev/emd/1        Second unit
                 32 = /dev/emd/2        Third unit
                    ...
                240 = /dev/emd/15       Sixteenth unit

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 154 char       Specialix RIO serial card
                  0 = /dev/ttySR0       First RIO port
                    ...
                255 = /dev/ttySR255     256th RIO port

 155 char       Specialix RIO serial card - alternate devices
                  0 = /dev/cusr0        Callout device for ttySR0
                    ...
                255 = /dev/cusr255      Callout device for ttySR255

 156 char       Specialix RIO serial card
                  0 = /dev/ttySR256     257th RIO port
                    ...
                255 = /dev/ttySR511     512th RIO port

 157 char       Specialix RIO serial card - alternate devices
                  0 = /dev/cusr256      Callout device for ttySR256
                    ...
                255 = /dev/cusr511      Callout device for ttySR511

 158 char       Dialogic GammaLink fax driver
                  0 = /dev/gfax0        GammaLink channel 0
                  1 = /dev/gfax1        GammaLink channel 1
                    ...

 159 char       RESERVED

 159 block      RESERVED

 160 char       General Purpose Instrument Bus (GPIB)
                  0 = /dev/gpib0        First GPIB bus
                  1 = /dev/gpib1        Second GPIB bus
                    ...

 160 block       Carmel 8-port SATA Disks on First Controller
                  0 = /dev/carmel/0     SATA disk 0 whole disk
                  1 = /dev/carmel/0p1   SATA disk 0 partition 1
                    ...
                 31 = /dev/carmel/0p31  SATA disk 0 partition 31

                 32 = /dev/carmel/1     SATA disk 1 whole disk
                 64 = /dev/carmel/2     SATA disk 2 whole disk
                    ...
                224 = /dev/carmel/7     SATA disk 7 whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 31.

 161 char       IrCOMM devices (IrDA serial/parallel emulation)
                  0 = /dev/ircomm0      First IrCOMM device
                  1 = /dev/ircomm1      Second IrCOMM device
                    ...
                 16 = /dev/irlpt0       First IrLPT device
                 17 = /dev/irlpt1       Second IrLPT device
                    ...

 161 block       Carmel 8-port SATA Disks on Second Controller
                  0 = /dev/carmel/8     SATA disk 8 whole disk
                  1 = /dev/carmel/8p1   SATA disk 8 partition 1
                    ...
                 31 = /dev/carmel/8p31  SATA disk 8 partition 31

                 32 = /dev/carmel/9     SATA disk 9 whole disk
                 64 = /dev/carmel/10    SATA disk 10 whole disk
                    ...
                224 = /dev/carmel/15    SATA disk 15 whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 31.

 162 char       Raw block device interface
                  0 = /dev/rawctl       Raw I/O control device
                  1 = /dev/raw/raw1     First raw I/O device
                  2 = /dev/raw/raw2     Second raw I/O device
                    ...
                 max minor number of raw device is set by kernel config
                 MAX\_RAW\_DEVS or raw module parameter `max\_raw\_devs'

 163 char

 164 char       Chase Research AT/PCI-Fast serial card
                  0 = /dev/ttyCH0       AT/PCI-Fast board 0, port 0
                    ...
                 15 = /dev/ttyCH15      AT/PCI-Fast board 0, port 15
                 16 = /dev/ttyCH16      AT/PCI-Fast board 1, port 0
                    ...
                 31 = /dev/ttyCH31      AT/PCI-Fast board 1, port 15
                 32 = /dev/ttyCH32      AT/PCI-Fast board 2, port 0
                    ...
                 47 = /dev/ttyCH47      AT/PCI-Fast board 2, port 15
                 48 = /dev/ttyCH48      AT/PCI-Fast board 3, port 0
                    ...
                 63 = /dev/ttyCH63      AT/PCI-Fast board 3, port 15

 165 char       Chase Research AT/PCI-Fast serial card - alternate devices
                  0 = /dev/cuch0        Callout device for ttyCH0
                    ...
                 63 = /dev/cuch63       Callout device for ttyCH63

 166 char       ACM USB modems
                  0 = /dev/ttyACM0      First ACM modem
                  1 = /dev/ttyACM1      Second ACM modem
                    ...

 167 char       ACM USB modems - alternate devices
                  0 = /dev/cuacm0       Callout device for ttyACM0
                  1 = /dev/cuacm1       Callout device for ttyACM1
                    ...

 168 char       Eracom CSA7000 PCI encryption adaptor
                  0 = /dev/ecsa0        First CSA7000
                  1 = /dev/ecsa1        Second CSA7000
                    ...

 169 char       Eracom CSA8000 PCI encryption adaptor
                  0 = /dev/ecsa8-0      First CSA8000
                  1 = /dev/ecsa8-1      Second CSA8000
                    ...

 170 char       AMI MegaRAC remote access controller
                  0 = /dev/megarac0     First MegaRAC card
                  1 = /dev/megarac1     Second MegaRAC card
                    ...

 171 char       Reserved for IEEE 1394 (Firewire)

 172 char       Moxa Intellio serial card
                  0 = /dev/ttyMX0       First Moxa port
                  1 = /dev/ttyMX1       Second Moxa port
                    ...
                127 = /dev/ttyMX127     128th Moxa port
                128 = /dev/moxactl      Moxa control port

 173 char       Moxa Intellio serial card - alternate devices
                  0 = /dev/cumx0        Callout device for ttyMX0
                  1 = /dev/cumx1        Callout device for ttyMX1
                    ...
                127 = /dev/cumx127      Callout device for ttyMX127

 174 char       SmartIO serial card
                  0 = /dev/ttySI0       First SmartIO port
                  1 = /dev/ttySI1       Second SmartIO port
                    ...

 175 char       SmartIO serial card - alternate devices
                  0 = /dev/cusi0        Callout device for ttySI0
                  1 = /dev/cusi1        Callout device for ttySI1
                    ...

 176 char       nCipher nFast PCI crypto accelerator
                  0 = /dev/nfastpci0    First nFast PCI device
                  1 = /dev/nfastpci1    First nFast PCI device
                    ...

 177 char       TI PCILynx memory spaces
                  0 = /dev/pcilynx/aux0  AUX space of first PCILynx card
                    ...
                 15 = /dev/pcilynx/aux15 AUX space of 16th PCILynx card
                 16 = /dev/pcilynx/rom0  ROM space of first PCILynx card
                    ...
                 31 = /dev/pcilynx/rom15 ROM space of 16th PCILynx card
                 32 = /dev/pcilynx/ram0  RAM space of first PCILynx card
                    ...
                 47 = /dev/pcilynx/ram15 RAM space of 16th PCILynx card

 178 char       Giganet cLAN1xxx virtual interface adapter
                  0 = /dev/clanvi0      First cLAN adapter
                  1 = /dev/clanvi1      Second cLAN adapter
                    ...

 179 block       MMC block devices
                  0 = /dev/mmcblk0      First SD/MMC card
                  1 = /dev/mmcblk0p1    First partition on first MMC card
                  8 = /dev/mmcblk1      Second SD/MMC card
                    ...

                The start of next SD/MMC card can be configured with
                CONFIG\_MMC\_BLOCK\_MINORS, or overridden at boot/modprobe
                time using the mmcblk.perdev\_minors option. That would
                bump the offset between each card to be the configured
                value instead of the default 8.

 179 char       CCube DVXChip-based PCI products
                  0 = /dev/dvxirq0      First DVX device
                  1 = /dev/dvxirq1      Second DVX device
                    ...

 180 char       USB devices
                  0 = /dev/usb/lp0      First USB printer
                    ...
                 15 = /dev/usb/lp15     16th USB printer
                 48 = /dev/usb/scanner0 First USB scanner
                    ...
                 63 = /dev/usb/scanner15 16th USB scanner
                 64 = /dev/usb/rio500   Diamond Rio 500
                 65 = /dev/usb/usblcd   USBLCD Interface (info@usblcd.de)
                 66 = /dev/usb/cpad0    Synaptics cPad (mouse/LCD)
                 96 = /dev/usb/hiddev0  1st USB HID device
                    ...
                111 = /dev/usb/hiddev15 16th USB HID device
                112 = /dev/usb/auer0    1st auerswald ISDN device
                    ...
                127 = /dev/usb/auer15   16th auerswald ISDN device
                128 = /dev/usb/brlvgr0  First Braille Voyager device
                    ...
                131 = /dev/usb/brlvgr3  Fourth Braille Voyager device
                132 = /dev/usb/idmouse  ID Mouse (fingerprint scanner) device
                133 = /dev/usb/sisusbvga1       First SiSUSB VGA device
                    ...
                140 = /dev/usb/sisusbvga8       Eighth SISUSB VGA device
                144 = /dev/usb/lcd      USB LCD device
                160 = /dev/usb/legousbtower0    1st USB Legotower device
                    ...
                175 = /dev/usb/legousbtower15   16th USB Legotower device
                176 = /dev/usb/usbtmc1  First USB TMC device
                   ...
                191 = /dev/usb/usbtmc16 16th USB TMC device
                192 = /dev/usb/yurex1   First USB Yurex device
                   ...
                209 = /dev/usb/yurex16  16th USB Yurex device

 180 block      USB block devices
                  0 = /dev/uba          First USB block device
                  8 = /dev/ubb          Second USB block device
                 16 = /dev/ubc          Third USB block device
                    ...

 181 char       Conrad Electronic parallel port radio clocks
                  0 = /dev/pcfclock0    First Conrad radio clock
                  1 = /dev/pcfclock1    Second Conrad radio clock
                    ...

 182 char       Picture Elements THR2 binarizer
                  0 = /dev/pethr0       First THR2 board
                  1 = /dev/pethr1       Second THR2 board
                    ...

 183 char       SST 5136-DN DeviceNet interface
                  0 = /dev/ss5136dn0    First DeviceNet interface
                  1 = /dev/ss5136dn1    Second DeviceNet interface
                    ...

                This device used to be assigned to major number 144.
                It had to be moved due to an unfortunate conflict.

 184 char       Picture Elements' video simulator/sender
                  0 = /dev/pevss0       First sender board
                  1 = /dev/pevss1       Second sender board
                    ...

 185 char       InterMezzo high availability file system
                  0 = /dev/intermezzo0  First cache manager
                  1 = /dev/intermezzo1  Second cache manager
                    ...

                See http://web.archive.org/web/20080115195241/
                http://inter-mezzo.org/index.html

 186 char       Object-based storage control device
                  0 = /dev/obd0         First obd control device
                  1 = /dev/obd1         Second obd control device
                    ...

                See ftp://ftp.lustre.org/pub/obd for code and information.

 187 char       DESkey hardware encryption device
                  0 = /dev/deskey0      First DES key
                  1 = /dev/deskey1      Second DES key
                    ...

 188 char       USB serial converters
                  0 = /dev/ttyUSB0      First USB serial converter
                  1 = /dev/ttyUSB1      Second USB serial converter
                    ...

 189 char       USB serial converters - alternate devices
                  0 = /dev/cuusb0       Callout device for ttyUSB0
                  1 = /dev/cuusb1       Callout device for ttyUSB1
                    ...

 190 char       Kansas City tracker/tuner card
                  0 = /dev/kctt0        First KCT/T card
                  1 = /dev/kctt1        Second KCT/T card
                    ...

 191 char       Reserved for PCMCIA

 192 char       Kernel profiling interface
                  0 = /dev/profile      Profiling control device
                  1 = /dev/profile0     Profiling device for CPU 0
                  2 = /dev/profile1     Profiling device for CPU 1
                    ...

 193 char       Kernel event-tracing interface
                  0 = /dev/trace        Tracing control device
                  1 = /dev/trace0       Tracing device for CPU 0
                  2 = /dev/trace1       Tracing device for CPU 1
                    ...

 194 char       linVideoStreams (LINVS)
                  0 = /dev/mvideo/status0       Video compression status
                  1 = /dev/mvideo/stream0       Video stream
                  2 = /dev/mvideo/frame0        Single compressed frame
                  3 = /dev/mvideo/rawframe0     Raw uncompressed frame
                  4 = /dev/mvideo/codec0        Direct codec access
                  5 = /dev/mvideo/video4linux0  Video4Linux compatibility

                 16 = /dev/mvideo/status1       Second device
                    ...
                 32 = /dev/mvideo/status2       Third device
                    ...
                    ...
                240 = /dev/mvideo/status15      16th device
                    ...

 195 char       Nvidia graphics devices
                  0 = /dev/nvidia0              First Nvidia card
                  1 = /dev/nvidia1              Second Nvidia card
                    ...
                255 = /dev/nvidiactl            Nvidia card control device

 196 char       Tormenta T1 card
                  0 = /dev/tor/0                Master control channel for all cards
                  1 = /dev/tor/1                First DS0
                  2 = /dev/tor/2                Second DS0
                    ...
                 48 = /dev/tor/48               48th DS0
                 49 = /dev/tor/49               First pseudo-channel
                 50 = /dev/tor/50               Second pseudo-channel
                    ...

 197 char       OpenTNF tracing facility
                  0 = /dev/tnf/t0               Trace 0 data extraction
                  1 = /dev/tnf/t1               Trace 1 data extraction
                    ...
                128 = /dev/tnf/status           Tracing facility status
                130 = /dev/tnf/trace            Tracing device

 198 char       Total Impact TPMP2 quad coprocessor PCI card
                  0 = /dev/tpmp2/0              First card
                  1 = /dev/tpmp2/1              Second card
                    ...

 199 char       Veritas volume manager (VxVM) volumes
                  0 = /dev/vx/rdsk/*/*          First volume
                  1 = /dev/vx/rdsk/*/*          Second volume
                    ...

 199 block      Veritas volume manager (VxVM) volumes
                  0 = /dev/vx/dsk/*/*           First volume
                  1 = /dev/vx/dsk/*/*           Second volume
                    ...

                The namespace in these directories is maintained by
                the user space VxVM software.

 200 char       Veritas VxVM configuration interface
                   0 = /dev/vx/config           Configuration access node
                   1 = /dev/vx/trace            Volume i/o trace access node
                   2 = /dev/vx/iod              Volume i/o daemon access node
                   3 = /dev/vx/info             Volume information access node
                   4 = /dev/vx/task             Volume tasks access node
                   5 = /dev/vx/taskmon          Volume tasks monitor daemon

 201 char       Veritas VxVM dynamic multipathing driver
                  0 = /dev/vx/rdmp/*            First multipath device
                  1 = /dev/vx/rdmp/*            Second multipath device
                    ...
 201 block      Veritas VxVM dynamic multipathing driver
                  0 = /dev/vx/dmp/*             First multipath device
                  1 = /dev/vx/dmp/*             Second multipath device
                    ...

                The namespace in these directories is maintained by
                the user space VxVM software.

 202 char       CPU model-specific registers
                  0 = /dev/cpu/0/msr            MSRs on CPU 0
                  1 = /dev/cpu/1/msr            MSRs on CPU 1
                    ...

 202 block      Xen Virtual Block Device
                  0 = /dev/xvda       First Xen VBD whole disk
                  16 = /dev/xvdb      Second Xen VBD whole disk
                  32 = /dev/xvdc      Third Xen VBD whole disk
                    ...
                  240 = /dev/xvdp     Sixteenth Xen VBD whole disk

                Partitions are handled in the same way as for IDE
                disks (see major number 3) except that the limit on
                partitions is 15.

 203 char       CPU CPUID information
                  0 = /dev/cpu/0/cpuid          CPUID on CPU 0
                  1 = /dev/cpu/1/cpuid          CPUID on CPU 1
                    ...

 204 char       Low-density serial ports
                  0 = /dev/ttyLU0               LinkUp Systems L72xx UART - port 0
                  1 = /dev/ttyLU1               LinkUp Systems L72xx UART - port 1
                  2 = /dev/ttyLU2               LinkUp Systems L72xx UART - port 2
                  3 = /dev/ttyLU3               LinkUp Systems L72xx UART - port 3
                  4 = /dev/ttyFB0               Intel Footbridge (ARM)
                  5 = /dev/ttySA0               StrongARM builtin serial port 0
                  6 = /dev/ttySA1               StrongARM builtin serial port 1
                  7 = /dev/ttySA2               StrongARM builtin serial port 2
                  8 = /dev/ttySC0               SCI serial port (SuperH) - port 0
                  9 = /dev/ttySC1               SCI serial port (SuperH) - port 1
                 10 = /dev/ttySC2               SCI serial port (SuperH) - port 2
                 11 = /dev/ttySC3               SCI serial port (SuperH) - port 3
                 12 = /dev/ttyFW0               Firmware console - port 0
                 13 = /dev/ttyFW1               Firmware console - port 1
                 14 = /dev/ttyFW2               Firmware console - port 2
                 15 = /dev/ttyFW3               Firmware console - port 3
                 16 = /dev/ttyAM0               ARM ``AMBA'' serial port 0
                    ...
                 31 = /dev/ttyAM15              ARM ``AMBA'' serial port 15
                 32 = /dev/ttyDB0               DataBooster serial port 0
                    ...
                 39 = /dev/ttyDB7               DataBooster serial port 7
                 40 = /dev/ttySG0               SGI Altix console port
                 41 = /dev/ttySMX0              Motorola i.MX - port 0
                 42 = /dev/ttySMX1              Motorola i.MX - port 1
                 43 = /dev/ttySMX2              Motorola i.MX - port 2
                 44 = /dev/ttyMM0               Marvell MPSC - port 0
                 45 = /dev/ttyMM1               Marvell MPSC - port 1
                 46 = /dev/ttyCPM0              PPC CPM (SCC or SMC) - port 0
                    ...
                 47 = /dev/ttyCPM5              PPC CPM (SCC or SMC) - port 5
                 50 = /dev/ttyIOC0              Altix serial card
                    ...
                 81 = /dev/ttyIOC31             Altix serial card
                 82 = /dev/ttyVR0               NEC VR4100 series SIU
                 83 = /dev/ttyVR1               NEC VR4100 series DSIU
                 84 = /dev/ttyIOC84             Altix ioc4 serial card
                    ...
                 115 = /dev/ttyIOC115           Altix ioc4 serial card
                 116 = /dev/ttySIOC0            Altix ioc3 serial card
                    ...
                 147 = /dev/ttySIOC31           Altix ioc3 serial card
                 148 = /dev/ttyPSC0             PPC PSC - port 0
                    ...
                 153 = /dev/ttyPSC5             PPC PSC - port 5
                 154 = /dev/ttyAT0              ATMEL serial port 0
                    ...
                 169 = /dev/ttyAT15             ATMEL serial port 15
                 170 = /dev/ttyNX0              Hilscher netX serial port 0
                    ...
                 185 = /dev/ttyNX15             Hilscher netX serial port 15
                 186 = /dev/ttyJ0               JTAG1 DCC protocol based serial port emulation
                 187 = /dev/ttyUL0              Xilinx uartlite - port 0
                    ...
                 190 = /dev/ttyUL3              Xilinx uartlite - port 3
                 191 = /dev/xvc0                Xen virtual console - port 0
                 192 = /dev/ttyPZ0              pmac\_zilog - port 0
                    ...
                 195 = /dev/ttyPZ3              pmac\_zilog - port 3
                 196 = /dev/ttyTX0              TX39/49 serial port 0
                    ...
                 204 = /dev/ttyTX7              TX39/49 serial port 7
                 205 = /dev/ttySC0              SC26xx serial port 0
                 206 = /dev/ttySC1              SC26xx serial port 1
                 207 = /dev/ttySC2              SC26xx serial port 2
                 208 = /dev/ttySC3              SC26xx serial port 3
                 209 = /dev/ttyMAX0             MAX3100 serial port 0
                 210 = /dev/ttyMAX1             MAX3100 serial port 1
                 211 = /dev/ttyMAX2             MAX3100 serial port 2
                 212 = /dev/ttyMAX3             MAX3100 serial port 3

 205 char       Low-density serial ports (alternate device)
                  0 = /dev/culu0                Callout device for ttyLU0
                  1 = /dev/culu1                Callout device for ttyLU1
                  2 = /dev/culu2                Callout device for ttyLU2
                  3 = /dev/culu3                Callout device for ttyLU3
                  4 = /dev/cufb0                Callout device for ttyFB0
                  5 = /dev/cusa0                Callout device for ttySA0
                  6 = /dev/cusa1                Callout device for ttySA1
                  7 = /dev/cusa2                Callout device for ttySA2
                  8 = /dev/cusc0                Callout device for ttySC0
                  9 = /dev/cusc1                Callout device for ttySC1
                 10 = /dev/cusc2                Callout device for ttySC2
                 11 = /dev/cusc3                Callout device for ttySC3
                 12 = /dev/cufw0                Callout device for ttyFW0
                 13 = /dev/cufw1                Callout device for ttyFW1
                 14 = /dev/cufw2                Callout device for ttyFW2
                 15 = /dev/cufw3                Callout device for ttyFW3
                 16 = /dev/cuam0                Callout device for ttyAM0
                    ...
                 31 = /dev/cuam15               Callout device for ttyAM15
                 32 = /dev/cudb0                Callout device for ttyDB0
                    ...
                 39 = /dev/cudb7                Callout device for ttyDB7
                 40 = /dev/cusg0                Callout device for ttySG0
                 41 = /dev/ttycusmx0            Callout device for ttySMX0
                 42 = /dev/ttycusmx1            Callout device for ttySMX1
                 43 = /dev/ttycusmx2            Callout device for ttySMX2
                 46 = /dev/cucpm0               Callout device for ttyCPM0
                    ...
                 49 = /dev/cucpm5               Callout device for ttyCPM5
                 50 = /dev/cuioc40              Callout device for ttyIOC40
                    ...
                 81 = /dev/cuioc431             Callout device for ttyIOC431
                 82 = /dev/cuvr0                Callout device for ttyVR0
                 83 = /dev/cuvr1                Callout device for ttyVR1

 206 char       OnStream SC-x0 tape devices
                  0 = /dev/osst0                First OnStream SCSI tape, mode 0
                  1 = /dev/osst1                Second OnStream SCSI tape, mode 0
                    ...
                 32 = /dev/osst0l               First OnStream SCSI tape, mode 1
                 33 = /dev/osst1l               Second OnStream SCSI tape, mode 1
                    ...
                 64 = /dev/osst0m               First OnStream SCSI tape, mode 2
                 65 = /dev/osst1m               Second OnStream SCSI tape, mode 2
                    ...
                 96 = /dev/osst0a               First OnStream SCSI tape, mode 3
                 97 = /dev/osst1a               Second OnStream SCSI tape, mode 3
                    ...
                128 = /dev/nosst0               No rewind version of /dev/osst0
                129 = /dev/nosst1               No rewind version of /dev/osst1
                    ...
                160 = /dev/nosst0l              No rewind version of /dev/osst0l
                161 = /dev/nosst1l              No rewind version of /dev/osst1l
                    ...
                192 = /dev/nosst0m              No rewind version of /dev/osst0m
                193 = /dev/nosst1m              No rewind version of /dev/osst1m
                    ...
                224 = /dev/nosst0a              No rewind version of /dev/osst0a
                225 = /dev/nosst1a              No rewind version of /dev/osst1a
                    ...

                The OnStream SC-x0 SCSI tapes do not support the
                standard SCSI SASD command set and therefore need
                their own driver ``osst''. Note that the IDE, USB (and
                maybe ParPort) versions may be driven via ide-scsi or
                usb-storage SCSI emulation and this osst device and
                driver as well.  The ADR-x0 drives are QIC-157
                compliant and don't need osst.

 207 char       Compaq ProLiant health feature indicate
                  0 = /dev/cpqhealth/cpqw       Redirector interface
                  1 = /dev/cpqhealth/crom       EISA CROM
                  2 = /dev/cpqhealth/cdt        Data Table
                  3 = /dev/cpqhealth/cevt       Event Log
                  4 = /dev/cpqhealth/casr       Automatic Server Recovery
                  5 = /dev/cpqhealth/cecc       ECC Memory
                  6 = /dev/cpqhealth/cmca       Machine Check Architecture
                  7 = /dev/cpqhealth/ccsm       Deprecated CDT
                  8 = /dev/cpqhealth/cnmi       NMI Handling
                  9 = /dev/cpqhealth/css        Sideshow Management
                 10 = /dev/cpqhealth/cram       CMOS interface
                 11 = /dev/cpqhealth/cpci       PCI IRQ interface

 208 char       User space serial ports
                  0 = /dev/ttyU0                First user space serial port
                  1 = /dev/ttyU1                Second user space serial port
                    ...

 209 char       User space serial ports (alternate devices)
                  0 = /dev/cuu0                 Callout device for ttyU0
                  1 = /dev/cuu1                 Callout device for ttyU1
                    ...

 210 char       SBE, Inc. sync/async serial card
                  0 = /dev/sbei/wxcfg0          Configuration device for board 0
                  1 = /dev/sbei/dld0            Download device for board 0
                  2 = /dev/sbei/wan00           WAN device, port 0, board 0
                  3 = /dev/sbei/wan01           WAN device, port 1, board 0
                  4 = /dev/sbei/wan02           WAN device, port 2, board 0
                  5 = /dev/sbei/wan03           WAN device, port 3, board 0
                  6 = /dev/sbei/wanc00          WAN clone device, port 0, board 0
                  7 = /dev/sbei/wanc01          WAN clone device, port 1, board 0
                  8 = /dev/sbei/wanc02          WAN clone device, port 2, board 0
                  9 = /dev/sbei/wanc03          WAN clone device, port 3, board 0
                 10 = /dev/sbei/wxcfg1          Configuration device for board 1
                 11 = /dev/sbei/dld1            Download device for board 1
                 12 = /dev/sbei/wan10           WAN device, port 0, board 1
                 13 = /dev/sbei/wan11           WAN device, port 1, board 1
                 14 = /dev/sbei/wan12           WAN device, port 2, board 1
                 15 = /dev/sbei/wan13           WAN device, port 3, board 1
                 16 = /dev/sbei/wanc10          WAN clone device, port 0, board 1
                 17 = /dev/sbei/wanc11          WAN clone device, port 1, board 1
                 18 = /dev/sbei/wanc12          WAN clone device, port 2, board 1
                 19 = /dev/sbei/wanc13          WAN clone device, port 3, board 1
                    ...

                Yes, each board is really spaced 10 (decimal) apart.

 211 char       Addinum CPCI1500 digital I/O card
                  0 = /dev/addinum/cpci1500/0   First CPCI1500 card
                  1 = /dev/addinum/cpci1500/1   Second CPCI1500 card
                    ...

 212 char       LinuxTV.org DVB driver subsystem
                  0 = /dev/dvb/adapter0/video0    first video decoder of first card
                  1 = /dev/dvb/adapter0/audio0    first audio decoder of first card
                  2 = /dev/dvb/adapter0/sec0      (obsolete/unused)
                  3 = /dev/dvb/adapter0/frontend0 first frontend device of first card
                  4 = /dev/dvb/adapter0/demux0    first demux device of first card
                  5 = /dev/dvb/adapter0/dvr0      first digital video recoder device of first card
                  6 = /dev/dvb/adapter0/ca0       first common access port of first card
                  7 = /dev/dvb/adapter0/net0      first network device of first card
                  8 = /dev/dvb/adapter0/osd0      first on-screen-display device of first card
                  9 = /dev/dvb/adapter0/video1    second video decoder of first card
                    ...
                 64 = /dev/dvb/adapter1/video0    first video decoder of second card
                    ...
                128 = /dev/dvb/adapter2/video0    first video decoder of third card
                    ...
                196 = /dev/dvb/adapter3/video0    first video decoder of fourth card

 216 char       Bluetooth RFCOMM TTY devices
                  0 = /dev/rfcomm0              First Bluetooth RFCOMM TTY device
                  1 = /dev/rfcomm1              Second Bluetooth RFCOMM TTY device
                    ...

 217 char       Bluetooth RFCOMM TTY devices (alternate devices)
                  0 = /dev/curf0                Callout device for rfcomm0
                  1 = /dev/curf1                Callout device for rfcomm1
                    ...

 218 char       The Logical Company bus Unibus/Qbus adapters
                  0 = /dev/logicalco/bci/0      First bus adapter
                  1 = /dev/logicalco/bci/1      First bus adapter
                    ...

 219 char       The Logical Company DCI-1300 digital I/O card
                  0 = /dev/logicalco/dci1300/0  First DCI-1300 card
                  1 = /dev/logicalco/dci1300/1  Second DCI-1300 card
                    ...

 220 char       Myricom Myrinet ``GM'' board
                  0 = /dev/myricom/gm0          First Myrinet GM board
                  1 = /dev/myricom/gmp0         First board ``root access''
                  2 = /dev/myricom/gm1          Second Myrinet GM board
                  3 = /dev/myricom/gmp1         Second board ``root access''
                    ...

 221 char       VME bus
                  0 = /dev/bus/vme/m0           First master image
                  1 = /dev/bus/vme/m1           Second master image
                  2 = /dev/bus/vme/m2           Third master image
                  3 = /dev/bus/vme/m3           Fourth master image
                  4 = /dev/bus/vme/s0           First slave image
                  5 = /dev/bus/vme/s1           Second slave image
                  6 = /dev/bus/vme/s2           Third slave image
                  7 = /dev/bus/vme/s3           Fourth slave image
                  8 = /dev/bus/vme/ctl          Control

                It is expected that all VME bus drivers will use the
                same interface.  For interface documentation see
                http://www.vmelinux.org/.

 224 char       A2232 serial card
                  0 = /dev/ttyY0                First A2232 port
                  1 = /dev/ttyY1                Second A2232 port
                    ...

 225 char       A2232 serial card (alternate devices)
                  0 = /dev/cuy0                 Callout device for ttyY0
                  1 = /dev/cuy1                 Callout device for ttyY1
                    ...

 226 char       Direct Rendering Infrastructure (DRI)
                  0 = /dev/dri/card0            First graphics card
                  1 = /dev/dri/card1            Second graphics card
                    ...

 227 char       IBM 3270 terminal Unix tty access
                  1 = /dev/3270/tty1            First 3270 terminal
                  2 = /dev/3270/tty2            Seconds 3270 terminal
                    ...

 228 char       IBM 3270 terminal block-mode access
                  0 = /dev/3270/tub             Controlling interface
                  1 = /dev/3270/tub1            First 3270 terminal
                  2 = /dev/3270/tub2            Second 3270 terminal
                    ...

 229 char       IBM iSeries/pSeries virtual console
                  0 = /dev/hvc0                 First console port
                  1 = /dev/hvc1                 Second console port
                    ...

 230 char       IBM iSeries virtual tape
                  0 = /dev/iseries/vt0          First virtual tape, mode 0
                  1 = /dev/iseries/vt1          Second virtual tape, mode 0
                    ...
                 32 = /dev/iseries/vt0l         First virtual tape, mode 1
                 33 = /dev/iseries/vt1l         Second virtual tape, mode 1
                    ...
                 64 = /dev/iseries/vt0m         First virtual tape, mode 2
                 65 = /dev/iseries/vt1m         Second virtual tape, mode 2
                    ...
                 96 = /dev/iseries/vt0a         First virtual tape, mode 3
                 97 = /dev/iseries/vt1a         Second virtual tape, mode 3
                      ...
                128 = /dev/iseries/nvt0         First virtual tape, mode 0, no rewind
                129 = /dev/iseries/nvt1         Second virtual tape, mode 0, no rewind
                    ...
                160 = /dev/iseries/nvt0l        First virtual tape, mode 1, no rewind
                161 = /dev/iseries/nvt1l        Second virtual tape, mode 1, no rewind
                    ...
                192 = /dev/iseries/nvt0m        First virtual tape, mode 2, no rewind
                193 = /dev/iseries/nvt1m        Second virtual tape, mode 2, no rewind
                    ...
                224 = /dev/iseries/nvt0a        First virtual tape, mode 3, no rewind
                225 = /dev/iseries/nvt1a        Second virtual tape, mode 3, no rewind
                    ...

                ``No rewind'' refers to the omission of the default
                automatic rewind on device close.  The MTREW or MTOFFL
                ioctl()'s can be used to rewind the tape regardless of
                the device used to access it.

 231 char       InfiniBand
                0 = /dev/infiniband/umad0
                1 = /dev/infiniband/umad1
                  ...
                63 = /dev/infiniband/umad63    63rd InfiniBandMad device
                64 = /dev/infiniband/issm0     First InfiniBand IsSM device
                65 = /dev/infiniband/issm1     Second InfiniBand IsSM device
                  ...
                127 = /dev/infiniband/issm63    63rd InfiniBand IsSM device
                128 = /dev/infiniband/uverbs0   First InfiniBand verbs device
                129 = /dev/infiniband/uverbs1   Second InfiniBand verbs device
                  ...
                159 = /dev/infiniband/uverbs31  31st InfiniBand verbs device

 232 char       Biometric Devices
                0 = /dev/biometric/sensor0/fingerprint  first fingerprint sensor on first device
                1 = /dev/biometric/sensor0/iris         first iris sensor on first device
                2 = /dev/biometric/sensor0/retina       first retina sensor on first device
                3 = /dev/biometric/sensor0/voiceprint   first voiceprint sensor on first device
                4 = /dev/biometric/sensor0/facial       first facial sensor on first device
                5 = /dev/biometric/sensor0/hand         first hand sensor on first device
                  ...
                10 = /dev/biometric/sensor1/fingerprint first fingerprint sensor on second device
                  ...
                20 = /dev/biometric/sensor2/fingerprint first fingerprint sensor on third device
                  ...

 233 char       PathScale InfiniPath interconnect
                0 = /dev/ipath        Primary device for programs (any unit)
                1 = /dev/ipath0       Access specifically to unit 0
                2 = /dev/ipath1       Access specifically to unit 1
                  ...
                4 = /dev/ipath3       Access specifically to unit 3
                129 = /dev/ipath\_sma    Device used by Subnet Management Agent
                130 = /dev/ipath\_diag   Device used by diagnostics programs

 234-254        char    RESERVED FOR DYNAMIC ASSIGNMENT
                Character devices that request a dynamic allocation of major number will
                take numbers starting from 254 and downward.

 240-254 block  LOCAL/EXPERIMENTAL USE
                Allocated for local/experimental use.  For devices not
                assigned official numbers, these ranges should be
                used in order to avoid conflicting with future assignments.

 255 char       RESERVED

 255 block      RESERVED

                This major is reserved to assist the expansion to a
                larger number space.  No device nodes with this major
                should ever be created on the filesystem.
                (This is probably not true anymore, but I'll leave it
                for now /Torben)

 ---LARGE MAJORS!!!!!---

 256 char       Equinox SST multi-port serial boards
                   0 = /dev/ttyEQ0      First serial port on first Equinox SST board
                 127 = /dev/ttyEQ127    Last serial port on first Equinox SST board
                 128 = /dev/ttyEQ128    First serial port on second Equinox SST board
                  ...
                1027 = /dev/ttyEQ1027   Last serial port on eighth Equinox SST board

 256 block      Resident Flash Disk Flash Translation Layer
                  0 = /dev/rfda         First RFD FTL layer
                 16 = /dev/rfdb         Second RFD FTL layer
                  ...
                240 = /dev/rfdp         16th RFD FTL layer

 257 char       Phoenix Technologies Cryptographic Services Driver
                  0 = /dev/ptlsec       Crypto Services Driver

 257 block      SSFDC Flash Translation Layer filesystem
                  0 = /dev/ssfdca       First SSFDC layer
                  8 = /dev/ssfdcb       Second SSFDC layer
                 16 = /dev/ssfdcc       Third SSFDC layer
                 24 = /dev/ssfdcd       4th SSFDC layer
                 32 = /dev/ssfdce       5th SSFDC layer
                 40 = /dev/ssfdcf       6th SSFDC layer
                 48 = /dev/ssfdcg       7th SSFDC layer
                 56 = /dev/ssfdch       8th SSFDC layer

 258 block      ROM/Flash read-only translation layer
                  0 = /dev/blockrom0    First ROM card's translation layer interface
                  1 = /dev/blockrom1    Second ROM card's translation layer interface
                  ...

 259 block      Block Extended Major
                  Used dynamically to hold additional partition minor
                  numbers and allow large numbers of partitions per device

 259 char       FPGA configuration interfaces
                  0 = /dev/icap0        First Xilinx internal configuration
                  1 = /dev/icap1        Second Xilinx internal configuration

 260 char       OSD (Object-based-device) SCSI Device
                  0 = /dev/osd0         First OSD Device
                  1 = /dev/osd1         Second OSD Device
                  ...
                  255 = /dev/osd255     256th OSD Device

 384-511 char   RESERVED FOR DYNAMIC ASSIGNMENT
                Character devices that request a dynamic allocation of major
                number will take numbers starting from 511 and downward,
                once the 234-254 range is full.

\end{alltt}


\section{Additional \texttt{/dev/} directory entries}
\label{admin-guide/devices:additional-dev-directory-entries}
This section details additional entries that should or may exist in
the /dev directory.  It is preferred that symbolic links use the same
form (absolute or relative) as is indicated here.  Links are
classified as ``hard'' or ``symbolic'' depending on the preferred type of
link; if possible, the indicated type of link should be used.


\subsection{Compulsory links}
\label{admin-guide/devices:compulsory-links}
These links should exist on all systems:

\begin{tabulary}{\linewidth}{|L|L|L|L|}
\hline

/dev/fd
 & 
/proc/self/fd
 & 
symbolic
 & 
File descriptors
\\
\hline
/dev/stdin
 & 
fd/0
 & 
symbolic
 & 
stdin file descriptor
\\
\hline
/dev/stdout
 & 
fd/1
 & 
symbolic
 & 
stdout file descriptor
\\
\hline
/dev/stderr
 & 
fd/2
 & 
symbolic
 & 
stderr file descriptor
\\
\hline
/dev/nfsd
 & 
socksys
 & 
symbolic
 & 
Required by iBCS-2
\\
\hline
/dev/X0R
 & 
null
 & 
symbolic
 & 
Required by iBCS-2
\\
\hline\end{tabulary}


Note: \code{/dev/X0R} is \textless{}letter X\textgreater{}-\textless{}digit 0\textgreater{}-\textless{}letter R\textgreater{}.


\subsection{Recommended links}
\label{admin-guide/devices:recommended-links}
It is recommended that these links exist on all systems:

\begin{tabulary}{\linewidth}{|L|L|L|L|}
\hline

/dev/core
 & 
/proc/kcore
 & 
symbolic
 & 
Backward compatibility
\\
\hline
/dev/ramdisk
 & 
ram0
 & 
symbolic
 & 
Backward compatibility
\\
\hline
/dev/ftape
 & 
qft0
 & 
symbolic
 & 
Backward compatibility
\\
\hline
/dev/bttv0
 & 
video0
 & 
symbolic
 & 
Backward compatibility
\\
\hline
/dev/radio
 & 
radio0
 & 
symbolic
 & 
Backward compatibility
\\
\hline
/dev/i2o*
 & 
/dev/i2o/*
 & 
symbolic
 & 
Backward compatibility
\\
\hline
/dev/scd?
 & 
sr?
 & 
hard
 & 
Alternate SCSI CD-ROM name
\\
\hline\end{tabulary}



\subsection{Locally defined links}
\label{admin-guide/devices:locally-defined-links}
The following links may be established locally to conform to the
configuration of the system.  This is merely a tabulation of existing
practice, and does not constitute a recommendation.  However, if they
exist, they should have the following uses.

\begin{tabulary}{\linewidth}{|L|L|L|L|}
\hline

/dev/mouse
 & 
mouse port
 & 
symbolic
 & 
Current mouse device
\\
\hline
/dev/tape
 & 
tape device
 & 
symbolic
 & 
Current tape device
\\
\hline
/dev/cdrom
 & 
CD-ROM device
 & 
symbolic
 & 
Current CD-ROM device
\\
\hline
/dev/cdwriter
 & 
CD-writer
 & 
symbolic
 & 
Current CD-writer device
\\
\hline
/dev/scanner
 & 
scanner
 & 
symbolic
 & 
Current scanner device
\\
\hline
/dev/modem
 & 
modem port
 & 
symbolic
 & 
Current dialout device
\\
\hline
/dev/root
 & 
root device
 & 
symbolic
 & 
Current root filesystem
\\
\hline
/dev/swap
 & 
swap device
 & 
symbolic
 & 
Current swap device
\\
\hline\end{tabulary}


\code{/dev/modem} should not be used for a modem which supports dialin as
well as dialout, as it tends to cause lock file problems.  If it
exists, \code{/dev/modem} should point to the appropriate primary TTY device
(the use of the alternate callout devices is deprecated).

For SCSI devices, \code{/dev/tape} and \code{/dev/cdrom} should point to the
\emph{cooked} devices (\code{/dev/st*} and \code{/dev/sr*}, respectively), whereas
\code{/dev/cdwriter} and /dev/scanner should point to the appropriate generic
SCSI devices (/dev/sg*).

\code{/dev/mouse} may point to a primary serial TTY device, a hardware mouse
device, or a socket for a mouse driver program (e.g. \code{/dev/gpmdata}).


\subsection{Sockets and pipes}
\label{admin-guide/devices:sockets-and-pipes}
Non-transient sockets and named pipes may exist in /dev.  Common entries are:

\begin{tabulary}{\linewidth}{|L|L|L|}
\hline

/dev/printer
 & 
socket
 & 
lpd local socket
\\
\hline
/dev/log
 & 
socket
 & 
syslog local socket
\\
\hline
/dev/gpmdata
 & 
socket
 & 
gpm mouse multiplexer
\\
\hline\end{tabulary}



\subsection{Mount points}
\label{admin-guide/devices:mount-points}
The following names are reserved for mounting special filesystems
under /dev.  These special filesystems provide kernel interfaces that
cannot be provided with standard device nodes.

\begin{tabulary}{\linewidth}{|L|L|L|}
\hline

/dev/pts
 & 
devpts
 & 
PTY slave filesystem
\\
\hline
/dev/shm
 & 
tmpfs
 & 
POSIX shared memory maintenance access
\\
\hline\end{tabulary}



\section{Terminal devices}
\label{admin-guide/devices:terminal-devices}
Terminal, or TTY devices are a special class of character devices.  A
terminal device is any device that could act as a controlling terminal
for a session; this includes virtual consoles, serial ports, and
pseudoterminals (PTYs).

All terminal devices share a common set of capabilities known as line
disciplines; these include the common terminal line discipline as well
as SLIP and PPP modes.

All terminal devices are named similarly; this section explains the
naming and use of the various types of TTYs.  Note that the naming
conventions include several historical warts; some of these are
Linux-specific, some were inherited from other systems, and some
reflect Linux outgrowing a borrowed convention.

A hash mark (\code{\#}) in a device name is used here to indicate a decimal
number without leading zeroes.


\subsection{Virtual consoles and the console device}
\label{admin-guide/devices:virtual-consoles-and-the-console-device}
Virtual consoles are full-screen terminal displays on the system video
monitor.  Virtual consoles are named \code{/dev/tty\#}, with numbering
starting at \code{/dev/tty1}; \code{/dev/tty0} is the current virtual console.
\code{/dev/tty0} is the device that should be used to access the system video
card on those architectures for which the frame buffer devices
(\code{/dev/fb*}) are not applicable. Do not use \code{/dev/console}
for this purpose.

The console device, \code{/dev/console}, is the device to which system
messages should be sent, and on which logins should be permitted in
single-user mode.  Starting with Linux 2.1.71, \code{/dev/console} is managed
by the kernel; for previous versions it should be a symbolic link to
either \code{/dev/tty0}, a specific virtual console such as \code{/dev/tty1}, or to
a serial port primary (\code{tty*}, not \code{cu*}) device, depending on the
configuration of the system.


\subsection{Serial ports}
\label{admin-guide/devices:serial-ports}
Serial ports are RS-232 serial ports and any device which simulates
one, either in hardware (such as internal modems) or in software (such
as the ISDN driver.)  Under Linux, each serial ports has two device
names, the primary or callin device and the alternate or callout one.
Each kind of device is indicated by a different letter.  For any
letter X, the names of the devices are \code{/dev/ttyX\#} and \code{/dev/cux\#},
respectively; for historical reasons, \code{/dev/ttyS\#} and \code{/dev/ttyC\#}
correspond to \code{/dev/cua\#} and \code{/dev/cub\#}. In the future, it should be
expected that multiple letters will be used; all letters will be upper
case for the ``tty'' device (e.g. \code{/dev/ttyDP\#}) and lower case for the
``cu'' device (e.g. \code{/dev/cudp\#}).

The names \code{/dev/ttyQ\#} and \code{/dev/cuq\#} are reserved for local use.

The alternate devices provide for kernel-based exclusion and somewhat
different defaults than the primary devices.  Their main purpose is to
allow the use of serial ports with programs with no inherent or broken
support for serial ports.  Their use is deprecated, and they may be
removed from a future version of Linux.

Arbitration of serial ports is provided by the use of lock files with
the names \code{/var/lock/LCK..ttyX\#}. The contents of the lock file should
be the PID of the locking process as an ASCII number.

It is common practice to install links such as /dev/modem
which point to serial ports.  In order to ensure proper locking in the
presence of these links, it is recommended that software chase
symlinks and lock all possible names; additionally, it is recommended
that a lock file be installed with the corresponding alternate
device.  In order to avoid deadlocks, it is recommended that the locks
are acquired in the following order, and released in the reverse:
\begin{enumerate}
\item {} 
The symbolic link name, if any (\code{/var/lock/LCK..modem})

\item {} 
The ``tty'' name (\code{/var/lock/LCK..ttyS2})

\item {} 
The alternate device name (\code{/var/lock/LCK..cua2})

\end{enumerate}

In the case of nested symbolic links, the lock files should be
installed in the order the symlinks are resolved.

Under no circumstances should an application hold a lock while waiting
for another to be released.  In addition, applications which attempt
to create lock files for the corresponding alternate device names
should take into account the possibility of being used on a non-serial
port TTY, for which no alternate device would exist.


\subsection{Pseudoterminals (PTYs)}
\label{admin-guide/devices:pseudoterminals-ptys}
Pseudoterminals, or PTYs, are used to create login sessions or provide
other capabilities requiring a TTY line discipline (including SLIP or
PPP capability) to arbitrary data-generation processes.  Each PTY has
a master side, named \code{/dev/pty{[}p-za-e{]}{[}0-9a-f{]}}, and a slave side, named
\code{/dev/tty{[}p-za-e{]}{[}0-9a-f{]}}.  The kernel arbitrates the use of PTYs by
allowing each master side to be opened only once.

Once the master side has been opened, the corresponding slave device
can be used in the same manner as any TTY device.  The master and
slave devices are connected by the kernel, generating the equivalent
of a bidirectional pipe with TTY capabilities.

Recent versions of the Linux kernels and GNU libc contain support for
the System V/Unix98 naming scheme for PTYs, which assigns a common
device, \code{/dev/ptmx}, to all the masters (opening it will automatically
give you a previously unassigned PTY) and a subdirectory, \code{/dev/pts},
for the slaves; the slaves are named with decimal integers (\code{/dev/pts/\#}
in our notation).  This removes the problem of exhausting the
namespace and enables the kernel to automatically create the device
nodes for the slaves on demand using the ``devpts'' filesystem.

Here is a set of documents aimed at users who are trying to track down
problems and bugs in particular.


\chapter{Reporting bugs}
\label{admin-guide/reporting-bugs:reporting-bugs}\label{admin-guide/reporting-bugs:reportingbugs}\label{admin-guide/reporting-bugs::doc}

\section{Background}
\label{admin-guide/reporting-bugs:background}
The upstream Linux kernel maintainers only fix bugs for specific kernel
versions.  Those versions include the current ``release candidate'' (or -rc)
kernel, any ``stable'' kernel versions, and any ``long term'' kernels.

Please see \href{https://www.kernel.org/}{https://www.kernel.org/} for a list of supported kernels.  Any
kernel marked with {[}EOL{]} is ``end of life'' and will not have any fixes
backported to it.

If you've found a bug on a kernel version that isn't listed on kernel.org,
contact your Linux distribution or embedded vendor for support.
Alternatively, you can attempt to run one of the supported stable or -rc
kernels, and see if you can reproduce the bug on that.  It's preferable
to reproduce the bug on the latest -rc kernel.


\section{How to report Linux kernel bugs}
\label{admin-guide/reporting-bugs:how-to-report-linux-kernel-bugs}

\subsection{Identify the problematic subsystem}
\label{admin-guide/reporting-bugs:identify-the-problematic-subsystem}
Identifying which part of the Linux kernel might be causing your issue
increases your chances of getting your bug fixed. Simply posting to the
generic linux-kernel mailing list (LKML) may cause your bug report to be
lost in the noise of a mailing list that gets 1000+ emails a day.

Instead, try to figure out which kernel subsystem is causing the issue,
and email that subsystem's maintainer and mailing list.  If the subsystem
maintainer doesn't answer, then expand your scope to mailing lists like
LKML.


\subsection{Identify who to notify}
\label{admin-guide/reporting-bugs:identify-who-to-notify}
Once you know the subsystem that is causing the issue, you should send a
bug report.  Some maintainers prefer bugs to be reported via bugzilla
(\href{https://bugzilla.kernel.org}{https://bugzilla.kernel.org}), while others prefer that bugs be reported
via the subsystem mailing list.

To find out where to send an emailed bug report, find your subsystem or
device driver in the MAINTAINERS file.  Search in the file for relevant
entries, and send your bug report to the person(s) listed in the ``M:''
lines, making sure to Cc the mailing list(s) in the ``L:'' lines.  When the
maintainer replies to you, make sure to `Reply-all' in order to keep the
public mailing list(s) in the email thread.

If you know which driver is causing issues, you can pass one of the driver
files to the get\_maintainer.pl script:

\begin{Verbatim}[commandchars=\\\{\}]
perl scripts/get\PYGZus{}maintainer.pl \PYGZhy{}f \PYGZlt{}filename\PYGZgt{}
\end{Verbatim}

If it is a security bug, please copy the Security Contact listed in the
MAINTAINERS file.  They can help coordinate bugfix and disclosure.  See
{\hyperref[admin\string-guide/security\string-bugs:securitybugs]{\emph{Documentation/admin-guide/security-bugs.rst}}} for more information.

If you can't figure out which subsystem caused the issue, you should file
a bug in kernel.org bugzilla and send email to
\href{mailto:linux-kernel@vger.kernel.org}{linux-kernel@vger.kernel.org}, referencing the bugzilla URL.  (For more
information on the linux-kernel mailing list see
\href{http://www.tux.org/lkml/}{http://www.tux.org/lkml/}).


\subsection{Tips for reporting bugs}
\label{admin-guide/reporting-bugs:tips-for-reporting-bugs}
If you haven't reported a bug before, please read:
\begin{quote}

\href{http://www.chiark.greenend.org.uk/~sgtatham/bugs.html}{http://www.chiark.greenend.org.uk/\textasciitilde{}sgtatham/bugs.html}

\href{http://www.catb.org/esr/faqs/smart-questions.html}{http://www.catb.org/esr/faqs/smart-questions.html}
\end{quote}

It's REALLY important to report bugs that seem unrelated as separate email
threads or separate bugzilla entries.  If you report several unrelated
bugs at once, it's difficult for maintainers to tease apart the relevant
data.


\subsection{Gather information}
\label{admin-guide/reporting-bugs:gather-information}
The most important information in a bug report is how to reproduce the
bug.  This includes system information, and (most importantly)
step-by-step instructions for how a user can trigger the bug.

If the failure includes an ``OOPS:'', take a picture of the screen, capture
a netconsole trace, or type the message from your screen into the bug
report.  Please read ``Documentation/admin-guide/bug-hunting.rst'' before posting your
bug report. This explains what you should do with the ``Oops'' information
to make it useful to the recipient.

This is a suggested format for a bug report sent via email or bugzilla.
Having a standardized bug report form makes it easier for you not to
overlook things, and easier for the developers to find the pieces of
information they're really interested in.  If some information is not
relevant to your bug, feel free to exclude it.

First run the ver\_linux script included as scripts/ver\_linux, which
reports the version of some important subsystems.  Run this script with
the command \code{awk -f scripts/ver\_linux}.

Use that information to fill in all fields of the bug report form, and
post it to the mailing list with a subject of ``PROBLEM: \textless{}one line
summary from {[}1.{]}\textgreater{}'' for easy identification by the developers:

\begin{Verbatim}[commandchars=\\\{\}]
[1.] One line summary of the problem:
[2.] Full description of the problem/report:
[3.] Keywords (i.e., modules, networking, kernel):
[4.] Kernel information
[4.1.] Kernel version (from /proc/version):
[4.2.] Kernel .config file:
[5.] Most recent kernel version which did not have the bug:
[6.] Output of Oops.. message (if applicable) with symbolic information
     resolved (see Documentation/admin\PYGZhy{}guide/bug\PYGZhy{}hunting.rst)
[7.] A small shell script or example program which triggers the
     problem (if possible)
[8.] Environment
[8.1.] Software (add the output of the ver\PYGZus{}linux script here)
[8.2.] Processor information (from /proc/cpuinfo):
[8.3.] Module information (from /proc/modules):
[8.4.] Loaded driver and hardware information (/proc/ioports, /proc/iomem)
[8.5.] PCI information (\PYGZsq{}lspci \PYGZhy{}vvv\PYGZsq{} as root)
[8.6.] SCSI information (from /proc/scsi/scsi)
[8.7.] Other information that might be relevant to the problem
       (please look in /proc and include all information that you
       think to be relevant):
[X.] Other notes, patches, fixes, workarounds:
\end{Verbatim}


\section{Follow up}
\label{admin-guide/reporting-bugs:follow-up}

\subsection{Expectations for bug reporters}
\label{admin-guide/reporting-bugs:expectations-for-bug-reporters}
Linux kernel maintainers expect bug reporters to be able to follow up on
bug reports.  That may include running new tests, applying patches,
recompiling your kernel, and/or re-triggering your bug.  The most
frustrating thing for maintainers is for someone to report a bug, and then
never follow up on a request to try out a fix.

That said, it's still useful for a kernel maintainer to know a bug exists
on a supported kernel, even if you can't follow up with retests.  Follow
up reports, such as replying to the email thread with ``I tried the latest
kernel and I can't reproduce my bug anymore'' are also helpful, because
maintainers have to assume silence means things are still broken.


\subsection{Expectations for kernel maintainers}
\label{admin-guide/reporting-bugs:expectations-for-kernel-maintainers}
Linux kernel maintainers are busy, overworked human beings.  Some times
they may not be able to address your bug in a day, a week, or two weeks.
If they don't answer your email, they may be on vacation, or at a Linux
conference.  Check the conference schedule at \href{https://LWN.net}{https://LWN.net} for more info:
\begin{quote}

\href{https://lwn.net/Calendar/}{https://lwn.net/Calendar/}
\end{quote}

In general, kernel maintainers take 1 to 5 business days to respond to
bugs.  The majority of kernel maintainers are employed to work on the
kernel, and they may not work on the weekends.  Maintainers are scattered
around the world, and they may not work in your time zone.  Unless you
have a high priority bug, please wait at least a week after the first bug
report before sending the maintainer a reminder email.

The exceptions to this rule are regressions, kernel crashes, security holes,
or userspace breakage caused by new kernel behavior.  Those bugs should be
addressed by the maintainers ASAP.  If you suspect a maintainer is not
responding to these types of bugs in a timely manner (especially during a
merge window), escalate the bug to LKML and Linus Torvalds.

Thank you!

{[}Some of this is taken from Frohwalt Egerer's original linux-kernel FAQ{]}


\chapter{Security bugs}
\label{admin-guide/security-bugs:securitybugs}\label{admin-guide/security-bugs::doc}\label{admin-guide/security-bugs:security-bugs}
Linux kernel developers take security very seriously.  As such, we'd
like to know when a security bug is found so that it can be fixed and
disclosed as quickly as possible.  Please report security bugs to the
Linux kernel security team.


\section{Contact}
\label{admin-guide/security-bugs:contact}
The Linux kernel security team can be contacted by email at
\textless{}\href{mailto:security@kernel.org}{security@kernel.org}\textgreater{}.  This is a private list of security officers
who will help verify the bug report and develop and release a fix.
If you already have a fix, please include it with your report, as
that can speed up the process considerably.  It is possible that the
security team will bring in extra help from area maintainers to
understand and fix the security vulnerability.

As it is with any bug, the more information provided the easier it
will be to diagnose and fix.  Please review the procedure outlined in
admin-guide/reporting-bugs.rst if you are unclear about what
information is helpful.  Any exploit code is very helpful and will not
be released without consent from the reporter unless it has already been
made public.


\section{Disclosure}
\label{admin-guide/security-bugs:disclosure}
The goal of the Linux kernel security team is to work with the
bug submitter to bug resolution as well as disclosure.  We prefer
to fully disclose the bug as soon as possible.  It is reasonable to
delay disclosure when the bug or the fix is not yet fully understood,
the solution is not well-tested or for vendor coordination.  However, we
expect these delays to be short, measurable in days, not weeks or months.
A disclosure date is negotiated by the security team working with the
bug submitter as well as vendors.  However, the kernel security team
holds the final say when setting a disclosure date.  The timeframe for
disclosure is from immediate (esp. if it's already publicly known)
to a few weeks.  As a basic default policy, we expect report date to
disclosure date to be on the order of 7 days.


\section{Coordination}
\label{admin-guide/security-bugs:coordination}
Fixes for sensitive bugs, such as those that might lead to privilege
escalations, may need to be coordinated with the private
\textless{}\href{mailto:linux-distros@vs.openwall.org}{linux-distros@vs.openwall.org}\textgreater{} mailing list so that distribution vendors
are well prepared to issue a fixed kernel upon public disclosure of the
upstream fix. Distros will need some time to test the proposed patch and
will generally request at least a few days of embargo, and vendor update
publication prefers to happen Tuesday through Thursday. When appropriate,
the security team can assist with this coordination, or the reporter can
include linux-distros from the start. In this case, remember to prefix
the email Subject line with ``{[}vs{]}'' as described in the linux-distros wiki:
\textless{}\href{http://oss-security.openwall.org/wiki/mailing-lists/distros\#how-to-use-the-lists}{http://oss-security.openwall.org/wiki/mailing-lists/distros\#how-to-use-the-lists}\textgreater{}


\section{CVE assignment}
\label{admin-guide/security-bugs:cve-assignment}
The security team does not normally assign CVEs, nor do we require them
for reports or fixes, as this can needlessly complicate the process and
may delay the bug handling. If a reporter wishes to have a CVE identifier
assigned ahead of public disclosure, they will need to contact the private
linux-distros list, described above. When such a CVE identifier is known
before a patch is provided, it is desirable to mention it in the commit
message, though.


\section{Non-disclosure agreements}
\label{admin-guide/security-bugs:non-disclosure-agreements}
The Linux kernel security team is not a formal body and therefore unable
to enter any non-disclosure agreements.


\chapter{Bug hunting}
\label{admin-guide/bug-hunting::doc}\label{admin-guide/bug-hunting:bug-hunting}
Kernel bug reports often come with a stack dump like the one below:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}[ cut here ]\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
WARNING: CPU: 1 PID: 28102 at kernel/module.c:1108 module\PYGZus{}put+0x57/0x70
Modules linked in: dvb\PYGZus{}usb\PYGZus{}gp8psk(\PYGZhy{}) dvb\PYGZus{}usb dvb\PYGZus{}core nvidia\PYGZus{}drm(PO) nvidia\PYGZus{}modeset(PO) snd\PYGZus{}hda\PYGZus{}codec\PYGZus{}hdmi snd\PYGZus{}hda\PYGZus{}intel snd\PYGZus{}hda\PYGZus{}codec snd\PYGZus{}hwdep snd\PYGZus{}hda\PYGZus{}core snd\PYGZus{}pcm snd\PYGZus{}timer snd soundcore nvidia(PO) [last unloaded: rc\PYGZus{}core]
CPU: 1 PID: 28102 Comm: rmmod Tainted: P        WC O 4.8.4\PYGZhy{}build.1 \PYGZsh{}1
Hardware name: MSI MS\PYGZhy{}7309/MS\PYGZhy{}7309, BIOS V1.12 02/23/2009
 00000000 c12ba080 00000000 00000000 c103ed6a c1616014 00000001 00006dc6
 c1615862 00000454 c109e8a7 c109e8a7 00000009 ffffffff 00000000 f13f6a10
 f5f5a600 c103ee33 00000009 00000000 00000000 c109e8a7 f80ca4d0 c109f617
Call Trace:
 [\PYGZlt{}c12ba080\PYGZgt{}] ? dump\PYGZus{}stack+0x44/0x64
 [\PYGZlt{}c103ed6a\PYGZgt{}] ? \PYGZus{}\PYGZus{}warn+0xfa/0x120
 [\PYGZlt{}c109e8a7\PYGZgt{}] ? module\PYGZus{}put+0x57/0x70
 [\PYGZlt{}c109e8a7\PYGZgt{}] ? module\PYGZus{}put+0x57/0x70
 [\PYGZlt{}c103ee33\PYGZgt{}] ? warn\PYGZus{}slowpath\PYGZus{}null+0x23/0x30
 [\PYGZlt{}c109e8a7\PYGZgt{}] ? module\PYGZus{}put+0x57/0x70
 [\PYGZlt{}f80ca4d0\PYGZgt{}] ? gp8psk\PYGZus{}fe\PYGZus{}set\PYGZus{}frontend+0x460/0x460 [dvb\PYGZus{}usb\PYGZus{}gp8psk]
 [\PYGZlt{}c109f617\PYGZgt{}] ? symbol\PYGZus{}put\PYGZus{}addr+0x27/0x50
 [\PYGZlt{}f80bc9ca\PYGZgt{}] ? dvb\PYGZus{}usb\PYGZus{}adapter\PYGZus{}frontend\PYGZus{}exit+0x3a/0x70 [dvb\PYGZus{}usb]
 [\PYGZlt{}f80bb3bf\PYGZgt{}] ? dvb\PYGZus{}usb\PYGZus{}exit+0x2f/0xd0 [dvb\PYGZus{}usb]
 [\PYGZlt{}c13d03bc\PYGZgt{}] ? usb\PYGZus{}disable\PYGZus{}endpoint+0x7c/0xb0
 [\PYGZlt{}f80bb48a\PYGZgt{}] ? dvb\PYGZus{}usb\PYGZus{}device\PYGZus{}exit+0x2a/0x50 [dvb\PYGZus{}usb]
 [\PYGZlt{}c13d2882\PYGZgt{}] ? usb\PYGZus{}unbind\PYGZus{}interface+0x62/0x250
 [\PYGZlt{}c136b514\PYGZgt{}] ? \PYGZus{}\PYGZus{}pm\PYGZus{}runtime\PYGZus{}idle+0x44/0x70
 [\PYGZlt{}c13620d8\PYGZgt{}] ? \PYGZus{}\PYGZus{}device\PYGZus{}release\PYGZus{}driver+0x78/0x120
 [\PYGZlt{}c1362907\PYGZgt{}] ? driver\PYGZus{}detach+0x87/0x90
 [\PYGZlt{}c1361c48\PYGZgt{}] ? bus\PYGZus{}remove\PYGZus{}driver+0x38/0x90
 [\PYGZlt{}c13d1c18\PYGZgt{}] ? usb\PYGZus{}deregister+0x58/0xb0
 [\PYGZlt{}c109fbb0\PYGZgt{}] ? SyS\PYGZus{}delete\PYGZus{}module+0x130/0x1f0
 [\PYGZlt{}c1055654\PYGZgt{}] ? task\PYGZus{}work\PYGZus{}run+0x64/0x80
 [\PYGZlt{}c1000fa5\PYGZgt{}] ? exit\PYGZus{}to\PYGZus{}usermode\PYGZus{}loop+0x85/0x90
 [\PYGZlt{}c10013f0\PYGZgt{}] ? do\PYGZus{}fast\PYGZus{}syscall\PYGZus{}32+0x80/0x130
 [\PYGZlt{}c1549f43\PYGZgt{}] ? sysenter\PYGZus{}past\PYGZus{}esp+0x40/0x6a
\PYGZhy{}\PYGZhy{}\PYGZhy{}[ end trace 6ebc60ef3981792f ]\PYGZhy{}\PYGZhy{}\PYGZhy{}
\end{Verbatim}

Such stack traces provide enough information to identify the line inside the
Kernel's source code where the bug happened. Depending on the severity of
the issue, it may also contain the word \textbf{Oops}, as on this one:

\begin{Verbatim}[commandchars=\\\{\}]
BUG: unable to handle kernel NULL pointer dereference at   (null)
IP: [\PYGZlt{}c06969d4\PYGZgt{}] iret\PYGZus{}exc+0x7d0/0xa59
*pdpt = 000000002258a001 *pde = 0000000000000000
Oops: 0002 [\PYGZsh{}1] PREEMPT SMP
...
\end{Verbatim}

Despite being an \textbf{Oops} or some other sort of stack trace, the offended
line is usually required to identify and handle the bug. Along this chapter,
we'll refer to ``Oops'' for all kinds of stack traces that need to be analized.

\begin{notice}{note}{Note:}
\code{ksymoops} is useless on 2.6 or upper.  Please use the Oops in its original
format (from \code{dmesg}, etc).  Ignore any references in this or other docs to
``decoding the Oops'' or ``running it through ksymoops''.
If you post an Oops from 2.6+ that has been run through \code{ksymoops},
people will just tell you to repost it.
\end{notice}


\section{Where is the Oops message is located?}
\label{admin-guide/bug-hunting:where-is-the-oops-message-is-located}
Normally the Oops text is read from the kernel buffers by klogd and
handed to \code{syslogd} which writes it to a syslog file, typically
\code{/var/log/messages} (depends on \code{/etc/syslog.conf}). On systems with
systemd, it may also be stored by the \code{journald} daemon, and accessed
by running \code{journalctl} command.

Sometimes \code{klogd} dies, in which case you can run \code{dmesg \textgreater{} file} to
read the data from the kernel buffers and save it.  Or you can
\code{cat /proc/kmsg \textgreater{} file}, however you have to break in to stop the transfer,
\code{kmsg} is a ``never ending file''.

If the machine has crashed so badly that you cannot enter commands or
the disk is not available then you have three options:
\begin{enumerate}
\item {} 
Hand copy the text from the screen and type it in after the machine
has restarted.  Messy but it is the only option if you have not
planned for a crash. Alternatively, you can take a picture of
the screen with a digital camera - not nice, but better than
nothing.  If the messages scroll off the top of the console, you
may find that booting with a higher resolution (eg, \code{vga=791})
will allow you to read more of the text. (Caveat: This needs \code{vesafb},
so won't help for `early' oopses)

\item {} 
Boot with a serial console (see
{\hyperref[admin\string-guide/serial\string-console:serial\string-console]{\emph{Documentation/admin-guide/serial-console.rst}}}),
run a null modem to a second machine and capture the output there
using your favourite communication program.  Minicom works well.

\item {} 
Use Kdump (see Documentation/kdump/kdump.txt),
extract the kernel ring buffer from old memory with using dmesg
gdbmacro in Documentation/kdump/gdbmacros.txt.

\end{enumerate}


\section{Finding the bug's location}
\label{admin-guide/bug-hunting:finding-the-bug-s-location}
Reporting a bug works best if you point the location of the bug at the
Kernel source file. There are two methods for doing that. Usually, using
\code{gdb} is easier, but the Kernel should be pre-compiled with debug info.


\subsection{gdb}
\label{admin-guide/bug-hunting:gdb}
The GNU debug (\code{gdb}) is the best way to figure out the exact file and line
number of the OOPS from the \code{vmlinux} file.

The usage of gdb works best on a kernel compiled with \code{CONFIG\_DEBUG\_INFO}.
This can be set by running:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} ./scripts/config \PYGZhy{}d COMPILE\PYGZus{}TEST \PYGZhy{}e DEBUG\PYGZus{}KERNEL \PYGZhy{}e DEBUG\PYGZus{}INFO
\end{Verbatim}

On a kernel compiled with \code{CONFIG\_DEBUG\_INFO}, you can simply copy the
EIP value from the OOPS:

\begin{Verbatim}[commandchars=\\\{\}]
EIP:    0060:[\PYGZlt{}c021e50e\PYGZgt{}]    Not tainted VLI
\end{Verbatim}

And use GDB to translate that to human-readable form:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} gdb vmlinux
(gdb) l *0xc021e50e
\end{Verbatim}

If you don't have \code{CONFIG\_DEBUG\_INFO} enabled, you use the function
offset from the OOPS:

\begin{Verbatim}[commandchars=\\\{\}]
EIP is at vt\PYGZus{}ioctl+0xda8/0x1482
\end{Verbatim}

And recompile the kernel with \code{CONFIG\_DEBUG\_INFO} enabled:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} ./scripts/config \PYGZhy{}d COMPILE\PYGZus{}TEST \PYGZhy{}e DEBUG\PYGZus{}KERNEL \PYGZhy{}e DEBUG\PYGZus{}INFO
\PYGZdl{} make vmlinux
\PYGZdl{} gdb vmlinux
(gdb) l *vt\PYGZus{}ioctl+0xda8
0x1888 is in vt\PYGZus{}ioctl (drivers/tty/vt/vt\PYGZus{}ioctl.c:293).
288   \PYGZob{}
289           struct vc\PYGZus{}data *vc = NULL;
290           int ret = 0;
291
292           console\PYGZus{}lock();
293           if (VT\PYGZus{}BUSY(vc\PYGZus{}num))
294                   ret = \PYGZhy{}EBUSY;
295           else if (vc\PYGZus{}num)
296                   vc = vc\PYGZus{}deallocate(vc\PYGZus{}num);
297           console\PYGZus{}unlock();
\end{Verbatim}

or, if you want to be more verbose:

\begin{Verbatim}[commandchars=\\\{\}]
(gdb) p vt\PYGZus{}ioctl
\PYGZdl{}1 = \PYGZob{}int (struct tty\PYGZus{}struct *, unsigned int, unsigned long)\PYGZcb{} 0xae0 \PYGZlt{}vt\PYGZus{}ioctl\PYGZgt{}
(gdb) l *0xae0+0xda8
\end{Verbatim}

You could, instead, use the object file:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} make drivers/tty/
\PYGZdl{} gdb drivers/tty/vt/vt\PYGZus{}ioctl.o
(gdb) l *vt\PYGZus{}ioctl+0xda8
\end{Verbatim}

If you have a call trace, such as:

\begin{Verbatim}[commandchars=\\\{\}]
Call Trace:
 [\PYGZlt{}ffffffff8802c8e9\PYGZgt{}] :jbd:log\PYGZus{}wait\PYGZus{}commit+0xa3/0xf5
 [\PYGZlt{}ffffffff810482d9\PYGZgt{}] autoremove\PYGZus{}wake\PYGZus{}function+0x0/0x2e
 [\PYGZlt{}ffffffff8802770b\PYGZgt{}] :jbd:journal\PYGZus{}stop+0x1be/0x1ee
 ...
\end{Verbatim}

this shows the problem likely in the :jbd: module. You can load that module
in gdb and list the relevant code:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} gdb fs/jbd/jbd.ko
(gdb) l *log\PYGZus{}wait\PYGZus{}commit+0xa3
\end{Verbatim}

\begin{notice}{note}{Note:}
You can also do the same for any function call at the stack trace,
like this one:

\begin{Verbatim}[commandchars=\\\{\}]
[\PYGZlt{}f80bc9ca\PYGZgt{}] ? dvb\PYGZus{}usb\PYGZus{}adapter\PYGZus{}frontend\PYGZus{}exit+0x3a/0x70 [dvb\PYGZus{}usb]
\end{Verbatim}

The position where the above call happened can be seen with:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} gdb drivers/media/usb/dvb\PYGZhy{}usb/dvb\PYGZhy{}usb.o
(gdb) l *dvb\PYGZus{}usb\PYGZus{}adapter\PYGZus{}frontend\PYGZus{}exit+0x3a
\end{Verbatim}
\end{notice}


\subsection{objdump}
\label{admin-guide/bug-hunting:objdump}
To debug a kernel, use objdump and look for the hex offset from the crash
output to find the valid line of code/assembler. Without debug symbols, you
will see the assembler code for the routine shown, but if your kernel has
debug symbols the C code will also be available. (Debug symbols can be enabled
in the kernel hacking menu of the menu configuration.) For example:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} objdump \PYGZhy{}r \PYGZhy{}S \PYGZhy{}l \PYGZhy{}\PYGZhy{}disassemble net/dccp/ipv4.o
\end{Verbatim}

\begin{notice}{note}{Note:}
You need to be at the top level of the kernel tree for this to pick up
your C files.
\end{notice}

If you don't have access to the code you can also debug on some crash dumps
e.g. crash dump output as shown by Dave Miller:

\begin{Verbatim}[commandchars=\\\{\}]
EIP is at  +0x14/0x4c0
 ...
Code: 44 24 04 e8 6f 05 00 00 e9 e8 fe ff ff 8d 76 00 8d bc 27 00 00
00 00 55 57  56 53 81 ec bc 00 00 00 8b ac 24 d0 00 00 00 8b 5d 08
\PYGZlt{}8b\PYGZgt{} 83 3c 01 00 00 89 44  24 14 8b 45 28 85 c0 89 44 24 18 0f 85

Put the bytes into a \PYGZdq{}foo.s\PYGZdq{} file like this:

       .text
       .globl foo
foo:
       .byte  .... /* bytes from Code: part of OOPS dump */

Compile it with \PYGZdq{}gcc \PYGZhy{}c \PYGZhy{}o foo.o foo.s\PYGZdq{} then look at the output of
\PYGZdq{}objdump \PYGZhy{}\PYGZhy{}disassemble foo.o\PYGZdq{}.

Output:

ip\PYGZus{}queue\PYGZus{}xmit:
    push       \PYGZpc{}ebp
    push       \PYGZpc{}edi
    push       \PYGZpc{}esi
    push       \PYGZpc{}ebx
    sub        \PYGZdl{}0xbc, \PYGZpc{}esp
    mov        0xd0(\PYGZpc{}esp), \PYGZpc{}ebp        ! \PYGZpc{}ebp = arg0 (skb)
    mov        0x8(\PYGZpc{}ebp), \PYGZpc{}ebx         ! \PYGZpc{}ebx = skb\PYGZhy{}\PYGZgt{}sk
    mov        0x13c(\PYGZpc{}ebx), \PYGZpc{}eax       ! \PYGZpc{}eax = inet\PYGZus{}sk(sk)\PYGZhy{}\PYGZgt{}opt
\end{Verbatim}


\section{Reporting the bug}
\label{admin-guide/bug-hunting:reporting-the-bug}
Once you find where the bug happened, by inspecting its location,
you could either try to fix it yourself or report it upstream.

In order to report it upstream, you should identify the mailing list
used for the development of the affected code. This can be done by using
the \code{get\_maintainer.pl} script.

For example, if you find a bug at the gspca's sonixj.c file, you can get
their maintainers with:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} ./scripts/get\PYGZus{}maintainer.pl \PYGZhy{}f drivers/media/usb/gspca/sonixj.c
Hans Verkuil \PYGZlt{}hverkuil@xs4all.nl\PYGZgt{} (odd fixer:GSPCA USB WEBCAM DRIVER,commit\PYGZus{}signer:1/1=100\PYGZpc{})
Mauro Carvalho Chehab \PYGZlt{}mchehab@kernel.org\PYGZgt{} (maintainer:MEDIA INPUT INFRASTRUCTURE (V4L/DVB),commit\PYGZus{}signer:1/1=100\PYGZpc{})
Tejun Heo \PYGZlt{}tj@kernel.org\PYGZgt{} (commit\PYGZus{}signer:1/1=100\PYGZpc{})
Bhaktipriya Shridhar \PYGZlt{}bhaktipriya96@gmail.com\PYGZgt{} (commit\PYGZus{}signer:1/1=100\PYGZpc{},authored:1/1=100\PYGZpc{},added\PYGZus{}lines:4/4=100\PYGZpc{},removed\PYGZus{}lines:9/9=100\PYGZpc{})
linux\PYGZhy{}media@vger.kernel.org (open list:GSPCA USB WEBCAM DRIVER)
linux\PYGZhy{}kernel@vger.kernel.org (open list)
\end{Verbatim}

Please notice that it will point to:
\begin{itemize}
\item {} 
The last developers that touched on the source code. On the above example,
Tejun and Bhaktipriya (in this specific case, none really envolved on the
development of this file);

\item {} 
The driver maintainer (Hans Verkuil);

\item {} 
The subsystem maintainer (Mauro Carvalho Chehab);

\item {} 
The driver and/or subsystem mailing list (\href{mailto:linux-media@vger.kernel.org}{linux-media@vger.kernel.org});

\item {} 
the Linux Kernel mailing list (\href{mailto:linux-kernel@vger.kernel.org}{linux-kernel@vger.kernel.org}).

\end{itemize}

Usually, the fastest way to have your bug fixed is to report it to mailing
list used for the development of the code (linux-media ML) copying the driver maintainer (Hans).

If you are totally stumped as to whom to send the report, and
\code{get\_maintainer.pl} didn't provide you anything useful, send it to
\href{mailto:linux-kernel@vger.kernel.org}{linux-kernel@vger.kernel.org}.

Thanks for your help in making Linux as stable as humanly possible.


\section{Fixing the bug}
\label{admin-guide/bug-hunting:fixing-the-bug}
If you know programming, you could help us by not only reporting the bug,
but also providing us with a solution. After all, open source is about
sharing what you do and don't you want to be recognised for your genius?

If you decide to take this way, once you have worked out a fix please submit
it upstream.

Please do read
\DUspan{xref,std,std-ref}{Documentation/process/submitting-patches.rst} though
to help your code get accepted.


\bigskip\hrule{}\bigskip



\section{Notes on Oops tracing with \texttt{klogd}}
\label{admin-guide/bug-hunting:notes-on-oops-tracing-with-klogd}
In order to help Linus and the other kernel developers there has been
substantial support incorporated into \code{klogd} for processing protection
faults.  In order to have full support for address resolution at least
version 1.3-pl3 of the \code{sysklogd} package should be used.

When a protection fault occurs the \code{klogd} daemon automatically
translates important addresses in the kernel log messages to their
symbolic equivalents.  This translated kernel message is then
forwarded through whatever reporting mechanism \code{klogd} is using.  The
protection fault message can be simply cut out of the message files
and forwarded to the kernel developers.

Two types of address resolution are performed by \code{klogd}.  The first is
static translation and the second is dynamic translation.  Static
translation uses the System.map file in much the same manner that
ksymoops does.  In order to do static translation the \code{klogd} daemon
must be able to find a system map file at daemon initialization time.
See the klogd man page for information on how \code{klogd} searches for map
files.

Dynamic address translation is important when kernel loadable modules
are being used.  Since memory for kernel modules is allocated from the
kernel's dynamic memory pools there are no fixed locations for either
the start of the module or for functions and symbols in the module.

The kernel supports system calls which allow a program to determine
which modules are loaded and their location in memory.  Using these
system calls the klogd daemon builds a symbol table which can be used
to debug a protection fault which occurs in a loadable kernel module.

At the very minimum klogd will provide the name of the module which
generated the protection fault.  There may be additional symbolic
information available if the developer of the loadable module chose to
export symbol information from the module.

Since the kernel module environment can be dynamic there must be a
mechanism for notifying the \code{klogd} daemon when a change in module
environment occurs.  There are command line options available which
allow klogd to signal the currently executing daemon that symbol
information should be refreshed.  See the \code{klogd} manual page for more
information.

A patch is included with the sysklogd distribution which modifies the
\code{modules-2.0.0} package to automatically signal klogd whenever a module
is loaded or unloaded.  Applying this patch provides essentially
seamless support for debugging protection faults which occur with
kernel loadable modules.

The following is an example of a protection fault in a loadable module
processed by \code{klogd}:

\begin{Verbatim}[commandchars=\\\{\}]
Aug 29 09:51:01 blizard kernel: Unable to handle kernel paging request at virtual address f15e97cc
Aug 29 09:51:01 blizard kernel: current\PYGZhy{}\PYGZgt{}tss.cr3 = 0062d000, \PYGZpc{}cr3 = 0062d000
Aug 29 09:51:01 blizard kernel: *pde = 00000000
Aug 29 09:51:01 blizard kernel: Oops: 0002
Aug 29 09:51:01 blizard kernel: CPU:    0
Aug 29 09:51:01 blizard kernel: EIP:    0010:[oops:\PYGZus{}oops+16/3868]
Aug 29 09:51:01 blizard kernel: EFLAGS: 00010212
Aug 29 09:51:01 blizard kernel: eax: 315e97cc   ebx: 003a6f80   ecx: 001be77b   edx: 00237c0c
Aug 29 09:51:01 blizard kernel: esi: 00000000   edi: bffffdb3   ebp: 00589f90   esp: 00589f8c
Aug 29 09:51:01 blizard kernel: ds: 0018   es: 0018   fs: 002b   gs: 002b   ss: 0018
Aug 29 09:51:01 blizard kernel: Process oops\PYGZus{}test (pid: 3374, process nr: 21, stackpage=00589000)
Aug 29 09:51:01 blizard kernel: Stack: 315e97cc 00589f98 0100b0b4 bffffed4 0012e38e 00240c64 003a6f80 00000001
Aug 29 09:51:01 blizard kernel:        00000000 00237810 bfffff00 0010a7fa 00000003 00000001 00000000 bfffff00
Aug 29 09:51:01 blizard kernel:        bffffdb3 bffffed4 ffffffda 0000002b 0007002b 0000002b 0000002b 00000036
Aug 29 09:51:01 blizard kernel: Call Trace: [oops:\PYGZus{}oops\PYGZus{}ioctl+48/80] [\PYGZus{}sys\PYGZus{}ioctl+254/272] [\PYGZus{}system\PYGZus{}call+82/128]
Aug 29 09:51:01 blizard kernel: Code: c7 00 05 00 00 00 eb 08 90 90 90 90 90 90 90 90 89 ec 5d c3
\end{Verbatim}


\bigskip\hrule{}\bigskip


\begin{Verbatim}[commandchars=\\\{\}]
Dr. G.W. Wettstein           Oncology Research Div. Computing Facility
Roger Maris Cancer Center    INTERNET: greg@wind.rmcc.com
820 4th St. N.
Fargo, ND  58122
Phone: 701\PYGZhy{}234\PYGZhy{}7556
\end{Verbatim}


\chapter{Bisecting a bug}
\label{admin-guide/bug-bisect::doc}\label{admin-guide/bug-bisect:bisecting-a-bug}
Last updated: 28 October 2016


\section{Introduction}
\label{admin-guide/bug-bisect:introduction}
Always try the latest kernel from kernel.org and build from source. If you are
not confident in doing that please report the bug to your distribution vendor
instead of to a kernel developer.

Finding bugs is not always easy. Have a go though. If you can't find it don't
give up. Report as much as you have found to the relevant maintainer. See
MAINTAINERS for who that is for the subsystem you have worked on.

Before you submit a bug report read
{\hyperref[admin\string-guide/reporting\string-bugs:reportingbugs]{\emph{Documentation/admin-guide/reporting-bugs.rst}}}.


\section{Devices not appearing}
\label{admin-guide/bug-bisect:devices-not-appearing}
Often this is caused by udev/systemd. Check that first before blaming it
on the kernel.


\section{Finding patch that caused a bug}
\label{admin-guide/bug-bisect:finding-patch-that-caused-a-bug}
Using the provided tools with \code{git} makes finding bugs easy provided the bug
is reproducible.

Steps to do it:
\begin{itemize}
\item {} 
build the Kernel from its git source

\item {} 
start bisect with \footnote[1]{
You can, optionally, provide both good and bad arguments at git
start with \code{git bisect start {[}BAD{]} {[}GOOD{]}}
}:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} git bisect start
\end{Verbatim}

\item {} 
mark the broken changeset with:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} git bisect bad [commit]
\end{Verbatim}

\item {} 
mark a changeset where the code is known to work with:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} git bisect good [commit]
\end{Verbatim}

\item {} 
rebuild the Kernel and test

\item {} 
interact with git bisect by using either:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} git bisect good
\end{Verbatim}

or:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} git bisect bad
\end{Verbatim}

depending if the bug happened on the changeset you're testing

\item {} 
After some interactions, git bisect will give you the changeset that
likely caused the bug.

\item {} 
For example, if you know that the current version is bad, and version
4.8 is good, you could do:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} git bisect start
\PYGZdl{} git bisect bad                 \PYGZsh{} Current version is bad
\PYGZdl{} git bisect good v4.8
\end{Verbatim}

\end{itemize}

For further references, please read:
\begin{itemize}
\item {} 
The man page for \code{git-bisect}

\item {} 
\href{https://www.kernel.org/pub/software/scm/git/docs/git-bisect-lk2009.html}{Fighting regressions with git bisect}

\item {} 
\href{https://lwn.net/Articles/317154}{Fully automated bisecting with ``git bisect run''}

\item {} 
\href{http://webchick.net/node/99}{Using Git bisect to figure out when brokenness was introduced}

\end{itemize}


\chapter{Tainted kernels}
\label{admin-guide/tainted-kernels::doc}\label{admin-guide/tainted-kernels:tainted-kernels}
Some oops reports contain the string \textbf{`Tainted: `} after the program
counter. This indicates that the kernel has been tainted by some
mechanism.  The string is followed by a series of position-sensitive
characters, each representing a particular tainted value.
\begin{quote}
\begin{enumerate}
\item {} 
`G' if all modules loaded have a GPL or compatible license, `P' if
any proprietary module has been loaded.  Modules without a
MODULE\_LICENSE or with a MODULE\_LICENSE that is not recognised by
insmod as GPL compatible are assumed to be proprietary.

\item {} 
\code{F} if any module was force loaded by \code{insmod -f}, \code{' '} if all
modules were loaded normally.

\item {} 
\code{S} if the oops occurred on an SMP kernel running on hardware that
hasn't been certified as safe to run multiprocessor.
Currently this occurs only on various Athlons that are not
SMP capable.

\item {} 
\code{R} if a module was force unloaded by \code{rmmod -f}, \code{' '} if all
modules were unloaded normally.

\item {} 
\code{M} if any processor has reported a Machine Check Exception,
\code{' '} if no Machine Check Exceptions have occurred.

\item {} 
\code{B} if a page-release function has found a bad page reference or
some unexpected page flags.

\item {} 
\code{U} if a user or user application specifically requested that the
Tainted flag be set, \code{' '} otherwise.

\item {} 
\code{D} if the kernel has died recently, i.e. there was an OOPS or BUG.

\item {} 
\code{A} if the ACPI table has been overridden.

\end{enumerate}
\begin{enumerate}
\setcounter{enumi}{9}
\item {} 
\code{W} if a warning has previously been issued by the kernel.
(Though some warnings may set more specific taint flags.)

\item {} 
\code{C} if a staging driver has been loaded.

\item {} 
\code{I} if the kernel is working around a severe bug in the platform
firmware (BIOS or similar).

\item {} 
\code{O} if an externally-built (``out-of-tree'') module has been loaded.

\item {} 
\code{E} if an unsigned module has been loaded in a kernel supporting
module signature.

\item {} 
\code{L} if a soft lockup has previously occurred on the system.

\item {} 
\code{K} if the kernel has been live patched.

\end{enumerate}
\end{quote}

The primary reason for the \textbf{`Tainted: `} string is to tell kernel
debuggers if this is a clean kernel or if anything unusual has
occurred.  Tainting is permanent: even if an offending module is
unloaded, the tainted value remains to indicate that the kernel is not
trustworthy.


\chapter{Ramoops oops/panic logger}
\label{admin-guide/ramoops::doc}\label{admin-guide/ramoops:ramoops-oops-panic-logger}
Sergiu Iordache \textless{}\href{mailto:sergiu@chromium.org}{sergiu@chromium.org}\textgreater{}

Updated: 17 November 2011


\section{Introduction}
\label{admin-guide/ramoops:introduction}
Ramoops is an oops/panic logger that writes its logs to RAM before the system
crashes. It works by logging oopses and panics in a circular buffer. Ramoops
needs a system with persistent RAM so that the content of that area can
survive after a restart.


\section{Ramoops concepts}
\label{admin-guide/ramoops:ramoops-concepts}
Ramoops uses a predefined memory area to store the dump. The start and size
and type of the memory area are set using three variables:
\begin{itemize}
\item {} 
\code{mem\_address} for the start

\item {} 
\code{mem\_size} for the size. The memory size will be rounded down to a
power of two.

\item {} 
\code{mem\_type} to specifiy if the memory type (default is pgprot\_writecombine).

\end{itemize}

Typically the default value of \code{mem\_type=0} should be used as that sets the pstore
mapping to pgprot\_writecombine. Setting \code{mem\_type=1} attempts to use
\code{pgprot\_noncached}, which only works on some platforms. This is because pstore
depends on atomic operations. At least on ARM, pgprot\_noncached causes the
memory to be mapped strongly ordered, and atomic operations on strongly ordered
memory are implementation defined, and won't work on many ARMs such as omaps.

The memory area is divided into \code{record\_size} chunks (also rounded down to
power of two) and each oops/panic writes a \code{record\_size} chunk of
information.

Dumping both oopses and panics can be done by setting 1 in the \code{dump\_oops}
variable while setting 0 in that variable dumps only the panics.

The module uses a counter to record multiple dumps but the counter gets reset
on restart (i.e. new dumps after the restart will overwrite old ones).

Ramoops also supports software ECC protection of persistent memory regions.
This might be useful when a hardware reset was used to bring the machine back
to life (i.e. a watchdog triggered). In such cases, RAM may be somewhat
corrupt, but usually it is restorable.


\section{Setting the parameters}
\label{admin-guide/ramoops:setting-the-parameters}
Setting the ramoops parameters can be done in several different manners:
\begin{quote}

A. Use the module parameters (which have the names of the variables described
as before). For quick debugging, you can also reserve parts of memory during
boot and then use the reserved memory for ramoops. For example, assuming a
machine with \textgreater{} 128 MB of memory, the following kernel command line will tell
the kernel to use only the first 128 MB of memory, and place ECC-protected
ramoops region at 128 MB boundary:

\begin{Verbatim}[commandchars=\\\{\}]
mem=128M ramoops.mem\PYGZus{}address=0x8000000 ramoops.ecc=1
\end{Verbatim}

B. Use Device Tree bindings, as described in
\code{Documentation/device-tree/bindings/reserved-memory/admin-guide/ramoops.rst}.
For example:

\begin{Verbatim}[commandchars=\\\{\}]
reserved\PYGZhy{}memory \PYGZob{}
        \PYGZsh{}address\PYGZhy{}cells = \PYGZlt{}2\PYGZgt{};
        \PYGZsh{}size\PYGZhy{}cells = \PYGZlt{}2\PYGZgt{};
        ranges;

        ramoops@8f000000 \PYGZob{}
                compatible = \PYGZdq{}ramoops\PYGZdq{};
                reg = \PYGZlt{}0 0x8f000000 0 0x100000\PYGZgt{};
                record\PYGZhy{}size = \PYGZlt{}0x4000\PYGZgt{};
                console\PYGZhy{}size = \PYGZlt{}0x4000\PYGZgt{};
        \PYGZcb{};
\PYGZcb{};
\end{Verbatim}

C. Use a platform device and set the platform data. The parameters can then
be set through that platform data. An example of doing that is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZlt{}linux/pstore\PYGZus{}ram.h\PYGZgt{}}
\PYG{p}{[}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{p}{]}

\PYG{k}{static} \PYG{k}{struct} \PYG{n}{ramoops\PYGZus{}platform\PYGZus{}data} \PYG{n}{ramoops\PYGZus{}data} \PYG{o}{=} \PYG{p}{\PYGZob{}}
      \PYG{p}{.}\PYG{n}{mem\PYGZus{}size}               \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{o}{\PYGZgt{}}\PYG{p}{,}
      \PYG{p}{.}\PYG{n}{mem\PYGZus{}address}            \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{o}{\PYGZgt{}}\PYG{p}{,}
      \PYG{p}{.}\PYG{n}{mem\PYGZus{}type}               \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{o}{\PYGZgt{}}\PYG{p}{,}
      \PYG{p}{.}\PYG{n}{record\PYGZus{}size}            \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{o}{\PYGZgt{}}\PYG{p}{,}
      \PYG{p}{.}\PYG{n}{dump\PYGZus{}oops}              \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{o}{\PYGZgt{}}\PYG{p}{,}
      \PYG{p}{.}\PYG{n}{ecc}                    \PYG{o}{=} \PYG{o}{\PYGZlt{}}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{o}{\PYGZgt{}}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}\PYG{p}{;}

\PYG{k}{static} \PYG{k}{struct} \PYG{n}{platform\PYGZus{}device} \PYG{n}{ramoops\PYGZus{}dev} \PYG{o}{=} \PYG{p}{\PYGZob{}}
      \PYG{p}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{ramoops}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}
      \PYG{p}{.}\PYG{n}{dev} \PYG{o}{=} \PYG{p}{\PYGZob{}}
              \PYG{p}{.}\PYG{n}{platform\PYGZus{}data} \PYG{o}{=} \PYG{o}{\PYGZam{}}\PYG{n}{ramoops\PYGZus{}data}\PYG{p}{,}
      \PYG{p}{\PYGZcb{}}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}\PYG{p}{;}

\PYG{p}{[}\PYG{p}{.}\PYG{p}{.}\PYG{p}{.} \PYG{n}{inside} \PYG{n}{a} \PYG{n}{function} \PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{p}{]}
\PYG{k+kt}{int} \PYG{n}{ret}\PYG{p}{;}

\PYG{n}{ret} \PYG{o}{=} \PYG{n}{platform\PYGZus{}device\PYGZus{}register}\PYG{p}{(}\PYG{o}{\PYGZam{}}\PYG{n}{ramoops\PYGZus{}dev}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if} \PYG{p}{(}\PYG{n}{ret}\PYG{p}{)} \PYG{p}{\PYGZob{}}
      \PYG{n}{printk}\PYG{p}{(}\PYG{n}{KERN\PYGZus{}ERR} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{unable to register platform device}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{return} \PYG{n}{ret}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{Verbatim}
\end{quote}

You can specify either RAM memory or peripheral devices' memory. However, when
specifying RAM, be sure to reserve the memory by issuing memblock\_reserve()
very early in the architecture code, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{}include \PYGZlt{}linux/memblock.h\PYGZgt{}

memblock\PYGZus{}reserve(ramoops\PYGZus{}data.mem\PYGZus{}address, ramoops\PYGZus{}data.mem\PYGZus{}size);
\end{Verbatim}


\section{Dump format}
\label{admin-guide/ramoops:dump-format}
The data dump begins with a header, currently defined as \code{====} followed by a
timestamp and a new line. The dump then continues with the actual data.


\section{Reading the data}
\label{admin-guide/ramoops:reading-the-data}
The dump data can be read from the pstore filesystem. The format for these
files is \code{dmesg-ramoops-N}, where N is the record number in memory. To delete
a stored record from RAM, simply unlink the respective pstore file.


\section{Persistent function tracing}
\label{admin-guide/ramoops:persistent-function-tracing}
Persistent function tracing might be useful for debugging software or hardware
related hangs. The functions call chain log is stored in a \code{ftrace-ramoops}
file. Here is an example of usage:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} mount \PYGZhy{}t debugfs debugfs /sys/kernel/debug/
\PYGZsh{} echo 1 \PYGZgt{} /sys/kernel/debug/pstore/record\PYGZus{}ftrace
\PYGZsh{} reboot \PYGZhy{}f
[...]
\PYGZsh{} mount \PYGZhy{}t pstore pstore /mnt/
\PYGZsh{} tail /mnt/ftrace\PYGZhy{}ramoops
0 ffffffff8101ea64  ffffffff8101bcda  native\PYGZus{}apic\PYGZus{}mem\PYGZus{}read \PYGZlt{}\PYGZhy{} disconnect\PYGZus{}bsp\PYGZus{}APIC+0x6a/0xc0
0 ffffffff8101ea44  ffffffff8101bcf6  native\PYGZus{}apic\PYGZus{}mem\PYGZus{}write \PYGZlt{}\PYGZhy{} disconnect\PYGZus{}bsp\PYGZus{}APIC+0x86/0xc0
0 ffffffff81020084  ffffffff8101a4b5  hpet\PYGZus{}disable \PYGZlt{}\PYGZhy{} native\PYGZus{}machine\PYGZus{}shutdown+0x75/0x90
0 ffffffff81005f94  ffffffff8101a4bb  iommu\PYGZus{}shutdown\PYGZus{}noop \PYGZlt{}\PYGZhy{} native\PYGZus{}machine\PYGZus{}shutdown+0x7b/0x90
0 ffffffff8101a6a1  ffffffff8101a437  native\PYGZus{}machine\PYGZus{}emergency\PYGZus{}restart \PYGZlt{}\PYGZhy{} native\PYGZus{}machine\PYGZus{}restart+0x37/0x40
0 ffffffff811f9876  ffffffff8101a73a  acpi\PYGZus{}reboot \PYGZlt{}\PYGZhy{} native\PYGZus{}machine\PYGZus{}emergency\PYGZus{}restart+0xaa/0x1e0
0 ffffffff8101a514  ffffffff8101a772  mach\PYGZus{}reboot\PYGZus{}fixups \PYGZlt{}\PYGZhy{} native\PYGZus{}machine\PYGZus{}emergency\PYGZus{}restart+0xe2/0x1e0
0 ffffffff811d9c54  ffffffff8101a7a0  \PYGZus{}\PYGZus{}const\PYGZus{}udelay \PYGZlt{}\PYGZhy{} native\PYGZus{}machine\PYGZus{}emergency\PYGZus{}restart+0x110/0x1e0
0 ffffffff811d9c34  ffffffff811d9c80  \PYGZus{}\PYGZus{}delay \PYGZlt{}\PYGZhy{} \PYGZus{}\PYGZus{}const\PYGZus{}udelay+0x30/0x40
0 ffffffff811d9d14  ffffffff811d9c3f  delay\PYGZus{}tsc \PYGZlt{}\PYGZhy{} \PYGZus{}\PYGZus{}delay+0xf/0x20
\end{Verbatim}


\chapter{Dynamic debug}
\label{admin-guide/dynamic-debug-howto:dynamic-debug}\label{admin-guide/dynamic-debug-howto::doc}

\section{Introduction}
\label{admin-guide/dynamic-debug-howto:introduction}
This document describes how to use the dynamic debug (dyndbg) feature.

Dynamic debug is designed to allow you to dynamically enable/disable
kernel code to obtain additional kernel information.  Currently, if
\code{CONFIG\_DYNAMIC\_DEBUG} is set, then all \code{pr\_debug()}/\code{dev\_dbg()} and
\code{print\_hex\_dump\_debug()}/\code{print\_hex\_dump\_bytes()} calls can be dynamically
enabled per-callsite.

If \code{CONFIG\_DYNAMIC\_DEBUG} is not set, \code{print\_hex\_dump\_debug()} is just
shortcut for \code{print\_hex\_dump(KERN\_DEBUG)}.

For \code{print\_hex\_dump\_debug()}/\code{print\_hex\_dump\_bytes()}, format string is
its \code{prefix\_str} argument, if it is constant string; or \code{hexdump}
in case \code{prefix\_str} is built dynamically.

Dynamic debug has even more useful features:
\begin{itemize}
\item {} 
Simple query language allows turning on and off debugging
statements by matching any combination of 0 or 1 of:
\begin{itemize}
\item {} 
source filename

\item {} 
function name

\item {} 
line number (including ranges of line numbers)

\item {} 
module name

\item {} 
format string

\end{itemize}

\item {} 
Provides a debugfs control file: \code{\textless{}debugfs\textgreater{}/dynamic\_debug/control}
which can be read to display the complete list of known debug
statements, to help guide you

\end{itemize}


\section{Controlling dynamic debug Behaviour}
\label{admin-guide/dynamic-debug-howto:controlling-dynamic-debug-behaviour}
The behaviour of \code{pr\_debug()}/\code{dev\_dbg()} are controlled via writing to a
control file in the `debugfs' filesystem. Thus, you must first mount
the debugfs filesystem, in order to make use of this feature.
Subsequently, we refer to the control file as:
\code{\textless{}debugfs\textgreater{}/dynamic\_debug/control}. For example, if you want to enable
printing from source file \code{svcsock.c}, line 1603 you simply do:

\begin{Verbatim}[commandchars=\\\{\}]
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZsq{}file svcsock.c line 1603 +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\end{Verbatim}

If you make a mistake with the syntax, the write will fail thus:

\begin{Verbatim}[commandchars=\\\{\}]
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZsq{}file svcsock.c wtf 1 +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\PYGZhy{}bash: echo: write error: Invalid argument
\end{Verbatim}


\section{Viewing Dynamic Debug Behaviour}
\label{admin-guide/dynamic-debug-howto:viewing-dynamic-debug-behaviour}
You can view the currently configured behaviour of all the debug
statements via:

\begin{Verbatim}[commandchars=\\\{\}]
nullarbor:\PYGZti{} \PYGZsh{} cat \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\PYGZsh{} filename:lineno [module]function flags format
/usr/src/packages/BUILD/sgi\PYGZhy{}enhancednfs\PYGZhy{}1.4/default/net/sunrpc/svc\PYGZus{}rdma.c:323 [svcxprt\PYGZus{}rdma]svc\PYGZus{}rdma\PYGZus{}cleanup =\PYGZus{} \PYGZdq{}SVCRDMA Module Removed, deregister RPC RDMA transport\PYGZbs{}012\PYGZdq{}
/usr/src/packages/BUILD/sgi\PYGZhy{}enhancednfs\PYGZhy{}1.4/default/net/sunrpc/svc\PYGZus{}rdma.c:341 [svcxprt\PYGZus{}rdma]svc\PYGZus{}rdma\PYGZus{}init =\PYGZus{} \PYGZdq{}\PYGZbs{}011max\PYGZus{}inline       : \PYGZpc{}d\PYGZbs{}012\PYGZdq{}
/usr/src/packages/BUILD/sgi\PYGZhy{}enhancednfs\PYGZhy{}1.4/default/net/sunrpc/svc\PYGZus{}rdma.c:340 [svcxprt\PYGZus{}rdma]svc\PYGZus{}rdma\PYGZus{}init =\PYGZus{} \PYGZdq{}\PYGZbs{}011sq\PYGZus{}depth         : \PYGZpc{}d\PYGZbs{}012\PYGZdq{}
/usr/src/packages/BUILD/sgi\PYGZhy{}enhancednfs\PYGZhy{}1.4/default/net/sunrpc/svc\PYGZus{}rdma.c:338 [svcxprt\PYGZus{}rdma]svc\PYGZus{}rdma\PYGZus{}init =\PYGZus{} \PYGZdq{}\PYGZbs{}011max\PYGZus{}requests     : \PYGZpc{}d\PYGZbs{}012\PYGZdq{}
...
\end{Verbatim}

You can also apply standard Unix text manipulation filters to this
data, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
nullarbor:\PYGZti{} \PYGZsh{} grep \PYGZhy{}i rdma \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control  \textbar{} wc \PYGZhy{}l
62

nullarbor:\PYGZti{} \PYGZsh{} grep \PYGZhy{}i tcp \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control \textbar{} wc \PYGZhy{}l
42
\end{Verbatim}

The third column shows the currently enabled flags for each debug
statement callsite (see below for definitions of the flags).  The
default value, with no flags enabled, is \code{=\_}.  So you can view all
the debug statement callsites with any non-default flags:

\begin{Verbatim}[commandchars=\\\{\}]
nullarbor:\PYGZti{} \PYGZsh{} awk \PYGZsq{}\PYGZdl{}3 != \PYGZdq{}=\PYGZus{}\PYGZdq{}\PYGZsq{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\PYGZsh{} filename:lineno [module]function flags format
/usr/src/packages/BUILD/sgi\PYGZhy{}enhancednfs\PYGZhy{}1.4/default/net/sunrpc/svcsock.c:1603 [sunrpc]svc\PYGZus{}send p \PYGZdq{}svc\PYGZus{}process: st\PYGZus{}sendto returned \PYGZpc{}d\PYGZbs{}012\PYGZdq{}
\end{Verbatim}


\section{Command Language Reference}
\label{admin-guide/dynamic-debug-howto:command-language-reference}
At the lexical level, a command comprises a sequence of words separated
by spaces or tabs.  So these are all equivalent:

\begin{Verbatim}[commandchars=\\\{\}]
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}file svcsock.c line 1603 +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}  file   svcsock.c     line  1603 +p  \PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}file svcsock.c line 1603 +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\end{Verbatim}

Command submissions are bounded by a write() system call.
Multiple commands can be written together, separated by \code{;} or \code{\textbackslash{}n}:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZti{}\PYGZsh{} echo \PYGZdq{}func pnpacpi\PYGZus{}get\PYGZus{}resources +p; func pnp\PYGZus{}assign\PYGZus{}mem +p\PYGZdq{} \PYGZbs{}
   \PYGZgt{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\end{Verbatim}

If your query set is big, you can batch them too:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZti{}\PYGZsh{} cat query\PYGZhy{}batch\PYGZhy{}file \PYGZgt{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\end{Verbatim}

A another way is to use wildcard. The match rule support \code{*} (matches
zero or more characters) and \code{?} (matches exactly one character).For
example, you can match all usb drivers:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZti{}\PYGZsh{} echo \PYGZdq{}file drivers/usb/* +p\PYGZdq{} \PYGZgt{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\end{Verbatim}

At the syntactical level, a command comprises a sequence of match
specifications, followed by a flags change specification:

\begin{Verbatim}[commandchars=\\\{\}]
command ::= match\PYGZhy{}spec* flags\PYGZhy{}spec
\end{Verbatim}

The match-spec's are used to choose a subset of the known pr\_debug()
callsites to which to apply the flags-spec.  Think of them as a query
with implicit ANDs between each pair.  Note that an empty list of
match-specs will select all debug statement callsites.

A match specification comprises a keyword, which controls the
attribute of the callsite to be compared, and a value to compare
against.  Possible keywords are::

\begin{Verbatim}[commandchars=\\\{\}]
match\PYGZhy{}spec ::= \PYGZsq{}func\PYGZsq{} string \textbar{}
               \PYGZsq{}file\PYGZsq{} string \textbar{}
               \PYGZsq{}module\PYGZsq{} string \textbar{}
               \PYGZsq{}format\PYGZsq{} string \textbar{}
               \PYGZsq{}line\PYGZsq{} line\PYGZhy{}range

line\PYGZhy{}range ::= lineno \textbar{}
               \PYGZsq{}\PYGZhy{}\PYGZsq{}lineno \textbar{}
               lineno\PYGZsq{}\PYGZhy{}\PYGZsq{} \textbar{}
               lineno\PYGZsq{}\PYGZhy{}\PYGZsq{}lineno

lineno ::= unsigned\PYGZhy{}int
\end{Verbatim}

\begin{notice}{note}{Note:}
\code{line-range} cannot contain space, e.g.
``1-30'' is valid range but ``1 - 30'' is not.
\end{notice}

The meanings of each keyword are:
\begin{description}
\item[{func}] \leavevmode
The given string is compared against the function name
of each callsite.  Example:

\begin{Verbatim}[commandchars=\\\{\}]
func svc\PYGZus{}tcp\PYGZus{}accept
\end{Verbatim}

\item[{file}] \leavevmode
The given string is compared against either the full pathname, the
src-root relative pathname, or the basename of the source file of
each callsite.  Examples:

\begin{Verbatim}[commandchars=\\\{\}]
file svcsock.c
file kernel/freezer.c
file /usr/src/packages/BUILD/sgi\PYGZhy{}enhancednfs\PYGZhy{}1.4/default/net/sunrpc/svcsock.c
\end{Verbatim}

\item[{module}] \leavevmode
The given string is compared against the module name
of each callsite.  The module name is the string as
seen in \code{lsmod}, i.e. without the directory or the \code{.ko}
suffix and with \code{-} changed to \code{\_}.  Examples:

\begin{Verbatim}[commandchars=\\\{\}]
module sunrpc
module nfsd
\end{Verbatim}

\item[{format}] \leavevmode
The given string is searched for in the dynamic debug format
string.  Note that the string does not need to match the
entire format, only some part.  Whitespace and other
special characters can be escaped using C octal character
escape \code{\textbackslash{}ooo} notation, e.g. the space character is \code{\textbackslash{}040}.
Alternatively, the string can be enclosed in double quote
characters (\code{"}) or single quote characters (\code{'}).
Examples:

\begin{Verbatim}[commandchars=\\\{\}]
format svcrdma:         // many of the NFS/RDMA server pr\PYGZus{}debugs
format readahead        // some pr\PYGZus{}debugs in the readahead cache
format nfsd:\PYGZbs{}040SETATTR // one way to match a format with whitespace
format \PYGZdq{}nfsd: SETATTR\PYGZdq{}  // a neater way to match a format with whitespace
format \PYGZsq{}nfsd: SETATTR\PYGZsq{}  // yet another way to match a format with whitespace
\end{Verbatim}

\item[{line}] \leavevmode
The given line number or range of line numbers is compared
against the line number of each \code{pr\_debug()} callsite.  A single
line number matches the callsite line number exactly.  A
range of line numbers matches any callsite between the first
and last line number inclusive.  An empty first number means
the first line in the file, an empty last line number means the
last line number in the file.  Examples:

\begin{Verbatim}[commandchars=\\\{\}]
line 1603           // exactly line 1603
line 1600\PYGZhy{}1605      // the six lines from line 1600 to line 1605
line \PYGZhy{}1605          // the 1605 lines from line 1 to line 1605
line 1600\PYGZhy{}          // all lines from line 1600 to the end of the file
\end{Verbatim}

\end{description}

The flags specification comprises a change operation followed
by one or more flag characters.  The change operation is one
of the characters:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZhy{}    remove the given flags
+    add the given flags
=    set the flags to the given flags
\end{Verbatim}

The flags are:

\begin{Verbatim}[commandchars=\\\{\}]
p    enables the pr\PYGZus{}debug() callsite.
f    Include the function name in the printed message
l    Include line number in the printed message
m    Include module name in the printed message
t    Include thread ID in messages not generated from interrupt context
\PYGZus{}    No flags are set. (Or\PYGZsq{}d with others on input)
\end{Verbatim}

For \code{print\_hex\_dump\_debug()} and \code{print\_hex\_dump\_bytes()}, only \code{p} flag
have meaning, other flags ignored.

For display, the flags are preceded by \code{=}
(mnemonic: what the flags are currently equal to).

Note the regexp \code{\textasciicircum{}{[}-+={]}{[}flmpt\_{]}+\$} matches a flags specification.
To clear all flags at once, use \code{=\_} or \code{-flmpt}.


\section{Debug messages during Boot Process}
\label{admin-guide/dynamic-debug-howto:debug-messages-during-boot-process}
To activate debug messages for core code and built-in modules during
the boot process, even before userspace and debugfs exists, use
\code{dyndbg="QUERY"}, \code{module.dyndbg="QUERY"}, or \code{ddebug\_query="QUERY"}
(\code{ddebug\_query} is obsoleted by \code{dyndbg}, and deprecated).  QUERY follows
the syntax described above, but must not exceed 1023 characters.  Your
bootloader may impose lower limits.

These \code{dyndbg} params are processed just after the ddebug tables are
processed, as part of the arch\_initcall.  Thus you can enable debug
messages in all code run after this arch\_initcall via this boot
parameter.

On an x86 system for example ACPI enablement is a subsys\_initcall and:

\begin{Verbatim}[commandchars=\\\{\}]
dyndbg=\PYGZdq{}file ec.c +p\PYGZdq{}
\end{Verbatim}

will show early Embedded Controller transactions during ACPI setup if
your machine (typically a laptop) has an Embedded Controller.
PCI (or other devices) initialization also is a hot candidate for using
this boot parameter for debugging purposes.

If \code{foo} module is not built-in, \code{foo.dyndbg} will still be processed at
boot time, without effect, but will be reprocessed when module is
loaded later. \code{dyndbg\_query=} and bare \code{dyndbg=} are only processed at
boot.


\section{Debug Messages at Module Initialization Time}
\label{admin-guide/dynamic-debug-howto:debug-messages-at-module-initialization-time}
When \code{modprobe foo} is called, modprobe scans \code{/proc/cmdline} for
\code{foo.params}, strips \code{foo.}, and passes them to the kernel along with
params given in modprobe args or \code{/etc/modprob.d/*.conf} files,
in the following order:
\begin{enumerate}
\item {} 
parameters given via \code{/etc/modprobe.d/*.conf}:

\begin{Verbatim}[commandchars=\\\{\}]
options foo dyndbg=+pt
options foo dyndbg \PYGZsh{} defaults to +p
\end{Verbatim}

\item {} 
\code{foo.dyndbg} as given in boot args, \code{foo.} is stripped and passed:

\begin{Verbatim}[commandchars=\\\{\}]
foo.dyndbg=\PYGZdq{} func bar +p; func buz +mp\PYGZdq{}
\end{Verbatim}

\item {} 
args to modprobe:

\begin{Verbatim}[commandchars=\\\{\}]
modprobe foo dyndbg==pmf \PYGZsh{} override previous settings
\end{Verbatim}

\end{enumerate}

These \code{dyndbg} queries are applied in order, with last having final say.
This allows boot args to override or modify those from \code{/etc/modprobe.d}
(sensible, since 1 is system wide, 2 is kernel or boot specific), and
modprobe args to override both.

In the \code{foo.dyndbg="QUERY"} form, the query must exclude \code{module foo}.
\code{foo} is extracted from the param-name, and applied to each query in
\code{QUERY}, and only 1 match-spec of each type is allowed.

The \code{dyndbg} option is a ``fake'' module parameter, which means:
\begin{itemize}
\item {} 
modules do not need to define it explicitly

\item {} 
every module gets it tacitly, whether they use pr\_debug or not

\item {} 
it doesn't appear in \code{/sys/module/\$module/parameters/}
To see it, grep the control file, or inspect \code{/proc/cmdline.}

\end{itemize}

For \code{CONFIG\_DYNAMIC\_DEBUG} kernels, any settings given at boot-time (or
enabled by \code{-DDEBUG} flag during compilation) can be disabled later via
the sysfs interface if the debug messages are no longer needed:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}module module\PYGZus{}name \PYGZhy{}p\PYGZdq{} \PYGZgt{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control
\end{Verbatim}


\section{Examples}
\label{admin-guide/dynamic-debug-howto:examples}
\begin{Verbatim}[commandchars=\\\{\}]
// enable the message at line 1603 of file svcsock.c
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}file svcsock.c line 1603 +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// enable all the messages in file svcsock.c
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}file svcsock.c +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// enable all the messages in the NFS server module
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}module nfsd +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// enable all 12 messages in the function svc\PYGZus{}process()
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}func svc\PYGZus{}process +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// disable all 12 messages in the function svc\PYGZus{}process()
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}func svc\PYGZus{}process \PYGZhy{}p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// enable messages for NFS calls READ, READLINK, READDIR and READDIR+.
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}format \PYGZdq{}nfsd: READ\PYGZdq{} +p\PYGZsq{} \PYGZgt{}
                              \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// enable messages in files of which the paths include string \PYGZdq{}usb\PYGZdq{}
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}*usb* +p\PYGZsq{} \PYGZgt{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// enable all messages
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}+p\PYGZsq{} \PYGZgt{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// add module, function to all enabled messages
nullarbor:\PYGZti{} \PYGZsh{} echo \PYGZhy{}n \PYGZsq{}+mf\PYGZsq{} \PYGZgt{} \PYGZlt{}debugfs\PYGZgt{}/dynamic\PYGZus{}debug/control

// boot\PYGZhy{}args example, with newlines and comments for readability
Kernel command line: ...
  // see whats going on in dyndbg=value processing
  dynamic\PYGZus{}debug.verbose=1
  // enable pr\PYGZus{}debugs in 2 builtins, \PYGZsh{}cmt is stripped
  dyndbg=\PYGZdq{}module params +p \PYGZsh{}cmt ; module sys +p\PYGZdq{}
  // enable pr\PYGZus{}debugs in 2 functions in a module loaded later
  pc87360.dyndbg=\PYGZdq{}func pc87360\PYGZus{}init\PYGZus{}device +p; func pc87360\PYGZus{}find +p\PYGZdq{}
\end{Verbatim}


\chapter{Explaining the dreaded ``No init found.'' boot hang message}
\label{admin-guide/init::doc}\label{admin-guide/init:explaining-the-dreaded-no-init-found-boot-hang-message}
OK, so you've got this pretty unintuitive message (currently located
in init/main.c) and are wondering what the H*** went wrong.
Some high-level reasons for failure (listed roughly in order of execution)
to load the init binary are:
\begin{enumerate}
\item {} 
Unable to mount root FS

\item {} 
init binary doesn't exist on rootfs

\item {} 
broken console device

\item {} 
binary exists but dependencies not available

\item {} 
binary cannot be loaded

\end{enumerate}

Detailed explanations:
\begin{enumerate}
\item {} 
Set ``debug'' kernel parameter (in bootloader config file or CONFIG\_CMDLINE)
to get more detailed kernel messages.

\item {} 
make sure you have the correct root FS type
(and \code{root=} kernel parameter points to the correct partition),
required drivers such as storage hardware (such as SCSI or USB!)
and filesystem (ext3, jffs2 etc.) are builtin (alternatively as modules,
to be pre-loaded by an initrd)

\item {} 
Possibly a conflict in \code{console= setup} --\textgreater{} initial console unavailable.
E.g. some serial consoles are unreliable due to serial IRQ issues (e.g.
missing interrupt-based configuration).
Try using a different \code{console= device} or e.g. \code{netconsole=}.

\item {} 
e.g. required library dependencies of the init binary such as
\code{/lib/ld-linux.so.2} missing or broken. Use
\code{readelf -d \textless{}INIT\textgreater{}\textbar{}grep NEEDED} to find out which libraries are required.

\item {} 
make sure the binary's architecture matches your hardware.
E.g. i386 vs. x86\_64 mismatch, or trying to load x86 on ARM hardware.
In case you tried loading a non-binary file here (shell script?),
you should make sure that the script specifies an interpreter in its shebang
header line (\code{\#!/...}) that is fully working (including its library
dependencies). And before tackling scripts, better first test a simple
non-script binary such as \code{/bin/sh} and confirm its successful execution.
To find out more, add code \code{to init/main.c} to display kernel\_execve()s
return values.

\end{enumerate}

Please extend this explanation whenever you find new failure causes
(after all loading the init binary is a CRITICAL and hard transition step
which needs to be made as painless as possible), then submit patch to LKML.
Further TODOs:
\begin{itemize}
\item {} 
Implement the various \code{run\_init\_process()} invocations via a struct array
which can then store the \code{kernel\_execve()} result value and on failure
log it all by iterating over \textbf{all} results (very important usability fix).

\item {} 
try to make the implementation itself more helpful in general,
e.g. by providing additional error messages at affected places.

\end{itemize}

Andreas Mohr \textless{}andi at lisas period de\textgreater{}

This is the beginning of a section with information of interest to
application developers.  Documents covering various aspects of the kernel
ABI will be found here.


\chapter{Rules on how to access information in sysfs}
\label{admin-guide/sysfs-rules::doc}\label{admin-guide/sysfs-rules:rules-on-how-to-access-information-in-sysfs}
The kernel-exported sysfs exports internal kernel implementation details
and depends on internal kernel structures and layout. It is agreed upon
by the kernel developers that the Linux kernel does not provide a stable
internal API. Therefore, there are aspects of the sysfs interface that
may not be stable across kernel releases.

To minimize the risk of breaking users of sysfs, which are in most cases
low-level userspace applications, with a new kernel release, the users
of sysfs must follow some rules to use an as-abstract-as-possible way to
access this filesystem. The current udev and HAL programs already
implement this and users are encouraged to plug, if possible, into the
abstractions these programs provide instead of accessing sysfs directly.

But if you really do want or need to access sysfs directly, please follow
the following rules and then your programs should work with future
versions of the sysfs interface.
\begin{itemize}
\item {} \begin{description}
\item[{Do not use libsysfs}] \leavevmode
It makes assumptions about sysfs which are not true. Its API does not
offer any abstraction, it exposes all the kernel driver-core
implementation details in its own API. Therefore it is not better than
reading directories and opening the files yourself.
Also, it is not actively maintained, in the sense of reflecting the
current kernel development. The goal of providing a stable interface
to sysfs has failed; it causes more problems than it solves. It
violates many of the rules in this document.

\end{description}

\item {} \begin{description}
\item[{sysfs is always at \code{/sys}}] \leavevmode
Parsing \code{/proc/mounts} is a waste of time. Other mount points are a
system configuration bug you should not try to solve. For test cases,
possibly support a \code{SYSFS\_PATH} environment variable to overwrite the
application's behavior, but never try to search for sysfs. Never try
to mount it, if you are not an early boot script.

\end{description}

\item {} \begin{description}
\item[{devices are only ``devices''}] \leavevmode
There is no such thing like class-, bus-, physical devices,
interfaces, and such that you can rely on in userspace. Everything is
just simply a ``device''. Class-, bus-, physical, ... types are just
kernel implementation details which should not be expected by
applications that look for devices in sysfs.

The properties of a device are:
\begin{itemize}
\item {} 
devpath (\code{/devices/pci0000:00/0000:00:1d.1/usb2/2-2/2-2:1.0})
\begin{itemize}
\item {} 
identical to the DEVPATH value in the event sent from the kernel
at device creation and removal

\item {} 
the unique key to the device at that point in time

\item {} 
the kernel's path to the device directory without the leading
\code{/sys}, and always starting with a slash

\item {} 
all elements of a devpath must be real directories. Symlinks
pointing to /sys/devices must always be resolved to their real
target and the target path must be used to access the device.
That way the devpath to the device matches the devpath of the
kernel used at event time.

\item {} 
using or exposing symlink values as elements in a devpath string
is a bug in the application

\end{itemize}

\item {} 
kernel name (\code{sda}, \code{tty}, \code{0000:00:1f.2}, ...)
\begin{itemize}
\item {} 
a directory name, identical to the last element of the devpath

\item {} 
applications need to handle spaces and characters like \code{!} in
the name

\end{itemize}

\item {} 
subsystem (\code{block}, \code{tty}, \code{pci}, ...)
\begin{itemize}
\item {} 
simple string, never a path or a link

\item {} 
retrieved by reading the ``subsystem''-link and using only the
last element of the target path

\end{itemize}

\item {} 
driver (\code{tg3}, \code{ata\_piix}, \code{uhci\_hcd})
\begin{itemize}
\item {} 
a simple string, which may contain spaces, never a path or a
link

\item {} 
it is retrieved by reading the ``driver''-link and using only the
last element of the target path

\item {} 
devices which do not have ``driver''-link just do not have a
driver; copying the driver value in a child device context is a
bug in the application

\end{itemize}

\item {} 
attributes
\begin{itemize}
\item {} 
the files in the device directory or files below subdirectories
of the same device directory

\item {} 
accessing attributes reached by a symlink pointing to another device,
like the ``device''-link, is a bug in the application

\end{itemize}

\end{itemize}

Everything else is just a kernel driver-core implementation detail
that should not be assumed to be stable across kernel releases.

\end{description}

\item {} \begin{description}
\item[{Properties of parent devices never belong into a child device.}] \leavevmode
Always look at the parent devices themselves for determining device
context properties. If the device \code{eth0} or \code{sda} does not have a
``driver''-link, then this device does not have a driver. Its value is empty.
Never copy any property of the parent-device into a child-device. Parent
device properties may change dynamically without any notice to the
child device.

\end{description}

\item {} \begin{description}
\item[{Hierarchy in a single device tree}] \leavevmode
There is only one valid place in sysfs where hierarchy can be examined
and this is below: \code{/sys/devices.}
It is planned that all device directories will end up in the tree
below this directory.

\end{description}

\item {} \begin{description}
\item[{Classification by subsystem}] \leavevmode
There are currently three places for classification of devices:
\code{/sys/block,} \code{/sys/class} and \code{/sys/bus.} It is planned that these will
not contain any device directories themselves, but only flat lists of
symlinks pointing to the unified \code{/sys/devices} tree.
All three places have completely different rules on how to access
device information. It is planned to merge all three
classification directories into one place at \code{/sys/subsystem},
following the layout of the bus directories. All buses and
classes, including the converted block subsystem, will show up
there.
The devices belonging to a subsystem will create a symlink in the
``devices'' directory at \code{/sys/subsystem/\textless{}name\textgreater{}/devices},

If \code{/sys/subsystem} exists, \code{/sys/bus}, \code{/sys/class} and \code{/sys/block}
can be ignored. If it does not exist, you always have to scan all three
places, as the kernel is free to move a subsystem from one place to
the other, as long as the devices are still reachable by the same
subsystem name.

Assuming \code{/sys/class/\textless{}subsystem\textgreater{}} and \code{/sys/bus/\textless{}subsystem\textgreater{}}, or
\code{/sys/block} and \code{/sys/class/block} are not interchangeable is a bug in
the application.

\end{description}

\item {} \begin{description}
\item[{Block}] \leavevmode
The converted block subsystem at \code{/sys/class/block} or
\code{/sys/subsystem/block} will contain the links for disks and partitions
at the same level, never in a hierarchy. Assuming the block subsystem to
contain only disks and not partition devices in the same flat list is
a bug in the application.

\end{description}

\item {} \begin{description}
\item[{``device''-link and \textless{}subsystem\textgreater{}:\textless{}kernel name\textgreater{}-links}] \leavevmode
Never depend on the ``device''-link. The ``device''-link is a workaround
for the old layout, where class devices are not created in
\code{/sys/devices/} like the bus devices. If the link-resolving of a
device directory does not end in \code{/sys/devices/}, you can use the
``device''-link to find the parent devices in \code{/sys/devices/}, That is the
single valid use of the ``device''-link; it must never appear in any
path as an element. Assuming the existence of the ``device''-link for
a device in \code{/sys/devices/} is a bug in the application.
Accessing \code{/sys/class/net/eth0/device} is a bug in the application.

Never depend on the class-specific links back to the \code{/sys/class}
directory.  These links are also a workaround for the design mistake
that class devices are not created in \code{/sys/devices.} If a device
directory does not contain directories for child devices, these links
may be used to find the child devices in \code{/sys/class.} That is the single
valid use of these links; they must never appear in any path as an
element. Assuming the existence of these links for devices which are
real child device directories in the \code{/sys/devices} tree is a bug in
the application.

It is planned to remove all these links when all class device
directories live in \code{/sys/devices.}

\end{description}

\item {} \begin{description}
\item[{Position of devices along device chain can change.}] \leavevmode
Never depend on a specific parent device position in the devpath,
or the chain of parent devices. The kernel is free to insert devices into
the chain. You must always request the parent device you are looking for
by its subsystem value. You need to walk up the chain until you find
the device that matches the expected subsystem. Depending on a specific
position of a parent device or exposing relative paths using \code{../} to
access the chain of parents is a bug in the application.

\end{description}

\item {} \begin{description}
\item[{When reading and writing sysfs device attribute files, avoid dependency}] \leavevmode
on specific error codes wherever possible. This minimizes coupling to
the error handling implementation within the kernel.

In general, failures to read or write sysfs device attributes shall
propagate errors wherever possible. Common errors include, but are not
limited to:
\begin{quote}

\code{-EIO}: The read or store operation is not supported, typically
returned by the sysfs system itself if the read or store pointer
is \code{NULL}.

\code{-ENXIO}: The read or store operation failed
\end{quote}

Error codes will not be changed without good reason, and should a change
to error codes result in user-space breakage, it will be fixed, or the
the offending change will be reverted.

Userspace applications can, however, expect the format and contents of
the attribute files to remain consistent in the absence of a version
attribute change in the context of a given attribute.

\end{description}

\end{itemize}

The rest of this manual consists of various unordered guides on how to
configure specific aspects of kernel behavior to your liking.


\chapter{Using the initial RAM disk (initrd)}
\label{admin-guide/initrd:using-the-initial-ram-disk-initrd}\label{admin-guide/initrd::doc}
Written 1996,2000 by Werner Almesberger \textless{}\href{mailto:werner.almesberger@epfl.ch}{werner.almesberger@epfl.ch}\textgreater{} and
Hans Lermen \textless{}\href{mailto:lermen@fgan.de}{lermen@fgan.de}\textgreater{}

initrd provides the capability to load a RAM disk by the boot loader.
This RAM disk can then be mounted as the root file system and programs
can be run from it. Afterwards, a new root file system can be mounted
from a different device. The previous root (from initrd) is then moved
to a directory and can be subsequently unmounted.

initrd is mainly designed to allow system startup to occur in two phases,
where the kernel comes up with a minimum set of compiled-in drivers, and
where additional modules are loaded from initrd.

This document gives a brief overview of the use of initrd. A more detailed
discussion of the boot process can be found in \footnote[1]{
Almesberger, Werner; ``Booting Linux: The History and the Future''
\href{http://www.almesberger.net/cv/papers/ols2k-9.ps.gz}{http://www.almesberger.net/cv/papers/ols2k-9.ps.gz}
}.


\section{Operation}
\label{admin-guide/initrd:operation}
When using initrd, the system typically boots as follows:
\begin{enumerate}
\item {} 
the boot loader loads the kernel and the initial RAM disk

\item {} 
the kernel converts initrd into a ``normal'' RAM disk and
frees the memory used by initrd

\item {} 
if the root device is not \code{/dev/ram0}, the old (deprecated)
change\_root procedure is followed. see the ``Obsolete root change
mechanism'' section below.

\item {} 
root device is mounted. if it is \code{/dev/ram0}, the initrd image is
then mounted as root

\item {} 
/sbin/init is executed (this can be any valid executable, including
shell scripts; it is run with uid 0 and can do basically everything
init can do).

\item {} 
init mounts the ``real'' root file system

\item {} 
init places the root file system at the root directory using the
pivot\_root system call

\item {} 
init execs the \code{/sbin/init} on the new root filesystem, performing
the usual boot sequence

\item {} 
the initrd file system is removed

\end{enumerate}

Note that changing the root directory does not involve unmounting it.
It is therefore possible to leave processes running on initrd during that
procedure. Also note that file systems mounted under initrd continue to
be accessible.


\section{Boot command-line options}
\label{admin-guide/initrd:boot-command-line-options}
initrd adds the following new options:

\begin{Verbatim}[commandchars=\\\{\}]
initrd=\PYGZlt{}path\PYGZgt{}    (e.g. LOADLIN)

  Loads the specified file as the initial RAM disk. When using LILO, you
  have to specify the RAM disk image file in /etc/lilo.conf, using the
  INITRD configuration variable.

noinitrd

  initrd data is preserved but it is not converted to a RAM disk and
  the \PYGZdq{}normal\PYGZdq{} root file system is mounted. initrd data can be read
  from /dev/initrd. Note that the data in initrd can have any structure
  in this case and doesn\PYGZsq{}t necessarily have to be a file system image.
  This option is used mainly for debugging.

  Note: /dev/initrd is read\PYGZhy{}only and it can only be used once. As soon
  as the last process has closed it, all data is freed and /dev/initrd
  can\PYGZsq{}t be opened anymore.

root=/dev/ram0

  initrd is mounted as root, and the normal boot procedure is followed,
  with the RAM disk mounted as root.
\end{Verbatim}


\section{Compressed cpio images}
\label{admin-guide/initrd:compressed-cpio-images}
Recent kernels have support for populating a ramdisk from a compressed cpio
archive. On such systems, the creation of a ramdisk image doesn't need to
involve special block devices or loopbacks; you merely create a directory on
disk with the desired initrd content, cd to that directory, and run (as an
example):

\begin{Verbatim}[commandchars=\\\{\}]
find . \textbar{} cpio \PYGZhy{}\PYGZhy{}quiet \PYGZhy{}H newc \PYGZhy{}o \textbar{} gzip \PYGZhy{}9 \PYGZhy{}n \PYGZgt{} /boot/imagefile.img
\end{Verbatim}

Examining the contents of an existing image file is just as simple:

\begin{Verbatim}[commandchars=\\\{\}]
mkdir /tmp/imagefile
cd /tmp/imagefile
gzip \PYGZhy{}cd /boot/imagefile.img \textbar{} cpio \PYGZhy{}imd \PYGZhy{}\PYGZhy{}quiet
\end{Verbatim}


\section{Installation}
\label{admin-guide/initrd:installation}
First, a directory for the initrd file system has to be created on the
``normal'' root file system, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} mkdir /initrd
\end{Verbatim}

The name is not relevant. More details can be found on the
\emph{\texttt{pivot\_root(2)}} man page.

If the root file system is created during the boot procedure (i.e. if
you're building an install floppy), the root file system creation
procedure should create the \code{/initrd} directory.

If initrd will not be mounted in some cases, its content is still
accessible if the following device has been created:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} mknod /dev/initrd b 1 250
\PYGZsh{} chmod 400 /dev/initrd
\end{Verbatim}

Second, the kernel has to be compiled with RAM disk support and with
support for the initial RAM disk enabled. Also, at least all components
needed to execute programs from initrd (e.g. executable format and file
system) must be compiled into the kernel.

Third, you have to create the RAM disk image. This is done by creating a
file system on a block device, copying files to it as needed, and then
copying the content of the block device to the initrd file. With recent
kernels, at least three types of devices are suitable for that:
\begin{itemize}
\item {} 
a floppy disk (works everywhere but it's painfully slow)

\item {} 
a RAM disk (fast, but allocates physical memory)

\item {} 
a loopback device (the most elegant solution)

\end{itemize}

We'll describe the loopback device method:
\begin{enumerate}
\item {} 
make sure loopback block devices are configured into the kernel

\item {} 
create an empty file system of the appropriate size, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} dd if=/dev/zero of=initrd bs=300k count=1
\PYGZsh{} mke2fs \PYGZhy{}F \PYGZhy{}m0 initrd
\end{Verbatim}

(if space is critical, you may want to use the Minix FS instead of Ext2)

\item {} 
mount the file system, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} mount \PYGZhy{}t ext2 \PYGZhy{}o loop initrd /mnt
\end{Verbatim}

\item {} 
create the console device:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} mkdir /mnt/dev
\PYGZsh{} mknod /mnt/dev/console c 5 1
\end{Verbatim}

\item {} 
copy all the files that are needed to properly use the initrd
environment. Don't forget the most important file, \code{/sbin/init}

\begin{notice}{note}{Note:}
\code{/sbin/init} permissions must include ``x'' (execute).
\end{notice}

\item {} 
correct operation the initrd environment can frequently be tested
even without rebooting with the command:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} chroot /mnt /sbin/init
\end{Verbatim}

This is of course limited to initrds that do not interfere with the
general system state (e.g. by reconfiguring network interfaces,
overwriting mounted devices, trying to start already running demons,
etc. Note however that it is usually possible to use pivot\_root in
such a chroot'ed initrd environment.)

\item {} 
unmount the file system:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} umount /mnt
\end{Verbatim}

\item {} 
the initrd is now in the file ``initrd''. Optionally, it can now be
compressed:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} gzip \PYGZhy{}9 initrd
\end{Verbatim}

\end{enumerate}

For experimenting with initrd, you may want to take a rescue floppy and
only add a symbolic link from \code{/sbin/init} to \code{/bin/sh}. Alternatively, you
can try the experimental newlib environment \footnote[2]{
newlib package (experimental), with initrd example
\href{https://www.sourceware.org/newlib/}{https://www.sourceware.org/newlib/}
} to create a small
initrd.

Finally, you have to boot the kernel and load initrd. Almost all Linux
boot loaders support initrd. Since the boot process is still compatible
with an older mechanism, the following boot command line parameters
have to be given:

\begin{Verbatim}[commandchars=\\\{\}]
root=/dev/ram0 rw
\end{Verbatim}

(rw is only necessary if writing to the initrd file system.)

With LOADLIN, you simply execute:

\begin{Verbatim}[commandchars=\\\{\}]
LOADLIN \PYGZlt{}kernel\PYGZgt{} initrd=\PYGZlt{}disk\PYGZus{}image\PYGZgt{}
\end{Verbatim}

e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
LOADLIN C:\PYGZbs{}LINUX\PYGZbs{}BZIMAGE initrd=C:\PYGZbs{}LINUX\PYGZbs{}INITRD.GZ root=/dev/ram0 rw
\end{Verbatim}

With LILO, you add the option \code{INITRD=\textless{}path\textgreater{}} to either the global section
or to the section of the respective kernel in \code{/etc/lilo.conf}, and pass
the options using APPEND, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
image = /bzImage
  initrd = /boot/initrd.gz
  append = \PYGZdq{}root=/dev/ram0 rw\PYGZdq{}
\end{Verbatim}

and run \code{/sbin/lilo}

For other boot loaders, please refer to the respective documentation.

Now you can boot and enjoy using initrd.


\section{Changing the root device}
\label{admin-guide/initrd:changing-the-root-device}
When finished with its duties, init typically changes the root device
and proceeds with starting the Linux system on the ``real'' root device.
\begin{description}
\item[{The procedure involves the following steps:}] \leavevmode\begin{itemize}
\item {} 
mounting the new root file system

\item {} 
turning it into the root file system

\item {} 
removing all accesses to the old (initrd) root file system

\item {} 
unmounting the initrd file system and de-allocating the RAM disk

\end{itemize}

\end{description}

Mounting the new root file system is easy: it just needs to be mounted on
a directory under the current root. Example:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} mkdir /new\PYGZhy{}root
\PYGZsh{} mount \PYGZhy{}o ro /dev/hda1 /new\PYGZhy{}root
\end{Verbatim}

The root change is accomplished with the pivot\_root system call, which
is also available via the \code{pivot\_root} utility (see \emph{\texttt{pivot\_root(8)}}
man page; \code{pivot\_root} is distributed with util-linux version 2.10h or higher
\footnote[3]{
util-linux: Miscellaneous utilities for Linux
\href{https://www.kernel.org/pub/linux/utils/util-linux/}{https://www.kernel.org/pub/linux/utils/util-linux/}
}). \code{pivot\_root} moves the current root to a directory under the new
root, and puts the new root at its place. The directory for the old root
must exist before calling \code{pivot\_root}. Example:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} cd /new\PYGZhy{}root
\PYGZsh{} mkdir initrd
\PYGZsh{} pivot\PYGZus{}root . initrd
\end{Verbatim}

Now, the init process may still access the old root via its
executable, shared libraries, standard input/output/error, and its
current root directory. All these references are dropped by the
following command:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} exec chroot . what\PYGZhy{}follows \PYGZlt{}dev/console \PYGZgt{}dev/console 2\PYGZgt{}\PYGZam{}1
\end{Verbatim}

Where what-follows is a program under the new root, e.g. \code{/sbin/init}
If the new root file system will be used with udev and has no valid
\code{/dev} directory, udev must be initialized before invoking chroot in order
to provide \code{/dev/console}.

Note: implementation details of pivot\_root may change with time. In order
to ensure compatibility, the following points should be observed:
\begin{itemize}
\item {} 
before calling pivot\_root, the current directory of the invoking
process should point to the new root directory

\item {} 
use . as the first argument, and the \_relative\_ path of the directory
for the old root as the second argument

\item {} 
a chroot program must be available under the old and the new root

\item {} 
chroot to the new root afterwards

\item {} 
use relative paths for dev/console in the exec command

\end{itemize}

Now, the initrd can be unmounted and the memory allocated by the RAM
disk can be freed:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} umount /initrd
\PYGZsh{} blockdev \PYGZhy{}\PYGZhy{}flushbufs /dev/ram0
\end{Verbatim}

It is also possible to use initrd with an NFS-mounted root, see the
\emph{\texttt{pivot\_root(8)}} man page for details.


\section{Usage scenarios}
\label{admin-guide/initrd:usage-scenarios}
The main motivation for implementing initrd was to allow for modular
kernel configuration at system installation. The procedure would work
as follows:
\begin{enumerate}
\item {} 
system boots from floppy or other media with a minimal kernel
(e.g. support for RAM disks, initrd, a.out, and the Ext2 FS) and
loads initrd

\item {} 
\code{/sbin/init} determines what is needed to (1) mount the ``real'' root FS
(i.e. device type, device drivers, file system) and (2) the
distribution media (e.g. CD-ROM, network, tape, ...). This can be
done by asking the user, by auto-probing, or by using a hybrid
approach.

\item {} 
\code{/sbin/init} loads the necessary kernel modules

\item {} 
\code{/sbin/init} creates and populates the root file system (this doesn't
have to be a very usable system yet)

\item {} 
\code{/sbin/init} invokes \code{pivot\_root} to change the root file system and
execs - via chroot - a program that continues the installation

\item {} 
the boot loader is installed

\item {} 
the boot loader is configured to load an initrd with the set of
modules that was used to bring up the system (e.g. \code{/initrd} can be
modified, then unmounted, and finally, the image is written from
\code{/dev/ram0} or \code{/dev/rd/0} to a file)

\item {} 
now the system is bootable and additional installation tasks can be
performed

\end{enumerate}

The key role of initrd here is to re-use the configuration data during
normal system operation without requiring the use of a bloated ``generic''
kernel or re-compiling or re-linking the kernel.

A second scenario is for installations where Linux runs on systems with
different hardware configurations in a single administrative domain. In
such cases, it is desirable to generate only a small set of kernels
(ideally only one) and to keep the system-specific part of configuration
information as small as possible. In this case, a common initrd could be
generated with all the necessary modules. Then, only \code{/sbin/init} or a file
read by it would have to be different.

A third scenario is more convenient recovery disks, because information
like the location of the root FS partition doesn't have to be provided at
boot time, but the system loaded from initrd can invoke a user-friendly
dialog and it can also perform some sanity checks (or even some form of
auto-detection).

Last not least, CD-ROM distributors may use it for better installation
from CD, e.g. by using a boot floppy and bootstrapping a bigger RAM disk
via initrd from CD; or by booting via a loader like \code{LOADLIN} or directly
from the CD-ROM, and loading the RAM disk from CD without need of
floppies.


\section{Obsolete root change mechanism}
\label{admin-guide/initrd:obsolete-root-change-mechanism}
The following mechanism was used before the introduction of pivot\_root.
Current kernels still support it, but you should \_not\_ rely on its
continued availability.

It works by mounting the ``real'' root device (i.e. the one set with rdev
in the kernel image or with root=... at the boot command line) as the
root file system when linuxrc exits. The initrd file system is then
unmounted, or, if it is still busy, moved to a directory \code{/initrd}, if
such a directory exists on the new root file system.

In order to use this mechanism, you do not have to specify the boot
command options root, init, or rw. (If specified, they will affect
the real root file system, not the initrd environment.)

If /proc is mounted, the ``real'' root device can be changed from within
linuxrc by writing the number of the new root FS device to the special
file /proc/sys/kernel/real-root-dev, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} echo 0x301 \PYGZgt{}/proc/sys/kernel/real\PYGZhy{}root\PYGZhy{}dev
\end{Verbatim}

Note that the mechanism is incompatible with NFS and similar file
systems.

This old, deprecated mechanism is commonly called \code{change\_root}, while
the new, supported mechanism is called \code{pivot\_root}.


\section{Mixed change\_root and pivot\_root mechanism}
\label{admin-guide/initrd:mixed-change-root-and-pivot-root-mechanism}
In case you did not want to use \code{root=/dev/ram0} to trigger the pivot\_root
mechanism, you may create both \code{/linuxrc} and \code{/sbin/init} in your initrd
image.

\code{/linuxrc} would contain only the following:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{}! /bin/sh
mount \PYGZhy{}n \PYGZhy{}t proc proc /proc
echo 0x0100 \PYGZgt{}/proc/sys/kernel/real\PYGZhy{}root\PYGZhy{}dev
umount \PYGZhy{}n /proc
\end{Verbatim}

Once linuxrc exited, the kernel would mount again your initrd as root,
this time executing \code{/sbin/init}. Again, it would be the duty of this init
to build the right environment (maybe using the \code{root= device} passed on
the cmdline) before the final execution of the real \code{/sbin/init}.


\section{Resources}
\label{admin-guide/initrd:resources}

\chapter{Linux Serial Console}
\label{admin-guide/serial-console::doc}\label{admin-guide/serial-console:serial-console}\label{admin-guide/serial-console:linux-serial-console}
To use a serial port as console you need to compile the support into your
kernel - by default it is not compiled in. For PC style serial ports
it's the config option next to menu option:

\emph{Character devices \(\rightarrow\) Serial drivers \(\rightarrow\) 8250/16550 and compatible serial support \(\rightarrow\) Console on 8250/16550 and compatible serial port}

You must compile serial support into the kernel and not as a module.

It is possible to specify multiple devices for console output. You can
define a new kernel command line option to select which device(s) to
use for console output.

The format of this option is:

\begin{Verbatim}[commandchars=\\\{\}]
console=device,options

device:         tty0 for the foreground virtual console
                ttyX for any other virtual console
                ttySx for a serial port
                lp0 for the first parallel port
                ttyUSB0 for the first USB serial device

options:        depend on the driver. For the serial port this
                defines the baudrate/parity/bits/flow control of
                the port, in the format BBBBPNF, where BBBB is the
                speed, P is parity (n/o/e), N is number of bits,
                and F is flow control (\PYGZsq{}r\PYGZsq{} for RTS). Default is
                9600n8. The maximum baudrate is 115200.
\end{Verbatim}

You can specify multiple console= options on the kernel command line.
Output will appear on all of them. The last device will be used when
you open \code{/dev/console}. So, for example:

\begin{Verbatim}[commandchars=\\\{\}]
console=ttyS1,9600 console=tty0
\end{Verbatim}

defines that opening \code{/dev/console} will get you the current foreground
virtual console, and kernel messages will appear on both the VGA
console and the 2nd serial port (ttyS1 or COM2) at 9600 baud.

Note that you can only define one console per device type (serial, video).

If no console device is specified, the first device found capable of
acting as a system console will be used. At this time, the system
first looks for a VGA card and then for a serial port. So if you don't
have a VGA card in your system the first serial port will automatically
become the console.

You will need to create a new device to use \code{/dev/console}. The official
\code{/dev/console} is now character device 5,1.

(You can also use a network device as a console.  See
\code{Documentation/networking/netconsole.txt} for information on that.)

Here's an example that will use \code{/dev/ttyS1} (COM2) as the console.
Replace the sample values as needed.
\begin{enumerate}
\item {} 
Create \code{/dev/console} (real console) and \code{/dev/tty0} (master virtual
console):

\begin{Verbatim}[commandchars=\\\{\}]
cd /dev
rm \PYGZhy{}f console tty0
mknod \PYGZhy{}m 622 console c 5 1
mknod \PYGZhy{}m 622 tty0 c 4 0
\end{Verbatim}

\item {} 
LILO can also take input from a serial device. This is a very
useful option. To tell LILO to use the serial port:
In lilo.conf (global section):

\begin{Verbatim}[commandchars=\\\{\}]
serial  = 1,9600n8 (ttyS1, 9600 bd, no parity, 8 bits)
\end{Verbatim}

\item {} 
Adjust to kernel flags for the new kernel,
again in lilo.conf (kernel section):

\begin{Verbatim}[commandchars=\\\{\}]
append = \PYGZdq{}console=ttyS1,9600\PYGZdq{}
\end{Verbatim}

\item {} 
Make sure a getty runs on the serial port so that you can login to
it once the system is done booting. This is done by adding a line
like this to \code{/etc/inittab} (exact syntax depends on your getty):

\begin{Verbatim}[commandchars=\\\{\}]
S1:23:respawn:/sbin/getty \PYGZhy{}L ttyS1 9600 vt100
\end{Verbatim}

\item {} 
Init and \code{/etc/ioctl.save}

Sysvinit remembers its stty settings in a file in \code{/etc}, called
\code{/etc/ioctl.save}. REMOVE THIS FILE before using the serial
console for the first time, because otherwise init will probably
set the baudrate to 38400 (baudrate of the virtual console).

\item {} 
\code{/dev/console} and X
Programs that want to do something with the virtual console usually
open \code{/dev/console}. If you have created the new \code{/dev/console} device,
and your console is NOT the virtual console some programs will fail.
Those are programs that want to access the VT interface, and use
\code{/dev/console instead of /dev/tty0}. Some of those programs are:

\begin{Verbatim}[commandchars=\\\{\}]
Xfree86, svgalib, gpm, SVGATextMode
\end{Verbatim}

It should be fixed in modern versions of these programs though.

Note that if you boot without a \code{console=} option (or with
\code{console=/dev/tty0}), \code{/dev/console} is the same as \code{/dev/tty0}.
In that case everything will still work.

\item {} 
Thanks

Thanks to Geert Uytterhoeven \textless{}\href{mailto:geert@linux-m68k.org}{geert@linux-m68k.org}\textgreater{}
for porting the patches from 2.1.4x to 2.1.6x for taking care of
the integration of these patches into m68k, ppc and alpha.

\end{enumerate}

Miquel van Smoorenburg \textless{}\href{mailto:miquels@cistron.nl}{miquels@cistron.nl}\textgreater{}, 11-Jun-2000


\chapter{Linux Braille Console}
\label{admin-guide/braille-console:linux-braille-console}\label{admin-guide/braille-console::doc}
To get early boot messages on a braille device (before userspace screen
readers can start), you first need to compile the support for the usual serial
console (see {\hyperref[admin\string-guide/serial\string-console:serial\string-console]{\emph{Documentation/admin-guide/serial-console.rst}}}), and
for braille device
(in \emph{Device Drivers \(\rightarrow\) Accessibility support \(\rightarrow\) Console on braille device}).

Then you need to specify a \code{console=brl}, option on the kernel command line, the
format is:

\begin{Verbatim}[commandchars=\\\{\}]
console=brl,serial\PYGZus{}options...
\end{Verbatim}

where \code{serial\_options...} are the same as described in
{\hyperref[admin\string-guide/serial\string-console:serial\string-console]{\emph{Documentation/admin-guide/serial-console.rst}}}.

So for instance you can use \code{console=brl,ttyS0} if the braille device is connected to the first serial port, and \code{console=brl,ttyS0,115200} to
override the baud rate to 115200, etc.

By default, the braille device will just show the last kernel message (console
mode).  To review previous messages, press the Insert key to switch to the VT
review mode.  In review mode, the arrow keys permit to browse in the VT content,
\code{PAGE-UP}/\code{PAGE-DOWN} keys go at the top/bottom of the screen, and
the \code{HOME} key goes back
to the cursor, hence providing very basic screen reviewing facility.

Sound feedback can be obtained by adding the \code{braille\_console.sound=1} kernel
parameter.

For simplicity, only one braille console can be enabled, other uses of
\code{console=brl,...} will be discarded.  Also note that it does not interfere with
the console selection mechanism described in
{\hyperref[admin\string-guide/serial\string-console:serial\string-console]{\emph{Documentation/admin-guide/serial-console.rst}}}.

For now, only the VisioBraille device is supported.

Samuel Thibault \textless{}\href{mailto:samuel.thibault@ens-lyon.org}{samuel.thibault@ens-lyon.org}\textgreater{}


\chapter{Parport}
\label{admin-guide/parport:parport}\label{admin-guide/parport::doc}
The \code{parport} code provides parallel-port support under Linux.  This
includes the ability to share one port between multiple device
drivers.

You can pass parameters to the \code{parport} code to override its automatic
detection of your hardware.  This is particularly useful if you want
to use IRQs, since in general these can't be autoprobed successfully.
By default IRQs are not used even if they \textbf{can} be probed.  This is
because there are a lot of people using the same IRQ for their
parallel port and a sound card or network card.

The \code{parport} code is split into two parts: generic (which deals with
port-sharing) and architecture-dependent (which deals with actually
using the port).


\section{Parport as modules}
\label{admin-guide/parport:parport-as-modules}
If you load the \emph{parport{}`} code as a module, say:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} insmod parport
\end{Verbatim}

to load the generic \code{parport} code.  You then must load the
architecture-dependent code with (for example):

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} insmod parport\PYGZus{}pc io=0x3bc,0x378,0x278 irq=none,7,auto
\end{Verbatim}

to tell the \code{parport} code that you want three PC-style ports, one at
0x3bc with no IRQ, one at 0x378 using IRQ 7, and one at 0x278 with an
auto-detected IRQ.  Currently, PC-style (\code{parport\_pc}), Sun \code{bpp},
Amiga, Atari, and MFC3 hardware is supported.

PCI parallel I/O card support comes from \code{parport\_pc}.  Base I/O
addresses should not be specified for supported PCI cards since they
are automatically detected.


\subsection{modprobe}
\label{admin-guide/parport:modprobe}
If you use modprobe , you will find it useful to add lines as below to a
configuration file in /etc/modprobe.d/ directory:

\begin{Verbatim}[commandchars=\\\{\}]
alias parport\PYGZus{}lowlevel parport\PYGZus{}pc
options parport\PYGZus{}pc io=0x378,0x278 irq=7,auto
\end{Verbatim}

modprobe will load \code{parport\_pc} (with the options \code{io=0x378,0x278 irq=7,auto})
whenever a parallel port device driver (such as \code{lp}) is loaded.

Note that these are example lines only!  You shouldn't in general need
to specify any options to \code{parport\_pc} in order to be able to use a
parallel port.


\subsection{Parport probe {[}optional{]}}
\label{admin-guide/parport:parport-probe-optional}
In 2.2 kernels there was a module called \code{parport\_probe}, which was used
for collecting IEEE 1284 device ID information.  This has now been
enhanced and now lives with the IEEE 1284 support.  When a parallel
port is detected, the devices that are connected to it are analysed,
and information is logged like this:

\begin{Verbatim}[commandchars=\\\{\}]
parport0: Printer, BJC\PYGZhy{}210 (Canon)
\end{Verbatim}

The probe information is available from files in \code{/proc/sys/dev/parport/}.


\section{Parport linked into the kernel statically}
\label{admin-guide/parport:parport-linked-into-the-kernel-statically}
If you compile the \code{parport} code into the kernel, then you can use
kernel boot parameters to get the same effect.  Add something like the
following to your LILO command line:

\begin{Verbatim}[commandchars=\\\{\}]
parport=0x3bc parport=0x378,7 parport=0x278,auto,nofifo
\end{Verbatim}

You can have many \code{parport=...} statements, one for each port you want
to add.  Adding \code{parport=0} to the kernel command-line will disable
parport support entirely.  Adding \code{parport=auto} to the kernel
command-line will make \code{parport} use any IRQ lines or DMA channels that
it auto-detects.


\section{Files in /proc}
\label{admin-guide/parport:files-in-proc}
If you have configured the \code{/proc} filesystem into your kernel, you will
see a new directory entry: \code{/proc/sys/dev/parport}.  In there will be a
directory entry for each parallel port for which parport is
configured.  In each of those directories are a collection of files
describing that parallel port.

The \code{/proc/sys/dev/parport} directory tree looks like:

\begin{Verbatim}[commandchars=\\\{\}]
parport
\textbar{}\PYGZhy{}\PYGZhy{} default
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} spintime
\textbar{}   {}`\PYGZhy{}\PYGZhy{} timeslice
\textbar{}\PYGZhy{}\PYGZhy{} parport0
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} autoprobe
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} autoprobe0
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} autoprobe1
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} autoprobe2
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} autoprobe3
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} devices
\textbar{}   \textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} active
\textbar{}   \textbar{}   {}`\PYGZhy{}\PYGZhy{} lp
\textbar{}   \textbar{}       {}`\PYGZhy{}\PYGZhy{} timeslice
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} base\PYGZhy{}addr
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} irq
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} dma
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} modes
\textbar{}   {}`\PYGZhy{}\PYGZhy{} spintime
{}`\PYGZhy{}\PYGZhy{} parport1
\textbar{}\PYGZhy{}\PYGZhy{} autoprobe
\textbar{}\PYGZhy{}\PYGZhy{} autoprobe0
\textbar{}\PYGZhy{}\PYGZhy{} autoprobe1
\textbar{}\PYGZhy{}\PYGZhy{} autoprobe2
\textbar{}\PYGZhy{}\PYGZhy{} autoprobe3
\textbar{}\PYGZhy{}\PYGZhy{} devices
\textbar{}   \textbar{}\PYGZhy{}\PYGZhy{} active
\textbar{}   {}`\PYGZhy{}\PYGZhy{} ppa
\textbar{}       {}`\PYGZhy{}\PYGZhy{} timeslice
\textbar{}\PYGZhy{}\PYGZhy{} base\PYGZhy{}addr
\textbar{}\PYGZhy{}\PYGZhy{} irq
\textbar{}\PYGZhy{}\PYGZhy{} dma
\textbar{}\PYGZhy{}\PYGZhy{} modes
{}`\PYGZhy{}\PYGZhy{} spintime
\end{Verbatim}

\begin{tabulary}{\linewidth}{|p{4.0cm}|p{13.5cm}|}
\hline
\textsf{\relax 
File
} & \textsf{\relax 
Contents
}\\
\hline
\code{devices/active}
 & 
A list of the device drivers using that port.  A ``+''
will appear by the name of the device currently using
the port (it might not appear against any).  The
string ``none'' means that there are no device drivers
using that port.
\\
\hline
\code{base-addr}
 & 
Parallel port's base address, or addresses if the port
has more than one in which case they are separated
with tabs.  These values might not have any sensible
meaning for some ports.
\\
\hline
\code{irq}
 & 
Parallel port's IRQ, or -1 if none is being used.
\\
\hline
\code{dma}
 & 
Parallel port's DMA channel, or -1 if none is being
used.
\\
\hline
\code{modes}
 & 
Parallel port's hardware modes, comma-separated,
meaning:
\begin{itemize}
\item {} \begin{description}
\item[{PCSPP}] \leavevmode
PC-style SPP registers are available.

\end{description}

\item {} \begin{description}
\item[{TRISTATE}] \leavevmode
Port is bidirectional.

\end{description}

\item {} \begin{description}
\item[{COMPAT}] \leavevmode
Hardware acceleration for printers is
available and will be used.

\end{description}

\item {} \begin{description}
\item[{EPP}] \leavevmode
Hardware acceleration for EPP protocol
is available and will be used.

\end{description}

\item {} \begin{description}
\item[{ECP}] \leavevmode
Hardware acceleration for ECP protocol
is available and will be used.

\end{description}

\item {} \begin{description}
\item[{DMA}] \leavevmode
DMA is available and will be used.

\end{description}

\end{itemize}

Note that the current implementation will only take
advantage of COMPAT and ECP modes if it has an IRQ
line to use.
\\
\hline
\code{autoprobe}
 & 
Any IEEE-1284 device ID information that has been
acquired from the (non-IEEE 1284.3) device.
\\
\hline
\code{autoprobe{[}0-3{]}}
 & 
IEEE 1284 device ID information retrieved from
daisy-chain devices that conform to IEEE 1284.3.
\\
\hline
\code{spintime}
 & 
The number of microseconds to busy-loop while waiting
for the peripheral to respond.  You might find that
adjusting this improves performance, depending on your
peripherals.  This is a port-wide setting, i.e. it
applies to all devices on a particular port.
\\
\hline
\code{timeslice}
 & 
The number of milliseconds that a device driver is
allowed to keep a port claimed for.  This is advisory,
and driver can ignore it if it must.
\\
\hline
\code{default/*}
 & 
The defaults for spintime and timeslice. When a new
port is registered, it picks up the default spintime.
When a new device is registered, it picks up the
default timeslice.
\\
\hline\end{tabulary}



\section{Device drivers}
\label{admin-guide/parport:device-drivers}
Once the parport code is initialised, you can attach device drivers to
specific ports.  Normally this happens automatically; if the lp driver
is loaded it will create one lp device for each port found.  You can
override this, though, by using parameters either when you load the lp
driver:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} insmod lp parport=0,2
\end{Verbatim}

or on the LILO command line:

\begin{Verbatim}[commandchars=\\\{\}]
lp=parport0 lp=parport2
\end{Verbatim}

Both the above examples would inform lp that you want \code{/dev/lp0} to be
the first parallel port, and /dev/lp1 to be the \textbf{third} parallel port,
with no lp device associated with the second port (parport1).  Note
that this is different to the way older kernels worked; there used to
be a static association between the I/O port address and the device
name, so \code{/dev/lp0} was always the port at 0x3bc.  This is no longer the
case - if you only have one port, it will default to being \code{/dev/lp0},
regardless of base address.

Also:
\begin{itemize}
\item {} 
If you selected the IEEE 1284 support at compile time, you can say
\code{lp=auto} on the kernel command line, and lp will create devices
only for those ports that seem to have printers attached.

\item {} 
If you give PLIP the \code{timid} parameter, either with \code{plip=timid} on
the command line, or with \code{insmod plip timid=1} when using modules,
it will avoid any ports that seem to be in use by other devices.

\item {} 
IRQ autoprobing works only for a few port types at the moment.

\end{itemize}


\section{Reporting printer problems with parport}
\label{admin-guide/parport:reporting-printer-problems-with-parport}
If you are having problems printing, please go through these steps to
try to narrow down where the problem area is.

When reporting problems with parport, really you need to give all of
the messages that \code{parport\_pc} spits out when it initialises.  There are
several code paths:
\begin{itemize}
\item {} 
polling

\item {} 
interrupt-driven, protocol in software

\item {} 
interrupt-driven, protocol in hardware using PIO

\item {} 
interrupt-driven, protocol in hardware using DMA

\end{itemize}

The kernel messages that \code{parport\_pc} logs give an indication of which
code path is being used. (They could be a lot better actually..)

For normal printer protocol, having IEEE 1284 modes enabled or not
should not make a difference.

To turn off the `protocol in hardware' code paths, disable
\code{CONFIG\_PARPORT\_PC\_FIFO}.  Note that when they are enabled they are not
necessarily \textbf{used}; it depends on whether the hardware is available,
enabled by the BIOS, and detected by the driver.

So, to start with, disable \code{CONFIG\_PARPORT\_PC\_FIFO}, and load \code{parport\_pc}
with \code{irq=none}. See if printing works then.  It really should,
because this is the simplest code path.

If that works fine, try with \code{io=0x378 irq=7} (adjust for your
hardware), to make it use interrupt-driven in-software protocol.

If \textbf{that} works fine, then one of the hardware modes isn't working
right.  Enable \code{CONFIG\_FIFO} (no, it isn't a module option,
and yes, it should be), set the port to ECP mode in the BIOS and note
the DMA channel, and try with:

\begin{Verbatim}[commandchars=\\\{\}]
io=0x378 irq=7 dma=none (for PIO)
io=0x378 irq=7 dma=3 (for DMA)
\end{Verbatim}


\bigskip\hrule{}\bigskip


\href{mailto:philb@gnu.org}{philb@gnu.org}
\href{mailto:tim@cyberelk.net}{tim@cyberelk.net}


\chapter{RAID arrays}
\label{admin-guide/md:raid-arrays}\label{admin-guide/md::doc}

\section{Boot time assembly of RAID arrays}
\label{admin-guide/md:boot-time-assembly-of-raid-arrays}\begin{description}
\item[{Tools that manage md devices can be found at}] \leavevmode
\href{http://www.kernel.org/pub/linux/utils/raid/}{http://www.kernel.org/pub/linux/utils/raid/}

\end{description}

You can boot with your md device with the following kernel command
lines:

for old raid arrays without persistent superblocks:

\begin{Verbatim}[commandchars=\\\{\}]
md=\PYGZlt{}md device no.\PYGZgt{},\PYGZlt{}raid level\PYGZgt{},\PYGZlt{}chunk size factor\PYGZgt{},\PYGZlt{}fault level\PYGZgt{},dev0,dev1,...,devn
\end{Verbatim}

for raid arrays with persistent superblocks:

\begin{Verbatim}[commandchars=\\\{\}]
md=\PYGZlt{}md device no.\PYGZgt{},dev0,dev1,...,devn
\end{Verbatim}

or, to assemble a partitionable array:

\begin{Verbatim}[commandchars=\\\{\}]
md=d\PYGZlt{}md device no.\PYGZgt{},dev0,dev1,...,devn
\end{Verbatim}


\subsection{\texttt{md device no.}}
\label{admin-guide/md:md-device-no}
The number of the md device

\begin{tabulary}{\linewidth}{|L|L|}
\hline
\textsf{\relax 
\code{md device no.}
} & \textsf{\relax 
device
}\\
\hline
0
 & 
md0
\\
\hline
1
 & 
md1
\\
\hline
2
 & 
md2
\\
\hline
3
 & 
md3
\\
\hline
4
 & 
md4
\\
\hline\end{tabulary}



\subsection{\texttt{raid level}}
\label{admin-guide/md:raid-level}
level of the RAID array

\begin{tabulary}{\linewidth}{|L|L|}
\hline
\textsf{\relax 
\code{raid level}
} & \textsf{\relax 
level
}\\
\hline
-1
 & 
linear mode
\\
\hline
0
 & 
striped mode
\\
\hline\end{tabulary}


other modes are only supported with persistent super blocks


\subsection{\texttt{chunk size factor}}
\label{admin-guide/md:chunk-size-factor}
(raid-0 and raid-1 only)

Set  the chunk size as 4k \textless{}\textless{} n.


\subsection{\texttt{fault level}}
\label{admin-guide/md:fault-level}
Totally ignored


\subsection{\texttt{dev0} to \texttt{devn}}
\label{admin-guide/md:dev0-to-devn}
e.g. \code{/dev/hda1}, \code{/dev/hdc1}, \code{/dev/sda1}, \code{/dev/sdb1}

A possible loadlin line (Harald Hoyer \textless{}\href{mailto:HarryH@Royal.Net}{HarryH@Royal.Net}\textgreater{})  looks like this:

\begin{Verbatim}[commandchars=\\\{\}]
e:\PYGZbs{}loadlin\PYGZbs{}loadlin e:\PYGZbs{}zimage root=/dev/md0 md=0,0,4,0,/dev/hdb2,/dev/hdc3 ro
\end{Verbatim}


\section{Boot time autodetection of RAID arrays}
\label{admin-guide/md:boot-time-autodetection-of-raid-arrays}
When md is compiled into the kernel (not as module), partitions of
type 0xfd are scanned and automatically assembled into RAID arrays.
This autodetection may be suppressed with the kernel parameter
\code{raid=noautodetect}.  As of kernel 2.6.9, only drives with a type 0
superblock can be autodetected and run at boot time.

The kernel parameter \code{raid=partitionable} (or \code{raid=part}) means
that all auto-detected arrays are assembled as partitionable.


\section{Boot time assembly of degraded/dirty arrays}
\label{admin-guide/md:boot-time-assembly-of-degraded-dirty-arrays}
If a raid5 or raid6 array is both dirty and degraded, it could have
undetectable data corruption.  This is because the fact that it is
\code{dirty} means that the parity cannot be trusted, and the fact that it
is degraded means that some datablocks are missing and cannot reliably
be reconstructed (due to no parity).

For this reason, md will normally refuse to start such an array.  This
requires the sysadmin to take action to explicitly start the array
despite possible corruption.  This is normally done with:

\begin{Verbatim}[commandchars=\\\{\}]
mdadm \PYGZhy{}\PYGZhy{}assemble \PYGZhy{}\PYGZhy{}force ....
\end{Verbatim}

This option is not really available if the array has the root
filesystem on it.  In order to support this booting from such an
array, md supports a module parameter \code{start\_dirty\_degraded} which,
when set to 1, bypassed the checks and will allows dirty degraded
arrays to be started.

So, to boot with a root filesystem of a dirty degraded raid 5 or 6, use:

\begin{Verbatim}[commandchars=\\\{\}]
md\PYGZhy{}mod.start\PYGZus{}dirty\PYGZus{}degraded=1
\end{Verbatim}


\section{Superblock formats}
\label{admin-guide/md:superblock-formats}
The md driver can support a variety of different superblock formats.
Currently, it supports superblock formats \code{0.90.0} and the \code{md-1} format
introduced in the 2.5 development series.

The kernel will autodetect which format superblock is being used.

Superblock format \code{0} is treated differently to others for legacy
reasons - it is the original superblock format.


\section{General Rules - apply for all superblock formats}
\label{admin-guide/md:general-rules-apply-for-all-superblock-formats}
An array is \code{created} by writing appropriate superblocks to all
devices.

It is \code{assembled} by associating each of these devices with an
particular md virtual device.  Once it is completely assembled, it can
be accessed.

An array should be created by a user-space tool.  This will write
superblocks to all devices.  It will usually mark the array as
\code{unclean}, or with some devices missing so that the kernel md driver
can create appropriate redundancy (copying in raid 1, parity
calculation in raid 4/5).

When an array is assembled, it is first initialized with the
SET\_ARRAY\_INFO ioctl.  This contains, in particular, a major and minor
version number.  The major version number selects which superblock
format is to be used.  The minor number might be used to tune handling
of the format, such as suggesting where on each device to look for the
superblock.

Then each device is added using the ADD\_NEW\_DISK ioctl.  This
provides, in particular, a major and minor number identifying the
device to add.

The array is started with the RUN\_ARRAY ioctl.

Once started, new devices can be added.  They should have an
appropriate superblock written to them, and then be passed in with
ADD\_NEW\_DISK.

Devices that have failed or are not yet active can be detached from an
array using HOT\_REMOVE\_DISK.


\section{Specific Rules that apply to format-0 super block arrays, and arrays with no superblock (non-persistent)}
\label{admin-guide/md:specific-rules-that-apply-to-format-0-super-block-arrays-and-arrays-with-no-superblock-non-persistent}
An array can be \code{created} by describing the array (level, chunksize
etc) in a SET\_ARRAY\_INFO ioctl.  This must have \code{major\_version==0} and
\code{raid\_disks != 0}.

Then uninitialized devices can be added with ADD\_NEW\_DISK.  The
structure passed to ADD\_NEW\_DISK must specify the state of the device
and its role in the array.

Once started with RUN\_ARRAY, uninitialized spares can be added with
HOT\_ADD\_DISK.


\section{MD devices in sysfs}
\label{admin-guide/md:md-devices-in-sysfs}
md devices appear in sysfs (\code{/sys}) as regular block devices,
e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
/sys/block/md0
\end{Verbatim}

Each \code{md} device will contain a subdirectory called \code{md} which
contains further md-specific information about the device.

All md devices contain:
\begin{quote}
\begin{description}
\item[{level}] \leavevmode
a text file indicating the \code{raid level}. e.g. raid0, raid1,
raid5, linear, multipath, faulty.
If no raid level has been set yet (array is still being
assembled), the value will reflect whatever has been written
to it, which may be a name like the above, or may be a number
such as \code{0}, \code{5}, etc.

\item[{raid\_disks}] \leavevmode
a text file with a simple number indicating the number of devices
in a fully functional array.  If this is not yet known, the file
will be empty.  If an array is being resized this will contain
the new number of devices.
Some raid levels allow this value to be set while the array is
active.  This will reconfigure the array.   Otherwise it can only
be set while assembling an array.
A change to this attribute will not be permitted if it would
reduce the size of the array.  To reduce the number of drives
in an e.g. raid5, the array size must first be reduced by
setting the \code{array\_size} attribute.

\item[{chunk\_size}] \leavevmode
This is the size in bytes for \code{chunks} and is only relevant to
raid levels that involve striping (0,4,5,6,10). The address space
of the array is conceptually divided into chunks and consecutive
chunks are striped onto neighbouring devices.
The size should be at least PAGE\_SIZE (4k) and should be a power
of 2.  This can only be set while assembling an array

\item[{layout}] \leavevmode
The \code{layout} for the array for the particular level.  This is
simply a number that is interpretted differently by different
levels.  It can be written while assembling an array.

\item[{array\_size}] \leavevmode
This can be used to artificially constrain the available space in
the array to be less than is actually available on the combined
devices.  Writing a number (in Kilobytes) which is less than
the available size will set the size.  Any reconfiguration of the
array (e.g. adding devices) will not cause the size to change.
Writing the word \code{default} will cause the effective size of the
array to be whatever size is actually available based on
\code{level}, \code{chunk\_size} and \code{component\_size}.

This can be used to reduce the size of the array before reducing
the number of devices in a raid4/5/6, or to support external
metadata formats which mandate such clipping.

\item[{reshape\_position}] \leavevmode
This is either \code{none} or a sector number within the devices of
the array where \code{reshape} is up to.  If this is set, the three
attributes mentioned above (raid\_disks, chunk\_size, layout) can
potentially have 2 values, an old and a new value.  If these
values differ, reading the attribute returns:

\begin{Verbatim}[commandchars=\\\{\}]
new (old)
\end{Verbatim}

and writing will effect the \code{new} value, leaving the \code{old}
unchanged.

\item[{component\_size}] \leavevmode
For arrays with data redundancy (i.e. not raid0, linear, faulty,
multipath), all components must be the same size - or at least
there must a size that they all provide space for.  This is a key
part or the geometry of the array.  It is measured in sectors
and can be read from here.  Writing to this value may resize
the array if the personality supports it (raid1, raid5, raid6),
and if the component drives are large enough.

\item[{metadata\_version}] \leavevmode
This indicates the format that is being used to record metadata
about the array.  It can be 0.90 (traditional format), 1.0, 1.1,
1.2 (newer format in varying locations) or \code{none} indicating that
the kernel isn't managing metadata at all.
Alternately it can be \code{external:} followed by a string which
is set by user-space.  This indicates that metadata is managed
by a user-space program.  Any device failure or other event that
requires a metadata update will cause array activity to be
suspended until the event is acknowledged.

\item[{resync\_start}] \leavevmode
The point at which resync should start.  If no resync is needed,
this will be a very large number (or \code{none} since 2.6.30-rc1).  At
array creation it will default to 0, though starting the array as
\code{clean} will set it much larger.

\item[{new\_dev}] \leavevmode
This file can be written but not read.  The value written should
be a block device number as major:minor.  e.g. 8:0
This will cause that device to be attached to the array, if it is
available.  It will then appear at md/dev-XXX (depending on the
name of the device) and further configuration is then possible.

\item[{safe\_mode\_delay}] \leavevmode
When an md array has seen no write requests for a certain period
of time, it will be marked as \code{clean}.  When another write
request arrives, the array is marked as \code{dirty} before the write
commences.  This is known as \code{safe\_mode}.
The \code{certain period} is controlled by this file which stores the
period as a number of seconds.  The default is 200msec (0.200).
Writing a value of 0 disables safemode.

\item[{array\_state}] \leavevmode
This file contains a single word which describes the current
state of the array.  In many cases, the state can be set by
writing the word for the desired state, however some states
cannot be explicitly set, and some transitions are not allowed.

Select/poll works on this file.  All changes except between
Active\_idle and active (which can be frequent and are not
very interesting) are notified.  active-\textgreater{}active\_idle is
reported if the metadata is externally managed.
\begin{description}
\item[{clear}] \leavevmode
No devices, no size, no level

Writing is equivalent to STOP\_ARRAY ioctl

\item[{inactive}] \leavevmode
May have some settings, but array is not active
all IO results in error

When written, doesn't tear down array, but just stops it

\item[{suspended (not supported yet)}] \leavevmode
All IO requests will block. The array can be reconfigured.

Writing this, if accepted, will block until array is quiessent

\item[{readonly}] \leavevmode
no resync can happen.  no superblocks get written.

Write requests fail

\item[{read-auto}] \leavevmode
like readonly, but behaves like \code{clean} on a write request.

\item[{clean}] \leavevmode
no pending writes, but otherwise active.

When written to inactive array, starts without resync

If a write request arrives then
if metadata is known, mark \code{dirty} and switch to \code{active}.
if not known, block and switch to write-pending

If written to an active array that has pending writes, then fails.

\item[{active}] \leavevmode
fully active: IO and resync can be happening.
When written to inactive array, starts with resync

\item[{write-pending}] \leavevmode
clean, but writes are blocked waiting for \code{active} to be written.

\item[{active-idle}] \leavevmode
like active, but no writes have been seen for a while (safe\_mode\_delay).

\end{description}

\item[{bitmap/location}] \leavevmode
This indicates where the write-intent bitmap for the array is
stored.

It can be one of \code{none}, \code{file} or \code{{[}+-{]}N}.
\code{file} may later be extended to \code{file:/file/name}
\code{{[}+-{]}N} means that many sectors from the start of the metadata.

This is replicated on all devices.  For arrays with externally
managed metadata, the offset is from the beginning of the
device.

\item[{bitmap/chunksize}] \leavevmode
The size, in bytes, of the chunk which will be represented by a
single bit.  For RAID456, it is a portion of an individual
device. For RAID10, it is a portion of the array.  For RAID1, it
is both (they come to the same thing).

\item[{bitmap/time\_base}] \leavevmode
The time, in seconds, between looking for bits in the bitmap to
be cleared. In the current implementation, a bit will be cleared
between 2 and 3 times \code{time\_base} after all the covered blocks
are known to be in-sync.

\item[{bitmap/backlog}] \leavevmode
When write-mostly devices are active in a RAID1, write requests
to those devices proceed in the background - the filesystem (or
other user of the device) does not have to wait for them.
\code{backlog} sets a limit on the number of concurrent background
writes.  If there are more than this, new writes will by
synchronous.

\item[{bitmap/metadata}] \leavevmode
This can be either \code{internal} or \code{external}.
\begin{description}
\item[{\code{internal}}] \leavevmode
is the default and means the metadata for the bitmap
is stored in the first 256 bytes of the allocated space and is
managed by the md module.

\item[{\code{external}}] \leavevmode
means that bitmap metadata is managed externally to
the kernel (i.e. by some userspace program)

\end{description}

\item[{bitmap/can\_clear}] \leavevmode
This is either \code{true} or \code{false}.  If \code{true}, then bits in the
bitmap will be cleared when the corresponding blocks are thought
to be in-sync.  If \code{false}, bits will never be cleared.
This is automatically set to \code{false} if a write happens on a
degraded array, or if the array becomes degraded during a write.
When metadata is managed externally, it should be set to true
once the array becomes non-degraded, and this fact has been
recorded in the metadata.

\item[{consistency\_policy}] \leavevmode
This indicates how the array maintains consistency in case of unexpected
shutdown. It can be:
\begin{description}
\item[{none}] \leavevmode
Array has no redundancy information, e.g. raid0, linear.

\item[{resync}] \leavevmode
Full resync is performed and all redundancy is regenerated when the
array is started after unclean shutdown.

\item[{bitmap}] \leavevmode
Resync assisted by a write-intent bitmap.

\item[{journal}] \leavevmode
For raid4/5/6, journal device is used to log transactions and replay
after unclean shutdown.

\item[{ppl}] \leavevmode
For raid5 only, Partial Parity Log is used to close the write hole and
eliminate resync.

\end{description}

The accepted values when writing to this file are \code{ppl} and \code{resync},
used to enable and disable PPL.

\end{description}
\end{quote}

As component devices are added to an md array, they appear in the \code{md}
directory as new directories named:

\begin{Verbatim}[commandchars=\\\{\}]
dev\PYGZhy{}XXX
\end{Verbatim}

where \code{XXX} is a name that the kernel knows for the device, e.g. hdb1.
Each directory contains:
\begin{quote}
\begin{description}
\item[{block}] \leavevmode
a symlink to the block device in /sys/block, e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
/sys/block/md0/md/dev\PYGZhy{}hdb1/block \PYGZhy{}\PYGZgt{} ../../../../block/hdb/hdb1
\end{Verbatim}

\item[{super}] \leavevmode
A file containing an image of the superblock read from, or
written to, that device.

\item[{state}] \leavevmode
A file recording the current state of the device in the array
which can be a comma separated list of:
\begin{quote}
\begin{description}
\item[{faulty}] \leavevmode
device has been kicked from active use due to
a detected fault, or it has unacknowledged bad
blocks

\item[{in\_sync}] \leavevmode
device is a fully in-sync member of the array

\item[{writemostly}] \leavevmode
device will only be subject to read
requests if there are no other options.

This applies only to raid1 arrays.

\item[{blocked}] \leavevmode
device has failed, and the failure hasn't been
acknowledged yet by the metadata handler.

Writes that would write to this device if
it were not faulty are blocked.

\item[{spare}] \leavevmode
device is working, but not a full member.

This includes spares that are in the process
of being recovered to

\item[{write\_error}] \leavevmode
device has ever seen a write error.

\item[{want\_replacement}] \leavevmode
device is (mostly) working but probably
should be replaced, either due to errors or
due to user request.

\item[{replacement}] \leavevmode
device is a replacement for another active
device with same raid\_disk.

\end{description}
\end{quote}

This list may grow in future.

This can be written to.

Writing \code{faulty}  simulates a failure on the device.

Writing \code{remove} removes the device from the array.

Writing \code{writemostly} sets the writemostly flag.

Writing \code{-writemostly} clears the writemostly flag.

Writing \code{blocked} sets the \code{blocked} flag.

Writing \code{-blocked} clears the \code{blocked} flags and allows writes
to complete and possibly simulates an error.

Writing \code{in\_sync} sets the in\_sync flag.

Writing \code{write\_error} sets writeerrorseen flag.

Writing \code{-write\_error} clears writeerrorseen flag.

Writing \code{want\_replacement} is allowed at any time except to a
replacement device or a spare.  It sets the flag.

Writing \code{-want\_replacement} is allowed at any time.  It clears
the flag.

Writing \code{replacement} or \code{-replacement} is only allowed before
starting the array.  It sets or clears the flag.

This file responds to select/poll. Any change to \code{faulty}
or \code{blocked} causes an event.

\item[{errors}] \leavevmode
An approximate count of read errors that have been detected on
this device but have not caused the device to be evicted from
the array (either because they were corrected or because they
happened while the array was read-only).  When using version-1
metadata, this value persists across restarts of the array.

This value can be written while assembling an array thus
providing an ongoing count for arrays with metadata managed by
userspace.

\item[{slot}] \leavevmode
This gives the role that the device has in the array.  It will
either be \code{none} if the device is not active in the array
(i.e. is a spare or has failed) or an integer less than the
\code{raid\_disks} number for the array indicating which position
it currently fills.  This can only be set while assembling an
array.  A device for which this is set is assumed to be working.

\item[{offset}] \leavevmode
This gives the location in the device (in sectors from the
start) where data from the array will be stored.  Any part of
the device before this offset is not touched, unless it is
used for storing metadata (Formats 1.1 and 1.2).

\item[{size}] \leavevmode
The amount of the device, after the offset, that can be used
for storage of data.  This will normally be the same as the
component\_size.  This can be written while assembling an
array.  If a value less than the current component\_size is
written, it will be rejected.

\item[{recovery\_start}] \leavevmode
When the device is not \code{in\_sync}, this records the number of
sectors from the start of the device which are known to be
correct.  This is normally zero, but during a recovery
operation it will steadily increase, and if the recovery is
interrupted, restoring this value can cause recovery to
avoid repeating the earlier blocks.  With v1.x metadata, this
value is saved and restored automatically.

This can be set whenever the device is not an active member of
the array, either before the array is activated, or before
the \code{slot} is set.

Setting this to \code{none} is equivalent to setting \code{in\_sync}.
Setting to any other value also clears the \code{in\_sync} flag.

\item[{bad\_blocks}] \leavevmode
This gives the list of all known bad blocks in the form of
start address and length (in sectors respectively). If output
is too big to fit in a page, it will be truncated. Writing
\code{sector length} to this file adds new acknowledged (i.e.
recorded to disk safely) bad blocks.

\item[{unacknowledged\_bad\_blocks}] \leavevmode
This gives the list of known-but-not-yet-saved-to-disk bad
blocks in the same form of \code{bad\_blocks}. If output is too big
to fit in a page, it will be truncated. Writing to this file
adds bad blocks without acknowledging them. This is largely
for testing.

\item[{ppl\_sector, ppl\_size}] \leavevmode
Location and size (in sectors) of the space used for Partial Parity Log
on this device.

\end{description}
\end{quote}

An active md device will also contain an entry for each active device
in the array.  These are named:

\begin{Verbatim}[commandchars=\\\{\}]
rdNN
\end{Verbatim}

where \code{NN} is the position in the array, starting from 0.
So for a 3 drive array there will be rd0, rd1, rd2.
These are symbolic links to the appropriate \code{dev-XXX} entry.
Thus, for example:

\begin{Verbatim}[commandchars=\\\{\}]
cat /sys/block/md*/md/rd*/state
\end{Verbatim}

will show \code{in\_sync} on every line.

Active md devices for levels that support data redundancy (1,4,5,6,10)
also have
\begin{quote}
\begin{description}
\item[{sync\_action}] \leavevmode
a text file that can be used to monitor and control the rebuild
process.  It contains one word which can be one of:
\begin{quote}
\begin{quote}
\begin{description}
\item[{resync}] \leavevmode
redundancy is being recalculated after unclean
shutdown or creation

\item[{recover}] \leavevmode
a hot spare is being built to replace a
failed/missing device

\item[{idle}] \leavevmode
nothing is happening

\item[{check}] \leavevmode
A full check of redundancy was requested and is
happening.  This reads all blocks and checks
them. A repair may also happen for some raid
levels.

\item[{repair}] \leavevmode
A full check and repair is happening.  This is
similar to \code{resync}, but was requested by the
user, and the write-intent bitmap is NOT used to
optimise the process.

\end{description}
\end{quote}

This file is writable, and each of the strings that could be
read are meaningful for writing.
\begin{quote}

\code{idle} will stop an active resync/recovery etc.  There is no
guarantee that another resync/recovery may not be automatically
started again, though some event will be needed to trigger
this.

\code{resync} or \code{recovery} can be used to restart the
corresponding operation if it was stopped with \code{idle}.

\code{check} and \code{repair} will start the appropriate process
providing the current state is \code{idle}.
\end{quote}

This file responds to select/poll.  Any important change in the value
triggers a poll event.  Sometimes the value will briefly be
\code{recover} if a recovery seems to be needed, but cannot be
achieved. In that case, the transition to \code{recover} isn't
notified, but the transition away is.
\end{quote}

\item[{degraded}] \leavevmode
This contains a count of the number of devices by which the
arrays is degraded.  So an optimal array will show \code{0}.  A
single failed/missing drive will show \code{1}, etc.

This file responds to select/poll, any increase or decrease
in the count of missing devices will trigger an event.

\item[{mismatch\_count}] \leavevmode
When performing \code{check} and \code{repair}, and possibly when
performing \code{resync}, md will count the number of errors that are
found.  The count in \code{mismatch\_cnt} is the number of sectors
that were re-written, or (for \code{check}) would have been
re-written.  As most raid levels work in units of pages rather
than sectors, this may be larger than the number of actual errors
by a factor of the number of sectors in a page.

\item[{bitmap\_set\_bits}] \leavevmode
If the array has a write-intent bitmap, then writing to this
attribute can set bits in the bitmap, indicating that a resync
would need to check the corresponding blocks. Either individual
numbers or start-end pairs can be written.  Multiple numbers
can be separated by a space.

Note that the numbers are \code{bit} numbers, not \code{block} numbers.
They should be scaled by the bitmap\_chunksize.

\item[{sync\_speed\_min, sync\_speed\_max}] \leavevmode
This are similar to \code{/proc/sys/dev/raid/speed\_limit\_\{min,max\}}
however they only apply to the particular array.

If no value has been written to these, or if the word \code{system}
is written, then the system-wide value is used.  If a value,
in kibibytes-per-second is written, then it is used.

When the files are read, they show the currently active value
followed by \code{(local)} or \code{(system)} depending on whether it is
a locally set or system-wide value.

\item[{sync\_completed}] \leavevmode
This shows the number of sectors that have been completed of
whatever the current sync\_action is, followed by the number of
sectors in total that could need to be processed.  The two
numbers are separated by a \code{/}  thus effectively showing one
value, a fraction of the process that is complete.

A \code{select} on this attribute will return when resync completes,
when it reaches the current sync\_max (below) and possibly at
other times.

\item[{sync\_speed}] \leavevmode
This shows the current actual speed, in K/sec, of the current
sync\_action.  It is averaged over the last 30 seconds.

\item[{suspend\_lo, suspend\_hi}] \leavevmode
The two values, given as numbers of sectors, indicate a range
within the array where IO will be blocked.  This is currently
only supported for raid4/5/6.

\item[{sync\_min, sync\_max}] \leavevmode
The two values, given as numbers of sectors, indicate a range
within the array where \code{check}/\code{repair} will operate. Must be
a multiple of chunk\_size. When it reaches \code{sync\_max} it will
pause, rather than complete.
You can use \code{select} or \code{poll} on \code{sync\_completed} to wait for
that number to reach sync\_max.  Then you can either increase
\code{sync\_max}, or can write \code{idle} to \code{sync\_action}.

The value of \code{max} for \code{sync\_max} effectively disables the limit.
When a resync is active, the value can only ever be increased,
never decreased.
The value of \code{0} is the minimum for \code{sync\_min}.

\end{description}
\end{quote}

Each active md device may also have attributes specific to the
personality module that manages it.
These are specific to the implementation of the module and could
change substantially if the implementation changes.

These currently include:
\begin{quote}
\begin{description}
\item[{stripe\_cache\_size  (currently raid5 only)}] \leavevmode
number of entries in the stripe cache.  This is writable, but
there are upper and lower limits (32768, 17).  Default is 256.

\item[{strip\_cache\_active (currently raid5 only)}] \leavevmode
number of active entries in the stripe cache

\item[{preread\_bypass\_threshold (currently raid5 only)}] \leavevmode
number of times a stripe requiring preread will be bypassed by
a stripe that does not require preread.  For fairness defaults
to 1.  Setting this to 0 disables bypass accounting and
requires preread stripes to wait until all full-width stripe-
writes are complete.  Valid values are 0 to stripe\_cache\_size.

\item[{journal\_mode (currently raid5 only)}] \leavevmode
The cache mode for raid5. raid5 could include an extra disk for
caching. The mode can be ``write-throuth'' and ``write-back''. The
default is ``write-through''.

\end{description}
\end{quote}


\chapter{Kernel module signing facility}
\label{admin-guide/module-signing:kernel-module-signing-facility}\label{admin-guide/module-signing::doc}

\section{Overview}
\label{admin-guide/module-signing:overview}
The kernel module signing facility cryptographically signs modules during
installation and then checks the signature upon loading the module.  This
allows increased kernel security by disallowing the loading of unsigned modules
or modules signed with an invalid key.  Module signing increases security by
making it harder to load a malicious module into the kernel.  The module
signature checking is done by the kernel so that it is not necessary to have
trusted userspace bits.

This facility uses X.509 ITU-T standard certificates to encode the public keys
involved.  The signatures are not themselves encoded in any industrial standard
type.  The facility currently only supports the RSA public key encryption
standard (though it is pluggable and permits others to be used).  The possible
hash algorithms that can be used are SHA-1, SHA-224, SHA-256, SHA-384, and
SHA-512 (the algorithm is selected by data in the signature).


\section{Configuring module signing}
\label{admin-guide/module-signing:configuring-module-signing}
The module signing facility is enabled by going to the
\emph{Enable Loadable Module Support} section of
the kernel configuration and turning on:

\begin{Verbatim}[commandchars=\\\{\}]
CONFIG\PYGZus{}MODULE\PYGZus{}SIG       \PYGZdq{}Module signature verification\PYGZdq{}
\end{Verbatim}

This has a number of options available:
\begin{enumerate}
\item {} 
\emph{Require modules to be validly signed}
(\code{CONFIG\_MODULE\_SIG\_FORCE})

This specifies how the kernel should deal with a module that has a
signature for which the key is not known or a module that is unsigned.

If this is off (ie. ``permissive''), then modules for which the key is not
available and modules that are unsigned are permitted, but the kernel will
be marked as being tainted, and the concerned modules will be marked as
tainted, shown with the character `E'.

If this is on (ie. ``restrictive''), only modules that have a valid
signature that can be verified by a public key in the kernel's possession
will be loaded.  All other modules will generate an error.

Irrespective of the setting here, if the module has a signature block that
cannot be parsed, it will be rejected out of hand.

\item {} 
\emph{Automatically sign all modules}
(\code{CONFIG\_MODULE\_SIG\_ALL})

If this is on then modules will be automatically signed during the
modules\_install phase of a build.  If this is off, then the modules must
be signed manually using:

\begin{Verbatim}[commandchars=\\\{\}]
scripts/sign\PYGZhy{}file
\end{Verbatim}

\item {} 
\emph{Which hash algorithm should modules be signed with?}

This presents a choice of which hash algorithm the installation phase will
sign the modules with:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

\code{CONFIG\_MODULE\_SIG\_SHA1}
 & 
\emph{Sign modules with SHA-1}
\\
\hline
\code{CONFIG\_MODULE\_SIG\_SHA224}
 & 
\emph{Sign modules with SHA-224}
\\
\hline
\code{CONFIG\_MODULE\_SIG\_SHA256}
 & 
\emph{Sign modules with SHA-256}
\\
\hline
\code{CONFIG\_MODULE\_SIG\_SHA384}
 & 
\emph{Sign modules with SHA-384}
\\
\hline
\code{CONFIG\_MODULE\_SIG\_SHA512}
 & 
\emph{Sign modules with SHA-512}
\\
\hline\end{tabulary}

\end{quote}

The algorithm selected here will also be built into the kernel (rather
than being a module) so that modules signed with that algorithm can have
their signatures checked without causing a dependency loop.

\item {} 
\emph{File name or PKCS\#11 URI of module signing key}
(\code{CONFIG\_MODULE\_SIG\_KEY})

Setting this option to something other than its default of
\code{certs/signing\_key.pem} will disable the autogeneration of signing keys
and allow the kernel modules to be signed with a key of your choosing.
The string provided should identify a file containing both a private key
and its corresponding X.509 certificate in PEM form, or — on systems where
the OpenSSL ENGINE\_pkcs11 is functional — a PKCS\#11 URI as defined by
RFC7512. In the latter case, the PKCS\#11 URI should reference both a
certificate and a private key.

If the PEM file containing the private key is encrypted, or if the
PKCS\#11 token requries a PIN, this can be provided at build time by
means of the \code{KBUILD\_SIGN\_PIN} variable.

\item {} 
\emph{Additional X.509 keys for default system keyring}
(\code{CONFIG\_SYSTEM\_TRUSTED\_KEYS})

This option can be set to the filename of a PEM-encoded file containing
additional certificates which will be included in the system keyring by
default.

\end{enumerate}

Note that enabling module signing adds a dependency on the OpenSSL devel
packages to the kernel build processes for the tool that does the signing.


\section{Generating signing keys}
\label{admin-guide/module-signing:generating-signing-keys}
Cryptographic keypairs are required to generate and check signatures.  A
private key is used to generate a signature and the corresponding public key is
used to check it.  The private key is only needed during the build, after which
it can be deleted or stored securely.  The public key gets built into the
kernel so that it can be used to check the signatures as the modules are
loaded.

Under normal conditions, when \code{CONFIG\_MODULE\_SIG\_KEY} is unchanged from its
default, the kernel build will automatically generate a new keypair using
openssl if one does not exist in the file:

\begin{Verbatim}[commandchars=\\\{\}]
certs/signing\PYGZus{}key.pem
\end{Verbatim}

during the building of vmlinux (the public part of the key needs to be built
into vmlinux) using parameters in the:

\begin{Verbatim}[commandchars=\\\{\}]
certs/x509.genkey
\end{Verbatim}

file (which is also generated if it does not already exist).

It is strongly recommended that you provide your own x509.genkey file.

Most notably, in the x509.genkey file, the req\_distinguished\_name section
should be altered from the default:

\begin{Verbatim}[commandchars=\\\{\}]
[ req\PYGZus{}distinguished\PYGZus{}name ]
\PYGZsh{}O = Unspecified company
CN = Build time autogenerated kernel key
\PYGZsh{}emailAddress = unspecified.user@unspecified.company
\end{Verbatim}

The generated RSA key size can also be set with:

\begin{Verbatim}[commandchars=\\\{\}]
[ req ]
default\PYGZus{}bits = 4096
\end{Verbatim}

It is also possible to manually generate the key private/public files using the
x509.genkey key generation configuration file in the root node of the Linux
kernel sources tree and the openssl command.  The following is an example to
generate the public/private key files:

\begin{Verbatim}[commandchars=\\\{\}]
openssl req \PYGZhy{}new \PYGZhy{}nodes \PYGZhy{}utf8 \PYGZhy{}sha256 \PYGZhy{}days 36500 \PYGZhy{}batch \PYGZhy{}x509 \PYGZbs{}
   \PYGZhy{}config x509.genkey \PYGZhy{}outform PEM \PYGZhy{}out kernel\PYGZus{}key.pem \PYGZbs{}
   \PYGZhy{}keyout kernel\PYGZus{}key.pem
\end{Verbatim}

The full pathname for the resulting kernel\_key.pem file can then be specified
in the \code{CONFIG\_MODULE\_SIG\_KEY} option, and the certificate and key therein will
be used instead of an autogenerated keypair.


\section{Public keys in the kernel}
\label{admin-guide/module-signing:public-keys-in-the-kernel}
The kernel contains a ring of public keys that can be viewed by root.  They're
in a keyring called ''.system\_keyring'' that can be seen by:

\begin{Verbatim}[commandchars=\\\{\}]
[root@deneb \PYGZti{}]\PYGZsh{} cat /proc/keys
...
223c7853 I\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}     1 perm 1f030000     0     0 keyring   .system\PYGZus{}keyring: 1
302d2d52 I\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}     1 perm 1f010000     0     0 asymmetri Fedora kernel signing key: d69a84e6bce3d216b979e9505b3e3ef9a7118079: X509.RSA a7118079 []
...
\end{Verbatim}

Beyond the public key generated specifically for module signing, additional
trusted certificates can be provided in a PEM-encoded file referenced by the
\code{CONFIG\_SYSTEM\_TRUSTED\_KEYS} configuration option.

Further, the architecture code may take public keys from a hardware store and
add those in also (e.g. from the UEFI key database).

Finally, it is possible to add additional public keys by doing:

\begin{Verbatim}[commandchars=\\\{\}]
keyctl padd asymmetric \PYGZdq{}\PYGZdq{} [.system\PYGZus{}keyring\PYGZhy{}ID] \PYGZlt{}[key\PYGZhy{}file]
\end{Verbatim}

e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
keyctl padd asymmetric \PYGZdq{}\PYGZdq{} 0x223c7853 \PYGZlt{}my\PYGZus{}public\PYGZus{}key.x509
\end{Verbatim}

Note, however, that the kernel will only permit keys to be added to
\code{.system\_keyring \_if\_} the new key's X.509 wrapper is validly signed by a key
that is already resident in the .system\_keyring at the time the key was added.


\section{Manually signing modules}
\label{admin-guide/module-signing:manually-signing-modules}
To manually sign a module, use the scripts/sign-file tool available in
the Linux kernel source tree.  The script requires 4 arguments:
\begin{enumerate}
\item {} 
The hash algorithm (e.g., sha256)

\item {} 
The private key filename or PKCS\#11 URI

\item {} 
The public key filename

\item {} 
The kernel module to be signed

\end{enumerate}

The following is an example to sign a kernel module:

\begin{Verbatim}[commandchars=\\\{\}]
scripts/sign\PYGZhy{}file sha512 kernel\PYGZhy{}signkey.priv \PYGZbs{}
        kernel\PYGZhy{}signkey.x509 module.ko
\end{Verbatim}

The hash algorithm used does not have to match the one configured, but if it
doesn't, you should make sure that hash algorithm is either built into the
kernel or can be loaded without requiring itself.

If the private key requires a passphrase or PIN, it can be provided in the
\$KBUILD\_SIGN\_PIN environment variable.


\section{Signed modules and stripping}
\label{admin-guide/module-signing:signed-modules-and-stripping}
A signed module has a digital signature simply appended at the end.  The string
\code{\textasciitilde{}Module signature appended\textasciitilde{}.} at the end of the module's file confirms that a
signature is present but it does not confirm that the signature is valid!

Signed modules are BRITTLE as the signature is outside of the defined ELF
container.  Thus they MAY NOT be stripped once the signature is computed and
attached.  Note the entire module is the signed payload, including any and all
debug information present at the time of signing.


\section{Loading signed modules}
\label{admin-guide/module-signing:loading-signed-modules}
Modules are loaded with insmod, modprobe, \code{init\_module()} or
\code{finit\_module()}, exactly as for unsigned modules as no processing is
done in userspace.  The signature checking is all done within the kernel.


\section{Non-valid signatures and unsigned modules}
\label{admin-guide/module-signing:non-valid-signatures-and-unsigned-modules}
If \code{CONFIG\_MODULE\_SIG\_FORCE} is enabled or module.sig\_enforce=1 is supplied on
the kernel command line, the kernel will only load validly signed modules
for which it has a public key.   Otherwise, it will also load modules that are
unsigned.   Any module for which the kernel has a key, but which proves to have
a signature mismatch will not be permitted to load.

Any module that has an unparseable signature will be rejected.


\section{Administering/protecting the private key}
\label{admin-guide/module-signing:administering-protecting-the-private-key}
Since the private key is used to sign modules, viruses and malware could use
the private key to sign modules and compromise the operating system.  The
private key must be either destroyed or moved to a secure location and not kept
in the root node of the kernel source tree.

If you use the same private key to sign modules for multiple kernel
configurations, you must ensure that the module version information is
sufficient to prevent loading a module into a different kernel.  Either
set \code{CONFIG\_MODVERSIONS=y} or ensure that each configuration has a different
kernel release string by changing \code{EXTRAVERSION} or \code{CONFIG\_LOCALVERSION}.


\chapter{Linux Magic System Request Key Hacks}
\label{admin-guide/sysrq::doc}\label{admin-guide/sysrq:linux-magic-system-request-key-hacks}
Documentation for sysrq.c


\section{What is the magic SysRq key?}
\label{admin-guide/sysrq:what-is-the-magic-sysrq-key}
It is a `magical' key combo you can hit which the kernel will respond to
regardless of whatever else it is doing, unless it is completely locked up.


\section{How do I enable the magic SysRq key?}
\label{admin-guide/sysrq:how-do-i-enable-the-magic-sysrq-key}
You need to say ``yes'' to `Magic SysRq key (CONFIG\_MAGIC\_SYSRQ)' when
configuring the kernel. When running a kernel with SysRq compiled in,
/proc/sys/kernel/sysrq controls the functions allowed to be invoked via
the SysRq key. The default value in this file is set by the
CONFIG\_MAGIC\_SYSRQ\_DEFAULT\_ENABLE config symbol, which itself defaults
to 1. Here is the list of possible values in /proc/sys/kernel/sysrq:
\begin{itemize}
\item {} 
0 - disable sysrq completely

\item {} 
1 - enable all functions of sysrq

\item {} 
\textgreater{}1 - bitmask of allowed sysrq functions (see below for detailed function
description):

\begin{Verbatim}[commandchars=\\\{\}]
  2 =   0x2 \PYGZhy{} enable control of console logging level
  4 =   0x4 \PYGZhy{} enable control of keyboard (SAK, unraw)
  8 =   0x8 \PYGZhy{} enable debugging dumps of processes etc.
 16 =  0x10 \PYGZhy{} enable sync command
 32 =  0x20 \PYGZhy{} enable remount read\PYGZhy{}only
 64 =  0x40 \PYGZhy{} enable signalling of processes (term, kill, oom\PYGZhy{}kill)
128 =  0x80 \PYGZhy{} allow reboot/poweroff
256 = 0x100 \PYGZhy{} allow nicing of all RT tasks
\end{Verbatim}

\end{itemize}

You can set the value in the file by the following command:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}number\PYGZdq{} \PYGZgt{}/proc/sys/kernel/sysrq
\end{Verbatim}

The number may be written here either as decimal or as hexadecimal
with the 0x prefix. CONFIG\_MAGIC\_SYSRQ\_DEFAULT\_ENABLE must always be
written in hexadecimal.

Note that the value of \code{/proc/sys/kernel/sysrq} influences only the invocation
via a keyboard. Invocation of any operation via \code{/proc/sysrq-trigger} is
always allowed (by a user with admin privileges).


\section{How do I use the magic SysRq key?}
\label{admin-guide/sysrq:how-do-i-use-the-magic-sysrq-key}
On x86   - You press the key combo \code{ALT-SysRq-\textless{}command key\textgreater{}}.

\begin{notice}{note}{Note:}
Some
keyboards may not have a key labeled `SysRq'. The `SysRq' key is
also known as the `Print Screen' key. Also some keyboards cannot
handle so many keys being pressed at the same time, so you might
have better luck with press \code{Alt}, press \code{SysRq},
release \code{SysRq}, press \code{\textless{}command key\textgreater{}}, release everything.
\end{notice}

On SPARC - You press \code{ALT-STOP-\textless{}command key\textgreater{}}, I believe.
\begin{description}
\item[{On the serial console (PC style standard serial ports only)}] \leavevmode
You send a \code{BREAK}, then within 5 seconds a command key. Sending
\code{BREAK} twice is interpreted as a normal BREAK.

\item[{On PowerPC}] \leavevmode
Press \code{ALT - Print Screen} (or \code{F13}) - \code{\textless{}command key\textgreater{}},
\code{Print Screen} (or \code{F13}) - \code{\textless{}command key\textgreater{}} may suffice.

\item[{On other}] \leavevmode
If you know of the key combos for other architectures, please
let me know so I can add them to this section.

\item[{On all}] \leavevmode
write a character to /proc/sysrq-trigger.  e.g.:

\begin{Verbatim}[commandchars=\\\{\}]
echo t \PYGZgt{} /proc/sysrq\PYGZhy{}trigger
\end{Verbatim}

\end{description}


\section{What are the `command' keys?}
\label{admin-guide/sysrq:what-are-the-command-keys}
\begin{tabulary}{\linewidth}{|L|L|}
\hline
\textsf{\relax 
Command
} & \textsf{\relax 
Function
}\\
\hline
\code{b}
 & 
Will immediately reboot the system without syncing or unmounting
your disks.
\\
\hline
\code{c}
 & 
Will perform a system crash by a NULL pointer dereference.
A crashdump will be taken if configured.
\\
\hline
\code{d}
 & 
Shows all locks that are held.
\\
\hline
\code{e}
 & 
Send a SIGTERM to all processes, except for init.
\\
\hline
\code{f}
 & 
Will call the oom killer to kill a memory hog process, but do not
panic if nothing can be killed.
\\
\hline
\code{g}
 & 
Used by kgdb (kernel debugger)
\\
\hline
\code{h}
 & 
Will display help (actually any other key than those listed
here will display help. but \code{h} is easy to remember :-)
\\
\hline
\code{i}
 & 
Send a SIGKILL to all processes, except for init.
\\
\hline
\code{j}
 & 
Forcibly ``Just thaw it'' - filesystems frozen by the FIFREEZE ioctl.
\\
\hline
\code{k}
 & 
Secure Access Key (SAK) Kills all programs on the current virtual
console. NOTE: See important comments below in SAK section.
\\
\hline
\code{l}
 & 
Shows a stack backtrace for all active CPUs.
\\
\hline
\code{m}
 & 
Will dump current memory info to your console.
\\
\hline
\code{n}
 & 
Used to make RT tasks nice-able
\\
\hline
\code{o}
 & 
Will shut your system off (if configured and supported).
\\
\hline
\code{p}
 & 
Will dump the current registers and flags to your console.
\\
\hline
\code{q}
 & 
Will dump per CPU lists of all armed hrtimers (but NOT regular
timer\_list timers) and detailed information about all
clockevent devices.
\\
\hline
\code{r}
 & 
Turns off keyboard raw mode and sets it to XLATE.
\\
\hline
\code{s}
 & 
Will attempt to sync all mounted filesystems.
\\
\hline
\code{t}
 & 
Will dump a list of current tasks and their information to your
console.
\\
\hline
\code{u}
 & 
Will attempt to remount all mounted filesystems read-only.
\\
\hline
\code{v}
 & 
Forcefully restores framebuffer console
\\
\hline
\code{v}
 & 
Causes ETM buffer dump {[}ARM-specific{]}
\\
\hline
\code{w}
 & 
Dumps tasks that are in uninterruptable (blocked) state.
\\
\hline
\code{x}
 & 
Used by xmon interface on ppc/powerpc platforms.
Show global PMU Registers on sparc64.
Dump all TLB entries on MIPS.
\\
\hline
\code{y}
 & 
Show global CPU Registers {[}SPARC-64 specific{]}
\\
\hline
\code{z}
 & 
Dump the ftrace buffer
\\
\hline
\code{0}-\code{9}
 & 
Sets the console log level, controlling which kernel messages
will be printed to your console. (\code{0}, for example would make
it so that only emergency messages like PANICs or OOPSes would
make it to your console.)
\\
\hline\end{tabulary}



\section{Okay, so what can I use them for?}
\label{admin-guide/sysrq:okay-so-what-can-i-use-them-for}
Well, unraw(r) is very handy when your X server or a svgalib program crashes.

sak(k) (Secure Access Key) is useful when you want to be sure there is no
trojan program running at console which could grab your password
when you would try to login. It will kill all programs on given console,
thus letting you make sure that the login prompt you see is actually
the one from init, not some trojan program.

\begin{notice}{important}{Important:}
In its true form it is not a true SAK like the one in a
c2 compliant system, and it should not be mistaken as
such.
\end{notice}

It seems others find it useful as (System Attention Key) which is
useful when you want to exit a program that will not let you switch consoles.
(For example, X or a svgalib program.)

\code{reboot(b)} is good when you're unable to shut down. But you should also
\code{sync(s)} and \code{umount(u)} first.

\code{crash(c)} can be used to manually trigger a crashdump when the system is hung.
Note that this just triggers a crash if there is no dump mechanism available.

\code{sync(s)} is great when your system is locked up, it allows you to sync your
disks and will certainly lessen the chance of data loss and fscking. Note
that the sync hasn't taken place until you see the ``OK'' and ``Done'' appear
on the screen. (If the kernel is really in strife, you may not ever get the
OK or Done message...)

\code{umount(u)} is basically useful in the same ways as \code{sync(s)}. I generally
\code{sync(s)}, \code{umount(u)}, then \code{reboot(b)} when my system locks. It's saved
me many a fsck. Again, the unmount (remount read-only) hasn't taken place until
you see the ``OK'' and ``Done'' message appear on the screen.

The loglevels \code{0}-\code{9} are useful when your console is being flooded with
kernel messages you do not want to see. Selecting \code{0} will prevent all but
the most urgent kernel messages from reaching your console. (They will
still be logged if syslogd/klogd are alive, though.)

\code{term(e)} and \code{kill(i)} are useful if you have some sort of runaway process
you are unable to kill any other way, especially if it's spawning other
processes.

``just thaw \code{it(j)}'' is useful if your system becomes unresponsive due to a
frozen (probably root) filesystem via the FIFREEZE ioctl.


\section{Sometimes SysRq seems to get `stuck' after using it, what can I do?}
\label{admin-guide/sysrq:sometimes-sysrq-seems-to-get-stuck-after-using-it-what-can-i-do}
That happens to me, also. I've found that tapping shift, alt, and control
on both sides of the keyboard, and hitting an invalid sysrq sequence again
will fix the problem. (i.e., something like \code{alt-sysrq-z}). Switching to
another virtual console (\code{ALT+Fn}) and then back again should also help.


\section{I hit SysRq, but nothing seems to happen, what's wrong?}
\label{admin-guide/sysrq:i-hit-sysrq-but-nothing-seems-to-happen-what-s-wrong}
There are some keyboards that produce a different keycode for SysRq than the
pre-defined value of 99
(see \code{KEY\_SYSRQ} in \code{include/uapi/linux/input-event-codes.h}), or
which don't have a SysRq key at all. In these cases, run \code{showkey -s} to find
an appropriate scancode sequence, and use \code{setkeycodes \textless{}sequence\textgreater{} 99} to map
this sequence to the usual SysRq code (e.g., \code{setkeycodes e05b 99}). It's
probably best to put this command in a boot script. Oh, and by the way, you
exit \code{showkey} by not typing anything for ten seconds.


\section{I want to add SysRQ key events to a module, how does it work?}
\label{admin-guide/sysrq:i-want-to-add-sysrq-key-events-to-a-module-how-does-it-work}
In order to register a basic function with the table, you must first include
the header \code{include/linux/sysrq.h}, this will define everything else you need.
Next, you must create a \code{sysrq\_key\_op} struct, and populate it with A) the key
handler function you will use, B) a help\_msg string, that will print when SysRQ
prints help, and C) an action\_msg string, that will print right before your
handler is called. Your handler must conform to the prototype in `sysrq.h'.

After the \code{sysrq\_key\_op} is created, you can call the kernel function
\code{register\_sysrq\_key(int key, struct sysrq\_key\_op *op\_p);} this will
register the operation pointed to by \code{op\_p} at table key `key',
if that slot in the table is blank. At module unload time, you must call
the function \code{unregister\_sysrq\_key(int key, struct sysrq\_key\_op *op\_p)}, which
will remove the key op pointed to by `op\_p' from the key `key', if and only if
it is currently registered in that slot. This is in case the slot has been
overwritten since you registered it.

The Magic SysRQ system works by registering key operations against a key op
lookup table, which is defined in `drivers/tty/sysrq.c'. This key table has
a number of operations registered into it at compile time, but is mutable,
and 2 functions are exported for interface to it:

\begin{Verbatim}[commandchars=\\\{\}]
register\PYGZus{}sysrq\PYGZus{}key and unregister\PYGZus{}sysrq\PYGZus{}key.
\end{Verbatim}

Of course, never ever leave an invalid pointer in the table. I.e., when
your module that called register\_sysrq\_key() exits, it must call
unregister\_sysrq\_key() to clean up the sysrq key table entry that it used.
Null pointers in the table are always safe. :)

If for some reason you feel the need to call the handle\_sysrq function from
within a function called by handle\_sysrq, you must be aware that you are in
a lock (you are also in an interrupt handler, which means don't sleep!), so
you must call \code{\_\_handle\_sysrq\_nolock} instead.


\section{When I hit a SysRq key combination only the header appears on the console?}
\label{admin-guide/sysrq:when-i-hit-a-sysrq-key-combination-only-the-header-appears-on-the-console}
Sysrq output is subject to the same console loglevel control as all
other console output.  This means that if the kernel was booted `quiet'
as is common on distro kernels the output may not appear on the actual
console, even though it will appear in the dmesg buffer, and be accessible
via the dmesg command and to the consumers of \code{/proc/kmsg}.  As a specific
exception the header line from the sysrq command is passed to all console
consumers as if the current loglevel was maximum.  If only the header
is emitted it is almost certain that the kernel loglevel is too low.
Should you require the output on the console channel then you will need
to temporarily up the console loglevel using \code{alt-sysrq-8} or:

\begin{Verbatim}[commandchars=\\\{\}]
echo 8 \PYGZgt{} /proc/sysrq\PYGZhy{}trigger
\end{Verbatim}

Remember to return the loglevel to normal after triggering the sysrq
command you are interested in.


\section{I have more questions, who can I ask?}
\label{admin-guide/sysrq:i-have-more-questions-who-can-i-ask}\begin{description}
\item[{Just ask them on the linux-kernel mailing list:}] \leavevmode
\href{mailto:linux-kernel@vger.kernel.org}{linux-kernel@vger.kernel.org}

\end{description}


\section{Credits}
\label{admin-guide/sysrq:credits}
Written by Mydraal \textless{}\href{mailto:vulpyne@vulpyne.net}{vulpyne@vulpyne.net}\textgreater{}
Updated by Adam Sulmicki \textless{}\href{mailto:adam@cfar.umd.edu}{adam@cfar.umd.edu}\textgreater{}
Updated by Jeremy M. Dolan \textless{}\href{mailto:jmd@turbogeek.org}{jmd@turbogeek.org}\textgreater{} 2001/01/28 10:15:59
Added to by Crutcher Dunnavant \textless{}\href{mailto:crutcher+kernel@datastacks.com}{crutcher+kernel@datastacks.com}\textgreater{}


\chapter{Unicode support}
\label{admin-guide/unicode:unicode-support}\label{admin-guide/unicode::doc}\begin{quote}

Last update: 2005-01-17, version 1.4
\end{quote}

This file is maintained by H. Peter Anvin \textless{}\href{mailto:unicode@lanana.org}{unicode@lanana.org}\textgreater{} as part
of the Linux Assigned Names And Numbers Authority (LANANA) project.
The current version can be found at:
\begin{quote}

\href{http://www.lanana.org/docs/unicode/admin-guide/unicode.rst}{http://www.lanana.org/docs/unicode/admin-guide/unicode.rst}
\end{quote}


\section{Introduction}
\label{admin-guide/unicode:introduction}
The Linux kernel code has been rewritten to use Unicode to map
characters to fonts.  By downloading a single Unicode-to-font table,
both the eight-bit character sets and UTF-8 mode are changed to use
the font as indicated.

This changes the semantics of the eight-bit character tables subtly.
The four character tables are now:

\begin{tabulary}{\linewidth}{|L|L|L|}
\hline
\textsf{\relax 
Map symbol
} & \textsf{\relax 
Map name
} & \textsf{\relax 
Escape code (G0)
}\\
\hline
LAT1\_MAP
 & 
Latin-1 (ISO 8859-1)
 & 
ESC ( B
\\
\hline
GRAF\_MAP
 & 
DEC VT100 pseudographics
 & 
ESC ( 0
\\
\hline
IBMPC\_MAP
 & 
IBM code page 437
 & 
ESC ( U
\\
\hline
USER\_MAP
 & 
User defined
 & 
ESC ( K
\\
\hline\end{tabulary}


In particular, ESC ( U is no longer ``straight to font'', since the font
might be completely different than the IBM character set.  This
permits for example the use of block graphics even with a Latin-1 font
loaded.

Note that although these codes are similar to ISO 2022, neither the
codes nor their uses match ISO 2022; Linux has two 8-bit codes (G0 and
G1), whereas ISO 2022 has four 7-bit codes (G0-G3).

In accordance with the Unicode standard/ISO 10646 the range U+F000 to
U+F8FF has been reserved for OS-wide allocation (the Unicode Standard
refers to this as a ``Corporate Zone'', since this is inaccurate for
Linux we call it the ``Linux Zone'').  U+F000 was picked as the starting
point since it lets the direct-mapping area start on a large power of
two (in case 1024- or 2048-character fonts ever become necessary).
This leaves U+E000 to U+EFFF as End User Zone.

{[}v1.2{]}: The Unicodes range from U+F000 and up to U+F7FF have been
hard-coded to map directly to the loaded font, bypassing the
translation table.  The user-defined map now defaults to U+F000 to
U+F0FF, emulating the previous behaviour.  In practice, this range
might be shorter; for example, vgacon can only handle 256-character
(U+F000..U+F0FF) or 512-character (U+F000..U+F1FF) fonts.


\section{Actual characters assigned in the Linux Zone}
\label{admin-guide/unicode:actual-characters-assigned-in-the-linux-zone}
In addition, the following characters not present in Unicode 1.1.4
have been defined; these are used by the DEC VT graphics map.  {[}v1.2{]}
THIS USE IS OBSOLETE AND SHOULD NO LONGER BE USED; PLEASE SEE BELOW.

\begin{tabulary}{\linewidth}{|L|L|}
\hline

U+F800
 & 
DEC VT GRAPHICS HORIZONTAL LINE SCAN 1
\\
\hline
U+F801
 & 
DEC VT GRAPHICS HORIZONTAL LINE SCAN 3
\\
\hline
U+F803
 & 
DEC VT GRAPHICS HORIZONTAL LINE SCAN 7
\\
\hline
U+F804
 & 
DEC VT GRAPHICS HORIZONTAL LINE SCAN 9
\\
\hline\end{tabulary}


The DEC VT220 uses a 6x10 character matrix, and these characters form
a smooth progression in the DEC VT graphics character set.  I have
omitted the scan 5 line, since it is also used as a block-graphics
character, and hence has been coded as U+2500 FORMS LIGHT HORIZONTAL.

{[}v1.3{]}: These characters have been officially added to Unicode 3.2.0;
they are added at U+23BA, U+23BB, U+23BC, U+23BD.  Linux now uses the
new values.

{[}v1.2{]}: The following characters have been added to represent common
keyboard symbols that are unlikely to ever be added to Unicode proper
since they are horribly vendor-specific.  This, of course, is an
excellent example of horrible design.

\begin{tabulary}{\linewidth}{|L|L|}
\hline

U+F810
 & 
KEYBOARD SYMBOL FLYING FLAG
\\
\hline
U+F811
 & 
KEYBOARD SYMBOL PULLDOWN MENU
\\
\hline
U+F812
 & 
KEYBOARD SYMBOL OPEN APPLE
\\
\hline
U+F813
 & 
KEYBOARD SYMBOL SOLID APPLE
\\
\hline\end{tabulary}



\section{Klingon language support}
\label{admin-guide/unicode:klingon-language-support}
In 1996, Linux was the first operating system in the world to add
support for the artificial language Klingon, created by Marc Okrand
for the ``Star Trek'' television series.  This encoding was later
adopted by the ConScript Unicode Registry and proposed (but ultimately
rejected) for inclusion in Unicode Plane 1.  Thus, it remains as a
Linux/CSUR private assignment in the Linux Zone.

This encoding has been endorsed by the Klingon Language Institute.
For more information, contact them at:
\begin{quote}

\href{http://www.kli.org/}{http://www.kli.org/}
\end{quote}

Since the characters in the beginning of the Linux CZ have been more
of the dingbats/symbols/forms type and this is a language, I have
located it at the end, on a 16-cell boundary in keeping with standard
Unicode practice.

\begin{notice}{note}{Note:}
This range is now officially managed by the ConScript Unicode
Registry.  The normative reference is at:
\begin{quote}

\href{http://www.evertype.com/standards/csur/klingon.html}{http://www.evertype.com/standards/csur/klingon.html}
\end{quote}
\end{notice}

Klingon has an alphabet of 26 characters, a positional numeric writing
system with 10 digits, and is written left-to-right, top-to-bottom.

Several glyph forms for the Klingon alphabet have been proposed.
However, since the set of symbols appear to be consistent throughout,
with only the actual shapes being different, in keeping with standard
Unicode practice these differences are considered font variants.

\begin{longtable}{|l|l|}
\hline
\endfirsthead

\multicolumn{2}{c}%
{{\textsf{\tablename\ \thetable{} -- continued from previous page}}} \\
\hline
\endhead

\hline \multicolumn{2}{|r|}{{\textsf{Continued on next page}}} \\ \hline
\endfoot

\endlastfoot


U+F8D0
 & 
KLINGON LETTER A
\\
\hline
U+F8D1
 & 
KLINGON LETTER B
\\
\hline
U+F8D2
 & 
KLINGON LETTER CH
\\
\hline
U+F8D3
 & 
KLINGON LETTER D
\\
\hline
U+F8D4
 & 
KLINGON LETTER E
\\
\hline
U+F8D5
 & 
KLINGON LETTER GH
\\
\hline
U+F8D6
 & 
KLINGON LETTER H
\\
\hline
U+F8D7
 & 
KLINGON LETTER I
\\
\hline
U+F8D8
 & 
KLINGON LETTER J
\\
\hline
U+F8D9
 & 
KLINGON LETTER L
\\
\hline
U+F8DA
 & 
KLINGON LETTER M
\\
\hline
U+F8DB
 & 
KLINGON LETTER N
\\
\hline
U+F8DC
 & 
KLINGON LETTER NG
\\
\hline
U+F8DD
 & 
KLINGON LETTER O
\\
\hline
U+F8DE
 & 
KLINGON LETTER P
\\
\hline
U+F8DF
 & 
KLINGON LETTER Q
- Written \textless{}q\textgreater{} in standard Okrand Latin transliteration
\\
\hline
U+F8E0
 & 
KLINGON LETTER QH
- Written \textless{}Q\textgreater{} in standard Okrand Latin transliteration
\\
\hline
U+F8E1
 & 
KLINGON LETTER R
\\
\hline
U+F8E2
 & 
KLINGON LETTER S
\\
\hline
U+F8E3
 & 
KLINGON LETTER T
\\
\hline
U+F8E4
 & 
KLINGON LETTER TLH
\\
\hline
U+F8E5
 & 
KLINGON LETTER U
\\
\hline
U+F8E6
 & 
KLINGON LETTER V
\\
\hline
U+F8E7
 & 
KLINGON LETTER W
\\
\hline
U+F8E8
 & 
KLINGON LETTER Y
\\
\hline
U+F8E9
 & 
KLINGON LETTER GLOTTAL STOP
\\
\hline
U+F8F0
 & 
KLINGON DIGIT ZERO
\\
\hline
U+F8F1
 & 
KLINGON DIGIT ONE
\\
\hline
U+F8F2
 & 
KLINGON DIGIT TWO
\\
\hline
U+F8F3
 & 
KLINGON DIGIT THREE
\\
\hline
U+F8F4
 & 
KLINGON DIGIT FOUR
\\
\hline
U+F8F5
 & 
KLINGON DIGIT FIVE
\\
\hline
U+F8F6
 & 
KLINGON DIGIT SIX
\\
\hline
U+F8F7
 & 
KLINGON DIGIT SEVEN
\\
\hline
U+F8F8
 & 
KLINGON DIGIT EIGHT
\\
\hline
U+F8F9
 & 
KLINGON DIGIT NINE
\\
\hline
U+F8FD
 & 
KLINGON COMMA
\\
\hline
U+F8FE
 & 
KLINGON FULL STOP
\\
\hline
U+F8FF
 & 
KLINGON SYMBOL FOR EMPIRE
\\
\hline\end{longtable}



\section{Other Fictional and Artificial Scripts}
\label{admin-guide/unicode:other-fictional-and-artificial-scripts}
Since the assignment of the Klingon Linux Unicode block, a registry of
fictional and artificial scripts has been established by John Cowan
\textless{}\href{mailto:jcowan@reutershealth.com}{jcowan@reutershealth.com}\textgreater{} and Michael Everson \textless{}\href{mailto:everson@evertype.com}{everson@evertype.com}\textgreater{}.
The ConScript Unicode Registry is accessible at:
\begin{quote}

\href{http://www.evertype.com/standards/csur/}{http://www.evertype.com/standards/csur/}
\end{quote}

The ranges used fall at the low end of the End User Zone and can hence
not be normatively assigned, but it is recommended that people who
wish to encode fictional scripts use these codes, in the interest of
interoperability.  For Klingon, CSUR has adopted the Linux encoding.
The CSUR people are driving adding Tengwar and Cirth into Unicode
Plane 1; the addition of Klingon to Unicode Plane 1 has been rejected
and so the above encoding remains official.


\chapter{Software cursor for VGA}
\label{admin-guide/vga-softcursor:software-cursor-for-vga}\label{admin-guide/vga-softcursor::doc}
by Pavel Machek \textless{}\href{mailto:pavel@atrey.karlin.mff.cuni.cz}{pavel@atrey.karlin.mff.cuni.cz}\textgreater{}
and Martin Mares \textless{}\href{mailto:mj@atrey.karlin.mff.cuni.cz}{mj@atrey.karlin.mff.cuni.cz}\textgreater{}

Linux now has some ability to manipulate cursor appearance.  Normally,
you can set the size of hardware cursor.  You can now play a few new
tricks: you can make your cursor look like a non-blinking red block,
make it inverse background of the character it's over or to highlight
that character and still choose whether the original hardware cursor
should remain visible or not.  There may be other things I have never
thought of.

The cursor appearance is controlled by a \code{\textless{}ESC\textgreater{}{[}?1;2;3c} escape sequence
where 1, 2 and 3 are parameters described below. If you omit any of them,
they will default to zeroes.
\begin{description}
\item[{first Parameter}] \leavevmode
specifies cursor size:

\begin{Verbatim}[commandchars=\\\{\}]
0=default
1=invisible
2=underline,
...
8=full block
+ 16 if you want the software cursor to be applied
+ 32 if you want to always change the background color
+ 64 if you dislike having the background the same as the
     foreground.
\end{Verbatim}

Highlights are ignored for the last two flags.

\item[{second parameter}] \leavevmode
selects character attribute bits you want to change
(by simply XORing them with the value of this parameter). On standard
VGA, the high four bits specify background and the low four the
foreground. In both groups, low three bits set color (as in normal
color codes used by the console) and the most significant one turns
on highlight (or sometimes blinking -- it depends on the configuration
of your VGA).

\item[{third parameter}] \leavevmode
consists of character attribute bits you want to set.

Bit setting takes place before bit toggling, so you can simply clear a
bit by including it in both the set mask and the toggle mask.

\end{description}


\section{Examples}
\label{admin-guide/vga-softcursor:examples}
To get normal blinking underline, use:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZhy{}e \PYGZsq{}\PYGZbs{}033[?2c\PYGZsq{}
\end{Verbatim}

To get blinking block, use:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZhy{}e \PYGZsq{}\PYGZbs{}033[?6c\PYGZsq{}
\end{Verbatim}

To get red non-blinking block, use:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZhy{}e \PYGZsq{}\PYGZbs{}033[?17;0;64c\PYGZsq{}
\end{Verbatim}


\chapter{Kernel Support for miscellaneous (your favourite) Binary Formats v1.1}
\label{admin-guide/binfmt-misc:kernel-support-for-miscellaneous-your-favourite-binary-formats-v1-1}\label{admin-guide/binfmt-misc::doc}
This Kernel feature allows you to invoke almost (for restrictions see below)
every program by simply typing its name in the shell.
This includes for example compiled Java(TM), Python or Emacs programs.

To achieve this you must tell binfmt\_misc which interpreter has to be invoked
with which binary. Binfmt\_misc recognises the binary-type by matching some bytes
at the beginning of the file with a magic byte sequence (masking out specified
bits) you have supplied. Binfmt\_misc can also recognise a filename extension
aka \code{.com} or \code{.exe}.

First you must mount binfmt\_misc:

\begin{Verbatim}[commandchars=\\\{\}]
mount binfmt\PYGZus{}misc \PYGZhy{}t binfmt\PYGZus{}misc /proc/sys/fs/binfmt\PYGZus{}misc
\end{Verbatim}

To actually register a new binary type, you have to set up a string looking like
\code{:name:type:offset:magic:mask:interpreter:flags} (where you can choose the
\code{:} upon your needs) and echo it to \code{/proc/sys/fs/binfmt\_misc/register}.

Here is what the fields mean:
\begin{itemize}
\item {} \begin{description}
\item[{\code{name}}] \leavevmode
is an identifier string. A new /proc file will be created with this
\code{name below /proc/sys/fs/binfmt\_misc}; cannot contain slashes \code{/} for
obvious reasons.

\end{description}

\item {} \begin{description}
\item[{\code{type}}] \leavevmode
is the type of recognition. Give \code{M} for magic and \code{E} for extension.

\end{description}

\item {} \begin{description}
\item[{\code{offset}}] \leavevmode
is the offset of the magic/mask in the file, counted in bytes. This
defaults to 0 if you omit it (i.e. you write \code{:name:type::magic...}).
Ignored when using filename extension matching.

\end{description}

\item {} \begin{description}
\item[{\code{magic}}] \leavevmode
is the byte sequence binfmt\_misc is matching for. The magic string
may contain hex-encoded characters like \code{\textbackslash{}x0a} or \code{\textbackslash{}xA4}. Note that you
must escape any NUL bytes; parsing halts at the first one. In a shell
environment you might have to write \code{\textbackslash{}\textbackslash{}x0a} to prevent the shell from
eating your \code{\textbackslash{}}.
If you chose filename extension matching, this is the extension to be
recognised (without the \code{.}, the \code{\textbackslash{}x0a} specials are not allowed).
Extension    matching is case sensitive, and slashes \code{/} are not allowed!

\end{description}

\item {} \begin{description}
\item[{\code{mask}}] \leavevmode
is an (optional, defaults to all 0xff) mask. You can mask out some
bits from matching by supplying a string like magic and as long as magic.
The mask is anded with the byte sequence of the file. Note that you must
escape any NUL bytes; parsing halts at the first one. Ignored when using
filename extension matching.

\end{description}

\item {} \begin{description}
\item[{\code{interpreter}}] \leavevmode
is the program that should be invoked with the binary as first
argument (specify the full path)

\end{description}

\item {} \begin{description}
\item[{\code{flags}}] \leavevmode
is an optional field that controls several aspects of the invocation
of the interpreter. It is a string of capital letters, each controls a
certain aspect. The following flags are supported:
\begin{quote}
\begin{description}
\item[{\code{P} - preserve-argv{[}0{]}}] \leavevmode
Legacy behavior of binfmt\_misc is to overwrite
the original argv{[}0{]} with the full path to the binary. When this
flag is included, binfmt\_misc will add an argument to the argument
vector for this purpose, thus preserving the original \code{argv{[}0{]}}.
e.g. If your interp is set to \code{/bin/foo} and you run \code{blah}
(which is in \code{/usr/local/bin}), then the kernel will execute
\code{/bin/foo} with \code{argv{[}{]}} set to \code{{[}"/bin/foo", "/usr/local/bin/blah", "blah"{]}}.  The interp has to be aware of this so it can
execute \code{/usr/local/bin/blah}
with \code{argv{[}{]}} set to \code{{[}"blah"{]}}.

\item[{\code{O} - open-binary}] \leavevmode
Legacy behavior of binfmt\_misc is to pass the full path
of the binary to the interpreter as an argument. When this flag is
included, binfmt\_misc will open the file for reading and pass its
descriptor as an argument, instead of the full path, thus allowing
the interpreter to execute non-readable binaries. This feature
should be used with care - the interpreter has to be trusted not to
emit the contents of the non-readable binary.

\item[{\code{C} - credentials}] \leavevmode
Currently, the behavior of binfmt\_misc is to calculate
the credentials and security token of the new process according to
the interpreter. When this flag is included, these attributes are
calculated according to the binary. It also implies the \code{O} flag.
This feature should be used with care as the interpreter
will run with root permissions when a setuid binary owned by root
is run with binfmt\_misc.

\item[{\code{F} - fix binary}] \leavevmode
The usual behaviour of binfmt\_misc is to spawn the
binary lazily when the misc format file is invoked.  However,
this doesn{}`{}`t work very well in the face of mount namespaces and
changeroots, so the \code{F} mode opens the binary as soon as the
emulation is installed and uses the opened image to spawn the
emulator, meaning it is always available once installed,
regardless of how the environment changes.

\end{description}
\end{quote}

\end{description}

\end{itemize}

There are some restrictions:
\begin{itemize}
\item {} 
the whole register string may not exceed 1920 characters

\item {} 
the magic must reside in the first 128 bytes of the file, i.e.
offset+size(magic) has to be less than 128

\item {} 
the interpreter string may not exceed 127 characters

\end{itemize}

To use binfmt\_misc you have to mount it first. You can mount it with
\code{mount -t binfmt\_misc none /proc/sys/fs/binfmt\_misc} command, or you can add
a line \code{none  /proc/sys/fs/binfmt\_misc binfmt\_misc defaults 0 0} to your
\code{/etc/fstab} so it auto mounts on boot.

You may want to add the binary formats in one of your \code{/etc/rc} scripts during
boot-up. Read the manual of your init program to figure out how to do this
right.

Think about the order of adding entries! Later added entries are matched first!

A few examples (assumed you are in \code{/proc/sys/fs/binfmt\_misc}):
\begin{itemize}
\item {} 
enable support for em86 (like binfmt\_em86, for Alpha AXP only):

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZsq{}:i386:M::\PYGZbs{}x7fELF\PYGZbs{}x01\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x02\PYGZbs{}x00\PYGZbs{}x03:\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xfe\PYGZbs{}xfe\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xfb\PYGZbs{}xff\PYGZbs{}xff:/bin/em86:\PYGZsq{} \PYGZgt{} register
echo \PYGZsq{}:i486:M::\PYGZbs{}x7fELF\PYGZbs{}x01\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x00\PYGZbs{}x02\PYGZbs{}x00\PYGZbs{}x06:\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xfe\PYGZbs{}xfe\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xff\PYGZbs{}xfb\PYGZbs{}xff\PYGZbs{}xff:/bin/em86:\PYGZsq{} \PYGZgt{} register
\end{Verbatim}

\item {} 
enable support for packed DOS applications (pre-configured dosemu hdimages):

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZsq{}:DEXE:M::\PYGZbs{}x0eDEX::/usr/bin/dosexec:\PYGZsq{} \PYGZgt{} register
\end{Verbatim}

\item {} 
enable support for Windows executables using wine:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZsq{}:DOSWin:M::MZ::/usr/local/bin/wine:\PYGZsq{} \PYGZgt{} register
\end{Verbatim}

\end{itemize}

For java support see Documentation/admin-guide/java.rst

You can enable/disable binfmt\_misc or one binary type by echoing 0 (to disable)
or 1 (to enable) to \code{/proc/sys/fs/binfmt\_misc/status} or
\code{/proc/.../the\_name}.
Catting the file tells you the current status of \code{binfmt\_misc/the\_entry}.

You can remove one entry or all entries by echoing -1 to \code{/proc/.../the\_name}
or \code{/proc/sys/fs/binfmt\_misc/status}.


\section{Hints}
\label{admin-guide/binfmt-misc:hints}
If you want to pass special arguments to your interpreter, you can
write a wrapper script for it. See Documentation/admin-guide/java.rst for an
example.

Your interpreter should NOT look in the PATH for the filename; the kernel
passes it the full filename (or the file descriptor) to use.  Using \code{\$PATH} can
cause unexpected behaviour and can be a security hazard.

Richard Günther \textless{}\href{mailto:rguenth@tat.physik.uni-tuebingen.de}{rguenth@tat.physik.uni-tuebingen.de}\textgreater{}


\chapter{Mono(tm) Binary Kernel Support for Linux}
\label{admin-guide/mono:mono-tm-binary-kernel-support-for-linux}\label{admin-guide/mono::doc}
To configure Linux to automatically execute Mono-based .NET binaries
(in the form of .exe files) without the need to use the mono CLR
wrapper, you can use the BINFMT\_MISC kernel support.

This will allow you to execute Mono-based .NET binaries just like any
other program after you have done the following:
\begin{enumerate}
\item {} 
You MUST FIRST install the Mono CLR support, either by downloading
a binary package, a source tarball or by installing from Git. Binary
packages for several distributions can be found at:
\begin{quote}

\href{http://www.mono-project.com/download/}{http://www.mono-project.com/download/}
\end{quote}

Instructions for compiling Mono can be found at:
\begin{quote}

\href{http://www.mono-project.com/docs/compiling-mono/linux/}{http://www.mono-project.com/docs/compiling-mono/linux/}
\end{quote}

Once the Mono CLR support has been installed, just check that
\code{/usr/bin/mono} (which could be located elsewhere, for example
\code{/usr/local/bin/mono}) is working.

\item {} 
You have to compile BINFMT\_MISC either as a module or into
the kernel (\code{CONFIG\_BINFMT\_MISC}) and set it up properly.
If you choose to compile it as a module, you will have
to insert it manually with modprobe/insmod, as kmod
cannot be easily supported with binfmt\_misc.
Read the file \code{binfmt\_misc.txt} in this directory to know
more about the configuration process.

\item {} 
Add the following entries to \code{/etc/rc.local} or similar script
to be run at system startup:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Insert BINFMT\PYGZus{}MISC module into the kernel}
\PYG{k}{if} \PYG{o}{[} ! \PYGZhy{}e /proc/sys/fs/binfmt\PYGZus{}misc/register \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
    /sbin/modprobe binfmt\PYGZus{}misc
    \PYG{c+c1}{\PYGZsh{} Some distributions, like Fedora Core, perform}
    \PYG{c+c1}{\PYGZsh{} the following command automatically when the}
    \PYG{c+c1}{\PYGZsh{} binfmt\PYGZus{}misc module is loaded into the kernel}
    \PYG{c+c1}{\PYGZsh{} or during normal boot up (systemd\PYGZhy{}based systems).}
    \PYG{c+c1}{\PYGZsh{} Thus, it is possible that the following line}
    \PYG{c+c1}{\PYGZsh{} is not needed at all.}
    mount \PYGZhy{}t binfmt\PYGZus{}misc none /proc/sys/fs/binfmt\PYGZus{}misc
\PYG{k}{fi}

\PYG{c+c1}{\PYGZsh{} Register support for .NET CLR binaries}
\PYG{k}{if} \PYG{o}{[} \PYGZhy{}e /proc/sys/fs/binfmt\PYGZus{}misc/register \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
    \PYG{c+c1}{\PYGZsh{} Replace /usr/bin/mono with the correct pathname to}
    \PYG{c+c1}{\PYGZsh{} the Mono CLR runtime (usually /usr/local/bin/mono}
    \PYG{c+c1}{\PYGZsh{} when compiling from sources or CVS).}
    \PYG{n+nb}{echo} \PYG{l+s+s1}{\PYGZsq{}:CLR:M::MZ::/usr/bin/mono:\PYGZsq{}} \PYGZgt{} /proc/sys/fs/binfmt\PYGZus{}misc/register
\PYG{k}{else}
    \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}No binfmt\PYGZus{}misc support\PYGZdq{}}
    \PYG{n+nb}{exit} 1
\PYG{k}{fi}
\end{Verbatim}

\item {} 
Check that \code{.exe} binaries can be ran without the need of a
wrapper script, simply by launching the \code{.exe} file directly
from a command prompt, for example:

\begin{Verbatim}[commandchars=\\\{\}]
/usr/bin/xsd.exe
\end{Verbatim}

\begin{notice}{note}{Note:}
If this fails with a permission denied error, check
that the \code{.exe} file has execute permissions.
\end{notice}

\end{enumerate}


\chapter{Java(tm) Binary Kernel Support for Linux v1.03}
\label{admin-guide/java:java-tm-binary-kernel-support-for-linux-v1-03}\label{admin-guide/java::doc}
Linux beats them ALL! While all other OS's are TALKING about direct
support of Java Binaries in the OS, Linux is doing it!

You can execute Java applications and Java Applets just like any
other program after you have done the following:
\begin{enumerate}
\item {} 
You MUST FIRST install the Java Developers Kit for Linux.
The Java on Linux HOWTO gives the details on getting and
installing this. This HOWTO can be found at:
\begin{quote}

\href{ftp://sunsite.unc.edu/pub/Linux/docs/HOWTO/Java-HOWTO}{ftp://sunsite.unc.edu/pub/Linux/docs/HOWTO/Java-HOWTO}
\end{quote}

You should also set up a reasonable CLASSPATH environment
variable to use Java applications that make use of any
nonstandard classes (not included in the same directory
as the application itself).

\item {} 
You have to compile BINFMT\_MISC either as a module or into
the kernel (\code{CONFIG\_BINFMT\_MISC}) and set it up properly.
If you choose to compile it as a module, you will have
to insert it manually with modprobe/insmod, as kmod
cannot easily be supported with binfmt\_misc.
Read the file `binfmt\_misc.txt' in this directory to know
more about the configuration process.

\item {} 
Add the following configuration items to binfmt\_misc
(you should really have read \code{binfmt\_misc.txt} now):
support for Java applications:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsq{}:Java:M::\PYGZbs{}xca\PYGZbs{}xfe\PYGZbs{}xba\PYGZbs{}xbe::/usr/local/bin/javawrapper:\PYGZsq{}
\end{Verbatim}

support for executable Jar files:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsq{}:ExecutableJAR:E::jar::/usr/local/bin/jarwrapper:\PYGZsq{}
\end{Verbatim}

support for Java Applets:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsq{}:Applet:E::html::/usr/bin/appletviewer:\PYGZsq{}
\end{Verbatim}

or the following, if you want to be more selective:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsq{}:Applet:M::\PYGZlt{}!\PYGZhy{}\PYGZhy{}applet::/usr/bin/appletviewer:\PYGZsq{}
\end{Verbatim}

Of course you have to fix the path names. The path/file names given in this
document match the Debian 2.1 system. (i.e. jdk installed in \code{/usr},
custom wrappers from this document in \code{/usr/local})

Note, that for the more selective applet support you have to modify
existing html-files to contain \code{\textless{}!-{-}applet-{-}\textgreater{}} in the first line
(\code{\textless{}} has to be the first character!) to let this work!

For the compiled Java programs you need a wrapper script like the
following (this is because Java is broken in case of the filename
handling), again fix the path names, both in the script and in the
above given configuration string.

You, too, need the little program after the script. Compile like:

\begin{Verbatim}[commandchars=\\\{\}]
gcc \PYGZhy{}O2 \PYGZhy{}o javaclassname javaclassname.c
\end{Verbatim}

and stick it to \code{/usr/local/bin}.

Both the javawrapper shellscript and the javaclassname program
were supplied by Colin J. Watson \textless{}\href{mailto:cjw44@cam.ac.uk}{cjw44@cam.ac.uk}\textgreater{}.

\end{enumerate}

Javawrapper shell script:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} /usr/local/bin/javawrapper \PYGZhy{} the wrapper for binfmt\PYGZus{}misc/java}

\PYG{k}{if} \PYG{o}{[} \PYGZhy{}z \PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
      \PYG{n+nb}{exec} 1\PYGZgt{}\PYG{p}{\PYGZam{}}2
      \PYG{n+nb}{echo} Usage: \PYG{n+nv}{\PYGZdl{}0} class\PYGZhy{}file
      \PYG{n+nb}{exit} 1
\PYG{k}{fi}

\PYG{n+nv}{CLASS}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}1}
\PYG{n+nv}{FQCLASS}\PYG{o}{=}\PYG{l+s+sb}{{}`}/usr/local/bin/javaclassname \PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+sb}{{}`}
\PYG{n+nv}{FQCLASSN}\PYG{o}{=}\PYG{l+s+sb}{{}`}\PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}F}QCLASS \PYG{p}{\textbar{}} sed \PYGZhy{}e \PYG{l+s+s1}{\PYGZsq{}s/\PYGZca{}.*\PYGZbs{}.\PYGZbs{}([\PYGZca{}.]*\PYGZbs{})\PYGZdl{}/\PYGZbs{}1/\PYGZsq{}}\PYG{l+s+sb}{{}`}
\PYG{n+nv}{FQCLASSP}\PYG{o}{=}\PYG{l+s+sb}{{}`}\PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}F}QCLASS \PYG{p}{\textbar{}} sed \PYGZhy{}e \PYG{l+s+s1}{\PYGZsq{}s\PYGZhy{}\PYGZbs{}.\PYGZhy{}/\PYGZhy{}g\PYGZsq{}} \PYGZhy{}e \PYG{l+s+s1}{\PYGZsq{}s\PYGZhy{}\PYGZca{}[\PYGZca{}/]*\PYGZdl{}\PYGZhy{}\PYGZhy{}\PYGZsq{}} \PYGZhy{}e \PYG{l+s+s1}{\PYGZsq{}s\PYGZhy{}/[\PYGZca{}/]*\PYGZdl{}\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{l+s+sb}{{}`}

\PYG{c+c1}{\PYGZsh{} for example:}
\PYG{c+c1}{\PYGZsh{} CLASS=Test.class}
\PYG{c+c1}{\PYGZsh{} FQCLASS=foo.bar.Test}
\PYG{c+c1}{\PYGZsh{} FQCLASSN=Test}
\PYG{c+c1}{\PYGZsh{} FQCLASSP=foo/bar}

\PYG{n+nb}{unset} CLASSBASE

\PYG{n+nb}{declare} \PYGZhy{}i \PYG{n+nv}{LINKLEVEL}\PYG{o}{=}0

\PYG{k}{while} :\PYG{p}{;} \PYG{k}{do}
      \PYG{k}{if} \PYG{o}{[} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{{}`basename }\PYG{n+nv}{\PYGZdl{}C}\PYG{l+s+s2}{LASS .class{}`}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{=}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASSN}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
              \PYG{c+c1}{\PYGZsh{} See if this directory works straight off}
              \PYG{n+nb}{cd} \PYGZhy{}L \PYG{l+s+sb}{{}`}dirname \PYG{n+nv}{\PYGZdl{}C}LASS\PYG{l+s+sb}{{}`}
              \PYG{n+nv}{CLASSDIR}\PYG{o}{=}\PYGZdl{}PWD
              \PYG{n+nb}{cd} \PYGZdl{}OLDPWD
              \PYG{k}{if} \PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}C}LASSDIR \PYG{p}{\textbar{}} grep \PYGZhy{}q \PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASSP}\PYGZdl{}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;} \PYG{k}{then}
                      \PYG{n+nv}{CLASSBASE}\PYG{o}{=}\PYG{l+s+sb}{{}`}\PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}C}LASSDIR \PYG{p}{\textbar{}} sed \PYGZhy{}e \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{s.}\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASSP}\PYGZdl{}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+sb}{{}`}
                      break\PYG{p}{;}
              \PYG{k}{fi}
              \PYG{c+c1}{\PYGZsh{} Try dereferencing the directory name}
              \PYG{n+nb}{cd} \PYGZhy{}P \PYG{l+s+sb}{{}`}dirname \PYG{n+nv}{\PYGZdl{}C}LASS\PYG{l+s+sb}{{}`}
              \PYG{n+nv}{CLASSDIR}\PYG{o}{=}\PYGZdl{}PWD
              \PYG{n+nb}{cd} \PYGZdl{}OLDPWD
              \PYG{k}{if} \PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}C}LASSDIR \PYG{p}{\textbar{}} grep \PYGZhy{}q \PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASSP}\PYGZdl{}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;} \PYG{k}{then}
                      \PYG{n+nv}{CLASSBASE}\PYG{o}{=}\PYG{l+s+sb}{{}`}\PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}C}LASSDIR \PYG{p}{\textbar{}} sed \PYGZhy{}e \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{s.}\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASSP}\PYGZdl{}\PYG{l+s+s2}{..}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+sb}{{}`}
                      break\PYG{p}{;}
              \PYG{k}{fi}
              \PYG{c+c1}{\PYGZsh{} If no other possible filename exists}
              \PYG{k}{if} \PYG{o}{[} ! \PYGZhy{}L \PYG{n+nv}{\PYGZdl{}C}LASS \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
                      \PYG{n+nb}{exec} 1\PYGZgt{}\PYG{p}{\PYGZam{}}2
                      \PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}0}:
                      \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}C}\PYG{l+s+s2}{LASS should be in a}\PYG{l+s+s2}{\PYGZdq{}} \PYG{l+s+se}{\PYGZbs{}}
                           \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{directory tree called }\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASSP}\PYG{l+s+s2}{\PYGZdq{}}
                      \PYG{n+nb}{exit} 1
              \PYG{k}{fi}
      \PYG{k}{fi}
      \PYG{k}{if} \PYG{o}{[} ! \PYGZhy{}L \PYG{n+nv}{\PYGZdl{}C}LASS \PYG{o}{]}\PYG{p}{;} \PYG{k}{then} break\PYG{p}{;} \PYG{k}{fi}
      \PYG{c+c1}{\PYGZsh{} Go down one more level of symbolic links}
      \PYG{n+nb}{let} LINKLEVEL+\PYG{o}{=}1
      \PYG{k}{if} \PYG{o}{[} \PYGZdl{}LINKLEVEL \PYGZhy{}gt \PYG{l+m}{5} \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
              \PYG{n+nb}{exec} 1\PYGZgt{}\PYG{p}{\PYGZam{}}2
              \PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}0}:
              \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}  Too many symbolic links encountered\PYGZdq{}}
              \PYG{n+nb}{exit} 1
      \PYG{k}{fi}
      \PYG{n+nv}{CLASS}\PYG{o}{=}\PYG{l+s+sb}{{}`}ls \PYGZhy{}\PYGZhy{}color\PYG{o}{=}no \PYGZhy{}l \PYG{n+nv}{\PYGZdl{}C}LASS \PYG{p}{\textbar{}} sed \PYGZhy{}e \PYG{l+s+s1}{\PYGZsq{}s/\PYGZca{}.* \PYGZbs{}([\PYGZca{} ]*\PYGZbs{})\PYGZdl{}/\PYGZbs{}1/\PYGZsq{}}\PYG{l+s+sb}{{}`}
\PYG{k}{done}

\PYG{k}{if} \PYG{o}{[} \PYGZhy{}z \PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}C}\PYG{l+s+s2}{LASSBASE}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
      \PYG{k}{if} \PYG{o}{[} \PYGZhy{}z \PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASSP}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
              \PYG{n+nv}{GOODNAME}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}F}QCLASSN.class
      \PYG{k}{else}
              \PYG{n+nv}{GOODNAME}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}F}QCLASSP/\PYG{n+nv}{\PYGZdl{}F}QCLASSN.class
      \PYG{k}{fi}
      \PYG{n+nb}{exec} 1\PYGZgt{}\PYG{p}{\PYGZam{}}2
      \PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}0}:
      \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}F}\PYG{l+s+s2}{QCLASS should be in a file called }\PYGZdl{}\PYG{l+s+s2}{GOODNAME}\PYG{l+s+s2}{\PYGZdq{}}
      \PYG{n+nb}{exit} 1
\PYG{k}{fi}

\PYG{k}{if} ! \PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}C}LASSPATH \PYG{p}{\textbar{}} grep \PYGZhy{}q \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZca{}\PYGZbs{}(.*:\PYGZbs{})*}\PYG{n+nv}{\PYGZdl{}C}\PYG{l+s+s2}{LASSBASE\PYGZbs{}(:.*\PYGZbs{})*}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;} \PYG{k}{then}
      \PYG{c+c1}{\PYGZsh{} class is not in CLASSPATH, so prepend dir of class to CLASSPATH}
      \PYG{k}{if} \PYG{o}{[} \PYGZhy{}z \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{CLASSPATH}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{]} \PYG{p}{;} \PYG{k}{then}
              \PYG{n+nb}{export} \PYG{n+nv}{CLASSPATH}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}C}LASSBASE
      \PYG{k}{else}
              \PYG{n+nb}{export} \PYG{n+nv}{CLASSPATH}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}C}LASSBASE:\PYG{n+nv}{\PYGZdl{}C}LASSPATH
      \PYG{k}{fi}
\PYG{k}{fi}

\PYG{n+nb}{shift}
/usr/bin/java \PYG{n+nv}{\PYGZdl{}F}QCLASS \PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}@}\PYG{l+s+s2}{\PYGZdq{}}
\end{Verbatim}

javaclassname.c:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+cm}{/* javaclassname.c}
\PYG{c+cm}{ *}
\PYG{c+cm}{ * Extracts the class name from a Java class file; intended for use in a Java}
\PYG{c+cm}{ * wrapper of the type supported by the binfmt\PYGZus{}misc option in the Linux kernel.}
\PYG{c+cm}{ *}
\PYG{c+cm}{ * Copyright (C) 1999 Colin J. Watson \PYGZlt{}cjw44@cam.ac.uk\PYGZgt{}.}
\PYG{c+cm}{ *}
\PYG{c+cm}{ * This program is free software; you can redistribute it and/or modify}
\PYG{c+cm}{ * it under the terms of the GNU General Public License as published by}
\PYG{c+cm}{ * the Free Software Foundation; either version 2 of the License, or}
\PYG{c+cm}{ * (at your option) any later version.}
\PYG{c+cm}{ *}
\PYG{c+cm}{ * This program is distributed in the hope that it will be useful,}
\PYG{c+cm}{ * but WITHOUT ANY WARRANTY; without even the implied warranty of}
\PYG{c+cm}{ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
\PYG{c+cm}{ * GNU General Public License for more details.}
\PYG{c+cm}{ *}
\PYG{c+cm}{ * You should have received a copy of the GNU General Public License}
\PYG{c+cm}{ * along with this program; if not, write to the Free Software}
\PYG{c+cm}{ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111\PYGZhy{}1307  USA}
\PYG{c+cm}{ */}

\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZlt{}stdlib.h\PYGZgt{}}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZlt{}stdio.h\PYGZgt{}}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZlt{}stdarg.h\PYGZgt{}}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{include} \PYG{c+cpf}{\PYGZlt{}sys/types.h\PYGZgt{}}

\PYG{c+cm}{/* From Sun\PYGZsq{}s Java VM Specification, as tag entries in the constant pool. */}

\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}UTF8 1}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}INTEGER 3}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}FLOAT 4}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}LONG 5}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}DOUBLE 6}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}CLASS 7}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}STRING 8}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}FIELDREF 9}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}METHODREF 10}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}INTERFACEMETHODREF 11}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}NAMEANDTYPE 12}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}METHODHANDLE 15}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}METHODTYPE 16}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define CP\PYGZus{}INVOKEDYNAMIC 18}

\PYG{c+cm}{/* Define some commonly used error messages */}

\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define seek\PYGZus{}error() error(\PYGZdq{}\PYGZpc{}s: Cannot seek\PYGZbs{}n\PYGZdq{}, program)}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define corrupt\PYGZus{}error() error(\PYGZdq{}\PYGZpc{}s: Class file corrupt\PYGZbs{}n\PYGZdq{}, program)}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define eof\PYGZus{}error() error(\PYGZdq{}\PYGZpc{}s: Unexpected end of file\PYGZbs{}n\PYGZdq{}, program)}
\PYG{c+cp}{\PYGZsh{}}\PYG{c+cp}{define utf8\PYGZus{}error() error(\PYGZdq{}\PYGZpc{}s: Only ASCII 1\PYGZhy{}255 supported\PYGZbs{}n\PYGZdq{}, program);}

\PYG{k+kt}{char} \PYG{o}{*}\PYG{n}{program}\PYG{p}{;}

\PYG{k+kt}{long} \PYG{o}{*}\PYG{n}{pool}\PYG{p}{;}

\PYG{n}{u\PYGZus{}int8\PYGZus{}t} \PYG{n+nf}{read\PYGZus{}8}\PYG{p}{(}\PYG{k+kt}{FILE} \PYG{o}{*}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{u\PYGZus{}int16\PYGZus{}t} \PYG{n+nf}{read\PYGZus{}16}\PYG{p}{(}\PYG{k+kt}{FILE} \PYG{o}{*}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
\PYG{k+kt}{void} \PYG{n+nf}{skip\PYGZus{}constant}\PYG{p}{(}\PYG{k+kt}{FILE} \PYG{o}{*}\PYG{n}{classfile}\PYG{p}{,} \PYG{n}{u\PYGZus{}int16\PYGZus{}t} \PYG{o}{*}\PYG{n}{cur}\PYG{p}{)}\PYG{p}{;}
\PYG{k+kt}{void} \PYG{n+nf}{error}\PYG{p}{(}\PYG{k}{const} \PYG{k+kt}{char} \PYG{o}{*}\PYG{n}{format}\PYG{p}{,} \PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{p}{)}\PYG{p}{;}
\PYG{k+kt}{int} \PYG{n+nf}{main}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{argc}\PYG{p}{,} \PYG{k+kt}{char} \PYG{o}{*}\PYG{o}{*}\PYG{n}{argv}\PYG{p}{)}\PYG{p}{;}

\PYG{c+cm}{/* Reads in an unsigned 8\PYGZhy{}bit integer. */}
\PYG{n}{u\PYGZus{}int8\PYGZus{}t} \PYG{n+nf}{read\PYGZus{}8}\PYG{p}{(}\PYG{k+kt}{FILE} \PYG{o}{*}\PYG{n}{classfile}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
      \PYG{k+kt}{int} \PYG{n}{b} \PYG{o}{=} \PYG{n}{fgetc}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{b} \PYG{o}{=}\PYG{o}{=} \PYG{n}{EOF}\PYG{p}{)}
              \PYG{n}{eof\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{return} \PYG{p}{(}\PYG{n}{u\PYGZus{}int8\PYGZus{}t}\PYG{p}{)}\PYG{n}{b}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}

\PYG{c+cm}{/* Reads in an unsigned 16\PYGZhy{}bit integer. */}
\PYG{n}{u\PYGZus{}int16\PYGZus{}t} \PYG{n+nf}{read\PYGZus{}16}\PYG{p}{(}\PYG{k+kt}{FILE} \PYG{o}{*}\PYG{n}{classfile}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
      \PYG{k+kt}{int} \PYG{n}{b1}\PYG{p}{,} \PYG{n}{b2}\PYG{p}{;}
      \PYG{n}{b1} \PYG{o}{=} \PYG{n}{fgetc}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{b1} \PYG{o}{=}\PYG{o}{=} \PYG{n}{EOF}\PYG{p}{)}
              \PYG{n}{eof\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{b2} \PYG{o}{=} \PYG{n}{fgetc}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{b2} \PYG{o}{=}\PYG{o}{=} \PYG{n}{EOF}\PYG{p}{)}
              \PYG{n}{eof\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{return} \PYG{p}{(}\PYG{n}{u\PYGZus{}int16\PYGZus{}t}\PYG{p}{)}\PYG{p}{(}\PYG{p}{(}\PYG{n}{b1} \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{8}\PYG{p}{)} \PYG{o}{\textbar{}} \PYG{n}{b2}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}

\PYG{c+cm}{/* Reads in a value from the constant pool. */}
\PYG{k+kt}{void} \PYG{n+nf}{skip\PYGZus{}constant}\PYG{p}{(}\PYG{k+kt}{FILE} \PYG{o}{*}\PYG{n}{classfile}\PYG{p}{,} \PYG{n}{u\PYGZus{}int16\PYGZus{}t} \PYG{o}{*}\PYG{n}{cur}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
      \PYG{n}{u\PYGZus{}int16\PYGZus{}t} \PYG{n}{len}\PYG{p}{;}
      \PYG{k+kt}{int} \PYG{n}{seekerr} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;}
      \PYG{n}{pool}\PYG{p}{[}\PYG{o}{*}\PYG{n}{cur}\PYG{p}{]} \PYG{o}{=} \PYG{n}{ftell}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{switch}\PYG{p}{(}\PYG{n}{read\PYGZus{}8}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{)}
      \PYG{p}{\PYGZob{}}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}UTF8}\PYG{p}{:}
              \PYG{n}{len} \PYG{o}{=} \PYG{n}{read\PYGZus{}16}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
              \PYG{n}{seekerr} \PYG{o}{=} \PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{n}{len}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}CUR}\PYG{p}{)}\PYG{p}{;}
              \PYG{k}{break}\PYG{p}{;}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}CLASS}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}STRING}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}METHODTYPE}\PYG{p}{:}
              \PYG{n}{seekerr} \PYG{o}{=} \PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}CUR}\PYG{p}{)}\PYG{p}{;}
              \PYG{k}{break}\PYG{p}{;}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}METHODHANDLE}\PYG{p}{:}
              \PYG{n}{seekerr} \PYG{o}{=} \PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}CUR}\PYG{p}{)}\PYG{p}{;}
              \PYG{k}{break}\PYG{p}{;}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}INTEGER}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}FLOAT}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}FIELDREF}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}METHODREF}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}INTERFACEMETHODREF}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}NAMEANDTYPE}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}INVOKEDYNAMIC}\PYG{p}{:}
              \PYG{n}{seekerr} \PYG{o}{=} \PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}CUR}\PYG{p}{)}\PYG{p}{;}
              \PYG{k}{break}\PYG{p}{;}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}LONG}\PYG{p}{:}
      \PYG{k}{case} \PYG{n+nl}{CP\PYGZus{}DOUBLE}\PYG{p}{:}
              \PYG{n}{seekerr} \PYG{o}{=} \PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}CUR}\PYG{p}{)}\PYG{p}{;}
              \PYG{o}{+}\PYG{o}{+}\PYG{p}{(}\PYG{o}{*}\PYG{n}{cur}\PYG{p}{)}\PYG{p}{;}
              \PYG{k}{break}\PYG{p}{;}
      \PYG{k}{default}\PYG{o}{:}
              \PYG{n}{corrupt\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{p}{\PYGZcb{}}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{seekerr}\PYG{p}{)}
              \PYG{n}{seek\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}

\PYG{k+kt}{void} \PYG{n+nf}{error}\PYG{p}{(}\PYG{k}{const} \PYG{k+kt}{char} \PYG{o}{*}\PYG{n}{format}\PYG{p}{,} \PYG{p}{.}\PYG{p}{.}\PYG{p}{.}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
      \PYG{k+kt}{va\PYGZus{}list} \PYG{n}{ap}\PYG{p}{;}
      \PYG{n}{va\PYGZus{}start}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{,} \PYG{n}{format}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{vfprintf}\PYG{p}{(}\PYG{n}{stderr}\PYG{p}{,} \PYG{n}{format}\PYG{p}{,} \PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{va\PYGZus{}end}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{exit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}

\PYG{k+kt}{int} \PYG{n+nf}{main}\PYG{p}{(}\PYG{k+kt}{int} \PYG{n}{argc}\PYG{p}{,} \PYG{k+kt}{char} \PYG{o}{*}\PYG{o}{*}\PYG{n}{argv}\PYG{p}{)}
\PYG{p}{\PYGZob{}}
      \PYG{k+kt}{FILE} \PYG{o}{*}\PYG{n}{classfile}\PYG{p}{;}
      \PYG{n}{u\PYGZus{}int16\PYGZus{}t} \PYG{n}{cp\PYGZus{}count}\PYG{p}{,} \PYG{n}{i}\PYG{p}{,} \PYG{n}{this\PYGZus{}class}\PYG{p}{,} \PYG{n}{classinfo\PYGZus{}ptr}\PYG{p}{;}
      \PYG{n}{u\PYGZus{}int8\PYGZus{}t} \PYG{n}{length}\PYG{p}{;}

      \PYG{n}{program} \PYG{o}{=} \PYG{n}{argv}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{;}

      \PYG{k}{if}\PYG{p}{(}\PYG{o}{!}\PYG{n}{argv}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
              \PYG{n}{error}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}s: Missing input file}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{program}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{classfile} \PYG{o}{=} \PYG{n}{fopen}\PYG{p}{(}\PYG{n}{argv}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+s}{\PYGZdq{}}\PYG{l+s}{rb}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{o}{!}\PYG{n}{classfile}\PYG{p}{)}
              \PYG{n}{error}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}s: Error opening \PYGZpc{}s}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{program}\PYG{p}{,} \PYG{n}{argv}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}

      \PYG{k}{if}\PYG{p}{(}\PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}SET}\PYG{p}{)}\PYG{p}{)}  \PYG{c+cm}{/* skip magic and version numbers */}
              \PYG{n}{seek\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{cp\PYGZus{}count} \PYG{o}{=} \PYG{n}{read\PYGZus{}16}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{pool} \PYG{o}{=} \PYG{n}{calloc}\PYG{p}{(}\PYG{n}{cp\PYGZus{}count}\PYG{p}{,} \PYG{k}{sizeof}\PYG{p}{(}\PYG{k+kt}{long}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{o}{!}\PYG{n}{pool}\PYG{p}{)}
              \PYG{n}{error}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}s: Out of memory for constant pool}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{program}\PYG{p}{)}\PYG{p}{;}

      \PYG{k}{for}\PYG{p}{(}\PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{cp\PYGZus{}count}\PYG{p}{;} \PYG{o}{+}\PYG{o}{+}\PYG{n}{i}\PYG{p}{)}
              \PYG{n}{skip\PYGZus{}constant}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{o}{\PYGZam{}}\PYG{n}{i}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}CUR}\PYG{p}{)}\PYG{p}{)}       \PYG{c+cm}{/* skip access flags */}
              \PYG{n}{seek\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

      \PYG{n}{this\PYGZus{}class} \PYG{o}{=} \PYG{n}{read\PYGZus{}16}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{this\PYGZus{}class} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{1} \PYG{o}{\textbar{}}\PYG{o}{\textbar{}} \PYG{n}{this\PYGZus{}class} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{n}{cp\PYGZus{}count}\PYG{p}{)}
              \PYG{n}{corrupt\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{o}{!}\PYG{n}{pool}\PYG{p}{[}\PYG{n}{this\PYGZus{}class}\PYG{p}{]} \PYG{o}{\textbar{}}\PYG{o}{\textbar{}} \PYG{n}{pool}\PYG{p}{[}\PYG{n}{this\PYGZus{}class}\PYG{p}{]} \PYG{o}{=}\PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
              \PYG{n}{corrupt\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{n}{pool}\PYG{p}{[}\PYG{n}{this\PYGZus{}class}\PYG{p}{]} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}SET}\PYG{p}{)}\PYG{p}{)}
              \PYG{n}{seek\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

      \PYG{n}{classinfo\PYGZus{}ptr} \PYG{o}{=} \PYG{n}{read\PYGZus{}16}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{classinfo\PYGZus{}ptr} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{1} \PYG{o}{\textbar{}}\PYG{o}{\textbar{}} \PYG{n}{classinfo\PYGZus{}ptr} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{n}{cp\PYGZus{}count}\PYG{p}{)}
              \PYG{n}{corrupt\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{o}{!}\PYG{n}{pool}\PYG{p}{[}\PYG{n}{classinfo\PYGZus{}ptr}\PYG{p}{]} \PYG{o}{\textbar{}}\PYG{o}{\textbar{}} \PYG{n}{pool}\PYG{p}{[}\PYG{n}{classinfo\PYGZus{}ptr}\PYG{p}{]} \PYG{o}{=}\PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
              \PYG{n}{corrupt\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{if}\PYG{p}{(}\PYG{n}{fseek}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{,} \PYG{n}{pool}\PYG{p}{[}\PYG{n}{classinfo\PYGZus{}ptr}\PYG{p}{]} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{SEEK\PYGZus{}SET}\PYG{p}{)}\PYG{p}{)}
              \PYG{n}{seek\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}

      \PYG{n}{length} \PYG{o}{=} \PYG{n}{read\PYGZus{}16}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{for}\PYG{p}{(}\PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{;} \PYG{n}{i} \PYG{o}{\PYGZlt{}} \PYG{n}{length}\PYG{p}{;} \PYG{o}{+}\PYG{o}{+}\PYG{n}{i}\PYG{p}{)}
      \PYG{p}{\PYGZob{}}
              \PYG{n}{u\PYGZus{}int8\PYGZus{}t} \PYG{n}{x} \PYG{o}{=} \PYG{n}{read\PYGZus{}8}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
              \PYG{k}{if}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x} \PYG{o}{\PYGZam{}} \PYG{l+m+mh}{0x80}\PYG{p}{)} \PYG{o}{\textbar{}}\PYG{o}{\textbar{}} \PYG{o}{!}\PYG{n}{x}\PYG{p}{)}
              \PYG{p}{\PYGZob{}}
                      \PYG{k}{if}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x} \PYG{o}{\PYGZam{}} \PYG{l+m+mh}{0xE0}\PYG{p}{)} \PYG{o}{=}\PYG{o}{=} \PYG{l+m+mh}{0xC0}\PYG{p}{)}
                      \PYG{p}{\PYGZob{}}
                              \PYG{n}{u\PYGZus{}int8\PYGZus{}t} \PYG{n}{y} \PYG{o}{=} \PYG{n}{read\PYGZus{}8}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
                              \PYG{k}{if}\PYG{p}{(}\PYG{p}{(}\PYG{n}{y} \PYG{o}{\PYGZam{}} \PYG{l+m+mh}{0xC0}\PYG{p}{)} \PYG{o}{=}\PYG{o}{=} \PYG{l+m+mh}{0x80}\PYG{p}{)}
                              \PYG{p}{\PYGZob{}}
                                      \PYG{k+kt}{int} \PYG{n}{c} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{x} \PYG{o}{\PYGZam{}} \PYG{l+m+mh}{0x1f}\PYG{p}{)} \PYG{o}{\PYGZlt{}}\PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{6}\PYG{p}{)} \PYG{o}{+} \PYG{p}{(}\PYG{n}{y} \PYG{o}{\PYGZam{}} \PYG{l+m+mh}{0x3f}\PYG{p}{)}\PYG{p}{;}
                                      \PYG{k}{if}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)} \PYG{n}{putchar}\PYG{p}{(}\PYG{n}{c}\PYG{p}{)}\PYG{p}{;}
                                      \PYG{k}{else} \PYG{n}{utf8\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
                              \PYG{p}{\PYGZcb{}}
                              \PYG{k}{else} \PYG{n}{utf8\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
                      \PYG{p}{\PYGZcb{}}
                      \PYG{k}{else} \PYG{n}{utf8\PYGZus{}error}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
              \PYG{p}{\PYGZcb{}}
              \PYG{k}{else} \PYG{k}{if}\PYG{p}{(}\PYG{n}{x} \PYG{o}{=}\PYG{o}{=} \PYG{l+s+sc}{\PYGZsq{}/\PYGZsq{}}\PYG{p}{)} \PYG{n}{putchar}\PYG{p}{(}\PYG{l+s+sc}{\PYGZsq{}.\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
              \PYG{k}{else} \PYG{n}{putchar}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{;}
      \PYG{p}{\PYGZcb{}}
      \PYG{n}{putchar}\PYG{p}{(}\PYG{l+s+sc}{\PYGZsq{}\PYGZbs{}n\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{free}\PYG{p}{(}\PYG{n}{pool}\PYG{p}{)}\PYG{p}{;}
      \PYG{n}{fclose}\PYG{p}{(}\PYG{n}{classfile}\PYG{p}{)}\PYG{p}{;}
      \PYG{k}{return} \PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{\PYGZcb{}}
\end{Verbatim}

jarwrapper:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{}!/bin/bash
\PYGZsh{} /usr/local/java/bin/jarwrapper \PYGZhy{} the wrapper for binfmt\PYGZus{}misc/jar

java \PYGZhy{}jar \PYGZdl{}1
\end{Verbatim}

Now simply \code{chmod +x} the \code{.class}, \code{.jar} and/or \code{.html} files you
want to execute.

To add a Java program to your path best put a symbolic link to the main
.class file into /usr/bin (or another place you like) omitting the .class
extension. The directory containing the original .class file will be
added to your CLASSPATH during execution.

To test your new setup, enter in the following simple Java app, and name
it ``HelloWorld.java'':

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k+kd}{class} \PYG{n+nc}{HelloWorld} \PYG{o}{\PYGZob{}}
        \PYG{k+kd}{public} \PYG{k+kd}{static} \PYG{k+kt}{void} \PYG{n+nf}{main}\PYG{o}{(}\PYG{n}{String} \PYG{n}{args}\PYG{o}{[}\PYG{o}{]}\PYG{o}{)} \PYG{o}{\PYGZob{}}
                \PYG{n}{System}\PYG{o}{.}\PYG{n+na}{out}\PYG{o}{.}\PYG{n+na}{println}\PYG{o}{(}\PYG{l+s}{\PYGZdq{}Hello World!\PYGZdq{}}\PYG{o}{)}\PYG{o}{;}
        \PYG{o}{\PYGZcb{}}
\PYG{o}{\PYGZcb{}}
\end{Verbatim}

Now compile the application with:

\begin{Verbatim}[commandchars=\\\{\}]
javac HelloWorld.java
\end{Verbatim}

Set the executable permissions of the binary file, with:

\begin{Verbatim}[commandchars=\\\{\}]
chmod 755 HelloWorld.class
\end{Verbatim}

And then execute it:

\begin{Verbatim}[commandchars=\\\{\}]
./HelloWorld.class
\end{Verbatim}

To execute Java Jar files, simple chmod the \code{*.jar} files to include
the execution bit, then just do:

\begin{Verbatim}[commandchars=\\\{\}]
./Application.jar
\end{Verbatim}

To execute Java Applets, simple chmod the \code{*.html} files to include
the execution bit, then just do:

\begin{Verbatim}[commandchars=\\\{\}]
./Applet.html
\end{Verbatim}

originally by Brian A. Lantz, \href{mailto:brian@lantz.com}{brian@lantz.com}
heavily edited for binfmt\_misc by Richard Günther
new scripts by Colin J. Watson \textless{}\href{mailto:cjw44@cam.ac.uk}{cjw44@cam.ac.uk}\textgreater{}
added executable Jar file support by Kurt Huwig \textless{}\href{mailto:kurt@iku-netz.de}{kurt@iku-netz.de}\textgreater{}


\chapter{Reliability, Availability and Serviceability}
\label{admin-guide/ras:reliability-availability-and-serviceability}\label{admin-guide/ras::doc}

\section{RAS concepts}
\label{admin-guide/ras:ras-concepts}
Reliability, Availability and Serviceability (RAS) is a concept used on
servers meant to measure their robustness.
\begin{description}
\item[{Reliability}] \leavevmode
is the probability that a system will produce correct outputs.
\begin{itemize}
\item {} 
Generally measured as Mean Time Between Failures (MTBF)

\item {} 
Enhanced by features that help to avoid, detect and repair hardware faults

\end{itemize}

\item[{Availability}] \leavevmode
is the probability that a system is operational at a given time
\begin{itemize}
\item {} 
Generally measured as a percentage of downtime per a period of time

\item {} 
Often uses mechanisms to detect and correct hardware faults in
runtime;

\end{itemize}

\item[{Serviceability (or maintainability)}] \leavevmode
is the simplicity and speed with which a system can be repaired or
maintained
\begin{itemize}
\item {} 
Generally measured on Mean Time Between Repair (MTBR)

\end{itemize}

\end{description}


\subsection{Improving RAS}
\label{admin-guide/ras:improving-ras}
In order to reduce systems downtime, a system should be capable of detecting
hardware errors, and, when possible correcting them in runtime. It should
also provide mechanisms to detect hardware degradation, in order to warn
the system administrator to take the action of replacing a component before
it causes data loss or system downtime.

Among the monitoring measures, the most usual ones include:
\begin{itemize}
\item {} 
CPU – detect errors at instruction execution and at L1/L2/L3 caches;

\item {} 
Memory – add error correction logic (ECC) to detect and correct errors;

\item {} 
I/O – add CRC checksums for transferred data;

\item {} 
Storage – RAID, journal file systems, checksums,
Self-Monitoring, Analysis and Reporting Technology (SMART).

\end{itemize}

By monitoring the number of occurrences of error detections, it is possible
to identify if the probability of hardware errors is increasing, and, on such
case, do a preventive maintenance to replace a degraded component while
those errors are correctable.


\subsection{Types of errors}
\label{admin-guide/ras:types-of-errors}
Most mechanisms used on modern systems use use technologies like Hamming
Codes that allow error correction when the number of errors on a bit packet
is below a threshold. If the number of errors is above, those mechanisms
can indicate with a high degree of confidence that an error happened, but
they can't correct.

Also, sometimes an error occur on a component that it is not used. For
example, a part of the memory that it is not currently allocated.

That defines some categories of errors:
\begin{itemize}
\item {} 
\textbf{Correctable Error (CE)} - the error detection mechanism detected and
corrected the error. Such errors are usually not fatal, although some
Kernel mechanisms allow the system administrator to consider them as fatal.

\item {} 
\textbf{Uncorrected Error (UE)} - the amount of errors happened above the error
correction threshold, and the system was unable to auto-correct.

\item {} 
\textbf{Fatal Error} - when an UE error happens on a critical component of the
system (for example, a piece of the Kernel got corrupted by an UE), the
only reliable way to avoid data corruption is to hang or reboot the machine.

\item {} 
\textbf{Non-fatal Error} - when an UE error happens on an unused component,
like a CPU in power down state or an unused memory bank, the system may
still run, eventually replacing the affected hardware by a hot spare,
if available.

Also, when an error happens on a userspace process, it is also possible to
kill such process and let userspace restart it.

\end{itemize}

The mechanism for handling non-fatal errors is usually complex and may
require the help of some userspace application, in order to apply the
policy desired by the system administrator.


\subsection{Identifying a bad hardware component}
\label{admin-guide/ras:identifying-a-bad-hardware-component}
Just detecting a hardware flaw is usually not enough, as the system needs
to pinpoint to the minimal replaceable unit (MRU) that should be exchanged
to make the hardware reliable again.

So, it requires not only error logging facilities, but also mechanisms that
will translate the error message to the silkscreen or component label for
the MRU.

Typically, it is very complex for memory, as modern CPUs interlace memory
from different memory modules, in order to provide a better performance. The
DMI BIOS usually have a list of memory module labels, with can be obtained
using the \code{dmidecode} tool. For example, on a desktop machine, it shows:

\begin{Verbatim}[commandchars=\\\{\}]
Memory Device
        Total Width: 64 bits
        Data Width: 64 bits
        Size: 16384 MB
        Form Factor: SODIMM
        Set: None
        Locator: ChannelA\PYGZhy{}DIMM0
        Bank Locator: BANK 0
        Type: DDR4
        Type Detail: Synchronous
        Speed: 2133 MHz
        Rank: 2
        Configured Clock Speed: 2133 MHz
\end{Verbatim}

On the above example, a DDR4 SO-DIMM memory module is located at the
system's memory labeled as ``BANK 0'', as given by the \emph{bank locator} field.
Please notice that, on such system, the \emph{total width} is equal to the
\emph{data width}. It means that such memory module doesn't have error
detection/correction mechanisms.

Unfortunately, not all systems use the same field to specify the memory
bank. On this example, from an older server, \code{dmidecode} shows:

\begin{Verbatim}[commandchars=\\\{\}]
Memory Device
        Array Handle: 0x1000
        Error Information Handle: Not Provided
        Total Width: 72 bits
        Data Width: 64 bits
        Size: 8192 MB
        Form Factor: DIMM
        Set: 1
        Locator: DIMM\PYGZus{}A1
        Bank Locator: Not Specified
        Type: DDR3
        Type Detail: Synchronous Registered (Buffered)
        Speed: 1600 MHz
        Rank: 2
        Configured Clock Speed: 1600 MHz
\end{Verbatim}

There, the DDR3 RDIMM memory module is located at the system's memory labeled
as ``DIMM\_A1'', as given by the \emph{locator} field. Please notice that this
memory module has 64 bits of \emph{data width} and 72 bits of \emph{total width}. So,
it has 8 extra bits to be used by error detection and correction mechanisms.
Such kind of memory is called Error-correcting code memory (ECC memory).

To make things even worse, it is not uncommon that systems with different
labels on their system's board to use exactly the same BIOS, meaning that
the labels provided by the BIOS won't match the real ones.


\subsection{ECC memory}
\label{admin-guide/ras:ecc-memory}
As mentioned on the previous section, ECC memory has extra bits to be
used for error correction. So, on 64 bit systems, a memory module
has 64 bits of \emph{data width}, and 74 bits of \emph{total width}. So, there are
8 bits extra bits to be used for the error detection and correction
mechanisms. Those extra bits are called \emph{syndrome}\footnote[1]{
Please notice that several memory controllers allow operation on a
mode called ``Lock-Step'', where it groups two memory modules together,
doing 128-bit reads/writes. That gives 16 bits for error correction, with
significantly improves the error correction mechanism, at the expense
that, when an error happens, there's no way to know what memory module is
to blame. So, it has to blame both memory modules.
}\footnote[2]{
Some memory controllers also allow using memory in mirror mode.
On such mode, the same data is written to two memory modules. At read,
the system checks both memory modules, in order to check if both provide
identical data. On such configuration, when an error happens, there's no
way to know what memory module is to blame. So, it has to blame both
memory modules (or 4 memory modules, if the system is also on Lock-step
mode).
}.

So, when the cpu requests the memory controller to write a word with
\emph{data width}, the memory controller calculates the \emph{syndrome} in real time,
using Hamming code, or some other error correction code, like SECDED+,
producing a code with \emph{total width} size. Such code is then written
on the memory modules.

At read, the \emph{total width} bits code is converted back, using the same
ECC code used on write, producing a word with \emph{data width} and a \emph{syndrome}.
The word with \emph{data width} is sent to the CPU, even when errors happen.

The memory controller also looks at the \emph{syndrome} in order to check if
there was an error, and if the ECC code was able to fix such error.
If the error was corrected, a Corrected Error (CE) happened. If not, an
Uncorrected Error (UE) happened.

The information about the CE/UE errors is stored on some special registers
at the memory controller and can be accessed by reading such registers,
either by BIOS, by some special CPUs or by Linux EDAC driver. On x86 64
bit CPUs, such errors can also be retrieved via the Machine Check
Architecture (MCA)\footnote[3]{
For more details about the Machine Check Architecture (MCA),
please read Documentation/x86/x86\_64/machinecheck at the Kernel tree.
}.


\section{EDAC - Error Detection And Correction}
\label{admin-guide/ras:edac-error-detection-and-correction}
\begin{notice}{note}{Note:}
``bluesmoke'' was the name for this device driver subsystem when it
was ``out-of-tree'' and maintained at \href{http://bluesmoke.sourceforge.net}{http://bluesmoke.sourceforge.net}.
That site is mostly archaic now and can be used only for historical
purposes.

When the subsystem was pushed upstream for the first time, on
Kernel 2.6.16, for the first time, it was renamed to \code{EDAC}.
\end{notice}


\subsection{Purpose}
\label{admin-guide/ras:purpose}
The \code{edac} kernel module's goal is to detect and report hardware errors
that occur within the computer system running under linux.


\subsection{Memory}
\label{admin-guide/ras:memory}
Memory Correctable Errors (CE) and Uncorrectable Errors (UE) are the
primary errors being harvested. These types of errors are harvested by
the \code{edac\_mc} device.

Detecting CE events, then harvesting those events and reporting them,
\textbf{can} but must not necessarily be a predictor of future UE events. With
CE events only, the system can and will continue to operate as no data
has been damaged yet.

However, preventive maintenance and proactive part replacement of memory
modules exhibiting CEs can reduce the likelihood of the dreaded UE events
and system panics.


\subsection{Other hardware elements}
\label{admin-guide/ras:other-hardware-elements}
A new feature for EDAC, the \code{edac\_device} class of device, was added in
the 2.6.23 version of the kernel.

This new device type allows for non-memory type of ECC hardware detectors
to have their states harvested and presented to userspace via the sysfs
interface.

Some architectures have ECC detectors for L1, L2 and L3 caches,
along with DMA engines, fabric switches, main data path switches,
interconnections, and various other hardware data paths. If the hardware
reports it, then a edac\_device device probably can be constructed to
harvest and present that to userspace.


\subsection{PCI bus scanning}
\label{admin-guide/ras:pci-bus-scanning}
In addition, PCI devices are scanned for PCI Bus Parity and SERR Errors
in order to determine if errors are occurring during data transfers.

The presence of PCI Parity errors must be examined with a grain of salt.
There are several add-in adapters that do \textbf{not} follow the PCI specification
with regards to Parity generation and reporting. The specification says
the vendor should tie the parity status bits to 0 if they do not intend
to generate parity.  Some vendors do not do this, and thus the parity bit
can ``float'' giving false positives.

There is a PCI device attribute located in sysfs that is checked by
the EDAC PCI scanning code. If that attribute is set, PCI parity/error
scanning is skipped for that device. The attribute is:

\begin{Verbatim}[commandchars=\\\{\}]
broken\PYGZus{}parity\PYGZus{}status
\end{Verbatim}

and is located in \code{/sys/devices/pci\textless{}XXX\textgreater{}/0000:XX:YY.Z} directories for
PCI devices.


\subsection{Versioning}
\label{admin-guide/ras:versioning}
EDAC is composed of a ``core'' module (\code{edac\_core.ko}) and several Memory
Controller (MC) driver modules. On a given system, the CORE is loaded
and one MC driver will be loaded. Both the CORE and the MC driver (or
\code{edac\_device} driver) have individual versions that reflect current
release level of their respective modules.

Thus, to ``report'' on what version a system is running, one must report
both the CORE's and the MC driver's versions.


\subsection{Loading}
\label{admin-guide/ras:loading}
If \code{edac} was statically linked with the kernel then no loading
is necessary. If \code{edac} was built as modules then simply modprobe
the \code{edac} pieces that you need. You should be able to modprobe
hardware-specific modules and have the dependencies load the necessary
core modules.

Example:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} modprobe amd76x\PYGZus{}edac
\end{Verbatim}

loads both the \code{amd76x\_edac.ko} memory controller module and the
\code{edac\_mc.ko} core module.


\subsection{Sysfs interface}
\label{admin-guide/ras:sysfs-interface}
EDAC presents a \code{sysfs} interface for control and reporting purposes. It
lives in the /sys/devices/system/edac directory.

Within this directory there currently reside 2 components:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

mc
 & 
memory controller(s) system
\\
\hline
pci
 & 
PCI control and status system
\\
\hline\end{tabulary}

\end{quote}


\subsection{Memory Controller (mc) Model}
\label{admin-guide/ras:memory-controller-mc-model}
Each \code{mc} device controls a set of memory modules \footnote[4]{
Nowadays, the term DIMM (Dual In-line Memory Module) is widely
used to refer to a memory module, although there are other memory
packaging alternatives, like SO-DIMM, SIMM, etc. Along this document,
and inside the EDAC system, the term ``dimm'' is used for all memory
modules, even when they use a different kind of packaging.
}. These modules
are laid out in a Chip-Select Row (\code{csrowX}) and Channel table (\code{chX}).
There can be multiple csrows and multiple channels.

Memory controllers allow for several csrows, with 8 csrows being a
typical value. Yet, the actual number of csrows depends on the layout of
a given motherboard, memory controller and memory module characteristics.

Dual channels allow for dual data length (e. g. 128 bits, on 64 bit systems)
data transfers to/from the CPU from/to memory. Some newer chipsets allow
for more than 2 channels, like Fully Buffered DIMMs (FB-DIMMs) memory
controllers. The following example will assume 2 channels:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|L|}
\hline
\textsf{\relax 
CS Rows
} &  \multicolumn{2}{l|}{\textsf{\relax 
Channels
}}\\
\hline\textsf{\relax } & \textsf{\relax 
\code{ch0}
} & \textsf{\relax 
\code{ch1}
}\\
\hline
\code{csrow0}
 &  \multirow{2}{*}{
DIMM\_A0
} &  \multirow{2}{*}{
DIMM\_B0
}\\
\cline{1-1}
\code{csrow1}
 &  & \\
\hline
\code{csrow2}
 &  \multirow{2}{*}{
DIMM\_A1
} &  \multirow{2}{*}{
DIMM\_B1
}\\
\cline{1-1}
\code{csrow3}
 &  & \\
\hline\end{tabulary}

\end{quote}

In the above example, there are 4 physical slots on the motherboard
for memory DIMMs:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

DIMM\_A0
 & 
DIMM\_B0
\\
\hline
DIMM\_A1
 & 
DIMM\_B1
\\
\hline\end{tabulary}

\end{quote}

Labels for these slots are usually silk-screened on the motherboard.
Slots labeled \code{A} are channel 0 in this example. Slots labeled \code{B} are
channel 1. Notice that there are two csrows possible on a physical DIMM.
These csrows are allocated their csrow assignment based on the slot into
which the memory DIMM is placed. Thus, when 1 DIMM is placed in each
Channel, the csrows cross both DIMMs.

Memory DIMMs come single or dual ``ranked''. A rank is a populated csrow.
Thus, 2 single ranked DIMMs, placed in slots DIMM\_A0 and DIMM\_B0 above
will have just one csrow (csrow0). csrow1 will be empty. On the other
hand, when 2 dual ranked DIMMs are similarly placed, then both csrow0
and csrow1 will be populated. The pattern repeats itself for csrow2 and
csrow3.

The representation of the above is reflected in the directory
tree in EDAC's sysfs interface. Starting in directory
\code{/sys/devices/system/edac/mc}, each memory controller will be
represented by its own \code{mcX} directory, where \code{X} is the
index of the MC:

\begin{Verbatim}[commandchars=\\\{\}]
..../edac/mc/
           \textbar{}
           \textbar{}\PYGZhy{}\PYGZgt{}mc0
           \textbar{}\PYGZhy{}\PYGZgt{}mc1
           \textbar{}\PYGZhy{}\PYGZgt{}mc2
           ....
\end{Verbatim}

Under each \code{mcX} directory each \code{csrowX} is again represented by a
\code{csrowX}, where \code{X} is the csrow index:

\begin{Verbatim}[commandchars=\\\{\}]
.../mc/mc0/
        \textbar{}
        \textbar{}\PYGZhy{}\PYGZgt{}csrow0
        \textbar{}\PYGZhy{}\PYGZgt{}csrow2
        \textbar{}\PYGZhy{}\PYGZgt{}csrow3
        ....
\end{Verbatim}

Notice that there is no csrow1, which indicates that csrow0 is composed
of a single ranked DIMMs. This should also apply in both Channels, in
order to have dual-channel mode be operational. Since both csrow2 and
csrow3 are populated, this indicates a dual ranked set of DIMMs for
channels 0 and 1.

Within each of the \code{mcX} and \code{csrowX} directories are several EDAC
control and attribute files.


\subsection{\texttt{mcX} directories}
\label{admin-guide/ras:mcx-directories}
In \code{mcX} directories are EDAC control and attribute files for
this \code{X} instance of the memory controllers.

For a description of the sysfs API, please see:
\begin{quote}

Documentation/ABI/testing/sysfs-devices-edac
\end{quote}


\subsection{\texttt{dimmX} or \texttt{rankX} directories}
\label{admin-guide/ras:dimmx-or-rankx-directories}
The recommended way to use the EDAC subsystem is to look at the information
provided by the \code{dimmX} or \code{rankX} directories \footnote[5]{
On some systems, the memory controller doesn't have any logic
to identify the memory module. On such systems, the directory is called \code{rankX} and works on a similar way as the \code{csrowX} directories.
On modern Intel memory controllers, the memory controller identifies the
memory modules directly. On such systems, the directory is called \code{dimmX}.
}.

A typical EDAC system has the following structure under
\code{/sys/devices/system/edac/}\footnote[6]{
There are also some \code{power} directories and \code{subsystem}
symlinks inside the sysfs mapping that are automatically created by
the sysfs subsystem. Currently, they serve no purpose.
}:

\begin{Verbatim}[commandchars=\\\{\}]
/sys/devices/system/edac/
├-- mc
\textbar{}   ├-- mc0
\textbar{}   \textbar{}   ├-- ce\PYGZus{}count
\textbar{}   \textbar{}   ├-- ce\PYGZus{}noinfo\PYGZus{}count
\textbar{}   \textbar{}   ├-- dimm0
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}ce\PYGZus{}count
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}dev\PYGZus{}type
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}edac\PYGZus{}mode
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}label
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}location
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}mem\PYGZus{}type
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}ue\PYGZus{}count
\textbar{}   \textbar{}   \textbar{}   ├-- size
\textbar{}   \textbar{}   \textbar{}   └-- uevent
\textbar{}   \textbar{}   ├-- max\PYGZus{}location
\textbar{}   \textbar{}   ├-- mc\PYGZus{}name
\textbar{}   \textbar{}   ├-- reset\PYGZus{}counters
\textbar{}   \textbar{}   ├-- seconds\PYGZus{}since\PYGZus{}reset
\textbar{}   \textbar{}   ├-- size\PYGZus{}mb
\textbar{}   \textbar{}   ├-- ue\PYGZus{}count
\textbar{}   \textbar{}   ├-- ue\PYGZus{}noinfo\PYGZus{}count
\textbar{}   \textbar{}   └-- uevent
\textbar{}   ├-- mc1
\textbar{}   \textbar{}   ├-- ce\PYGZus{}count
\textbar{}   \textbar{}   ├-- ce\PYGZus{}noinfo\PYGZus{}count
\textbar{}   \textbar{}   ├-- dimm0
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}ce\PYGZus{}count
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}dev\PYGZus{}type
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}edac\PYGZus{}mode
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}label
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}location
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}mem\PYGZus{}type
\textbar{}   \textbar{}   \textbar{}   ├-- dimm\PYGZus{}ue\PYGZus{}count
\textbar{}   \textbar{}   \textbar{}   ├-- size
\textbar{}   \textbar{}   \textbar{}   └-- uevent
\textbar{}   \textbar{}   ├-- max\PYGZus{}location
\textbar{}   \textbar{}   ├-- mc\PYGZus{}name
\textbar{}   \textbar{}   ├-- reset\PYGZus{}counters
\textbar{}   \textbar{}   ├-- seconds\PYGZus{}since\PYGZus{}reset
\textbar{}   \textbar{}   ├-- size\PYGZus{}mb
\textbar{}   \textbar{}   ├-- ue\PYGZus{}count
\textbar{}   \textbar{}   ├-- ue\PYGZus{}noinfo\PYGZus{}count
\textbar{}   \textbar{}   └-- uevent
\textbar{}   └-- uevent
└-- uevent
\end{Verbatim}

In the \code{dimmX} directories are EDAC control and attribute files for
this \code{X} memory module:
\begin{itemize}
\item {} 
\code{size} - Total memory managed by this csrow attribute file
\begin{quote}

This attribute file displays, in count of megabytes, the memory
that this csrow contains.
\end{quote}

\item {} 
\code{dimm\_ue\_count} - Uncorrectable Errors count attribute file
\begin{quote}

This attribute file displays the total count of uncorrectable
errors that have occurred on this DIMM. If panic\_on\_ue is set
this counter will not have a chance to increment, since EDAC
will panic the system.
\end{quote}

\item {} 
\code{dimm\_ce\_count} - Correctable Errors count attribute file
\begin{quote}

This attribute file displays the total count of correctable
errors that have occurred on this DIMM. This count is very
important to examine. CEs provide early indications that a
DIMM is beginning to fail. This count field should be
monitored for non-zero values and report such information
to the system administrator.
\end{quote}

\item {} 
\code{dimm\_dev\_type}  - Device type attribute file
\begin{quote}

This attribute file will display what type of DRAM device is
being utilized on this DIMM.
Examples:
\begin{itemize}
\item {} 
x1

\item {} 
x2

\item {} 
x4

\item {} 
x8

\end{itemize}
\end{quote}

\item {} 
\code{dimm\_edac\_mode} - EDAC Mode of operation attribute file
\begin{quote}

This attribute file will display what type of Error detection
and correction is being utilized.
\end{quote}

\item {} 
\code{dimm\_label} - memory module label control file
\begin{quote}

This control file allows this DIMM to have a label assigned
to it. With this label in the module, when errors occur
the output can provide the DIMM label in the system log.
This becomes vital for panic events to isolate the
cause of the UE event.

DIMM Labels must be assigned after booting, with information
that correctly identifies the physical slot with its
silk screen label. This information is currently very
motherboard specific and determination of this information
must occur in userland at this time.
\end{quote}

\item {} 
\code{dimm\_location} - location of the memory module
\begin{quote}

The location can have up to 3 levels, and describe how the
memory controller identifies the location of a memory module.
Depending on the type of memory and memory controller, it
can be:
\begin{itemize}
\item {} 
\emph{csrow} and \emph{channel} - used when the memory controller
doesn't identify a single DIMM - e. g. in \code{rankX} dir;

\item {} 
\emph{branch}, \emph{channel}, \emph{slot} - typically used on FB-DIMM memory
controllers;

\item {} 
\emph{channel}, \emph{slot} - used on Nehalem and newer Intel drivers.

\end{itemize}
\end{quote}

\item {} 
\code{dimm\_mem\_type} - Memory Type attribute file
\begin{quote}

This attribute file will display what type of memory is currently
on this csrow. Normally, either buffered or unbuffered memory.
Examples:
\begin{itemize}
\item {} 
Registered-DDR

\item {} 
Unbuffered-DDR

\end{itemize}
\end{quote}

\end{itemize}


\subsection{\texttt{csrowX} directories}
\label{admin-guide/ras:csrowx-directories}
When CONFIG\_EDAC\_LEGACY\_SYSFS is enabled, sysfs will contain the \code{csrowX}
directories. As this API doesn't work properly for Rambus, FB-DIMMs and
modern Intel Memory Controllers, this is being deprecated in favor of
\code{dimmX} directories.

In the \code{csrowX} directories are EDAC control and attribute files for
this \code{X} instance of csrow:
\begin{itemize}
\item {} 
\code{ue\_count} - Total Uncorrectable Errors count attribute file
\begin{quote}

This attribute file displays the total count of uncorrectable
errors that have occurred on this csrow. If panic\_on\_ue is set
this counter will not have a chance to increment, since EDAC
will panic the system.
\end{quote}

\item {} 
\code{ce\_count} - Total Correctable Errors count attribute file
\begin{quote}

This attribute file displays the total count of correctable
errors that have occurred on this csrow. This count is very
important to examine. CEs provide early indications that a
DIMM is beginning to fail. This count field should be
monitored for non-zero values and report such information
to the system administrator.
\end{quote}

\item {} 
\code{size\_mb} - Total memory managed by this csrow attribute file
\begin{quote}

This attribute file displays, in count of megabytes, the memory
that this csrow contains.
\end{quote}

\item {} 
\code{mem\_type} - Memory Type attribute file
\begin{quote}

This attribute file will display what type of memory is currently
on this csrow. Normally, either buffered or unbuffered memory.
Examples:
\begin{itemize}
\item {} 
Registered-DDR

\item {} 
Unbuffered-DDR

\end{itemize}
\end{quote}

\item {} 
\code{edac\_mode} - EDAC Mode of operation attribute file
\begin{quote}

This attribute file will display what type of Error detection
and correction is being utilized.
\end{quote}

\item {} 
\code{dev\_type} - Device type attribute file
\begin{quote}

This attribute file will display what type of DRAM device is
being utilized on this DIMM.
Examples:
\begin{itemize}
\item {} 
x1

\item {} 
x2

\item {} 
x4

\item {} 
x8

\end{itemize}
\end{quote}

\item {} 
\code{ch0\_ce\_count} - Channel 0 CE Count attribute file
\begin{quote}

This attribute file will display the count of CEs on this
DIMM located in channel 0.
\end{quote}

\item {} 
\code{ch0\_ue\_count} - Channel 0 UE Count attribute file
\begin{quote}

This attribute file will display the count of UEs on this
DIMM located in channel 0.
\end{quote}

\item {} 
\code{ch0\_dimm\_label} - Channel 0 DIMM Label control file
\begin{quote}

This control file allows this DIMM to have a label assigned
to it. With this label in the module, when errors occur
the output can provide the DIMM label in the system log.
This becomes vital for panic events to isolate the
cause of the UE event.

DIMM Labels must be assigned after booting, with information
that correctly identifies the physical slot with its
silk screen label. This information is currently very
motherboard specific and determination of this information
must occur in userland at this time.
\end{quote}

\item {} 
\code{ch1\_ce\_count} - Channel 1 CE Count attribute file
\begin{quote}

This attribute file will display the count of CEs on this
DIMM located in channel 1.
\end{quote}

\item {} 
\code{ch1\_ue\_count} - Channel 1 UE Count attribute file
\begin{quote}

This attribute file will display the count of UEs on this
DIMM located in channel 0.
\end{quote}

\item {} 
\code{ch1\_dimm\_label} - Channel 1 DIMM Label control file
\begin{quote}

This control file allows this DIMM to have a label assigned
to it. With this label in the module, when errors occur
the output can provide the DIMM label in the system log.
This becomes vital for panic events to isolate the
cause of the UE event.

DIMM Labels must be assigned after booting, with information
that correctly identifies the physical slot with its
silk screen label. This information is currently very
motherboard specific and determination of this information
must occur in userland at this time.
\end{quote}

\end{itemize}


\subsection{System Logging}
\label{admin-guide/ras:system-logging}
If logging for UEs and CEs is enabled, then system logs will contain
information indicating that errors have been detected:

\begin{Verbatim}[commandchars=\\\{\}]
EDAC MC0: CE page 0x283, offset 0xce0, grain 8, syndrome 0x6ec3, row 0, channel 1 \PYGZdq{}DIMM\PYGZus{}B1\PYGZdq{}: amd76x\PYGZus{}edac
EDAC MC0: CE page 0x1e5, offset 0xfb0, grain 8, syndrome 0xb741, row 0, channel 1 \PYGZdq{}DIMM\PYGZus{}B1\PYGZdq{}: amd76x\PYGZus{}edac
\end{Verbatim}

The structure of the message is:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline
\textsf{\relax 
Content
} & \textsf{\relax 
Example
}\\
\hline
The memory controller
 & 
MC0
\\
\hline
Error type
 & 
CE
\\
\hline
Memory page
 & 
0x283
\\
\hline
Offset in the page
 & 
0xce0
\\
\hline
The byte granularity
or resolution of the error
 & 
grain 8
\\
\hline
The error syndrome
 & 
0xb741
\\
\hline
Memory row
 & 
row 0
\\
\hline
Memory channel
 & 
channel 1
\\
\hline
DIMM label, if set prior
 & 
DIMM B1
\\
\hline
And then an optional, driver-specific
message that may have additional
information.
 & \\
\hline\end{tabulary}

\end{quote}

Both UEs and CEs with no info will lack all but memory controller, error
type, a notice of ``no info'' and then an optional, driver-specific error
message.


\subsection{PCI Bus Parity Detection}
\label{admin-guide/ras:pci-bus-parity-detection}
On Header Type 00 devices, the primary status is looked at for any
parity error regardless of whether parity is enabled on the device or
not. (The spec indicates parity is generated in some cases). On Header
Type 01 bridges, the secondary status register is also looked at to see
if parity occurred on the bus on the other side of the bridge.


\subsection{Sysfs configuration}
\label{admin-guide/ras:sysfs-configuration}
Under \code{/sys/devices/system/edac/pci} are control and attribute files as
follows:
\begin{itemize}
\item {} 
\code{check\_pci\_parity} - Enable/Disable PCI Parity checking control file
\begin{quote}

This control file enables or disables the PCI Bus Parity scanning
operation. Writing a 1 to this file enables the scanning. Writing
a 0 to this file disables the scanning.

Enable:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}1\PYGZdq{} \PYGZgt{}/sys/devices/system/edac/pci/check\PYGZus{}pci\PYGZus{}parity
\end{Verbatim}

Disable:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}0\PYGZdq{} \PYGZgt{}/sys/devices/system/edac/pci/check\PYGZus{}pci\PYGZus{}parity
\end{Verbatim}
\end{quote}

\item {} 
\code{pci\_parity\_count} - Parity Count
\begin{quote}

This attribute file will display the number of parity errors that
have been detected.
\end{quote}

\end{itemize}


\subsection{Module parameters}
\label{admin-guide/ras:module-parameters}\begin{itemize}
\item {} 
\code{edac\_mc\_panic\_on\_ue} - Panic on UE control file
\begin{quote}

An uncorrectable error will cause a machine panic.  This is usually
desirable.  It is a bad idea to continue when an uncorrectable error
occurs - it is indeterminate what was uncorrected and the operating
system context might be so mangled that continuing will lead to further
corruption. If the kernel has MCE configured, then EDAC will never
notice the UE.

LOAD TIME:

\begin{Verbatim}[commandchars=\\\{\}]
module/kernel parameter: edac\PYGZus{}mc\PYGZus{}panic\PYGZus{}on\PYGZus{}ue=[0\textbar{}1]
\end{Verbatim}

RUN TIME:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}1\PYGZdq{} \PYGZgt{} /sys/module/edac\PYGZus{}core/parameters/edac\PYGZus{}mc\PYGZus{}panic\PYGZus{}on\PYGZus{}ue
\end{Verbatim}
\end{quote}

\item {} 
\code{edac\_mc\_log\_ue} - Log UE control file
\begin{quote}

Generate kernel messages describing uncorrectable errors.  These errors
are reported through the system message log system.  UE statistics
will be accumulated even when UE logging is disabled.

LOAD TIME:

\begin{Verbatim}[commandchars=\\\{\}]
module/kernel parameter: edac\PYGZus{}mc\PYGZus{}log\PYGZus{}ue=[0\textbar{}1]
\end{Verbatim}

RUN TIME:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}1\PYGZdq{} \PYGZgt{} /sys/module/edac\PYGZus{}core/parameters/edac\PYGZus{}mc\PYGZus{}log\PYGZus{}ue
\end{Verbatim}
\end{quote}

\item {} 
\code{edac\_mc\_log\_ce} - Log CE control file
\begin{quote}

Generate kernel messages describing correctable errors.  These
errors are reported through the system message log system.
CE statistics will be accumulated even when CE logging is disabled.

LOAD TIME:

\begin{Verbatim}[commandchars=\\\{\}]
module/kernel parameter: edac\PYGZus{}mc\PYGZus{}log\PYGZus{}ce=[0\textbar{}1]
\end{Verbatim}

RUN TIME:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}1\PYGZdq{} \PYGZgt{} /sys/module/edac\PYGZus{}core/parameters/edac\PYGZus{}mc\PYGZus{}log\PYGZus{}ce
\end{Verbatim}
\end{quote}

\item {} 
\code{edac\_mc\_poll\_msec} - Polling period control file
\begin{quote}

The time period, in milliseconds, for polling for error information.
Too small a value wastes resources.  Too large a value might delay
necessary handling of errors and might loose valuable information for
locating the error.  1000 milliseconds (once each second) is the current
default. Systems which require all the bandwidth they can get, may
increase this.

LOAD TIME:

\begin{Verbatim}[commandchars=\\\{\}]
module/kernel parameter: edac\PYGZus{}mc\PYGZus{}poll\PYGZus{}msec=[0\textbar{}1]
\end{Verbatim}

RUN TIME:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}1000\PYGZdq{} \PYGZgt{} /sys/module/edac\PYGZus{}core/parameters/edac\PYGZus{}mc\PYGZus{}poll\PYGZus{}msec
\end{Verbatim}
\end{quote}

\item {} 
\code{panic\_on\_pci\_parity} - Panic on PCI PARITY Error
\begin{quote}

This control file enables or disables panicking when a parity
error has been detected.

module/kernel parameter:

\begin{Verbatim}[commandchars=\\\{\}]
edac\PYGZus{}panic\PYGZus{}on\PYGZus{}pci\PYGZus{}pe=[0\textbar{}1]
\end{Verbatim}

Enable:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}1\PYGZdq{} \PYGZgt{} /sys/module/edac\PYGZus{}core/parameters/edac\PYGZus{}panic\PYGZus{}on\PYGZus{}pci\PYGZus{}pe
\end{Verbatim}

Disable:

\begin{Verbatim}[commandchars=\\\{\}]
echo \PYGZdq{}0\PYGZdq{} \PYGZgt{} /sys/module/edac\PYGZus{}core/parameters/edac\PYGZus{}panic\PYGZus{}on\PYGZus{}pci\PYGZus{}pe
\end{Verbatim}
\end{quote}

\end{itemize}


\subsection{EDAC device type}
\label{admin-guide/ras:edac-device-type}
In the header file, edac\_pci.h, there is a series of edac\_device structures
and APIs for the EDAC\_DEVICE.

User space access to an edac\_device is through the sysfs interface.

At the location \code{/sys/devices/system/edac} (sysfs) new edac\_device devices
will appear.

There is a three level tree beneath the above \code{edac} directory. For example,
the \code{test\_device\_edac} device (found at the \href{http://bluesmoke.sourceforget.net}{http://bluesmoke.sourceforget.net}
website) installs itself as:

\begin{Verbatim}[commandchars=\\\{\}]
/sys/devices/system/edac/test\PYGZhy{}instance
\end{Verbatim}

in this directory are various controls, a symlink and one or more \code{instance}
directories.

The standard default controls are:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

log\_ce
 & 
boolean to log CE events
\\
\hline
log\_ue
 & 
boolean to log UE events
\\
\hline
panic\_on\_ue
 & 
boolean to \code{panic} the system if an UE is encountered
(default off, can be set true via startup script)
\\
\hline
poll\_msec
 & 
time period between POLL cycles for events
\\
\hline\end{tabulary}

\end{quote}

The test\_device\_edac device adds at least one of its own custom control:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

test\_bits
 & 
which in the current test driver does nothing but
show how it is installed. A ported driver can
add one or more such controls and/or attributes
for specific uses.
One out-of-tree driver uses controls here to allow
for ERROR INJECTION operations to hardware
injection registers
\\
\hline\end{tabulary}

\end{quote}

The symlink points to the `struct dev' that is registered for this edac\_device.


\subsection{Instances}
\label{admin-guide/ras:instances}
One or more instance directories are present. For the \code{test\_device\_edac}
case:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|}
\hline

test-instance0
\\
\hline\end{tabulary}

\end{quote}

In this directory there are two default counter attributes, which are totals of
counter in deeper subdirectories.
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

ce\_count
 & 
total of CE events of subdirectories
\\
\hline
ue\_count
 & 
total of UE events of subdirectories
\\
\hline\end{tabulary}

\end{quote}


\subsection{Blocks}
\label{admin-guide/ras:blocks}
At the lowest directory level is the \code{block} directory. There can be 0, 1
or more blocks specified in each instance:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|}
\hline

test-block0
\\
\hline\end{tabulary}

\end{quote}

In this directory the default attributes are:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

ce\_count
 & 
which is counter of CE events for this \code{block}
of hardware being monitored
\\
\hline
ue\_count
 & 
which is counter of UE events for this \code{block}
of hardware being monitored
\\
\hline\end{tabulary}

\end{quote}

The \code{test\_device\_edac} device adds 4 attributes and 1 control:
\begin{quote}

\begin{tabulary}{\linewidth}{|L|L|}
\hline

test-block-bits-0
 & 
for every POLL cycle this counter
is incremented
\\
\hline
test-block-bits-1
 & 
every 10 cycles, this counter is bumped once,
and test-block-bits-0 is set to 0
\\
\hline
test-block-bits-2
 & 
every 100 cycles, this counter is bumped once,
and test-block-bits-1 is set to 0
\\
\hline
test-block-bits-3
 & 
every 1000 cycles, this counter is bumped once,
and test-block-bits-2 is set to 0
\\
\hline\end{tabulary}


\begin{tabulary}{\linewidth}{|L|L|}
\hline

reset-counters
 & 
writing ANY thing to this control will
reset all the above counters.
\\
\hline\end{tabulary}

\end{quote}

Use of the \code{test\_device\_edac} driver should enable any others to create their own
unique drivers for their hardware systems.

The \code{test\_device\_edac} sample driver is located at the
\href{http://bluesmoke.sourceforge.net}{http://bluesmoke.sourceforge.net} project site for EDAC.


\subsection{Usage of EDAC APIs on Nehalem and newer Intel CPUs}
\label{admin-guide/ras:usage-of-edac-apis-on-nehalem-and-newer-intel-cpus}
On older Intel architectures, the memory controller was part of the North
Bridge chipset. Nehalem, Sandy Bridge, Ivy Bridge, Haswell, Sky Lake and
newer Intel architectures integrated an enhanced version of the memory
controller (MC) inside the CPUs.

This chapter will cover the differences of the enhanced memory controllers
found on newer Intel CPUs, such as \code{i7core\_edac}, \code{sb\_edac} and
\code{sbx\_edac} drivers.

\begin{notice}{note}{Note:}
The Xeon E7 processor families use a separate chip for the memory
controller, called Intel Scalable Memory Buffer. This section doesn't
apply for such families.
\end{notice}
\begin{enumerate}
\item {} 
There is one Memory Controller per Quick Patch Interconnect
(QPI). At the driver, the term ``socket'' means one QPI. This is
associated with a physical CPU socket.

Each MC have 3 physical read channels, 3 physical write channels and
3 logic channels. The driver currently sees it as just 3 channels.
Each channel can have up to 3 DIMMs.

The minimum known unity is DIMMs. There are no information about csrows.
As EDAC API maps the minimum unity is csrows, the driver sequentially
maps channel/DIMM into different csrows.

For example, supposing the following layout:

\begin{Verbatim}[commandchars=\\\{\}]
Ch0 phy rd0, wr0 (0x063f4031): 2 ranks, UDIMMs
  dimm 0 1024 Mb offset: 0, bank: 8, rank: 1, row: 0x4000, col: 0x400
  dimm 1 1024 Mb offset: 4, bank: 8, rank: 1, row: 0x4000, col: 0x400
Ch1 phy rd1, wr1 (0x063f4031): 2 ranks, UDIMMs
  dimm 0 1024 Mb offset: 0, bank: 8, rank: 1, row: 0x4000, col: 0x400
Ch2 phy rd3, wr3 (0x063f4031): 2 ranks, UDIMMs
  dimm 0 1024 Mb offset: 0, bank: 8, rank: 1, row: 0x4000, col: 0x400
\end{Verbatim}

The driver will map it as:

\begin{Verbatim}[commandchars=\\\{\}]
csrow0: channel 0, dimm0
csrow1: channel 0, dimm1
csrow2: channel 1, dimm0
csrow3: channel 2, dimm0
\end{Verbatim}

exports one DIMM per csrow.

Each QPI is exported as a different memory controller.

\item {} 
The MC has the ability to inject errors to test drivers. The drivers
implement this functionality via some error injection nodes:

For injecting a memory error, there are some sysfs nodes, under
\code{/sys/devices/system/edac/mc/mc?/}:
\begin{itemize}
\item {} \begin{description}
\item[{\code{inject\_addrmatch/*}:}] \leavevmode
Controls the error injection mask register. It is possible to specify
several characteristics of the address to match an error code:

\begin{Verbatim}[commandchars=\\\{\}]
dimm = the affected dimm. Numbers are relative to a channel;
rank = the memory rank;
channel = the channel that will generate an error;
bank = the affected bank;
page = the page address;
column (or col) = the address column.
\end{Verbatim}

each of the above values can be set to ``any'' to match any valid value.

At driver init, all values are set to any.

For example, to generate an error at rank 1 of dimm 2, for any channel,
any bank, any page, any column:

\begin{Verbatim}[commandchars=\\\{\}]
        echo 2 \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}addrmatch/dimm
        echo 1 \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}addrmatch/rank

To return to the default behaviour of matching any, you can do::

        echo any \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}addrmatch/dimm
        echo any \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}addrmatch/rank
\end{Verbatim}

\end{description}

\item {} \begin{description}
\item[{\code{inject\_eccmask}:}] \leavevmode
specifies what bits will have troubles,

\end{description}

\item {} \begin{description}
\item[{\code{inject\_section}:}] \leavevmode
specifies what ECC cache section will get the error:

\begin{Verbatim}[commandchars=\\\{\}]
3 for both
2 for the highest
1 for the lowest
\end{Verbatim}

\end{description}

\item {} \begin{description}
\item[{\code{inject\_type}:}] \leavevmode
specifies the type of error, being a combination of the following bits:

\begin{Verbatim}[commandchars=\\\{\}]
bit 0 \PYGZhy{} repeat
bit 1 \PYGZhy{} ecc
bit 2 \PYGZhy{} parity
\end{Verbatim}

\end{description}

\item {} \begin{description}
\item[{\code{inject\_enable}:}] \leavevmode
starts the error generation when something different than 0 is written.

\end{description}

\end{itemize}

All inject vars can be read. root permission is needed for write.

Datasheet states that the error will only be generated after a write on an
address that matches inject\_addrmatch. It seems, however, that reading will
also produce an error.

For example, the following code will generate an error for any write access
at socket 0, on any DIMM/address on channel 2:

\begin{Verbatim}[commandchars=\\\{\}]
echo 2 \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}addrmatch/channel
echo 2 \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}type
echo 64 \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}eccmask
echo 3 \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}section
echo 1 \PYGZgt{}/sys/devices/system/edac/mc/mc0/inject\PYGZus{}enable
dd if=/dev/mem of=/dev/null seek=16k bs=4k count=1 \PYGZgt{}\PYGZam{} /dev/null
\end{Verbatim}

For socket 1, it is needed to replace ``mc0'' by ``mc1'' at the above
commands.

The generated error message will look like:

\begin{Verbatim}[commandchars=\\\{\}]
EDAC MC0: UE row 0, channel\PYGZhy{}a= 0 channel\PYGZhy{}b= 0 labels \PYGZdq{}\PYGZhy{}\PYGZdq{}: NON\PYGZus{}FATAL (addr = 0x0075b980, socket=0, Dimm=0, Channel=2, syndrome=0x00000040, count=1, Err=8c0000400001009f:4000080482 (read error: read ECC error))
\end{Verbatim}

\item {} 
Corrected Error memory register counters

Those newer MCs have some registers to count memory errors. The driver
uses those registers to report Corrected Errors on devices with Registered
DIMMs.

However, those counters don't work with Unregistered DIMM. As the chipset
offers some counters that also work with UDIMMs (but with a worse level of
granularity than the default ones), the driver exposes those registers for
UDIMM memories.

They can be read by looking at the contents of \code{all\_channel\_counts/}:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdl{} for i in /sys/devices/system/edac/mc/mc0/all\PYGZus{}channel\PYGZus{}counts/*; do echo \PYGZdl{}i; cat \PYGZdl{}i; done
   /sys/devices/system/edac/mc/mc0/all\PYGZus{}channel\PYGZus{}counts/udimm0
   0
   /sys/devices/system/edac/mc/mc0/all\PYGZus{}channel\PYGZus{}counts/udimm1
   0
   /sys/devices/system/edac/mc/mc0/all\PYGZus{}channel\PYGZus{}counts/udimm2
   0
\end{Verbatim}

What happens here is that errors on different csrows, but at the same
dimm number will increment the same counter.
So, in this memory mapping:

\begin{Verbatim}[commandchars=\\\{\}]
csrow0: channel 0, dimm0
csrow1: channel 0, dimm1
csrow2: channel 1, dimm0
csrow3: channel 2, dimm0
\end{Verbatim}

The hardware will increment udimm0 for an error at the first dimm at either
csrow0, csrow2  or csrow3;

The hardware will increment udimm1 for an error at the second dimm at either
csrow0, csrow2  or csrow3;

The hardware will increment udimm2 for an error at the third dimm at either
csrow0, csrow2  or csrow3;

\item {} 
Standard error counters

The standard error counters are generated when an mcelog error is received
by the driver. Since, with UDIMM, this is counted by software, it is
possible that some errors could be lost. With RDIMM's, they display the
contents of the registers

\end{enumerate}


\subsection{Reference documents used on \texttt{amd64\_edac}}
\label{admin-guide/ras:reference-documents-used-on-amd64-edac}
\code{amd64\_edac} module is based on the following documents
(available from \href{http://support.amd.com/en-us/search/tech-docs}{http://support.amd.com/en-us/search/tech-docs}):
\begin{enumerate}
\item {} \begin{quote}\begin{description}
\item[{Title}] \leavevmode
BIOS and Kernel Developer's Guide for AMD Athlon 64 and AMD
Opteron Processors

\item[{AMD publication \#}] \leavevmode
26094

\item[{Revision}] \leavevmode
3.26

\item[{Link}] \leavevmode
\href{http://support.amd.com/TechDocs/26094.PDF}{http://support.amd.com/TechDocs/26094.PDF}

\end{description}\end{quote}

\item {} \begin{quote}\begin{description}
\item[{Title}] \leavevmode
BIOS and Kernel Developer's Guide for AMD NPT Family 0Fh
Processors

\item[{AMD publication \#}] \leavevmode
32559

\item[{Revision}] \leavevmode
3.00

\item[{Issue Date}] \leavevmode
May 2006

\item[{Link}] \leavevmode
\href{http://support.amd.com/TechDocs/32559.pdf}{http://support.amd.com/TechDocs/32559.pdf}

\end{description}\end{quote}

\item {} \begin{quote}\begin{description}
\item[{Title}] \leavevmode
BIOS and Kernel Developer's Guide (BKDG) For AMD Family 10h
Processors

\item[{AMD publication \#}] \leavevmode
31116

\item[{Revision}] \leavevmode
3.00

\item[{Issue Date}] \leavevmode
September 07, 2007

\item[{Link}] \leavevmode
\href{http://support.amd.com/TechDocs/31116.pdf}{http://support.amd.com/TechDocs/31116.pdf}

\end{description}\end{quote}

\item {} \begin{quote}\begin{description}
\item[{Title}] \leavevmode
BIOS and Kernel Developer's Guide (BKDG) for AMD Family 15h
Models 30h-3Fh Processors

\item[{AMD publication \#}] \leavevmode
49125

\item[{Revision}] \leavevmode
3.06

\item[{Issue Date}] \leavevmode
2/12/2015 (latest release)

\item[{Link}] \leavevmode
\href{http://support.amd.com/TechDocs/49125\_15h\_Models\_30h-3Fh\_BKDG.pdf}{http://support.amd.com/TechDocs/49125\_15h\_Models\_30h-3Fh\_BKDG.pdf}

\end{description}\end{quote}

\item {} \begin{quote}\begin{description}
\item[{Title}] \leavevmode
BIOS and Kernel Developer's Guide (BKDG) for AMD Family 15h
Models 60h-6Fh Processors

\item[{AMD publication \#}] \leavevmode
50742

\item[{Revision}] \leavevmode
3.01

\item[{Issue Date}] \leavevmode
7/23/2015 (latest release)

\item[{Link}] \leavevmode
\href{http://support.amd.com/TechDocs/50742\_15h\_Models\_60h-6Fh\_BKDG.pdf}{http://support.amd.com/TechDocs/50742\_15h\_Models\_60h-6Fh\_BKDG.pdf}

\end{description}\end{quote}

\item {} \begin{quote}\begin{description}
\item[{Title}] \leavevmode
BIOS and Kernel Developer's Guide (BKDG) for AMD Family 16h
Models 00h-0Fh Processors

\item[{AMD publication \#}] \leavevmode
48751

\item[{Revision}] \leavevmode
3.03

\item[{Issue Date}] \leavevmode
2/23/2015 (latest release)

\item[{Link}] \leavevmode
\href{http://support.amd.com/TechDocs/48751\_16h\_bkdg.pdf}{http://support.amd.com/TechDocs/48751\_16h\_bkdg.pdf}

\end{description}\end{quote}

\end{enumerate}


\subsubsection{Credits}
\label{admin-guide/ras:credits}\begin{itemize}
\item {} 
Written by Doug Thompson \textless{}\href{mailto:dougthompson@xmission.com}{dougthompson@xmission.com}\textgreater{}
\begin{itemize}
\item {} 
7 Dec 2005

\item {} 
17 Jul 2007 Updated

\end{itemize}

\item {} 
© Mauro Carvalho Chehab
\begin{itemize}
\item {} 
05 Aug 2009 Nehalem interface

\item {} 
26 Oct 2016 Converted to ReST and cleanups at the Nehalem section

\end{itemize}

\item {} 
EDAC authors/maintainers:
\begin{itemize}
\item {} 
Doug Thompson, Dave Jiang, Dave Peterson et al,

\item {} 
Mauro Carvalho Chehab

\item {} 
Borislav Petkov

\item {} 
original author: Thayne Harbaugh

\end{itemize}

\end{itemize}


\chapter{Power Management}
\label{admin-guide/pm/index::doc}\label{admin-guide/pm/index:power-management}

\section{Power Management Strategies}
\label{admin-guide/pm/strategies::doc}\label{admin-guide/pm/strategies:power-management-strategies}
\begin{Verbatim}[commandchars=\\\{\}]
Copyright (c) 2017 Intel Corp., Rafael J. Wysocki \PYGZlt{}rafael.j.wysocki@intel.com\PYGZgt{}
\end{Verbatim}

The Linux kernel supports two major high-level power management strategies.

One of them is based on using global low-power states of the whole system in
which user space code cannot be executed and the overall system activity is
significantly reduced, referred to as {\hyperref[admin\string-guide/pm/sleep\string-states::doc]{\emph{\emph{sleep states}}}}.  The
kernel puts the system into one of these states when requested by user space
and the system stays in it until a special signal is received from one of
designated devices, triggering a transition to the \code{working state} in which
user space code can run.  Because sleep states are global and the whole system
is affected by the state changes, this strategy is referred to as the
{\hyperref[admin\string-guide/pm/system\string-wide::doc]{\emph{\emph{system-wide power management}}}}.

The other strategy, referred to as the {\hyperref[admin\string-guide/pm/working\string-state::doc]{\emph{\emph{working-state power management}}}}, is based on adjusting the power states of individual hardware
components of the system, as needed, in the working state.  In consequence, if
this strategy is in use, the working state of the system usually does not
correspond to any particular physical configuration of it, but can be treated as
a metastate covering a range of different power states of the system in which
the individual components of it can be either \code{active} (in use) or
\code{inactive} (idle).  If they are active, they have to be in power states
allowing them to process data and to be accessed by software.  In turn, if they
are inactive, ideally, they should be in low-power states in which they may not
be accessible.

If all of the system components are active, the system as a whole is regarded as
``runtime active'' and that situation typically corresponds to the maximum power
draw (or maximum energy usage) of it.  If all of them are inactive, the system
as a whole is regarded as ``runtime idle'' which may be very close to a sleep
state from the physical system configuration and power draw perspective, but
then it takes much less time and effort to start executing user space code than
for the same system in a sleep state.  However, transitions from sleep states
back to the working state can only be started by a limited set of devices, so
typically the system can spend much more time in a sleep state than it can be
runtime idle in one go.  For this reason, systems usually use less energy in
sleep states than when they are runtime idle most of the time.

Moreover, the two power management strategies address different usage scenarios.
Namely, if the user indicates that the system will not be in use going forward,
for example by closing its lid (if the system is a laptop), it probably should
go into a sleep state at that point.  On the other hand, if the user simply goes
away from the laptop keyboard, it probably should stay in the working state and
use the working-state power management in case it becomes idle, because the user
may come back to it at any time and then may want the system to be immediately
accessible.


\section{System-Wide Power Management}
\label{admin-guide/pm/system-wide::doc}\label{admin-guide/pm/system-wide:system-wide-power-management}

\subsection{System Sleep States}
\label{admin-guide/pm/sleep-states:system-sleep-states}\label{admin-guide/pm/sleep-states::doc}
\begin{Verbatim}[commandchars=\\\{\}]
Copyright (c) 2017 Intel Corp., Rafael J. Wysocki \PYGZlt{}rafael.j.wysocki@intel.com\PYGZgt{}
\end{Verbatim}

Sleep states are global low-power states of the entire system in which user
space code cannot be executed and the overall system activity is significantly
reduced.


\subsubsection{Sleep States That Can Be Supported}
\label{admin-guide/pm/sleep-states:sleep-states-that-can-be-supported}
Depending on its configuration and the capabilities of the platform it runs on,
the Linux kernel can support up to four system sleep states, includig
hibernation and up to three variants of system suspend.  The sleep states that
can be supported by the kernel are listed below.


\paragraph{Suspend-to-Idle}
\label{admin-guide/pm/sleep-states:suspend-to-idle}\label{admin-guide/pm/sleep-states:s2idle}
This is a generic, pure software, light-weight variant of system suspend (also
referred to as S2I or S2Idle).  It allows more energy to be saved relative to
runtime idle by freezing user space, suspending the timekeeping and putting all
I/O devices into low-power states (possibly lower-power than available in the
working state), such that the processors can spend time in their deepest idle
states while the system is suspended.

The system is woken up from this state by in-band interrupts, so theoretically
any devices that can cause interrupts to be generated in the working state can
also be set up as wakeup devices for S2Idle.

This state can be used on platforms without support for {\hyperref[admin\string-guide/pm/sleep\string-states:standby]{\emph{standby}}}
or {\hyperref[admin\string-guide/pm/sleep\string-states:s2ram]{\emph{suspend-to-RAM}}}, or it can be used in addition to any of the
deeper system suspend variants to provide reduced resume latency.  It is always
supported if the \code{CONFIG\_SUSPEND} kernel configuration option is set.


\paragraph{Standby}
\label{admin-guide/pm/sleep-states:standby}\label{admin-guide/pm/sleep-states:id1}
This state, if supported, offers moderate, but real, energy savings, while
providing a relatively straightforward transition back to the working state.  No
operating state is lost (the system core logic retains power), so the system can
go back to where it left off easily enough.

In addition to freezing user space, suspending the timekeeping and putting all
I/O devices into low-power states, which is done for {\hyperref[admin\string-guide/pm/sleep\string-states:s2idle]{\emph{suspend-to-idle}}} too, nonboot CPUs are taken offline and all low-level system functions
are suspended during transitions into this state.  For this reason, it should
allow more energy to be saved relative to {\hyperref[admin\string-guide/pm/sleep\string-states:s2idle]{\emph{suspend-to-idle}}}, but
the resume latency will generally be greater than for that state.

The set of devices that can wake up the system from this state usually is
reduced relative to {\hyperref[admin\string-guide/pm/sleep\string-states:s2idle]{\emph{suspend-to-idle}}} and it may be necessary to
rely on the platform for setting up the wakeup functionality as appropriate.

This state is supported if the \code{CONFIG\_SUSPEND} kernel configuration
option is set and the support for it is registered by the platform with the
core system suspend subsystem.  On ACPI-based systems this state is mapped to
the S1 system state defined by ACPI.


\paragraph{Suspend-to-RAM}
\label{admin-guide/pm/sleep-states:s2ram}\label{admin-guide/pm/sleep-states:suspend-to-ram}
This state (also referred to as STR or S2RAM), if supported, offers significant
energy savings as everything in the system is put into a low-power state, except
for memory, which should be placed into the self-refresh mode to retain its
contents.  All of the steps carried out when entering {\hyperref[admin\string-guide/pm/sleep\string-states:standby]{\emph{standby}}}
are also carried out during transitions to S2RAM.  Additional operations may
take place depending on the platform capabilities.  In particular, on ACPI-based
systems the kernel passes control to the platform firmware (BIOS) as the last
step during S2RAM transitions and that usually results in powering down some
more low-level components that are not directly controlled by the kernel.

The state of devices and CPUs is saved and held in memory.  All devices are
suspended and put into low-power states.  In many cases, all peripheral buses
lose power when entering S2RAM, so devices must be able to handle the transition
back to the ``on'' state.

On ACPI-based systems S2RAM requires some minimal boot-strapping code in the
platform firmware to resume the system from it.  This may be the case on other
platforms too.

The set of devices that can wake up the system from S2RAM usually is reduced
relative to {\hyperref[admin\string-guide/pm/sleep\string-states:s2idle]{\emph{suspend-to-idle}}} and {\hyperref[admin\string-guide/pm/sleep\string-states:standby]{\emph{standby}}} and it
may be necessary to rely on the platform for setting up the wakeup functionality
as appropriate.

S2RAM is supported if the \code{CONFIG\_SUSPEND} kernel configuration option
is set and the support for it is registered by the platform with the core system
suspend subsystem.  On ACPI-based systems it is mapped to the S3 system state
defined by ACPI.


\paragraph{Hibernation}
\label{admin-guide/pm/sleep-states:hibernation}\label{admin-guide/pm/sleep-states:id2}
This state (also referred to as Suspend-to-Disk or STD) offers the greatest
energy savings and can be used even in the absence of low-level platform support
for system suspend.  However, it requires some low-level code for resuming the
system to be present for the underlying CPU architecture.

Hibernation is significantly different from any of the system suspend variants.
It takes three system state changes to put it into hibernation and two system
state changes to resume it.

First, when hibernation is triggered, the kernel stops all system activity and
creates a snapshot image of memory to be written into persistent storage.  Next,
the system goes into a state in which the snapshot image can be saved, the image
is written out and finally the system goes into the target low-power state in
which power is cut from almost all of its hardware components, including memory,
except for a limited set of wakeup devices.

Once the snapshot image has been written out, the system may either enter a
special low-power state (like ACPI S4), or it may simply power down itself.
Powering down means minimum power draw and it allows this mechanism to work on
any system.  However, entering a special low-power state may allow additional
means of system wakeup to be used  (e.g. pressing a key on the keyboard or
opening a laptop lid).

After wakeup, control goes to the platform firmware that runs a boot loader
which boots a fresh instance of the kernel (control may also go directly to
the boot loader, depending on the system configuration, but anyway it causes
a fresh instance of the kernel to be booted).  That new instance of the kernel
(referred to as the \code{restore kernel}) looks for a hibernation image in
persistent storage and if one is found, it is loaded into memory.  Next, all
activity in the system is stopped and the restore kernel overwrites itself with
the image contents and jumps into a special trampoline area in the original
kernel stored in the image (referred to as the \code{image kernel}), which is where
the special architecture-specific low-level code is needed.  Finally, the
image kernel restores the system to the pre-hibernation state and allows user
space to run again.

Hibernation is supported if the \code{CONFIG\_HIBERNATION} kernel
configuration option is set.  However, this option can only be set if support
for the given CPU architecture includes the low-level code for system resume.


\subsubsection{Basic \texttt{sysfs} Interfaces for System Suspend and Hibernation}
\label{admin-guide/pm/sleep-states:basic-sysfs-interfaces-for-system-suspend-and-hibernation}
The following files located in the \code{/sys/power/} directory can be used by
user space for sleep states control.
\begin{description}
\item[{\code{state}}] \leavevmode
This file contains a list of strings representing sleep states supported
by the kernel.  Writing one of these strings into it causes the kernel
to start a transition of the system into the sleep state represented by
that string.

In particular, the strings ``disk'', ``freeze'' and ``standby'' represent the
{\hyperref[admin\string-guide/pm/sleep\string-states:hibernation]{\emph{hibernation}}}, {\hyperref[admin\string-guide/pm/sleep\string-states:s2idle]{\emph{suspend-to-idle}}} and
{\hyperref[admin\string-guide/pm/sleep\string-states:standby]{\emph{standby}}} sleep states, respectively.  The string ``mem''
is interpreted in accordance with the contents of the \code{mem\_sleep} file
described below.

If the kernel does not support any system sleep states, this file is
not present.

\item[{\code{mem\_sleep}}] \leavevmode
This file contains a list of strings representing supported system
suspend variants and allows user space to select the variant to be
associated with the ``mem'' string in the \code{state} file described above.

The strings that may be present in this file are ``s2idle'', ``shallow''
and ``deep''.  The string ``s2idle'' always represents {\hyperref[admin\string-guide/pm/sleep\string-states:s2idle]{\emph{suspend-to-idle}}} and, by convention, ``shallow'' and ``deep'' represent
{\hyperref[admin\string-guide/pm/sleep\string-states:standby]{\emph{standby}}} and {\hyperref[admin\string-guide/pm/sleep\string-states:s2ram]{\emph{suspend-to-RAM}}},
respectively.

Writing one of the listed strings into this file causes the system
suspend variant represented by it to be associated with the ``mem'' string
in the \code{state} file.  The string representing the suspend variant
currently associated with the ``mem'' string in the \code{state} file
is listed in square brackets.

If the kernel does not support system suspend, this file is not present.

\item[{\code{disk}}] \leavevmode
This file contains a list of strings representing different operations
that can be carried out after the hibernation image has been saved.  The
possible options are as follows:
\begin{description}
\item[{\code{platform}}] \leavevmode
Put the system into a special low-power state (e.g. ACPI S4) to
make additional wakeup options available and possibly allow the
platform firmware to take a simplified initialization path after
wakeup.

\item[{\code{shutdown}}] \leavevmode
Power off the system.

\item[{\code{reboot}}] \leavevmode
Reboot the system (useful for diagnostics mostly).

\item[{\code{suspend}}] \leavevmode
Hybrid system suspend.  Put the system into the suspend sleep
state selected through the \code{mem\_sleep} file described above.
If the system is successfully woken up from that state, discard
the hibernation image and continue.  Otherwise, use the image
to restore the previous state of the system.

\item[{\code{test\_resume}}] \leavevmode
Diagnostic operation.  Load the image as though the system had
just woken up from hibernation and the currently running kernel
instance was a restore kernel and follow up with full system
resume.

\end{description}

Writing one of the listed strings into this file causes the option
represented by it to be selected.

The currently selected option is shown in square brackets which means
that the operation represented by it will be carried out after creating
and saving the image next time hibernation is triggered by writing
\code{disk} to \code{/sys/power/state}.

If the kernel does not support hibernation, this file is not present.

\end{description}

According to the above, there are two ways to make the system go into the
{\hyperref[admin\string-guide/pm/sleep\string-states:s2idle]{\emph{suspend-to-idle}}} state.  The first one is to write ``freeze''
directly to \code{/sys/power/state}.  The second one is to write ``s2idle'' to
\code{/sys/power/mem\_sleep} and then to write ``mem'' to
\code{/sys/power/state}.  Likewise, there are two ways to make the system go
into the {\hyperref[admin\string-guide/pm/sleep\string-states:standby]{\emph{standby}}} state (the strings to write to the control
files in that case are ``standby'' or ``shallow'' and ``mem'', respectively) if that
state is supported by the platform.  However, there is only one way to make the
system go into the {\hyperref[admin\string-guide/pm/sleep\string-states:s2ram]{\emph{suspend-to-RAM}}} state (write ``deep'' into
\code{/sys/power/mem\_sleep} and ``mem'' into \code{/sys/power/state}).

The default suspend variant (ie. the one to be used without writing anything
into \code{/sys/power/mem\_sleep}) is either ``deep'' (on the majority of systems
supporting {\hyperref[admin\string-guide/pm/sleep\string-states:s2ram]{\emph{suspend-to-RAM}}}) or ``s2idle'', but it can be overridden
by the value of the ``mem\_sleep\_default'' parameter in the kernel command line.
On some ACPI-based systems, depending on the information in the ACPI tables, the
default may be ``s2idle'' even if {\hyperref[admin\string-guide/pm/sleep\string-states:s2ram]{\emph{suspend-to-RAM}}} is supported.


\section{Working-State Power Management}
\label{admin-guide/pm/working-state:working-state-power-management}\label{admin-guide/pm/working-state::doc}

\subsection{CPU Performance Scaling}
\label{admin-guide/pm/cpufreq:cpu-performance-scaling}\label{admin-guide/pm/cpufreq::doc}
\begin{Verbatim}[commandchars=\\\{\}]
Copyright (c) 2017 Intel Corp., Rafael J. Wysocki \PYGZlt{}rafael.j.wysocki@intel.com\PYGZgt{}
\end{Verbatim}


\subsubsection{The Concept of CPU Performance Scaling}
\label{admin-guide/pm/cpufreq:the-concept-of-cpu-performance-scaling}
The majority of modern processors are capable of operating in a number of
different clock frequency and voltage configurations, often referred to as
Operating Performance Points or P-states (in ACPI terminology).  As a rule,
the higher the clock frequency and the higher the voltage, the more instructions
can be retired by the CPU over a unit of time, but also the higher the clock
frequency and the higher the voltage, the more energy is consumed over a unit of
time (or the more power is drawn) by the CPU in the given P-state.  Therefore
there is a natural tradeoff between the CPU capacity (the number of instructions
that can be executed over a unit of time) and the power drawn by the CPU.

In some situations it is desirable or even necessary to run the program as fast
as possible and then there is no reason to use any P-states different from the
highest one (i.e. the highest-performance frequency/voltage configuration
available).  In some other cases, however, it may not be necessary to execute
instructions so quickly and maintaining the highest available CPU capacity for a
relatively long time without utilizing it entirely may be regarded as wasteful.
It also may not be physically possible to maintain maximum CPU capacity for too
long for thermal or power supply capacity reasons or similar.  To cover those
cases, there are hardware interfaces allowing CPUs to be switched between
different frequency/voltage configurations or (in the ACPI terminology) to be
put into different P-states.

Typically, they are used along with algorithms to estimate the required CPU
capacity, so as to decide which P-states to put the CPUs into.  Of course, since
the utilization of the system generally changes over time, that has to be done
repeatedly on a regular basis.  The activity by which this happens is referred
to as CPU performance scaling or CPU frequency scaling (because it involves
adjusting the CPU clock frequency).


\subsubsection{CPU Performance Scaling in Linux}
\label{admin-guide/pm/cpufreq:cpu-performance-scaling-in-linux}
The Linux kernel supports CPU performance scaling by means of the \code{CPUFreq}
(CPU Frequency scaling) subsystem that consists of three layers of code: the
core, scaling governors and scaling drivers.

The \code{CPUFreq} core provides the common code infrastructure and user space
interfaces for all platforms that support CPU performance scaling.  It defines
the basic framework in which the other components operate.

Scaling governors implement algorithms to estimate the required CPU capacity.
As a rule, each governor implements one, possibly parametrized, scaling
algorithm.

Scaling drivers talk to the hardware.  They provide scaling governors with
information on the available P-states (or P-state ranges in some cases) and
access platform-specific hardware interfaces to change CPU P-states as requested
by scaling governors.

In principle, all available scaling governors can be used with every scaling
driver.  That design is based on the observation that the information used by
performance scaling algorithms for P-state selection can be represented in a
platform-independent form in the majority of cases, so it should be possible
to use the same performance scaling algorithm implemented in exactly the same
way regardless of which scaling driver is used.  Consequently, the same set of
scaling governors should be suitable for every supported platform.

However, that observation may not hold for performance scaling algorithms
based on information provided by the hardware itself, for example through
feedback registers, as that information is typically specific to the hardware
interface it comes from and may not be easily represented in an abstract,
platform-independent way.  For this reason, \code{CPUFreq} allows scaling drivers
to bypass the governor layer and implement their own performance scaling
algorithms.  That is done by the {\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}} scaling driver.


\subsubsection{\texttt{CPUFreq} Policy Objects}
\label{admin-guide/pm/cpufreq:cpufreq-policy-objects}
In some cases the hardware interface for P-state control is shared by multiple
CPUs.  That is, for example, the same register (or set of registers) is used to
control the P-state of multiple CPUs at the same time and writing to it affects
all of those CPUs simultaneously.

Sets of CPUs sharing hardware P-state control interfaces are represented by
\code{CPUFreq} as \code{struct cpufreq\_policy} objects.  For consistency,
\code{struct cpufreq\_policy} is also used when there is only one CPU in the given
set.

The \code{CPUFreq} core maintains a pointer to a \code{struct cpufreq\_policy} object for
every CPU in the system, including CPUs that are currently offline.  If multiple
CPUs share the same hardware P-state control interface, all of the pointers
corresponding to them point to the same \code{struct cpufreq\_policy} object.

\code{CPUFreq} uses \code{struct cpufreq\_policy} as its basic data type and the design
of its user space interface is based on the policy concept.


\subsubsection{CPU Initialization}
\label{admin-guide/pm/cpufreq:cpu-initialization}
First of all, a scaling driver has to be registered for \code{CPUFreq} to work.
It is only possible to register one scaling driver at a time, so the scaling
driver is expected to be able to handle all CPUs in the system.

The scaling driver may be registered before or after CPU registration.  If
CPUs are registered earlier, the driver core invokes the \code{CPUFreq} core to
take a note of all of the already registered CPUs during the registration of the
scaling driver.  In turn, if any CPUs are registered after the registration of
the scaling driver, the \code{CPUFreq} core will be invoked to take note of them
at their registration time.

In any case, the \code{CPUFreq} core is invoked to take note of any logical CPU it
has not seen so far as soon as it is ready to handle that CPU.  {[}Note that the
logical CPU may be a physical single-core processor, or a single core in a
multicore processor, or a hardware thread in a physical processor or processor
core.  In what follows ``CPU'' always means ``logical CPU'' unless explicitly stated
otherwise and the word ``processor'' is used to refer to the physical part
possibly including multiple logical CPUs.{]}

Once invoked, the \code{CPUFreq} core checks if the policy pointer is already set
for the given CPU and if so, it skips the policy object creation.  Otherwise,
a new policy object is created and initialized, which involves the creation of
a new policy directory in \code{sysfs}, and the policy pointer corresponding to
the given CPU is set to the new policy object's address in memory.

Next, the scaling driver's \code{-\textgreater{}init()} callback is invoked with the policy
pointer of the new CPU passed to it as the argument.  That callback is expected
to initialize the performance scaling hardware interface for the given CPU (or,
more precisely, for the set of CPUs sharing the hardware interface it belongs
to, represented by its policy object) and, if the policy object it has been
called for is new, to set parameters of the policy, like the minimum and maximum
frequencies supported by the hardware, the table of available frequencies (if
the set of supported P-states is not a continuous range), and the mask of CPUs
that belong to the same policy (including both online and offline CPUs).  That
mask is then used by the core to populate the policy pointers for all of the
CPUs in it.

The next major initialization step for a new policy object is to attach a
scaling governor to it (to begin with, that is the default scaling governor
determined by the kernel configuration, but it may be changed later
via \code{sysfs}).  First, a pointer to the new policy object is passed to the
governor's \code{-\textgreater{}init()} callback which is expected to initialize all of the
data structures necessary to handle the given policy and, possibly, to add
a governor \code{sysfs} interface to it.  Next, the governor is started by
invoking its \code{-\textgreater{}start()} callback.

That callback it expected to register per-CPU utilization update callbacks for
all of the online CPUs belonging to the given policy with the CPU scheduler.
The utilization update callbacks will be invoked by the CPU scheduler on
important events, like task enqueue and dequeue, on every iteration of the
scheduler tick or generally whenever the CPU utilization may change (from the
scheduler's perspective).  They are expected to carry out computations needed
to determine the P-state to use for the given policy going forward and to
invoke the scaling driver to make changes to the hardware in accordance with
the P-state selection.  The scaling driver may be invoked directly from
scheduler context or asynchronously, via a kernel thread or workqueue, depending
on the configuration and capabilities of the scaling driver and the governor.

Similar steps are taken for policy objects that are not new, but were ``inactive''
previously, meaning that all of the CPUs belonging to them were offline.  The
only practical difference in that case is that the \code{CPUFreq} core will attempt
to use the scaling governor previously used with the policy that became
``inactive'' (and is re-initialized now) instead of the default governor.

In turn, if a previously offline CPU is being brought back online, but some
other CPUs sharing the policy object with it are online already, there is no
need to re-initialize the policy object at all.  In that case, it only is
necessary to restart the scaling governor so that it can take the new online CPU
into account.  That is achieved by invoking the governor's \code{-\textgreater{}stop} and
\code{-\textgreater{}start()} callbacks, in this order, for the entire policy.

As mentioned before, the {\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}} scaling driver bypasses the scaling
governor layer of \code{CPUFreq} and provides its own P-state selection algorithms.
Consequently, if {\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}} is used, scaling governors are not attached to
new policy objects.  Instead, the driver's \code{-\textgreater{}setpolicy()} callback is invoked
to register per-CPU utilization update callbacks for each policy.  These
callbacks are invoked by the CPU scheduler in the same way as for scaling
governors, but in the {\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}} case they both determine the P-state to
use and change the hardware configuration accordingly in one go from scheduler
context.

The policy objects created during CPU initialization and other data structures
associated with them are torn down when the scaling driver is unregistered
(which happens when the kernel module containing it is unloaded, for example) or
when the last CPU belonging to the given policy in unregistered.


\subsubsection{Policy Interface in \texttt{sysfs}}
\label{admin-guide/pm/cpufreq:policy-interface-in-sysfs}
During the initialization of the kernel, the \code{CPUFreq} core creates a
\code{sysfs} directory (kobject) called \code{cpufreq} under
\code{/sys/devices/system/cpu/}.

That directory contains a \code{policyX} subdirectory (where \code{X} represents an
integer number) for every policy object maintained by the \code{CPUFreq} core.
Each \code{policyX} directory is pointed to by \code{cpufreq} symbolic links
under \code{/sys/devices/system/cpu/cpuY/} (where \code{Y} represents an integer
that may be different from the one represented by \code{X}) for all of the CPUs
associated with (or belonging to) the given policy.  The \code{policyX} directories
in \code{/sys/devices/system/cpu/cpufreq} each contain policy-specific
attributes (files) to control \code{CPUFreq} behavior for the corresponding policy
objects (that is, for all of the CPUs associated with them).

Some of those attributes are generic.  They are created by the \code{CPUFreq} core
and their behavior generally does not depend on what scaling driver is in use
and what scaling governor is attached to the given policy.  Some scaling drivers
also add driver-specific attributes to the policy directories in \code{sysfs} to
control policy-specific aspects of driver behavior.

The generic attributes under \code{/sys/devices/system/cpu/cpufreq/policyX/}
are the following:
\begin{description}
\item[{\code{affected\_cpus}}] \leavevmode
List of online CPUs belonging to this policy (i.e. sharing the hardware
performance scaling interface represented by the \code{policyX} policy
object).

\item[{\code{bios\_limit}}] \leavevmode
If the platform firmware (BIOS) tells the OS to apply an upper limit to
CPU frequencies, that limit will be reported through this attribute (if
present).

The existence of the limit may be a result of some (often unintentional)
BIOS settings, restrictions coming from a service processor or another
BIOS/HW-based mechanisms.

This does not cover ACPI thermal limitations which can be discovered
through a generic thermal driver.

This attribute is not present if the scaling driver in use does not
support it.

\item[{\code{cpuinfo\_cur\_freq}}] \leavevmode
Current frequency of the CPUs belonging to this policy as obtained from
the hardware (in KHz).

This is expected to be the frequency the hardware actually runs at.
If that frequency cannot be determined, this attribute should not
be present.

\item[{\code{cpuinfo\_max\_freq}}] \leavevmode
Maximum possible operating frequency the CPUs belonging to this policy
can run at (in kHz).

\item[{\code{cpuinfo\_min\_freq}}] \leavevmode
Minimum possible operating frequency the CPUs belonging to this policy
can run at (in kHz).

\item[{\code{cpuinfo\_transition\_latency}}] \leavevmode
The time it takes to switch the CPUs belonging to this policy from one
P-state to another, in nanoseconds.

If unknown or if known to be so high that the scaling driver does not
work with the {\hyperref[admin\string-guide/pm/cpufreq:ondemand]{\emph{ondemand}}} governor, -1 (\code{CPUFREQ\_ETERNAL})
will be returned by reads from this attribute.

\item[{\code{related\_cpus}}] \leavevmode
List of all (online and offline) CPUs belonging to this policy.

\item[{\code{scaling\_available\_governors}}] \leavevmode
List of \code{CPUFreq} scaling governors present in the kernel that can
be attached to this policy or (if the {\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}} scaling driver is
in use) list of scaling algorithms provided by the driver that can be
applied to this policy.

{[}Note that some governors are modular and it may be necessary to load a
kernel module for the governor held by it to become available and be
listed by this attribute.{]}

\item[{\code{scaling\_cur\_freq}}] \leavevmode
Current frequency of all of the CPUs belonging to this policy (in kHz).

In the majority of cases, this is the frequency of the last P-state
requested by the scaling driver from the hardware using the scaling
interface provided by it, which may or may not reflect the frequency
the CPU is actually running at (due to hardware design and other
limitations).

Some architectures (e.g. \code{x86}) may attempt to provide information
more precisely reflecting the current CPU frequency through this
attribute, but that still may not be the exact current CPU frequency as
seen by the hardware at the moment.

\item[{\code{scaling\_driver}}] \leavevmode
The scaling driver currently in use.

\item[{\code{scaling\_governor}}] \leavevmode
The scaling governor currently attached to this policy or (if the
{\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}} scaling driver is in use) the scaling algorithm
provided by the driver that is currently applied to this policy.

This attribute is read-write and writing to it will cause a new scaling
governor to be attached to this policy or a new scaling algorithm
provided by the scaling driver to be applied to it (in the
{\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}} case), as indicated by the string written to this
attribute (which must be one of the names listed by the
\code{scaling\_available\_governors} attribute described above).

\item[{\code{scaling\_max\_freq}}] \leavevmode
Maximum frequency the CPUs belonging to this policy are allowed to be
running at (in kHz).

This attribute is read-write and writing a string representing an
integer to it will cause a new limit to be set (it must not be lower
than the value of the \code{scaling\_min\_freq} attribute).

\item[{\code{scaling\_min\_freq}}] \leavevmode
Minimum frequency the CPUs belonging to this policy are allowed to be
running at (in kHz).

This attribute is read-write and writing a string representing a
non-negative integer to it will cause a new limit to be set (it must not
be higher than the value of the \code{scaling\_max\_freq} attribute).

\item[{\code{scaling\_setspeed}}] \leavevmode
This attribute is functional only if the {\hyperref[admin\string-guide/pm/cpufreq:userspace]{\emph{userspace}}} scaling governor
is attached to the given policy.

It returns the last frequency requested by the governor (in kHz) or can
be written to in order to set a new frequency for the policy.

\end{description}


\subsubsection{Generic Scaling Governors}
\label{admin-guide/pm/cpufreq:generic-scaling-governors}
\code{CPUFreq} provides generic scaling governors that can be used with all
scaling drivers.  As stated before, each of them implements a single, possibly
parametrized, performance scaling algorithm.

Scaling governors are attached to policy objects and different policy objects
can be handled by different scaling governors at the same time (although that
may lead to suboptimal results in some cases).

The scaling governor for a given policy object can be changed at any time with
the help of the \code{scaling\_governor} policy attribute in \code{sysfs}.

Some governors expose \code{sysfs} attributes to control or fine-tune the scaling
algorithms implemented by them.  Those attributes, referred to as governor
tunables, can be either global (system-wide) or per-policy, depending on the
scaling driver in use.  If the driver requires governor tunables to be
per-policy, they are located in a subdirectory of each policy directory.
Otherwise, they are located in a subdirectory under
\code{/sys/devices/system/cpu/cpufreq/}.  In either case the name of the
subdirectory containing the governor tunables is the name of the governor
providing them.


\paragraph{\texttt{performance}}
\label{admin-guide/pm/cpufreq:performance}
When attached to a policy object, this governor causes the highest frequency,
within the \code{scaling\_max\_freq} policy limit, to be requested for that policy.

The request is made once at that time the governor for the policy is set to
\code{performance} and whenever the \code{scaling\_max\_freq} or \code{scaling\_min\_freq}
policy limits change after that.


\paragraph{\texttt{powersave}}
\label{admin-guide/pm/cpufreq:powersave}
When attached to a policy object, this governor causes the lowest frequency,
within the \code{scaling\_min\_freq} policy limit, to be requested for that policy.

The request is made once at that time the governor for the policy is set to
\code{powersave} and whenever the \code{scaling\_max\_freq} or \code{scaling\_min\_freq}
policy limits change after that.


\paragraph{\texttt{userspace}}
\label{admin-guide/pm/cpufreq:userspace}
This governor does not do anything by itself.  Instead, it allows user space
to set the CPU frequency for the policy it is attached to by writing to the
\code{scaling\_setspeed} attribute of that policy.


\paragraph{\texttt{schedutil}}
\label{admin-guide/pm/cpufreq:schedutil}
This governor uses CPU utilization data available from the CPU scheduler.  It
generally is regarded as a part of the CPU scheduler, so it can access the
scheduler's internal data structures directly.

It runs entirely in scheduler context, although in some cases it may need to
invoke the scaling driver asynchronously when it decides that the CPU frequency
should be changed for a given policy (that depends on whether or not the driver
is capable of changing the CPU frequency from scheduler context).

The actions of this governor for a particular CPU depend on the scheduling class
invoking its utilization update callback for that CPU.  If it is invoked by the
RT or deadline scheduling classes, the governor will increase the frequency to
the allowed maximum (that is, the \code{scaling\_max\_freq} policy limit).  In turn,
if it is invoked by the CFS scheduling class, the governor will use the
Per-Entity Load Tracking (PELT) metric for the root control group of the
given CPU as the CPU utilization estimate (see the \href{https://lwn.net/Articles/531853/}{Per-entity load tracking}
LWN.net article for a description of the PELT mechanism).  Then, the new
CPU frequency to apply is computed in accordance with the formula
\begin{quote}

f = 1.25 * \code{f\_0} * \code{util} / \code{max}
\end{quote}

where \code{util} is the PELT number, \code{max} is the theoretical maximum of
\code{util}, and \code{f\_0} is either the maximum possible CPU frequency for the given
policy (if the PELT number is frequency-invariant), or the current CPU frequency
(otherwise).

This governor also employs a mechanism allowing it to temporarily bump up the
CPU frequency for tasks that have been waiting on I/O most recently, called
``IO-wait boosting''.  That happens when the \code{SCHED\_CPUFREQ\_IOWAIT} flag
is passed by the scheduler to the governor callback which causes the frequency
to go up to the allowed maximum immediately and then draw back to the value
returned by the above formula over time.

This governor exposes only one tunable:
\begin{description}
\item[{\code{rate\_limit\_us}}] \leavevmode
Minimum time (in microseconds) that has to pass between two consecutive
runs of governor computations (default: 1000 times the scaling driver's
transition latency).

The purpose of this tunable is to reduce the scheduler context overhead
of the governor which might be excessive without it.

\end{description}

This governor generally is regarded as a replacement for the older {\hyperref[admin\string-guide/pm/cpufreq:ondemand]{\emph{ondemand}}}
and {\hyperref[admin\string-guide/pm/cpufreq:conservative]{\emph{conservative}}} governors (described below), as it is simpler and more
tightly integrated with the CPU scheduler, its overhead in terms of CPU context
switches and similar is less significant, and it uses the scheduler's own CPU
utilization metric, so in principle its decisions should not contradict the
decisions made by the other parts of the scheduler.


\paragraph{\texttt{ondemand}}
\label{admin-guide/pm/cpufreq:ondemand}
This governor uses CPU load as a CPU frequency selection metric.

In order to estimate the current CPU load, it measures the time elapsed between
consecutive invocations of its worker routine and computes the fraction of that
time in which the given CPU was not idle.  The ratio of the non-idle (active)
time to the total CPU time is taken as an estimate of the load.

If this governor is attached to a policy shared by multiple CPUs, the load is
estimated for all of them and the greatest result is taken as the load estimate
for the entire policy.

The worker routine of this governor has to run in process context, so it is
invoked asynchronously (via a workqueue) and CPU P-states are updated from
there if necessary.  As a result, the scheduler context overhead from this
governor is minimum, but it causes additional CPU context switches to happen
relatively often and the CPU P-state updates triggered by it can be relatively
irregular.  Also, it affects its own CPU load metric by running code that
reduces the CPU idle time (even though the CPU idle time is only reduced very
slightly by it).

It generally selects CPU frequencies proportional to the estimated load, so that
the value of the \code{cpuinfo\_max\_freq} policy attribute corresponds to the load of
1 (or 100\%), and the value of the \code{cpuinfo\_min\_freq} policy attribute
corresponds to the load of 0, unless when the load exceeds a (configurable)
speedup threshold, in which case it will go straight for the highest frequency
it is allowed to use (the \code{scaling\_max\_freq} policy limit).

This governor exposes the following tunables:
\begin{description}
\item[{\code{sampling\_rate}}] \leavevmode
This is how often the governor's worker routine should run, in
microseconds.

Typically, it is set to values of the order of 10000 (10 ms).  Its
default value is equal to the value of \code{cpuinfo\_transition\_latency}
for each policy this governor is attached to (but since the unit here
is greater by 1000, this means that the time represented by
\code{sampling\_rate} is 1000 times greater than the transition latency by
default).

If this tunable is per-policy, the following shell command sets the time
represented by it to be 750 times as high as the transition latency:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} echo {}`\PYGZdl{}((\PYGZdl{}(cat cpuinfo\PYGZus{}transition\PYGZus{}latency) * 750 / 1000)) \PYGZgt{} ondemand/sampling\PYGZus{}rate
\end{Verbatim}

\item[{\code{up\_threshold}}] \leavevmode
If the estimated CPU load is above this value (in percent), the governor
will set the frequency to the maximum value allowed for the policy.
Otherwise, the selected frequency will be proportional to the estimated
CPU load.

\item[{\code{ignore\_nice\_load}}] \leavevmode
If set to 1 (default 0), it will cause the CPU load estimation code to
treat the CPU time spent on executing tasks with ``nice'' levels greater
than 0 as CPU idle time.

This may be useful if there are tasks in the system that should not be
taken into account when deciding what frequency to run the CPUs at.
Then, to make that happen it is sufficient to increase the ``nice'' level
of those tasks above 0 and set this attribute to 1.

\item[{\code{sampling\_down\_factor}}] \leavevmode
Temporary multiplier, between 1 (default) and 100 inclusive, to apply to
the \code{sampling\_rate} value if the CPU load goes above \code{up\_threshold}.

This causes the next execution of the governor's worker routine (after
setting the frequency to the allowed maximum) to be delayed, so the
frequency stays at the maximum level for a longer time.

Frequency fluctuations in some bursty workloads may be avoided this way
at the cost of additional energy spent on maintaining the maximum CPU
capacity.

\item[{\code{powersave\_bias}}] \leavevmode
Reduction factor to apply to the original frequency target of the
governor (including the maximum value used when the \code{up\_threshold}
value is exceeded by the estimated CPU load) or sensitivity threshold
for the AMD frequency sensitivity powersave bias driver
(\code{drivers/cpufreq/amd\_freq\_sensitivity.c}), between 0 and 1000
inclusive.

If the AMD frequency sensitivity powersave bias driver is not loaded,
the effective frequency to apply is given by
\begin{quote}

f * (1 - \code{powersave\_bias} / 1000)
\end{quote}

where f is the governor's original frequency target.  The default value
of this attribute is 0 in that case.

If the AMD frequency sensitivity powersave bias driver is loaded, the
value of this attribute is 400 by default and it is used in a different
way.

On Family 16h (and later) AMD processors there is a mechanism to get a
measured workload sensitivity, between 0 and 100\% inclusive, from the
hardware.  That value can be used to estimate how the performance of the
workload running on a CPU will change in response to frequency changes.

The performance of a workload with the sensitivity of 0 (memory-bound or
IO-bound) is not expected to increase at all as a result of increasing
the CPU frequency, whereas workloads with the sensitivity of 100\%
(CPU-bound) are expected to perform much better if the CPU frequency is
increased.

If the workload sensitivity is less than the threshold represented by
the \code{powersave\_bias} value, the sensitivity powersave bias driver
will cause the governor to select a frequency lower than its original
target, so as to avoid over-provisioning workloads that will not benefit
from running at higher CPU frequencies.

\end{description}


\paragraph{\texttt{conservative}}
\label{admin-guide/pm/cpufreq:conservative}
This governor uses CPU load as a CPU frequency selection metric.

It estimates the CPU load in the same way as the {\hyperref[admin\string-guide/pm/cpufreq:ondemand]{\emph{ondemand}}} governor described
above, but the CPU frequency selection algorithm implemented by it is different.

Namely, it avoids changing the frequency significantly over short time intervals
which may not be suitable for systems with limited power supply capacity (e.g.
battery-powered).  To achieve that, it changes the frequency in relatively
small steps, one step at a time, up or down - depending on whether or not a
(configurable) threshold has been exceeded by the estimated CPU load.

This governor exposes the following tunables:
\begin{description}
\item[{\code{freq\_step}}] \leavevmode
Frequency step in percent of the maximum frequency the governor is
allowed to set (the \code{scaling\_max\_freq} policy limit), between 0 and
100 (5 by default).

This is how much the frequency is allowed to change in one go.  Setting
it to 0 will cause the default frequency step (5 percent) to be used
and setting it to 100 effectively causes the governor to periodically
switch the frequency between the \code{scaling\_min\_freq} and
\code{scaling\_max\_freq} policy limits.

\item[{\code{down\_threshold}}] \leavevmode
Threshold value (in percent, 20 by default) used to determine the
frequency change direction.

If the estimated CPU load is greater than this value, the frequency will
go up (by \code{freq\_step}).  If the load is less than this value (and the
\code{sampling\_down\_factor} mechanism is not in effect), the frequency will
go down.  Otherwise, the frequency will not be changed.

\item[{\code{sampling\_down\_factor}}] \leavevmode
Frequency decrease deferral factor, between 1 (default) and 10
inclusive.

It effectively causes the frequency to go down \code{sampling\_down\_factor}
times slower than it ramps up.

\end{description}


\subsubsection{Frequency Boost Support}
\label{admin-guide/pm/cpufreq:frequency-boost-support}

\paragraph{Background}
\label{admin-guide/pm/cpufreq:background}
Some processors support a mechanism to raise the operating frequency of some
cores in a multicore package temporarily (and above the sustainable frequency
threshold for the whole package) under certain conditions, for example if the
whole chip is not fully utilized and below its intended thermal or power budget.

Different names are used by different vendors to refer to this functionality.
For Intel processors it is referred to as ``Turbo Boost'', AMD calls it
``Turbo-Core'' or (in technical documentation) ``Core Performance Boost'' and so on.
As a rule, it also is implemented differently by different vendors.  The simple
term ``frequency boost'' is used here for brevity to refer to all of those
implementations.

The frequency boost mechanism may be either hardware-based or software-based.
If it is hardware-based (e.g. on x86), the decision to trigger the boosting is
made by the hardware (although in general it requires the hardware to be put
into a special state in which it can control the CPU frequency within certain
limits).  If it is software-based (e.g. on ARM), the scaling driver decides
whether or not to trigger boosting and when to do that.


\paragraph{The \texttt{boost} File in \texttt{sysfs}}
\label{admin-guide/pm/cpufreq:the-boost-file-in-sysfs}
This file is located under \code{/sys/devices/system/cpu/cpufreq/} and controls
the ``boost'' setting for the whole system.  It is not present if the underlying
scaling driver does not support the frequency boost mechanism (or supports it,
but provides a driver-specific interface for controlling it, like
{\hyperref[admin\string-guide/pm/intel_pstate::doc]{\emph{\emph{intel\_pstate}}}}).

If the value in this file is 1, the frequency boost mechanism is enabled.  This
means that either the hardware can be put into states in which it is able to
trigger boosting (in the hardware-based case), or the software is allowed to
trigger boosting (in the software-based case).  It does not mean that boosting
is actually in use at the moment on any CPUs in the system.  It only means a
permission to use the frequency boost mechanism (which still may never be used
for other reasons).

If the value in this file is 0, the frequency boost mechanism is disabled and
cannot be used at all.

The only values that can be written to this file are 0 and 1.


\paragraph{Rationale for Boost Control Knob}
\label{admin-guide/pm/cpufreq:rationale-for-boost-control-knob}
The frequency boost mechanism is generally intended to help to achieve optimum
CPU performance on time scales below software resolution (e.g. below the
scheduler tick interval) and it is demonstrably suitable for many workloads, but
it may lead to problems in certain situations.

For this reason, many systems make it possible to disable the frequency boost
mechanism in the platform firmware (BIOS) setup, but that requires the system to
be restarted for the setting to be adjusted as desired, which may not be
practical at least in some cases.  For example:
\begin{enumerate}
\item {} 
Boosting means overclocking the processor, although under controlled
conditions.  Generally, the processor's energy consumption increases
as a result of increasing its frequency and voltage, even temporarily.
That may not be desirable on systems that switch to power sources of
limited capacity, such as batteries, so the ability to disable the boost
mechanism while the system is running may help there (but that depends on
the workload too).

\item {} 
In some situations deterministic behavior is more important than
performance or energy consumption (or both) and the ability to disable
boosting while the system is running may be useful then.

\item {} 
To examine the impact of the frequency boost mechanism itself, it is useful
to be able to run tests with and without boosting, preferably without
restarting the system in the meantime.

\item {} 
Reproducible results are important when running benchmarks.  Since
the boosting functionality depends on the load of the whole package,
single-thread performance may vary because of it which may lead to
unreproducible results sometimes.  That can be avoided by disabling the
frequency boost mechanism before running benchmarks sensitive to that
issue.

\end{enumerate}


\paragraph{Legacy AMD \texttt{cpb} Knob}
\label{admin-guide/pm/cpufreq:legacy-amd-cpb-knob}
The AMD powernow-k8 scaling driver supports a \code{sysfs} knob very similar to
the global \code{boost} one.  It is used for disabling/enabling the ``Core
Performance Boost'' feature of some AMD processors.

If present, that knob is located in every \code{CPUFreq} policy directory in
\code{sysfs} (\code{/sys/devices/system/cpu/cpufreq/policyX/}) and is called
\code{cpb}, which indicates a more fine grained control interface.  The actual
implementation, however, works on the system-wide basis and setting that knob
for one policy causes the same value of it to be set for all of the other
policies at the same time.

That knob is still supported on AMD processors that support its underlying
hardware feature, but it may be configured out of the kernel (via the
\code{CONFIG\_X86\_ACPI\_CPUFREQ\_CPB} configuration option) and the global
\code{boost} knob is present regardless.  Thus it is always possible use the
\code{boost} knob instead of the \code{cpb} one which is highly recommended, as that
is more consistent with what all of the other systems do (and the \code{cpb} knob
may not be supported any more in the future).

The \code{cpb} knob is never present for any processors without the underlying
hardware feature (e.g. all Intel ones), even if the
\code{CONFIG\_X86\_ACPI\_CPUFREQ\_CPB} configuration option is set.


\subsection{\texttt{intel\_pstate} CPU Performance Scaling Driver}
\label{admin-guide/pm/intel_pstate:per-entity-load-tracking}\label{admin-guide/pm/intel_pstate::doc}\label{admin-guide/pm/intel_pstate:intel-pstate-cpu-performance-scaling-driver}
\begin{Verbatim}[commandchars=\\\{\}]
Copyright (c) 2017 Intel Corp., Rafael J. Wysocki \PYGZlt{}rafael.j.wysocki@intel.com\PYGZgt{}
\end{Verbatim}


\subsubsection{General Information}
\label{admin-guide/pm/intel_pstate:general-information}
\code{intel\_pstate} is a part of the
{\hyperref[admin\string-guide/pm/cpufreq::doc]{\emph{\emph{CPU performance scaling subsystem}}}} in the Linux kernel
(\code{CPUFreq}).  It is a scaling driver for the Sandy Bridge and later
generations of Intel processors.  Note, however, that some of those processors
may not be supported.  {[}To understand \code{intel\_pstate} it is necessary to know
how \code{CPUFreq} works in general, so this is the time to read {\hyperref[admin\string-guide/pm/cpufreq::doc]{\emph{\emph{CPU Performance Scaling}}}} if
you have not done that yet.{]}

For the processors supported by \code{intel\_pstate}, the P-state concept is broader
than just an operating frequency or an operating performance point (see the
\href{http://events.linuxfoundation.org/sites/events/files/slides/LinuxConEurope\_2015.pdf}{LinuxCon Europe 2015 presentation by Kristen Accardi} for more
information about that).  For this reason, the representation of P-states used
by \code{intel\_pstate} internally follows the hardware specification (for details
refer to \href{http://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-software-developer-system-programming-manual-325384.html}{Intel® 64 and IA-32 Architectures Software Developer’s Manual
Volume 3: System Programming Guide}).  However, the \code{CPUFreq} core
uses frequencies for identifying operating performance points of CPUs and
frequencies are involved in the user space interface exposed by it, so
\code{intel\_pstate} maps its internal representation of P-states to frequencies too
(fortunately, that mapping is unambiguous).  At the same time, it would not be
practical for \code{intel\_pstate} to supply the \code{CPUFreq} core with a table of
available frequencies due to the possible size of it, so the driver does not do
that.  Some functionality of the core is limited by that.

Since the hardware P-state selection interface used by \code{intel\_pstate} is
available at the logical CPU level, the driver always works with individual
CPUs.  Consequently, if \code{intel\_pstate} is in use, every \code{CPUFreq} policy
object corresponds to one logical CPU and \code{CPUFreq} policies are effectively
equivalent to CPUs.  In particular, this means that they become ``inactive'' every
time the corresponding CPU is taken offline and need to be re-initialized when
it goes back online.

\code{intel\_pstate} is not modular, so it cannot be unloaded, which means that the
only way to pass early-configuration-time parameters to it is via the kernel
command line.  However, its configuration can be adjusted via \code{sysfs} to a
great extent.  In some configurations it even is possible to unregister it via
\code{sysfs} which allows another \code{CPUFreq} scaling driver to be loaded and
registered (see {\hyperref[admin\string-guide/pm/intel_pstate:status\string-attr]{\emph{below}}}\phantomsection\label{admin-guide/pm/intel_pstate:status-attr}).


\subsubsection{Operation Modes}
\label{admin-guide/pm/intel_pstate:operation-modes}
\code{intel\_pstate} can operate in three different modes: in the active mode with
or without hardware-managed P-states support and in the passive mode.  Which of
them will be in effect depends on what kernel command line options are used and
on the capabilities of the processor.


\paragraph{Active Mode}
\label{admin-guide/pm/intel_pstate:active-mode}
This is the default operation mode of \code{intel\_pstate}.  If it works in this
mode, the \code{scaling\_driver} policy attribute in \code{sysfs} for all \code{CPUFreq}
policies contains the string ``intel\_pstate''.

In this mode the driver bypasses the scaling governors layer of \code{CPUFreq} and
provides its own scaling algorithms for P-state selection.  Those algorithms
can be applied to \code{CPUFreq} policies in the same way as generic scaling
governors (that is, through the \code{scaling\_governor} policy attribute in
\code{sysfs}).  {[}Note that different P-state selection algorithms may be chosen for
different policies, but that is not recommended.{]}

They are not generic scaling governors, but their names are the same as the
names of some of those governors.  Moreover, confusingly enough, they generally
do not work in the same way as the generic governors they share the names with.
For example, the \code{powersave} P-state selection algorithm provided by
\code{intel\_pstate} is not a counterpart of the generic \code{powersave} governor
(roughly, it corresponds to the \code{schedutil} and \code{ondemand} governors).

There are two P-state selection algorithms provided by \code{intel\_pstate} in the
active mode: \code{powersave} and \code{performance}.  The way they both operate
depends on whether or not the hardware-managed P-states (HWP) feature has been
enabled in the processor and possibly on the processor model.

Which of the P-state selection algorithms is used by default depends on the
\code{CONFIG\_CPU\_FREQ\_DEFAULT\_GOV\_PERFORMANCE} kernel configuration option.
Namely, if that option is set, the \code{performance} algorithm will be used by
default, and the other one will be used by default if it is not set.


\subparagraph{Active Mode With HWP}
\label{admin-guide/pm/intel_pstate:active-mode-with-hwp}
If the processor supports the HWP feature, it will be enabled during the
processor initialization and cannot be disabled after that.  It is possible
to avoid enabling it by passing the \code{intel\_pstate=no\_hwp} argument to the
kernel in the command line.

If the HWP feature has been enabled, \code{intel\_pstate} relies on the processor to
select P-states by itself, but still it can give hints to the processor's
internal P-state selection logic.  What those hints are depends on which P-state
selection algorithm has been applied to the given policy (or to the CPU it
corresponds to).

Even though the P-state selection is carried out by the processor automatically,
\code{intel\_pstate} registers utilization update callbacks with the CPU scheduler
in this mode.  However, they are not used for running a P-state selection
algorithm, but for periodic updates of the current CPU frequency information to
be made available from the \code{scaling\_cur\_freq} policy attribute in \code{sysfs}.


\subparagraph{HWP + \texttt{performance}}
\label{admin-guide/pm/intel_pstate:hwp-performance}
In this configuration \code{intel\_pstate} will write 0 to the processor's
Energy-Performance Preference (EPP) knob (if supported) or its
Energy-Performance Bias (EPB) knob (otherwise), which means that the processor's
internal P-state selection logic is expected to focus entirely on performance.

This will override the EPP/EPB setting coming from the \code{sysfs} interface
(see {\hyperref[admin\string-guide/pm/intel_pstate:energy\string-vs\string-performance\string-hints]{\emph{Energy vs Performance Hints}}} below).

Also, in this configuration the range of P-states available to the processor's
internal P-state selection logic is always restricted to the upper boundary
(that is, the maximum P-state that the driver is allowed to use).


\subparagraph{HWP + \texttt{powersave}}
\label{admin-guide/pm/intel_pstate:hwp-powersave}
In this configuration \code{intel\_pstate} will set the processor's
Energy-Performance Preference (EPP) knob (if supported) or its
Energy-Performance Bias (EPB) knob (otherwise) to whatever value it was
previously set to via \code{sysfs} (or whatever default value it was
set to by the platform firmware).  This usually causes the processor's
internal P-state selection logic to be less performance-focused.


\subparagraph{Active Mode Without HWP}
\label{admin-guide/pm/intel_pstate:active-mode-without-hwp}
This is the default operation mode for processors that do not support the HWP
feature.  It also is used by default with the \code{intel\_pstate=no\_hwp} argument
in the kernel command line.  However, in this mode \code{intel\_pstate} may refuse
to work with the given processor if it does not recognize it.  {[}Note that
\code{intel\_pstate} will never refuse to work with any processor with the HWP
feature enabled.{]}

In this mode \code{intel\_pstate} registers utilization update callbacks with the
CPU scheduler in order to run a P-state selection algorithm, either
\code{powersave} or \code{performance}, depending on the \code{scaling\_cur\_freq} policy
setting in \code{sysfs}.  The current CPU frequency information to be made
available from the \code{scaling\_cur\_freq} policy attribute in \code{sysfs} is
periodically updated by those utilization update callbacks too.


\subparagraph{\texttt{performance}}
\label{admin-guide/pm/intel_pstate:performance}
Without HWP, this P-state selection algorithm is always the same regardless of
the processor model and platform configuration.

It selects the maximum P-state it is allowed to use, subject to limits set via
\code{sysfs}, every time the driver configuration for the given CPU is updated
(e.g. via \code{sysfs}).

This is the default P-state selection algorithm if the
\code{CONFIG\_CPU\_FREQ\_DEFAULT\_GOV\_PERFORMANCE} kernel configuration option
is set.


\subparagraph{\texttt{powersave}}
\label{admin-guide/pm/intel_pstate:powersave}
Without HWP, this P-state selection algorithm is similar to the algorithm
implemented by the generic \code{schedutil} scaling governor except that the
utilization metric used by it is based on numbers coming from feedback
registers of the CPU.  It generally selects P-states proportional to the
current CPU utilization.

This algorithm is run by the driver's utilization update callback for the
given CPU when it is invoked by the CPU scheduler, but not more often than
every 10 ms.  Like in the \code{performance} case, the hardware configuration
is not touched if the new P-state turns out to be the same as the current
one.

This is the default P-state selection algorithm if the
\code{CONFIG\_CPU\_FREQ\_DEFAULT\_GOV\_PERFORMANCE} kernel configuration option
is not set.


\paragraph{Passive Mode}
\label{admin-guide/pm/intel_pstate:passive-mode}
This mode is used if the \code{intel\_pstate=passive} argument is passed to the
kernel in the command line (it implies the \code{intel\_pstate=no\_hwp} setting too).
Like in the active mode without HWP support, in this mode \code{intel\_pstate} may
refuse to work with the given processor if it does not recognize it.

If the driver works in this mode, the \code{scaling\_driver} policy attribute in
\code{sysfs} for all \code{CPUFreq} policies contains the string ``intel\_cpufreq''.
Then, the driver behaves like a regular \code{CPUFreq} scaling driver.  That is,
it is invoked by generic scaling governors when necessary to talk to the
hardware in order to change the P-state of a CPU (in particular, the
\code{schedutil} governor can invoke it directly from scheduler context).

While in this mode, \code{intel\_pstate} can be used with all of the (generic)
scaling governors listed by the \code{scaling\_available\_governors} policy attribute
in \code{sysfs} (and the P-state selection algorithms described above are not
used).  Then, it is responsible for the configuration of policy objects
corresponding to CPUs and provides the \code{CPUFreq} core (and the scaling
governors attached to the policy objects) with accurate information on the
maximum and minimum operating frequencies supported by the hardware (including
the so-called ``turbo'' frequency ranges).  In other words, in the passive mode
the entire range of available P-states is exposed by \code{intel\_pstate} to the
\code{CPUFreq} core.  However, in this mode the driver does not register
utilization update callbacks with the CPU scheduler and the \code{scaling\_cur\_freq}
information comes from the \code{CPUFreq} core (and is the last frequency selected
by the current scaling governor for the given policy).


\subsubsection{Turbo P-states Support}
\label{admin-guide/pm/intel_pstate:turbo}\label{admin-guide/pm/intel_pstate:turbo-p-states-support}
In the majority of cases, the entire range of P-states available to
\code{intel\_pstate} can be divided into two sub-ranges that correspond to
different types of processor behavior, above and below a boundary that
will be referred to as the ``turbo threshold'' in what follows.

The P-states above the turbo threshold are referred to as ``turbo P-states'' and
the whole sub-range of P-states they belong to is referred to as the ``turbo
range''.  These names are related to the Turbo Boost technology allowing a
multicore processor to opportunistically increase the P-state of one or more
cores if there is enough power to do that and if that is not going to cause the
thermal envelope of the processor package to be exceeded.

Specifically, if software sets the P-state of a CPU core within the turbo range
(that is, above the turbo threshold), the processor is permitted to take over
performance scaling control for that core and put it into turbo P-states of its
choice going forward.  However, that permission is interpreted differently by
different processor generations.  Namely, the Sandy Bridge generation of
processors will never use any P-states above the last one set by software for
the given core, even if it is within the turbo range, whereas all of the later
processor generations will take it as a license to use any P-states from the
turbo range, even above the one set by software.  In other words, on those
processors setting any P-state from the turbo range will enable the processor
to put the given core into all turbo P-states up to and including the maximum
supported one as it sees fit.

One important property of turbo P-states is that they are not sustainable.  More
precisely, there is no guarantee that any CPUs will be able to stay in any of
those states indefinitely, because the power distribution within the processor
package may change over time  or the thermal envelope it was designed for might
be exceeded if a turbo P-state was used for too long.

In turn, the P-states below the turbo threshold generally are sustainable.  In
fact, if one of them is set by software, the processor is not expected to change
it to a lower one unless in a thermal stress or a power limit violation
situation (a higher P-state may still be used if it is set for another CPU in
the same package at the same time, for example).

Some processors allow multiple cores to be in turbo P-states at the same time,
but the maximum P-state that can be set for them generally depends on the number
of cores running concurrently.  The maximum turbo P-state that can be set for 3
cores at the same time usually is lower than the analogous maximum P-state for
2 cores, which in turn usually is lower than the maximum turbo P-state that can
be set for 1 core.  The one-core maximum turbo P-state is thus the maximum
supported one overall.

The maximum supported turbo P-state, the turbo threshold (the maximum supported
non-turbo P-state) and the minimum supported P-state are specific to the
processor model and can be determined by reading the processor's model-specific
registers (MSRs).  Moreover, some processors support the Configurable TDP
(Thermal Design Power) feature and, when that feature is enabled, the turbo
threshold effectively becomes a configurable value that can be set by the
platform firmware.

Unlike \code{\_PSS} objects in the ACPI tables, \code{intel\_pstate} always exposes
the entire range of available P-states, including the whole turbo range, to the
\code{CPUFreq} core and (in the passive mode) to generic scaling governors.  This
generally causes turbo P-states to be set more often when \code{intel\_pstate} is
used relative to ACPI-based CPU performance scaling (see {\hyperref[admin\string-guide/pm/intel_pstate:acpi\string-cpufreq]{\emph{below}}}\phantomsection\label{admin-guide/pm/intel_pstate:acpi-cpufreq}
for more information).

Moreover, since \code{intel\_pstate} always knows what the real turbo threshold is
(even if the Configurable TDP feature is enabled in the processor), its
\code{no\_turbo} attribute in \code{sysfs} (described {\hyperref[admin\string-guide/pm/intel_pstate:no\string-turbo\string-attr]{\emph{below}}}\phantomsection\label{admin-guide/pm/intel_pstate:no-turbo-attr}) should
work as expected in all cases (that is, if set to disable turbo P-states, it
always should prevent \code{intel\_pstate} from using them).


\subsubsection{Processor Support}
\label{admin-guide/pm/intel_pstate:processor-support}
To handle a given processor \code{intel\_pstate} requires a number of different
pieces of information on it to be known, including:
\begin{itemize}
\item {} 
The minimum supported P-state.

\item {} 
The maximum supported {\hyperref[admin\string-guide/pm/intel_pstate:turbo]{\emph{non-turbo P-state}}}\phantomsection\label{admin-guide/pm/intel_pstate:turbo}.

\item {} 
Whether or not turbo P-states are supported at all.

\item {} 
The maximum supported {\hyperref[admin\string-guide/pm/intel_pstate:turbo]{\emph{one-core turbo P-state}}}\phantomsection\label{admin-guide/pm/intel_pstate:turbo} (if turbo P-states
are supported).

\item {} 
The scaling formula to translate the driver's internal representation
of P-states into frequencies and the other way around.

\end{itemize}

Generally, ways to obtain that information are specific to the processor model
or family.  Although it often is possible to obtain all of it from the processor
itself (using model-specific registers), there are cases in which hardware
manuals need to be consulted to get to it too.

For this reason, there is a list of supported processors in \code{intel\_pstate} and
the driver initialization will fail if the detected processor is not in that
list, unless it supports the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode]{\emph{HWP feature}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode}.  {[}The interface to
obtain all of the information listed above is the same for all of the processors
supporting the HWP feature, which is why they all are supported by
\code{intel\_pstate}.{]}


\subsubsection{User Space Interface in \texttt{sysfs}}
\label{admin-guide/pm/intel_pstate:user-space-interface-in-sysfs}

\paragraph{Global Attributes}
\label{admin-guide/pm/intel_pstate:global-attributes}
\code{intel\_pstate} exposes several global attributes (files) in \code{sysfs} to
control its functionality at the system level.  They are located in the
\code{/sys/devices/system/cpu/cpufreq/intel\_pstate/} directory and affect all
CPUs.

Some of them are not present if the \code{intel\_pstate=per\_cpu\_perf\_limits}
argument is passed to the kernel in the command line.
\begin{description}
\item[{\code{max\_perf\_pct}}] \leavevmode
Maximum P-state the driver is allowed to set in percent of the
maximum supported performance level (the highest supported {\hyperref[admin\string-guide/pm/intel_pstate:turbo]{\emph{turbo
P-state}}}\phantomsection\label{admin-guide/pm/intel_pstate:turbo}).

This attribute will not be exposed if the
\code{intel\_pstate=per\_cpu\_perf\_limits} argument is present in the kernel
command line.

\item[{\code{min\_perf\_pct}}] \leavevmode
Minimum P-state the driver is allowed to set in percent of the
maximum supported performance level (the highest supported {\hyperref[admin\string-guide/pm/intel_pstate:turbo]{\emph{turbo
P-state}}}\phantomsection\label{admin-guide/pm/intel_pstate:turbo}).

This attribute will not be exposed if the
\code{intel\_pstate=per\_cpu\_perf\_limits} argument is present in the kernel
command line.

\item[{\code{num\_pstates}}] \leavevmode
Number of P-states supported by the processor (between 0 and 255
inclusive) including both turbo and non-turbo P-states (see
{\hyperref[admin\string-guide/pm/intel_pstate:turbo\string-p\string-states\string-support]{\emph{Turbo P-states Support}}}).

The value of this attribute is not affected by the \code{no\_turbo}
setting described {\hyperref[admin\string-guide/pm/intel_pstate:no\string-turbo\string-attr]{\emph{below}}}\phantomsection\label{admin-guide/pm/intel_pstate:no-turbo-attr}.

This attribute is read-only.

\item[{\code{turbo\_pct}}] \leavevmode
Ratio of the {\hyperref[admin\string-guide/pm/intel_pstate:turbo]{\emph{turbo range}}}\phantomsection\label{admin-guide/pm/intel_pstate:turbo} size to the size of the entire
range of supported P-states, in percent.

This attribute is read-only.

\end{description}
\phantomsection\label{admin-guide/pm/intel_pstate:no-turbo-attr}\begin{description}
\item[{\code{no\_turbo}}] \leavevmode
If set (equal to 1), the driver is not allowed to set any turbo P-states
(see {\hyperref[admin\string-guide/pm/intel_pstate:turbo\string-p\string-states\string-support]{\emph{Turbo P-states Support}}}).  If unset (equalt to 0, which is the
default), turbo P-states can be set by the driver.
{[}Note that \code{intel\_pstate} does not support the general \code{boost}
attribute (supported by some other scaling drivers) which is replaced
by this one.{]}

This attrubute does not affect the maximum supported frequency value
supplied to the \code{CPUFreq} core and exposed via the policy interface,
but it affects the maximum possible value of per-policy P-state limits
(see {\hyperref[admin\string-guide/pm/intel_pstate:interpretation\string-of\string-policy\string-attributes]{\emph{Interpretation of Policy Attributes}}} below for details).

\end{description}
\phantomsection\label{admin-guide/pm/intel_pstate:status-attr}\begin{description}
\item[{\code{status}}] \leavevmode
Operation mode of the driver: ``active'', ``passive'' or ``off''.
\begin{description}
\item[{``active''}] \leavevmode
The driver is functional and in the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode]{\emph{active mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode}.

\item[{``passive''}] \leavevmode
The driver is functional and in the {\hyperref[admin\string-guide/pm/intel_pstate:passive\string-mode]{\emph{passive mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:passive-mode}.

\item[{``off''}] \leavevmode
The driver is not functional (it is not registered as a scaling
driver with the \code{CPUFreq} core).

\end{description}

This attribute can be written to in order to change the driver's
operation mode or to unregister it.  The string written to it must be
one of the possible values of it and, if successful, the write will
cause the driver to switch over to the operation mode represented by
that string - or to be unregistered in the ``off'' case.  {[}Actually,
switching over from the active mode to the passive mode or the other
way around causes the driver to be unregistered and registered again
with a different set of callbacks, so all of its settings (the global
as well as the per-policy ones) are then reset to their default
values, possibly depending on the target operation mode.{]}

That only is supported in some configurations, though (for example, if
the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode\string-with\string-hwp]{\emph{HWP feature is enabled in the processor}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode-with-hwp},
the operation mode of the driver cannot be changed), and if it is not
supported in the current configuration, writes to this attribute with
fail with an appropriate error.

\end{description}


\paragraph{Interpretation of Policy Attributes}
\label{admin-guide/pm/intel_pstate:interpretation-of-policy-attributes}
The interpretation of some \code{CPUFreq} policy attributes described in
{\hyperref[admin\string-guide/pm/cpufreq::doc]{\emph{\emph{CPU Performance Scaling}}}} is special with \code{intel\_pstate} as the current scaling driver
and it generally depends on the driver's {\hyperref[admin\string-guide/pm/intel_pstate:operation\string-modes]{\emph{operation mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:operation-modes}.

First of all, the values of the \code{cpuinfo\_max\_freq}, \code{cpuinfo\_min\_freq} and
\code{scaling\_cur\_freq} attributes are produced by applying a processor-specific
multiplier to the internal P-state representation used by \code{intel\_pstate}.
Also, the values of the \code{scaling\_max\_freq} and \code{scaling\_min\_freq}
attributes are capped by the frequency corresponding to the maximum P-state that
the driver is allowed to set.

If the \code{no\_turbo} {\hyperref[admin\string-guide/pm/intel_pstate:no\string-turbo\string-attr]{\emph{global attribute}}}\phantomsection\label{admin-guide/pm/intel_pstate:no-turbo-attr} is set, the driver is
not allowed to use turbo P-states, so the maximum value of \code{scaling\_max\_freq}
and \code{scaling\_min\_freq} is limited to the maximum non-turbo P-state frequency.
Accordingly, setting \code{no\_turbo} causes \code{scaling\_max\_freq} and
\code{scaling\_min\_freq} to go down to that value if they were above it before.
However, the old values of \code{scaling\_max\_freq} and \code{scaling\_min\_freq} will be
restored after unsetting \code{no\_turbo}, unless these attributes have been written
to after \code{no\_turbo} was set.

If \code{no\_turbo} is not set, the maximum possible value of \code{scaling\_max\_freq}
and \code{scaling\_min\_freq} corresponds to the maximum supported turbo P-state,
which also is the value of \code{cpuinfo\_max\_freq} in either case.

Next, the following policy attributes have special meaning if
\code{intel\_pstate} works in the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode]{\emph{active mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode}:
\begin{description}
\item[{\code{scaling\_available\_governors}}] \leavevmode
List of P-state selection algorithms provided by \code{intel\_pstate}.

\item[{\code{scaling\_governor}}] \leavevmode
P-state selection algorithm provided by \code{intel\_pstate} currently in
use with the given policy.

\item[{\code{scaling\_cur\_freq}}] \leavevmode
Frequency of the average P-state of the CPU represented by the given
policy for the time interval between the last two invocations of the
driver's utilization update callback by the CPU scheduler for that CPU.

\end{description}

The meaning of these attributes in the {\hyperref[admin\string-guide/pm/intel_pstate:passive\string-mode]{\emph{passive mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:passive-mode} is the
same as for other scaling drivers.

Additionally, the value of the \code{scaling\_driver} attribute for \code{intel\_pstate}
depends on the operation mode of the driver.  Namely, it is either
``intel\_pstate'' (in the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode]{\emph{active mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode}) or ``intel\_cpufreq'' (in the
{\hyperref[admin\string-guide/pm/intel_pstate:passive\string-mode]{\emph{passive mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:passive-mode}).


\paragraph{Coordination of P-State Limits}
\label{admin-guide/pm/intel_pstate:coordination-of-p-state-limits}
\code{intel\_pstate} allows P-state limits to be set in two ways: with the help of
the \code{max\_perf\_pct} and \code{min\_perf\_pct} {\hyperref[admin\string-guide/pm/intel_pstate:global\string-attributes]{\emph{global attributes}}}\phantomsection\label{admin-guide/pm/intel_pstate:global-attributes} or via the \code{scaling\_max\_freq} and \code{scaling\_min\_freq}
\code{CPUFreq} policy attributes.  The coordination between those limits is based
on the following rules, regardless of the current operation mode of the driver:
\begin{enumerate}
\item {} 
All CPUs are affected by the global limits (that is, none of them can be
requested to run faster than the global maximum and none of them can be
requested to run slower than the global minimum).

\item {} 
Each individual CPU is affected by its own per-policy limits (that is, it
cannot be requested to run faster than its own per-policy maximum and it
cannot be requested to run slower than its own per-policy minimum).

\item {} 
The global and per-policy limits can be set independently.

\end{enumerate}

If the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode\string-with\string-hwp]{\emph{HWP feature is enabled in the processor}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode-with-hwp}, the
resulting effective values are written into its registers whenever the limits
change in order to request its internal P-state selection logic to always set
P-states within these limits.  Otherwise, the limits are taken into account by
scaling governors (in the {\hyperref[admin\string-guide/pm/intel_pstate:passive\string-mode]{\emph{passive mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:passive-mode}) and by the driver
every time before setting a new P-state for a CPU.

Additionally, if the \code{intel\_pstate=per\_cpu\_perf\_limits} command line argument
is passed to the kernel, \code{max\_perf\_pct} and \code{min\_perf\_pct} are not exposed
at all and the only way to set the limits is by using the policy attributes.


\paragraph{Energy vs Performance Hints}
\label{admin-guide/pm/intel_pstate:energy-vs-performance-hints}
If \code{intel\_pstate} works in the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode\string-with\string-hwp]{\emph{active mode with the HWP feature enabled}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode-with-hwp} in the processor, additional attributes are present
in every \code{CPUFreq} policy directory in \code{sysfs}.  They are intended to allow
user space to help \code{intel\_pstate} to adjust the processor's internal P-state
selection logic by focusing it on performance or on energy-efficiency, or
somewhere between the two extremes:
\begin{description}
\item[{\code{energy\_performance\_preference}}] \leavevmode
Current value of the energy vs performance hint for the given policy
(or the CPU represented by it).

The hint can be changed by writing to this attribute.

\item[{\code{energy\_performance\_available\_preferences}}] \leavevmode
List of strings that can be written to the
\code{energy\_performance\_preference} attribute.

They represent different energy vs performance hints and should be
self-explanatory, except that \code{default} represents whatever hint
value was set by the platform firmware.

\end{description}

Strings written to the \code{energy\_performance\_preference} attribute are
internally translated to integer values written to the processor's
Energy-Performance Preference (EPP) knob (if supported) or its
Energy-Performance Bias (EPB) knob.

{[}Note that tasks may by migrated from one CPU to another by the scheduler's
load-balancing algorithm and if different energy vs performance hints are
set for those CPUs, that may lead to undesirable outcomes.  To avoid such
issues it is better to set the same energy vs performance hint for all CPUs
or to pin every task potentially sensitive to them to a specific CPU.{]}


\subsubsection{\texttt{intel\_pstate} vs \texttt{acpi-cpufreq}}
\label{admin-guide/pm/intel_pstate:intel-pstate-vs-acpi-cpufreq}\label{admin-guide/pm/intel_pstate:acpi-cpufreq}
On the majority of systems supported by \code{intel\_pstate}, the ACPI tables
provided by the platform firmware contain \code{\_PSS} objects returning information
that can be used for CPU performance scaling (refer to the \href{http://www.uefi.org/sites/default/files/resources/ACPI\_6\_1.pdf}{ACPI specification}
for details on the \code{\_PSS} objects and the format of the information returned
by them).

The information returned by the ACPI \code{\_PSS} objects is used by the
\code{acpi-cpufreq} scaling driver.  On systems supported by \code{intel\_pstate}
the \code{acpi-cpufreq} driver uses the same hardware CPU performance scaling
interface, but the set of P-states it can use is limited by the \code{\_PSS}
output.

On those systems each \code{\_PSS} object returns a list of P-states supported by
the corresponding CPU which basically is a subset of the P-states range that can
be used by \code{intel\_pstate} on the same system, with one exception: the whole
{\hyperref[admin\string-guide/pm/intel_pstate:turbo]{\emph{turbo range}}}\phantomsection\label{admin-guide/pm/intel_pstate:turbo} is represented by one item in it (the topmost one).  By
convention, the frequency returned by \code{\_PSS} for that item is greater by 1 MHz
than the frequency of the highest non-turbo P-state listed by it, but the
corresponding P-state representation (following the hardware specification)
returned for it matches the maximum supported turbo P-state (or is the
special value 255 meaning essentially ``go as high as you can get'').

The list of P-states returned by \code{\_PSS} is reflected by the table of
available frequencies supplied by \code{acpi-cpufreq} to the \code{CPUFreq} core and
scaling governors and the minimum and maximum supported frequencies reported by
it come from that list as well.  In particular, given the special representation
of the turbo range described above, this means that the maximum supported
frequency reported by \code{acpi-cpufreq} is higher by 1 MHz than the frequency
of the highest supported non-turbo P-state listed by \code{\_PSS} which, of course,
affects decisions made by the scaling governors, except for \code{powersave} and
\code{performance}.

For example, if a given governor attempts to select a frequency proportional to
estimated CPU load and maps the load of 100\% to the maximum supported frequency
(possibly multiplied by a constant), then it will tend to choose P-states below
the turbo threshold if \code{acpi-cpufreq} is used as the scaling driver, because
in that case the turbo range corresponds to a small fraction of the frequency
band it can use (1 MHz vs 1 GHz or more).  In consequence, it will only go to
the turbo range for the highest loads and the other loads above 50\% that might
benefit from running at turbo frequencies will be given non-turbo P-states
instead.

One more issue related to that may appear on systems supporting the
{\hyperref[admin\string-guide/pm/intel_pstate:turbo]{\emph{Configurable TDP feature}}}\phantomsection\label{admin-guide/pm/intel_pstate:turbo} allowing the platform firmware to set the
turbo threshold.  Namely, if that is not coordinated with the lists of P-states
returned by \code{\_PSS} properly, there may be more than one item corresponding to
a turbo P-state in those lists and there may be a problem with avoiding the
turbo range (if desirable or necessary).  Usually, to avoid using turbo
P-states overall, \code{acpi-cpufreq} simply avoids using the topmost state listed
by \code{\_PSS}, but that is not sufficient when there are other turbo P-states in
the list returned by it.

Apart from the above, \code{acpi-cpufreq} works like \code{intel\_pstate} in the
{\hyperref[admin\string-guide/pm/intel_pstate:passive\string-mode]{\emph{passive mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:passive-mode}, except that the number of P-states it can set
is limited to the ones listed by the ACPI \code{\_PSS} objects.


\subsubsection{Kernel Command Line Options for \texttt{intel\_pstate}}
\label{admin-guide/pm/intel_pstate:kernel-command-line-options-for-intel-pstate}
Several kernel command line options can be used to pass early-configuration-time
parameters to \code{intel\_pstate} in order to enforce specific behavior of it.  All
of them have to be prepended with the \code{intel\_pstate=} prefix.
\begin{description}
\item[{\code{disable}}] \leavevmode
Do not register \code{intel\_pstate} as the scaling driver even if the
processor is supported by it.

\item[{\code{passive}}] \leavevmode
Register \code{intel\_pstate} in the {\hyperref[admin\string-guide/pm/intel_pstate:passive\string-mode]{\emph{passive mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:passive-mode} to
start with.

This option implies the \code{no\_hwp} one described below.

\item[{\code{force}}] \leavevmode
Register \code{intel\_pstate} as the scaling driver instead of
\code{acpi-cpufreq} even if the latter is preferred on the given system.

This may prevent some platform features (such as thermal controls and
power capping) that rely on the availability of ACPI P-states
information from functioning as expected, so it should be used with
caution.

This option does not work with processors that are not supported by
\code{intel\_pstate} and on platforms where the \code{pcc-cpufreq} scaling
driver is used instead of \code{acpi-cpufreq}.

\item[{\code{no\_hwp}}] \leavevmode
Do not enable the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode\string-with\string-hwp]{\emph{hardware-managed P-states (HWP) feature}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode-with-hwp} even if it is supported by the processor.

\item[{\code{hwp\_only}}] \leavevmode
Register \code{intel\_pstate} as the scaling driver only if the
{\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode\string-with\string-hwp]{\emph{hardware-managed P-states (HWP) feature}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode-with-hwp} is
supported by the processor.

\item[{\code{support\_acpi\_ppc}}] \leavevmode
Take ACPI \code{\_PPC} performance limits into account.

If the preferred power management profile in the FADT (Fixed ACPI
Description Table) is set to ``Enterprise Server'' or ``Performance
Server'', the ACPI \code{\_PPC} limits are taken into account by default
and this option has no effect.

\item[{\code{per\_cpu\_perf\_limits}}] \leavevmode
Use per-logical-CPU P-State limits (see {\hyperref[admin\string-guide/pm/intel_pstate:coordination\string-of\string-p\string-state\string-limits]{\emph{Coordination of P-state
Limits}}} for details).

\end{description}


\subsubsection{Diagnostics and Tuning}
\label{admin-guide/pm/intel_pstate:diagnostics-and-tuning}

\paragraph{Trace Events}
\label{admin-guide/pm/intel_pstate:trace-events}
There are two static trace events that can be used for \code{intel\_pstate}
diagnostics.  One of them is the \code{cpu\_frequency} trace event generally used
by \code{CPUFreq}, and the other one is the \code{pstate\_sample} trace event specific
to \code{intel\_pstate}.  Both of them are triggered by \code{intel\_pstate} only if
it works in the {\hyperref[admin\string-guide/pm/intel_pstate:active\string-mode]{\emph{active mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:active-mode}.

The following sequence of shell commands can be used to enable them and see
their output (if the kernel is generally configured to support event tracing):

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} cd /sys/kernel/debug/tracing/
\PYGZsh{} echo 1 \PYGZgt{} events/power/pstate\PYGZus{}sample/enable
\PYGZsh{} echo 1 \PYGZgt{} events/power/cpu\PYGZus{}frequency/enable
\PYGZsh{} cat trace
gnome\PYGZhy{}terminal\PYGZhy{}\PYGZhy{}4510  [001] ..s.  1177.680733: pstate\PYGZus{}sample: core\PYGZus{}busy=107 scaled=94 from=26 to=26 mperf=1143818 aperf=1230607 tsc=29838618 freq=2474476
cat\PYGZhy{}5235  [002] ..s.  1177.681723: cpu\PYGZus{}frequency: state=2900000 cpu\PYGZus{}id=2
\end{Verbatim}

If \code{intel\_pstate} works in the {\hyperref[admin\string-guide/pm/intel_pstate:passive\string-mode]{\emph{passive mode}}}\phantomsection\label{admin-guide/pm/intel_pstate:passive-mode}, the
\code{cpu\_frequency} trace event will be triggered either by the \code{schedutil}
scaling governor (for the policies it is attached to), or by the \code{CPUFreq}
core (for the policies with other scaling governors).


\paragraph{\texttt{ftrace}}
\label{admin-guide/pm/intel_pstate:ftrace}
The \code{ftrace} interface can be used for low-level diagnostics of
\code{intel\_pstate}.  For example, to check how often the function to set a
P-state is called, the \code{ftrace} filter can be set to to
\code{intel\_pstate\_set\_pstate()}:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} cd /sys/kernel/debug/tracing/
\PYGZsh{} cat available\PYGZus{}filter\PYGZus{}functions \textbar{} grep \PYGZhy{}i pstate
intel\PYGZus{}pstate\PYGZus{}set\PYGZus{}pstate
intel\PYGZus{}pstate\PYGZus{}cpu\PYGZus{}init
...
\PYGZsh{} echo intel\PYGZus{}pstate\PYGZus{}set\PYGZus{}pstate \PYGZgt{} set\PYGZus{}ftrace\PYGZus{}filter
\PYGZsh{} echo function \PYGZgt{} current\PYGZus{}tracer
\PYGZsh{} cat trace \textbar{} head \PYGZhy{}15
\PYGZsh{} tracer: function
\PYGZsh{}
\PYGZsh{} entries\PYGZhy{}in\PYGZhy{}buffer/entries\PYGZhy{}written: 80/80   \PYGZsh{}P:4
\PYGZsh{}
\PYGZsh{}                              \PYGZus{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}=\PYGZgt{} irqs\PYGZhy{}off
\PYGZsh{}                             / \PYGZus{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}=\PYGZgt{} need\PYGZhy{}resched
\PYGZsh{}                            \textbar{} / \PYGZus{}\PYGZhy{}\PYGZhy{}\PYGZhy{}=\PYGZgt{} hardirq/softirq
\PYGZsh{}                            \textbar{}\textbar{} / \PYGZus{}\PYGZhy{}\PYGZhy{}=\PYGZgt{} preempt\PYGZhy{}depth
\PYGZsh{}                            \textbar{}\textbar{}\textbar{} /     delay
\PYGZsh{}           TASK\PYGZhy{}PID   CPU\PYGZsh{}  \textbar{}\textbar{}\textbar{}\textbar{}    TIMESTAMP  FUNCTION
\PYGZsh{}              \textbar{} \textbar{}       \textbar{}   \textbar{}\textbar{}\textbar{}\textbar{}       \textbar{}         \textbar{}
            Xorg\PYGZhy{}3129  [000] ..s.  2537.644844: intel\PYGZus{}pstate\PYGZus{}set\PYGZus{}pstate \PYGZlt{}\PYGZhy{}intel\PYGZus{}pstate\PYGZus{}timer\PYGZus{}func
 gnome\PYGZhy{}terminal\PYGZhy{}\PYGZhy{}4510  [002] ..s.  2537.649844: intel\PYGZus{}pstate\PYGZus{}set\PYGZus{}pstate \PYGZlt{}\PYGZhy{}intel\PYGZus{}pstate\PYGZus{}timer\PYGZus{}func
     gnome\PYGZhy{}shell\PYGZhy{}3409  [001] ..s.  2537.650850: intel\PYGZus{}pstate\PYGZus{}set\PYGZus{}pstate \PYGZlt{}\PYGZhy{}intel\PYGZus{}pstate\PYGZus{}timer\PYGZus{}func
          \PYGZlt{}idle\PYGZgt{}\PYGZhy{}0     [000] ..s.  2537.654843: intel\PYGZus{}pstate\PYGZus{}set\PYGZus{}pstate \PYGZlt{}\PYGZhy{}intel\PYGZus{}pstate\PYGZus{}timer\PYGZus{}func
\end{Verbatim}


\chapter{Thunderbolt}
\label{admin-guide/thunderbolt:thunderbolt}\label{admin-guide/thunderbolt:acpi-specification}\label{admin-guide/thunderbolt::doc}
The interface presented here is not meant for end users. Instead there
should be a userspace tool that handles all the low-level details, keeps
a database of the authorized devices and prompts users for new connections.

More details about the sysfs interface for Thunderbolt devices can be
found in \code{Documentation/ABI/testing/sysfs-bus-thunderbolt}.

Those users who just want to connect any device without any sort of
manual work can add following line to
\code{/etc/udev/rules.d/99-local.rules}:

\begin{Verbatim}[commandchars=\\\{\}]
ACTION==\PYGZdq{}add\PYGZdq{}, SUBSYSTEM==\PYGZdq{}thunderbolt\PYGZdq{}, ATTR\PYGZob{}authorized\PYGZcb{}==\PYGZdq{}0\PYGZdq{}, ATTR\PYGZob{}authorized\PYGZcb{}=\PYGZdq{}1\PYGZdq{}
\end{Verbatim}

This will authorize all devices automatically when they appear. However,
keep in mind that this bypasses the security levels and makes the system
vulnerable to DMA attacks.


\section{Security levels and how to use them}
\label{admin-guide/thunderbolt:security-levels-and-how-to-use-them}
Starting with Intel Falcon Ridge Thunderbolt controller there are 4
security levels available. The reason for these is the fact that the
connected devices can be DMA masters and thus read contents of the host
memory without CPU and OS knowing about it. There are ways to prevent
this by setting up an IOMMU but it is not always available for various
reasons.

The security levels are as follows:
\begin{quote}
\begin{description}
\item[{none}] \leavevmode
All devices are automatically connected by the firmware. No user
approval is needed. In BIOS settings this is typically called
\emph{Legacy mode}.

\item[{user}] \leavevmode
User is asked whether the device is allowed to be connected.
Based on the device identification information available through
\code{/sys/bus/thunderbolt/devices}, the user then can make the decision.
In BIOS settings this is typically called \emph{Unique ID}.

\item[{secure}] \leavevmode
User is asked whether the device is allowed to be connected. In
addition to UUID the device (if it supports secure connect) is sent
a challenge that should match the expected one based on a random key
written to the \code{key} sysfs attribute. In BIOS settings this is
typically called \emph{One time saved key}.

\item[{dponly}] \leavevmode
The firmware automatically creates tunnels for Display Port and
USB. No PCIe tunneling is done. In BIOS settings this is
typically called \emph{Display Port Only}.

\end{description}
\end{quote}

The current security level can be read from
\code{/sys/bus/thunderbolt/devices/domainX/security} where \code{domainX} is
the Thunderbolt domain the host controller manages. There is typically
one domain per Thunderbolt host controller.

If the security level reads as \code{user} or \code{secure} the connected
device must be authorized by the user before PCIe tunnels are created
(e.g the PCIe device appears).

Each Thunderbolt device plugged in will appear in sysfs under
\code{/sys/bus/thunderbolt/devices}. The device directory carries
information that can be used to identify the particular device,
including its name and UUID.


\section{Authorizing devices when security level is \texttt{user} or \texttt{secure}}
\label{admin-guide/thunderbolt:authorizing-devices-when-security-level-is-user-or-secure}
When a device is plugged in it will appear in sysfs as follows:

\begin{Verbatim}[commandchars=\\\{\}]
/sys/bus/thunderbolt/devices/0\PYGZhy{}1/authorized   \PYGZhy{} 0
/sys/bus/thunderbolt/devices/0\PYGZhy{}1/device       \PYGZhy{} 0x8004
/sys/bus/thunderbolt/devices/0\PYGZhy{}1/device\PYGZus{}name  \PYGZhy{} Thunderbolt to FireWire Adapter
/sys/bus/thunderbolt/devices/0\PYGZhy{}1/vendor       \PYGZhy{} 0x1
/sys/bus/thunderbolt/devices/0\PYGZhy{}1/vendor\PYGZus{}name  \PYGZhy{} Apple, Inc.
/sys/bus/thunderbolt/devices/0\PYGZhy{}1/unique\PYGZus{}id    \PYGZhy{} e0376f00\PYGZhy{}0300\PYGZhy{}0100\PYGZhy{}ffff\PYGZhy{}ffffffffffff
\end{Verbatim}

The \code{authorized} attribute reads 0 which means no PCIe tunnels are
created yet. The user can authorize the device by simply entering:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} echo 1 \PYGZgt{} /sys/bus/thunderbolt/devices/0\PYGZhy{}1/authorized
\end{Verbatim}

This will create the PCIe tunnels and the device is now connected.

If the device supports secure connect, and the domain security level is
set to \code{secure}, it has an additional attribute \code{key} which can hold
a random 32-byte value used for authorization and challenging the device in
future connects:

\begin{Verbatim}[commandchars=\\\{\}]
/sys/bus/thunderbolt/devices/0\PYGZhy{}3/authorized   \PYGZhy{} 0
/sys/bus/thunderbolt/devices/0\PYGZhy{}3/device       \PYGZhy{} 0x305
/sys/bus/thunderbolt/devices/0\PYGZhy{}3/device\PYGZus{}name  \PYGZhy{} AKiTiO Thunder3 PCIe Box
/sys/bus/thunderbolt/devices/0\PYGZhy{}3/key          \PYGZhy{}
/sys/bus/thunderbolt/devices/0\PYGZhy{}3/vendor       \PYGZhy{} 0x41
/sys/bus/thunderbolt/devices/0\PYGZhy{}3/vendor\PYGZus{}name  \PYGZhy{} inXtron
/sys/bus/thunderbolt/devices/0\PYGZhy{}3/unique\PYGZus{}id    \PYGZhy{} dc010000\PYGZhy{}0000\PYGZhy{}8508\PYGZhy{}a22d\PYGZhy{}32ca6421cb16
\end{Verbatim}

Notice the key is empty by default.

If the user does not want to use secure connect they can just \code{echo 1}
to the \code{authorized} attribute and the PCIe tunnels will be created in
the same way as in the \code{user} security level.

If the user wants to use secure connect, the first time the device is
plugged a key needs to be created and sent to the device:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} key=\PYGZdl{}(openssl rand \PYGZhy{}hex 32)
\PYGZsh{} echo \PYGZdl{}key \PYGZgt{} /sys/bus/thunderbolt/devices/0\PYGZhy{}3/key
\PYGZsh{} echo 1 \PYGZgt{} /sys/bus/thunderbolt/devices/0\PYGZhy{}3/authorized
\end{Verbatim}

Now the device is connected (PCIe tunnels are created) and in addition
the key is stored on the device NVM.

Next time the device is plugged in the user can verify (challenge) the
device using the same key:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} echo \PYGZdl{}key \PYGZgt{} /sys/bus/thunderbolt/devices/0\PYGZhy{}3/key
\PYGZsh{} echo 2 \PYGZgt{} /sys/bus/thunderbolt/devices/0\PYGZhy{}3/authorized
\end{Verbatim}

If the challenge the device returns back matches the one we expect based
on the key, the device is connected and the PCIe tunnels are created.
However, if the challenge fails no tunnels are created and error is
returned to the user.

If the user still wants to connect the device they can either approve
the device without a key or write a new key and write 1 to the
\code{authorized} file to get the new key stored on the device NVM.


\section{Upgrading NVM on Thunderbolt device or host}
\label{admin-guide/thunderbolt:upgrading-nvm-on-thunderbolt-device-or-host}
Since most of the functionality is handled in firmware running on a
host controller or a device, it is important that the firmware can be
upgraded to the latest where possible bugs in it have been fixed.
Typically OEMs provide this firmware from their support site.

There is also a central site which has links where to download firmware
for some machines:
\begin{quote}

\href{https://thunderbolttechnology.net/updates}{Thunderbolt Updates}
\end{quote}

Before you upgrade firmware on a device or host, please make sure it is a
suitable upgrade. Failing to do that may render the device (or host) in a
state where it cannot be used properly anymore without special tools!

Host NVM upgrade on Apple Macs is not supported.

Once the NVM image has been downloaded, you need to plug in a
Thunderbolt device so that the host controller appears. It does not
matter which device is connected (unless you are upgrading NVM on a
device - then you need to connect that particular device).

Note an OEM-specific method to power the controller up (``force power'') may
be available for your system in which case there is no need to plug in a
Thunderbolt device.

After that we can write the firmware to the non-active parts of the NVM
of the host or device. As an example here is how Intel NUC6i7KYK (Skull
Canyon) Thunderbolt controller NVM is upgraded:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} dd if=KYK\PYGZus{}TBT\PYGZus{}FW\PYGZus{}0018.bin of=/sys/bus/thunderbolt/devices/0\PYGZhy{}0/nvm\PYGZus{}non\PYGZus{}active0/nvmem
\end{Verbatim}

Once the operation completes we can trigger NVM authentication and
upgrade process as follows:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} echo 1 \PYGZgt{} /sys/bus/thunderbolt/devices/0\PYGZhy{}0/nvm\PYGZus{}authenticate
\end{Verbatim}

If no errors are returned, the host controller shortly disappears. Once
it comes back the driver notices it and initiates a full power cycle.
After a while the host controller appears again and this time it should
be fully functional.

We can verify that the new NVM firmware is active by running the following
commands:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} cat /sys/bus/thunderbolt/devices/0\PYGZhy{}0/nvm\PYGZus{}authenticate
0x0
\PYGZsh{} cat /sys/bus/thunderbolt/devices/0\PYGZhy{}0/nvm\PYGZus{}version
18.0
\end{Verbatim}

If \code{nvm\_authenticate} contains anything other than 0x0 it is the error
code from the last authentication cycle, which means the authentication
of the NVM image failed.

Note names of the NVMem devices \code{nvm\_activeN} and \code{nvm\_non\_activeN}
depend on the order they are registered in the NVMem subsystem. N in
the name is the identifier added by the NVMem subsystem.


\section{Upgrading NVM when host controller is in safe mode}
\label{admin-guide/thunderbolt:upgrading-nvm-when-host-controller-is-in-safe-mode}
If the existing NVM is not properly authenticated (or is missing) the
host controller goes into safe mode which means that the only available
functionality is flashing a new NVM image. When in this mode, reading
\code{nvm\_version} fails with \code{ENODATA} and the device identification
information is missing.

To recover from this mode, one needs to flash a valid NVM image to the
host controller in the same way it is done in the previous chapter.


\section{Networking over Thunderbolt cable}
\label{admin-guide/thunderbolt:networking-over-thunderbolt-cable}
Thunderbolt technology allows software communication between two hosts
connected by a Thunderbolt cable.

It is possible to tunnel any kind of traffic over a Thunderbolt link but
currently we only support Apple ThunderboltIP protocol.

If the other host is running Windows or macOS, the only thing you need to
do is to connect a Thunderbolt cable between the two hosts; the
\code{thunderbolt-net} driver is loaded automatically. If the other host is
also Linux you should load \code{thunderbolt-net} manually on one host (it
does not matter which one):

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} modprobe thunderbolt\PYGZhy{}net
\end{Verbatim}

This triggers module load on the other host automatically. If the driver
is built-in to the kernel image, there is no need to do anything.

The driver will create one virtual ethernet interface per Thunderbolt
port which are named like \code{thunderbolt0} and so on. From this point
you can either use standard userspace tools like \code{ifconfig} to
configure the interface or let your GUI handle it automatically.


\section{Forcing power}
\label{admin-guide/thunderbolt:forcing-power}
Many OEMs include a method that can be used to force the power of a
Thunderbolt controller to an ``On'' state even if nothing is connected.
If supported by your machine this will be exposed by the WMI bus with
a sysfs attribute called ``force\_power''.
\begin{description}
\item[{For example the intel-wmi-thunderbolt driver exposes this attribute in:}] \leavevmode
/sys/bus/wmi/devices/86CCFD48-205E-4A77-9C48-2021CBEDE341/force\_power

To force the power to on, write 1 to this attribute file.
To disable force power, write 0 to this attribute file.

\end{description}

Note: it's currently not possible to query the force power state of a platform.


\chapter{Linux Security Module Usage}
\label{admin-guide/LSM/index:linux-security-module-usage}\label{admin-guide/LSM/index::doc}
The Linux Security Module (LSM) framework provides a mechanism for
various security checks to be hooked by new kernel extensions. The name
``module'' is a bit of a misnomer since these extensions are not actually
loadable kernel modules. Instead, they are selectable at build-time via
CONFIG\_DEFAULT\_SECURITY and can be overridden at boot-time via the
\code{"security=..."} kernel command line argument, in the case where multiple
LSMs were built into a given kernel.

The primary users of the LSM interface are Mandatory Access Control
(MAC) extensions which provide a comprehensive security policy. Examples
include SELinux, Smack, Tomoyo, and AppArmor. In addition to the larger
MAC extensions, other extensions can be built using the LSM to provide
specific changes to system operation when these tweaks are not available
in the core functionality of Linux itself.

Without a specific LSM built into the kernel, the default LSM will be the
Linux capabilities system. Most LSMs choose to extend the capabilities
system, building their checks on top of the defined capability hooks.
For more details on capabilities, see \code{capabilities(7)} in the Linux
man-pages project.

A list of the active security modules can be found by reading
\code{/sys/kernel/security/lsm}. This is a comma separated list, and
will always include the capability module. The list reflects the
order in which checks are made. The capability module will always
be first, followed by any ``minor'' modules (e.g. Yama) and then
the one ``major'' module (e.g. SELinux) if there is one configured.


\section{AppArmor}
\label{admin-guide/LSM/apparmor::doc}\label{admin-guide/LSM/apparmor:apparmor}

\subsection{What is AppArmor?}
\label{admin-guide/LSM/apparmor:what-is-apparmor}
AppArmor is MAC style security extension for the Linux kernel.  It implements
a task centered policy, with task ``profiles'' being created and loaded
from user space.  Tasks on the system that do not have a profile defined for
them run in an unconfined state which is equivalent to standard Linux DAC
permissions.


\subsection{How to enable/disable}
\label{admin-guide/LSM/apparmor:how-to-enable-disable}
set \code{CONFIG\_SECURITY\_APPARMOR=y}

If AppArmor should be selected as the default security module then set:

\begin{Verbatim}[commandchars=\\\{\}]
CONFIG\PYGZus{}DEFAULT\PYGZus{}SECURITY=\PYGZdq{}apparmor\PYGZdq{}
CONFIG\PYGZus{}SECURITY\PYGZus{}APPARMOR\PYGZus{}BOOTPARAM\PYGZus{}VALUE=1
\end{Verbatim}

Build the kernel

If AppArmor is not the default security module it can be enabled by passing
\code{security=apparmor} on the kernel's command line.

If AppArmor is the default security module it can be disabled by passing
\code{apparmor=0, security=XXXX} (where \code{XXXX} is valid security module), on the
kernel's command line.

For AppArmor to enforce any restrictions beyond standard Linux DAC permissions
policy must be loaded into the kernel from user space (see the Documentation
and tools links).


\subsection{Documentation}
\label{admin-guide/LSM/apparmor:documentation}
Documentation can be found on the wiki, linked below.


\subsection{Links}
\label{admin-guide/LSM/apparmor:links}
Mailing List - \href{mailto:apparmor@lists.ubuntu.com}{apparmor@lists.ubuntu.com}

Wiki - \href{http://apparmor.wiki.kernel.org/}{http://apparmor.wiki.kernel.org/}

User space tools - \href{https://launchpad.net/apparmor}{https://launchpad.net/apparmor}

Kernel module - git://git.kernel.org/pub/scm/linux/kernel/git/jj/apparmor-dev.git


\section{LoadPin}
\label{admin-guide/LSM/LoadPin::doc}\label{admin-guide/LSM/LoadPin:loadpin}
LoadPin is a Linux Security Module that ensures all kernel-loaded files
(modules, firmware, etc) all originate from the same filesystem, with
the expectation that such a filesystem is backed by a read-only device
such as dm-verity or CDROM. This allows systems that have a verified
and/or unchangeable filesystem to enforce module and firmware loading
restrictions without needing to sign the files individually.

The LSM is selectable at build-time with \code{CONFIG\_SECURITY\_LOADPIN}, and
can be controlled at boot-time with the kernel command line option
``\code{loadpin.enabled}''. By default, it is enabled, but can be disabled at
boot (``\code{loadpin.enabled=0}'').

LoadPin starts pinning when it sees the first file loaded. If the
block device backing the filesystem is not read-only, a sysctl is
created to toggle pinning: \code{/proc/sys/kernel/loadpin/enabled}. (Having
a mutable filesystem means pinning is mutable too, but having the
sysctl allows for easy testing on systems with a mutable filesystem.)


\section{SELinux}
\label{admin-guide/LSM/SELinux:selinux}\label{admin-guide/LSM/SELinux::doc}
If you want to use SELinux, chances are you will want
to use the distro-provided policies, or install the
latest reference policy release from
\begin{quote}

\href{http://oss.tresys.com/projects/refpolicy}{http://oss.tresys.com/projects/refpolicy}
\end{quote}

However, if you want to install a dummy policy for
testing, you can do using \code{mdp} provided under
scripts/selinux.  Note that this requires the selinux
userspace to be installed - in particular you will
need checkpolicy to compile a kernel, and setfiles and
fixfiles to label the filesystem.
\begin{enumerate}
\item {} 
Compile the kernel with selinux enabled.

\item {} 
Type \code{make} to compile \code{mdp}.

\item {} 
Make sure that you are not running with
SELinux enabled and a real policy.  If
you are, reboot with selinux disabled
before continuing.

\item {} 
Run install\_policy.sh:

\begin{Verbatim}[commandchars=\\\{\}]
cd scripts/selinux
sh install\PYGZus{}policy.sh
\end{Verbatim}

\end{enumerate}

Step 4 will create a new dummy policy valid for your
kernel, with a single selinux user, role, and type.
It will compile the policy, will set your \code{SELINUXTYPE} to
\code{dummy} in \code{/etc/selinux/config}, install the compiled policy
as \code{dummy}, and relabel your filesystem.


\section{Smack}
\label{admin-guide/LSM/Smack:smack}\label{admin-guide/LSM/Smack::doc}\begin{quote}

``Good for you, you've decided to clean the elevator!''
- The Elevator, from Dark Star
\end{quote}

Smack is the Simplified Mandatory Access Control Kernel.
Smack is a kernel based implementation of mandatory access
control that includes simplicity in its primary design goals.

Smack is not the only Mandatory Access Control scheme
available for Linux. Those new to Mandatory Access Control
are encouraged to compare Smack with the other mechanisms
available to determine which is best suited to the problem
at hand.

Smack consists of three major components:
\begin{itemize}
\item {} 
The kernel

\item {} 
Basic utilities, which are helpful but not required

\item {} 
Configuration data

\end{itemize}

The kernel component of Smack is implemented as a Linux
Security Modules (LSM) module. It requires netlabel and
works best with file systems that support extended attributes,
although xattr support is not strictly required.
It is safe to run a Smack kernel under a ``vanilla'' distribution.

Smack kernels use the CIPSO IP option. Some network
configurations are intolerant of IP options and can impede
access to systems that use them as Smack does.

Smack is used in the Tizen operating system. Please
go to \href{http://wiki.tizen.org}{http://wiki.tizen.org} for information about how
Smack is used in Tizen.

The current git repository for Smack user space is:
\begin{quote}

git://github.com/smack-team/smack.git
\end{quote}

This should make and install on most modern distributions.
There are five commands included in smackutil:
\begin{description}
\item[{chsmack:}] \leavevmode
display or set Smack extended attribute values

\item[{smackctl:}] \leavevmode
load the Smack access rules

\item[{smackaccess:}] \leavevmode
report if a process with one label has access
to an object with another

\end{description}

These two commands are obsolete with the introduction of
the smackfs/load2 and smackfs/cipso2 interfaces.
\begin{description}
\item[{smackload:}] \leavevmode
properly formats data for writing to smackfs/load

\item[{smackcipso:}] \leavevmode
properly formats data for writing to smackfs/cipso

\end{description}

In keeping with the intent of Smack, configuration data is
minimal and not strictly required. The most important
configuration step is mounting the smackfs pseudo filesystem.
If smackutil is installed the startup script will take care
of this, but it can be manually as well.

Add this line to \code{/etc/fstab}:

\begin{Verbatim}[commandchars=\\\{\}]
smackfs /sys/fs/smackfs smackfs defaults 0 0
\end{Verbatim}

The \code{/sys/fs/smackfs} directory is created by the kernel.

Smack uses extended attributes (xattrs) to store labels on filesystem
objects. The attributes are stored in the extended attribute security
name space. A process must have \code{CAP\_MAC\_ADMIN} to change any of these
attributes.

The extended attributes that Smack uses are:
\begin{description}
\item[{SMACK64}] \leavevmode
Used to make access control decisions. In almost all cases
the label given to a new filesystem object will be the label
of the process that created it.

\item[{SMACK64EXEC}] \leavevmode
The Smack label of a process that execs a program file with
this attribute set will run with this attribute's value.

\item[{SMACK64MMAP}] \leavevmode
Don't allow the file to be mmapped by a process whose Smack
label does not allow all of the access permitted to a process
with the label contained in this attribute. This is a very
specific use case for shared libraries.

\item[{SMACK64TRANSMUTE}] \leavevmode
Can only have the value ``TRUE''. If this attribute is present
on a directory when an object is created in the directory and
the Smack rule (more below) that permitted the write access
to the directory includes the transmute (``t'') mode the object
gets the label of the directory instead of the label of the
creating process. If the object being created is a directory
the SMACK64TRANSMUTE attribute is set as well.

\item[{SMACK64IPIN}] \leavevmode
This attribute is only available on file descriptors for sockets.
Use the Smack label in this attribute for access control
decisions on packets being delivered to this socket.

\item[{SMACK64IPOUT}] \leavevmode
This attribute is only available on file descriptors for sockets.
Use the Smack label in this attribute for access control
decisions on packets coming from this socket.

\end{description}

There are multiple ways to set a Smack label on a file:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZsh{} attr \PYGZhy{}S \PYGZhy{}s SMACK64 \PYGZhy{}V \PYGZdq{}value\PYGZdq{} path
\PYGZsh{} chsmack \PYGZhy{}a value path
\end{Verbatim}

A process can see the Smack label it is running with by
reading \code{/proc/self/attr/current}. A process with \code{CAP\_MAC\_ADMIN}
can set the process Smack by writing there.

Most Smack configuration is accomplished by writing to files
in the smackfs filesystem. This pseudo-filesystem is mounted
on \code{/sys/fs/smackfs}.
\begin{description}
\item[{access}] \leavevmode
Provided for backward compatibility. The access2 interface
is preferred and should be used instead.
This interface reports whether a subject with the specified
Smack label has a particular access to an object with a
specified Smack label. Write a fixed format access rule to
this file. The next read will indicate whether the access
would be permitted. The text will be either ``1'' indicating
access, or ``0'' indicating denial.

\item[{access2}] \leavevmode
This interface reports whether a subject with the specified
Smack label has a particular access to an object with a
specified Smack label. Write a long format access rule to
this file. The next read will indicate whether the access
would be permitted. The text will be either ``1'' indicating
access, or ``0'' indicating denial.

\item[{ambient}] \leavevmode
This contains the Smack label applied to unlabeled network
packets.

\item[{change-rule}] \leavevmode
This interface allows modification of existing access control rules.
The format accepted on write is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}\PYGZpc{}s \PYGZpc{}s \PYGZpc{}s \PYGZpc{}s\PYGZdq{}
\end{Verbatim}

where the first string is the subject label, the second the
object label, the third the access to allow and the fourth the
access to deny. The access strings may contain only the characters
``rwxat-''. If a rule for a given subject and object exists it will be
modified by enabling the permissions in the third string and disabling
those in the fourth string. If there is no such rule it will be
created using the access specified in the third and the fourth strings.

\item[{cipso}] \leavevmode
Provided for backward compatibility. The cipso2 interface
is preferred and should be used instead.
This interface allows a specific CIPSO header to be assigned
to a Smack label. The format accepted on write is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}\PYGZpc{}24s\PYGZpc{}4d\PYGZpc{}4d\PYGZdq{}[\PYGZdq{}\PYGZpc{}4d\PYGZdq{}]...
\end{Verbatim}

The first string is a fixed Smack label. The first number is
the level to use. The second number is the number of categories.
The following numbers are the categories:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}level\PYGZhy{}3\PYGZhy{}cats\PYGZhy{}5\PYGZhy{}19          3   2   5  19\PYGZdq{}
\end{Verbatim}

\item[{cipso2}] \leavevmode
This interface allows a specific CIPSO header to be assigned
to a Smack label. The format accepted on write is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}\PYGZpc{}s\PYGZpc{}4d\PYGZpc{}4d\PYGZdq{}[\PYGZdq{}\PYGZpc{}4d\PYGZdq{}]...
\end{Verbatim}

The first string is a long Smack label. The first number is
the level to use. The second number is the number of categories.
The following numbers are the categories:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}level\PYGZhy{}3\PYGZhy{}cats\PYGZhy{}5\PYGZhy{}19   3   2   5  19\PYGZdq{}
\end{Verbatim}

\item[{direct}] \leavevmode
This contains the CIPSO level used for Smack direct label
representation in network packets.

\item[{doi}] \leavevmode
This contains the CIPSO domain of interpretation used in
network packets.

\item[{ipv6host}] \leavevmode
This interface allows specific IPv6 internet addresses to be
treated as single label hosts. Packets are sent to single
label hosts only from processes that have Smack write access
to the host label. All packets received from single label hosts
are given the specified label. The format accepted on write is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h label\PYGZdq{} or
\PYGZdq{}\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h:\PYGZpc{}h/\PYGZpc{}d label\PYGZdq{}.
\end{Verbatim}

The ''::'' address shortcut is not supported.
If label is ``-DELETE'' a matched entry will be deleted.

\item[{load}] \leavevmode
Provided for backward compatibility. The load2 interface
is preferred and should be used instead.
This interface allows access control rules in addition to
the system defined rules to be specified. The format accepted
on write is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}\PYGZpc{}24s\PYGZpc{}24s\PYGZpc{}5s\PYGZdq{}
\end{Verbatim}

where the first string is the subject label, the second the
object label, and the third the requested access. The access
string may contain only the characters ``rwxat-'', and specifies
which sort of access is allowed. The ``-'' is a placeholder for
permissions that are not allowed. The string ``r-x--'' would
specify read and execute access. Labels are limited to 23
characters in length.

\item[{load2}] \leavevmode
This interface allows access control rules in addition to
the system defined rules to be specified. The format accepted
on write is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}\PYGZpc{}s \PYGZpc{}s \PYGZpc{}s\PYGZdq{}
\end{Verbatim}

where the first string is the subject label, the second the
object label, and the third the requested access. The access
string may contain only the characters ``rwxat-'', and specifies
which sort of access is allowed. The ``-'' is a placeholder for
permissions that are not allowed. The string ``r-x--'' would
specify read and execute access.

\item[{load-self}] \leavevmode
Provided for backward compatibility. The load-self2 interface
is preferred and should be used instead.
This interface allows process specific access rules to be
defined. These rules are only consulted if access would
otherwise be permitted, and are intended to provide additional
restrictions on the process. The format is the same as for
the load interface.

\item[{load-self2}] \leavevmode
This interface allows process specific access rules to be
defined. These rules are only consulted if access would
otherwise be permitted, and are intended to provide additional
restrictions on the process. The format is the same as for
the load2 interface.

\item[{logging}] \leavevmode
This contains the Smack logging state.

\item[{mapped}] \leavevmode
This contains the CIPSO level used for Smack mapped label
representation in network packets.

\item[{netlabel}] \leavevmode
This interface allows specific internet addresses to be
treated as single label hosts. Packets are sent to single
label hosts without CIPSO headers, but only from processes
that have Smack write access to the host label. All packets
received from single label hosts are given the specified
label. The format accepted on write is:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZdq{}\PYGZpc{}d.\PYGZpc{}d.\PYGZpc{}d.\PYGZpc{}d label\PYGZdq{} or \PYGZdq{}\PYGZpc{}d.\PYGZpc{}d.\PYGZpc{}d.\PYGZpc{}d/\PYGZpc{}d label\PYGZdq{}.
\end{Verbatim}

If the label specified is ``-CIPSO'' the address is treated
as a host that supports CIPSO headers.

\item[{onlycap}] \leavevmode
This contains labels processes must have for CAP\_MAC\_ADMIN
and \code{CAP\_MAC\_OVERRIDE} to be effective. If this file is empty
these capabilities are effective at for processes with any
label. The values are set by writing the desired labels, separated
by spaces, to the file or cleared by writing ``-'' to the file.

\item[{ptrace}] \leavevmode
This is used to define the current ptrace policy
\begin{description}
\item[{0 - default:}] \leavevmode
this is the policy that relies on Smack access rules.
For the \code{PTRACE\_READ} a subject needs to have a read access on
object. For the \code{PTRACE\_ATTACH} a read-write access is required.

\item[{1 - exact:}] \leavevmode
this is the policy that limits \code{PTRACE\_ATTACH}. Attach is
only allowed when subject's and object's labels are equal.
\code{PTRACE\_READ} is not affected. Can be overridden with \code{CAP\_SYS\_PTRACE}.

\item[{2 - draconian:}] \leavevmode
this policy behaves like the `exact' above with an
exception that it can't be overridden with \code{CAP\_SYS\_PTRACE}.

\end{description}

\item[{revoke-subject}] \leavevmode
Writing a Smack label here sets the access to `-` for all access
rules with that subject label.

\item[{unconfined}] \leavevmode
If the kernel is configured with \code{CONFIG\_SECURITY\_SMACK\_BRINGUP}
a process with \code{CAP\_MAC\_ADMIN} can write a label into this interface.
Thereafter, accesses that involve that label will be logged and
the access permitted if it wouldn't be otherwise. Note that this
is dangerous and can ruin the proper labeling of your system.
It should never be used in production.

\item[{relabel-self}] \leavevmode
This interface contains a list of labels to which the process can
transition to, by writing to \code{/proc/self/attr/current}.
Normally a process can change its own label to any legal value, but only
if it has \code{CAP\_MAC\_ADMIN}. This interface allows a process without
\code{CAP\_MAC\_ADMIN} to relabel itself to one of labels from predefined list.
A process without \code{CAP\_MAC\_ADMIN} can change its label only once. When it
does, this list will be cleared.
The values are set by writing the desired labels, separated
by spaces, to the file or cleared by writing ``-'' to the file.

\end{description}

If you are using the smackload utility
you can add access rules in \code{/etc/smack/accesses}. They take the form:

\begin{Verbatim}[commandchars=\\\{\}]
subjectlabel objectlabel access
\end{Verbatim}

access is a combination of the letters rwxatb which specify the
kind of access permitted a subject with subjectlabel on an
object with objectlabel. If there is no rule no access is allowed.

Look for additional programs on \href{http://schaufler-ca.com}{http://schaufler-ca.com}


\subsection{The Simplified Mandatory Access Control Kernel (Whitepaper)}
\label{admin-guide/LSM/Smack:the-simplified-mandatory-access-control-kernel-whitepaper}
Casey Schaufler
\href{mailto:casey@schaufler-ca.com}{casey@schaufler-ca.com}


\subsubsection{Mandatory Access Control}
\label{admin-guide/LSM/Smack:mandatory-access-control}
Computer systems employ a variety of schemes to constrain how information is
shared among the people and services using the machine. Some of these schemes
allow the program or user to decide what other programs or users are allowed
access to pieces of data. These schemes are called discretionary access
control mechanisms because the access control is specified at the discretion
of the user. Other schemes do not leave the decision regarding what a user or
program can access up to users or programs. These schemes are called mandatory
access control mechanisms because you don't have a choice regarding the users
or programs that have access to pieces of data.


\subsubsection{Bell \& LaPadula}
\label{admin-guide/LSM/Smack:bell-lapadula}
From the middle of the 1980's until the turn of the century Mandatory Access
Control (MAC) was very closely associated with the Bell \& LaPadula security
model, a mathematical description of the United States Department of Defense
policy for marking paper documents. MAC in this form enjoyed a following
within the Capital Beltway and Scandinavian supercomputer centers but was
often sited as failing to address general needs.


\subsubsection{Domain Type Enforcement}
\label{admin-guide/LSM/Smack:domain-type-enforcement}
Around the turn of the century Domain Type Enforcement (DTE) became popular.
This scheme organizes users, programs, and data into domains that are
protected from each other. This scheme has been widely deployed as a component
of popular Linux distributions. The administrative overhead required to
maintain this scheme and the detailed understanding of the whole system
necessary to provide a secure domain mapping leads to the scheme being
disabled or used in limited ways in the majority of cases.


\subsubsection{Smack}
\label{admin-guide/LSM/Smack:id1}
Smack is a Mandatory Access Control mechanism designed to provide useful MAC
while avoiding the pitfalls of its predecessors. The limitations of Bell \&
LaPadula are addressed by providing a scheme whereby access can be controlled
according to the requirements of the system and its purpose rather than those
imposed by an arcane government policy. The complexity of Domain Type
Enforcement and avoided by defining access controls in terms of the access
modes already in use.


\subsubsection{Smack Terminology}
\label{admin-guide/LSM/Smack:smack-terminology}
The jargon used to talk about Smack will be familiar to those who have dealt
with other MAC systems and shouldn't be too difficult for the uninitiated to
pick up. There are four terms that are used in a specific way and that are
especially important:
\begin{quote}
\begin{description}
\item[{Subject:}] \leavevmode
A subject is an active entity on the computer system.
On Smack a subject is a task, which is in turn the basic unit
of execution.

\item[{Object:}] \leavevmode
An object is a passive entity on the computer system.
On Smack files of all types, IPC, and tasks can be objects.

\item[{Access:}] \leavevmode
Any attempt by a subject to put information into or get
information from an object is an access.

\item[{Label:}] \leavevmode
Data that identifies the Mandatory Access Control
characteristics of a subject or an object.

\end{description}
\end{quote}

These definitions are consistent with the traditional use in the security
community. There are also some terms from Linux that are likely to crop up:
\begin{quote}
\begin{description}
\item[{Capability:}] \leavevmode
A task that possesses a capability has permission to
violate an aspect of the system security policy, as identified by
the specific capability. A task that possesses one or more
capabilities is a privileged task, whereas a task with no
capabilities is an unprivileged task.

\item[{Privilege:}] \leavevmode
A task that is allowed to violate the system security
policy is said to have privilege. As of this writing a task can
have privilege either by possessing capabilities or by having an
effective user of root.

\end{description}
\end{quote}


\subsubsection{Smack Basics}
\label{admin-guide/LSM/Smack:smack-basics}
Smack is an extension to a Linux system. It enforces additional restrictions
on what subjects can access which objects, based on the labels attached to
each of the subject and the object.


\paragraph{Labels}
\label{admin-guide/LSM/Smack:labels}
Smack labels are ASCII character strings. They can be up to 255 characters
long, but keeping them to twenty-three characters is recommended.
Single character labels using special characters, that being anything
other than a letter or digit, are reserved for use by the Smack development
team. Smack labels are unstructured, case sensitive, and the only operation
ever performed on them is comparison for equality. Smack labels cannot
contain unprintable characters, the ``/'' (slash), the ``'' (backslash), the ``'''
(quote) and `''' (double-quote) characters.
Smack labels cannot begin with a `-`. This is reserved for special options.

There are some predefined labels:

\begin{Verbatim}[commandchars=\\\{\}]
\PYGZus{}       Pronounced \PYGZdq{}floor\PYGZdq{}, a single underscore character.
\PYGZca{}       Pronounced \PYGZdq{}hat\PYGZdq{}, a single circumflex character.
*       Pronounced \PYGZdq{}star\PYGZdq{}, a single asterisk character.
?       Pronounced \PYGZdq{}huh\PYGZdq{}, a single question mark character.
@       Pronounced \PYGZdq{}web\PYGZdq{}, a single at sign character.
\end{Verbatim}

Every task on a Smack system is assigned a label. The Smack label
of a process will usually be assigned by the system initialization
mechanism.


\paragraph{Access Rules}
\label{admin-guide/LSM/Smack:access-rules}
Smack uses the traditional access modes of Linux. These modes are read,
execute, write, and occasionally append. There are a few cases where the
access mode may not be obvious. These include:
\begin{quote}
\begin{description}
\item[{Signals:}] \leavevmode
A signal is a write operation from the subject task to
the object task.

\item[{Internet Domain IPC:}] \leavevmode
Transmission of a packet is considered a
write operation from the source task to the destination task.

\end{description}
\end{quote}

Smack restricts access based on the label attached to a subject and the label
attached to the object it is trying to access. The rules enforced are, in
order:
\begin{enumerate}
\item {} 
Any access requested by a task labeled ``*'' is denied.

\item {} 
A read or execute access requested by a task labeled ``\textasciicircum{}''
is permitted.

\item {} 
A read or execute access requested on an object labeled ``\_''
is permitted.

\item {} 
Any access requested on an object labeled ``*'' is permitted.

\item {} 
Any access requested by a task on an object with the same
label is permitted.

\item {} 
Any access requested that is explicitly defined in the loaded
rule set is permitted.

\item {} 
Any other access is denied.

\end{enumerate}


\paragraph{Smack Access Rules}
\label{admin-guide/LSM/Smack:smack-access-rules}
With the isolation provided by Smack access separation is simple. There are
many interesting cases where limited access by subjects to objects with
different labels is desired. One example is the familiar spy model of
sensitivity, where a scientist working on a highly classified project would be
able to read documents of lower classifications and anything she writes will
be ``born'' highly classified. To accommodate such schemes Smack includes a
mechanism for specifying rules allowing access between labels.


\paragraph{Access Rule Format}
\label{admin-guide/LSM/Smack:access-rule-format}
The format of an access rule is:

\begin{Verbatim}[commandchars=\\\{\}]
subject\PYGZhy{}label object\PYGZhy{}label access
\end{Verbatim}

Where subject-label is the Smack label of the task, object-label is the Smack
label of the thing being accessed, and access is a string specifying the sort
of access allowed. The access specification is searched for letters that
describe access modes:
\begin{quote}

a: indicates that append access should be granted.
r: indicates that read access should be granted.
w: indicates that write access should be granted.
x: indicates that execute access should be granted.
t: indicates that the rule requests transmutation.
b: indicates that the rule should be reported for bring-up.
\end{quote}

Uppercase values for the specification letters are allowed as well.
Access mode specifications can be in any order. Examples of acceptable rules
are:

\begin{Verbatim}[commandchars=\\\{\}]
TopSecret Secret  rx
Secret    Unclass R
Manager   Game    x
User      HR      w
Snap      Crackle rwxatb
New       Old     rRrRr
Closed    Off     \PYGZhy{}
\end{Verbatim}

Examples of unacceptable rules are:

\begin{Verbatim}[commandchars=\\\{\}]
Top Secret Secret     rx
Ace        Ace        r
Odd        spells     waxbeans
\end{Verbatim}

Spaces are not allowed in labels. Since a subject always has access to files
with the same label specifying a rule for that case is pointless. Only
valid letters (rwxatbRWXATB) and the dash (`-`) character are allowed in
access specifications. The dash is a placeholder, so ``a-r'' is the same
as ``ar''. A lone dash is used to specify that no access should be allowed.


\paragraph{Applying Access Rules}
\label{admin-guide/LSM/Smack:applying-access-rules}
The developers of Linux rarely define new sorts of things, usually importing
schemes and concepts from other systems. Most often, the other systems are
variants of Unix. Unix has many endearing properties, but consistency of
access control models is not one of them. Smack strives to treat accesses as
uniformly as is sensible while keeping with the spirit of the underlying
mechanism.

File system objects including files, directories, named pipes, symbolic links,
and devices require access permissions that closely match those used by mode
bit access. To open a file for reading read access is required on the file. To
search a directory requires execute access. Creating a file with write access
requires both read and write access on the containing directory. Deleting a
file requires read and write access to the file and to the containing
directory. It is possible that a user may be able to see that a file exists
but not any of its attributes by the circumstance of having read access to the
containing directory but not to the differently labeled file. This is an
artifact of the file name being data in the directory, not a part of the file.

If a directory is marked as transmuting (SMACK64TRANSMUTE=TRUE) and the
access rule that allows a process to create an object in that directory
includes `t' access the label assigned to the new object will be that
of the directory, not the creating process. This makes it much easier
for two processes with different labels to share data without granting
access to all of their files.

IPC objects, message queues, semaphore sets, and memory segments exist in flat
namespaces and access requests are only required to match the object in
question.

Process objects reflect tasks on the system and the Smack label used to access
them is the same Smack label that the task would use for its own access
attempts. Sending a signal via the kill() system call is a write operation
from the signaler to the recipient. Debugging a process requires both reading
and writing. Creating a new task is an internal operation that results in two
tasks with identical Smack labels and requires no access checks.

Sockets are data structures attached to processes and sending a packet from
one process to another requires that the sender have write access to the
receiver. The receiver is not required to have read access to the sender.


\paragraph{Setting Access Rules}
\label{admin-guide/LSM/Smack:setting-access-rules}
The configuration file /etc/smack/accesses contains the rules to be set at
system startup. The contents are written to the special file
/sys/fs/smackfs/load2. Rules can be added at any time and take effect
immediately. For any pair of subject and object labels there can be only
one rule, with the most recently specified overriding any earlier
specification.


\paragraph{Task Attribute}
\label{admin-guide/LSM/Smack:task-attribute}
The Smack label of a process can be read from /proc/\textless{}pid\textgreater{}/attr/current. A
process can read its own Smack label from /proc/self/attr/current. A
privileged process can change its own Smack label by writing to
/proc/self/attr/current but not the label of another process.


\paragraph{File Attribute}
\label{admin-guide/LSM/Smack:file-attribute}
The Smack label of a filesystem object is stored as an extended attribute
named SMACK64 on the file. This attribute is in the security namespace. It can
only be changed by a process with privilege.


\paragraph{Privilege}
\label{admin-guide/LSM/Smack:privilege}
A process with CAP\_MAC\_OVERRIDE or CAP\_MAC\_ADMIN is privileged.
CAP\_MAC\_OVERRIDE allows the process access to objects it would
be denied otherwise. CAP\_MAC\_ADMIN allows a process to change
Smack data, including rules and attributes.


\paragraph{Smack Networking}
\label{admin-guide/LSM/Smack:smack-networking}
As mentioned before, Smack enforces access control on network protocol
transmissions. Every packet sent by a Smack process is tagged with its Smack
label. This is done by adding a CIPSO tag to the header of the IP packet. Each
packet received is expected to have a CIPSO tag that identifies the label and
if it lacks such a tag the network ambient label is assumed. Before the packet
is delivered a check is made to determine that a subject with the label on the
packet has write access to the receiving process and if that is not the case
the packet is dropped.


\paragraph{CIPSO Configuration}
\label{admin-guide/LSM/Smack:cipso-configuration}
It is normally unnecessary to specify the CIPSO configuration. The default
values used by the system handle all internal cases. Smack will compose CIPSO
label values to match the Smack labels being used without administrative
intervention. Unlabeled packets that come into the system will be given the
ambient label.

Smack requires configuration in the case where packets from a system that is
not Smack that speaks CIPSO may be encountered. Usually this will be a Trusted
Solaris system, but there are other, less widely deployed systems out there.
CIPSO provides 3 important values, a Domain Of Interpretation (DOI), a level,
and a category set with each packet. The DOI is intended to identify a group
of systems that use compatible labeling schemes, and the DOI specified on the
Smack system must match that of the remote system or packets will be
discarded. The DOI is 3 by default. The value can be read from
/sys/fs/smackfs/doi and can be changed by writing to /sys/fs/smackfs/doi.

The label and category set are mapped to a Smack label as defined in
/etc/smack/cipso.

A Smack/CIPSO mapping has the form:

\begin{Verbatim}[commandchars=\\\{\}]
smack level [category [category]*]
\end{Verbatim}

Smack does not expect the level or category sets to be related in any
particular way and does not assume or assign accesses based on them. Some
examples of mappings:

\begin{Verbatim}[commandchars=\\\{\}]
TopSecret 7
TS:A,B    7 1 2
SecBDE    5 2 4 6
RAFTERS   7 12 26
\end{Verbatim}

The '':'' and '','' characters are permitted in a Smack label but have no special
meaning.

The mapping of Smack labels to CIPSO values is defined by writing to
/sys/fs/smackfs/cipso2.

In addition to explicit mappings Smack supports direct CIPSO mappings. One
CIPSO level is used to indicate that the category set passed in the packet is
in fact an encoding of the Smack label. The level used is 250 by default. The
value can be read from /sys/fs/smackfs/direct and changed by writing to
/sys/fs/smackfs/direct.


\paragraph{Socket Attributes}
\label{admin-guide/LSM/Smack:socket-attributes}
There are two attributes that are associated with sockets. These attributes
can only be set by privileged tasks, but any task can read them for their own
sockets.
\begin{quote}
\begin{description}
\item[{SMACK64IPIN:}] \leavevmode
The Smack label of the task object. A privileged
program that will enforce policy may set this to the star label.

\item[{SMACK64IPOUT:}] \leavevmode
The Smack label transmitted with outgoing packets.
A privileged program may set this to match the label of another
task with which it hopes to communicate.

\end{description}
\end{quote}


\paragraph{Smack Netlabel Exceptions}
\label{admin-guide/LSM/Smack:smack-netlabel-exceptions}
You will often find that your labeled application has to talk to the outside,
unlabeled world. To do this there's a special file /sys/fs/smackfs/netlabel
where you can add some exceptions in the form of:

\begin{Verbatim}[commandchars=\\\{\}]
@IP1       LABEL1 or
@IP2/MASK  LABEL2
\end{Verbatim}

It means that your application will have unlabeled access to @IP1 if it has
write access on LABEL1, and access to the subnet @IP2/MASK if it has write
access on LABEL2.

Entries in the /sys/fs/smackfs/netlabel file are matched by longest mask
first, like in classless IPv4 routing.

A special label `@' and an option `-CIPSO' can be used there:

\begin{Verbatim}[commandchars=\\\{\}]
@      means Internet, any application with any label has access to it
\PYGZhy{}CIPSO means standard CIPSO networking
\end{Verbatim}

If you don't know what CIPSO is and don't plan to use it, you can just do:

\begin{Verbatim}[commandchars=\\\{\}]
echo 127.0.0.1 \PYGZhy{}CIPSO \PYGZgt{} /sys/fs/smackfs/netlabel
echo 0.0.0.0/0 @      \PYGZgt{} /sys/fs/smackfs/netlabel
\end{Verbatim}

If you use CIPSO on your 192.168.0.0/16 local network and need also unlabeled
Internet access, you can have:

\begin{Verbatim}[commandchars=\\\{\}]
echo 127.0.0.1      \PYGZhy{}CIPSO \PYGZgt{} /sys/fs/smackfs/netlabel
echo 192.168.0.0/16 \PYGZhy{}CIPSO \PYGZgt{} /sys/fs/smackfs/netlabel
echo 0.0.0.0/0      @      \PYGZgt{} /sys/fs/smackfs/netlabel
\end{Verbatim}


\subsubsection{Writing Applications for Smack}
\label{admin-guide/LSM/Smack:writing-applications-for-smack}
There are three sorts of applications that will run on a Smack system. How an
application interacts with Smack will determine what it will have to do to
work properly under Smack.


\subsubsection{Smack Ignorant Applications}
\label{admin-guide/LSM/Smack:smack-ignorant-applications}
By far the majority of applications have no reason whatever to care about the
unique properties of Smack. Since invoking a program has no impact on the
Smack label associated with the process the only concern likely to arise is
whether the process has execute access to the program.


\subsubsection{Smack Relevant Applications}
\label{admin-guide/LSM/Smack:smack-relevant-applications}
Some programs can be improved by teaching them about Smack, but do not make
any security decisions themselves. The utility ls(1) is one example of such a
program.


\subsubsection{Smack Enforcing Applications}
\label{admin-guide/LSM/Smack:smack-enforcing-applications}
These are special programs that not only know about Smack, but participate in
the enforcement of system policy. In most cases these are the programs that
set up user sessions. There are also network services that provide information
to processes running with various labels.


\subsubsection{File System Interfaces}
\label{admin-guide/LSM/Smack:file-system-interfaces}
Smack maintains labels on file system objects using extended attributes. The
Smack label of a file, directory, or other file system object can be obtained
using getxattr(2):

\begin{Verbatim}[commandchars=\\\{\}]
len = getxattr(\PYGZdq{}/\PYGZdq{}, \PYGZdq{}security.SMACK64\PYGZdq{}, value, sizeof (value));
\end{Verbatim}

will put the Smack label of the root directory into value. A privileged
process can set the Smack label of a file system object with setxattr(2):

\begin{Verbatim}[commandchars=\\\{\}]
len = strlen(\PYGZdq{}Rubble\PYGZdq{});
rc = setxattr(\PYGZdq{}/foo\PYGZdq{}, \PYGZdq{}security.SMACK64\PYGZdq{}, \PYGZdq{}Rubble\PYGZdq{}, len, 0);
\end{Verbatim}

will set the Smack label of /foo to ``Rubble'' if the program has appropriate
privilege.


\subsubsection{Socket Interfaces}
\label{admin-guide/LSM/Smack:socket-interfaces}
The socket attributes can be read using fgetxattr(2).

A privileged process can set the Smack label of outgoing packets with
fsetxattr(2):

\begin{Verbatim}[commandchars=\\\{\}]
len = strlen(\PYGZdq{}Rubble\PYGZdq{});
rc = fsetxattr(fd, \PYGZdq{}security.SMACK64IPOUT\PYGZdq{}, \PYGZdq{}Rubble\PYGZdq{}, len, 0);
\end{Verbatim}

will set the Smack label ``Rubble'' on packets going out from the socket if the
program has appropriate privilege:

\begin{Verbatim}[commandchars=\\\{\}]
rc = fsetxattr(fd, \PYGZdq{}security.SMACK64IPIN, \PYGZdq{}*\PYGZdq{}, strlen(\PYGZdq{}*\PYGZdq{}), 0);
\end{Verbatim}

will set the Smack label ``*'' as the object label against which incoming
packets will be checked if the program has appropriate privilege.


\subsubsection{Administration}
\label{admin-guide/LSM/Smack:administration}
Smack supports some mount options:
\begin{quote}
\begin{description}
\item[{smackfsdef=label:}] \leavevmode
specifies the label to give files that lack
the Smack label extended attribute.

\item[{smackfsroot=label:}] \leavevmode
specifies the label to assign the root of the
file system if it lacks the Smack extended attribute.

\item[{smackfshat=label:}] \leavevmode
specifies a label that must have read access to
all labels set on the filesystem. Not yet enforced.

\item[{smackfsfloor=label:}] \leavevmode
specifies a label to which all labels set on the
filesystem must have read access. Not yet enforced.

\end{description}
\end{quote}

These mount options apply to all file system types.


\subsubsection{Smack auditing}
\label{admin-guide/LSM/Smack:smack-auditing}
If you want Smack auditing of security events, you need to set CONFIG\_AUDIT
in your kernel configuration.
By default, all denied events will be audited. You can change this behavior by
writing a single character to the /sys/fs/smackfs/logging file:

\begin{Verbatim}[commandchars=\\\{\}]
0 : no logging
1 : log denied (default)
2 : log accepted
3 : log denied \PYGZam{} accepted
\end{Verbatim}

Events are logged as `key=value' pairs, for each event you at least will get
the subject, the object, the rights requested, the action, the kernel function
that triggered the event, plus other pairs depending on the type of event
audited.


\subsubsection{Bringup Mode}
\label{admin-guide/LSM/Smack:bringup-mode}
Bringup mode provides logging features that can make application
configuration and system bringup easier. Configure the kernel with
CONFIG\_SECURITY\_SMACK\_BRINGUP to enable these features. When bringup
mode is enabled accesses that succeed due to rules marked with the ``b''
access mode will logged. When a new label is introduced for processes
rules can be added aggressively, marked with the ``b''. The logging allows
tracking of which rules actual get used for that label.

Another feature of bringup mode is the ``unconfined'' option. Writing
a label to /sys/fs/smackfs/unconfined makes subjects with that label
able to access any object, and objects with that label accessible to
all subjects. Any access that is granted because a label is unconfined
is logged. This feature is dangerous, as files and directories may
be created in places they couldn't if the policy were being enforced.


\section{TOMOYO}
\label{admin-guide/LSM/tomoyo:tomoyo}\label{admin-guide/LSM/tomoyo::doc}

\subsection{What is TOMOYO?}
\label{admin-guide/LSM/tomoyo:what-is-tomoyo}
TOMOYO is a name-based MAC extension (LSM module) for the Linux kernel.

LiveCD-based tutorials are available at

\href{http://tomoyo.sourceforge.jp/1.8/ubuntu12.04-live.html}{http://tomoyo.sourceforge.jp/1.8/ubuntu12.04-live.html}
\href{http://tomoyo.sourceforge.jp/1.8/centos6-live.html}{http://tomoyo.sourceforge.jp/1.8/centos6-live.html}

Though these tutorials use non-LSM version of TOMOYO, they are useful for you
to know what TOMOYO is.


\subsection{How to enable TOMOYO?}
\label{admin-guide/LSM/tomoyo:how-to-enable-tomoyo}
Build the kernel with \code{CONFIG\_SECURITY\_TOMOYO=y} and pass \code{security=tomoyo} on
kernel's command line.

Please see \href{http://tomoyo.osdn.jp/2.5/}{http://tomoyo.osdn.jp/2.5/} for details.


\subsection{Where is documentation?}
\label{admin-guide/LSM/tomoyo:where-is-documentation}
User \textless{}-\textgreater{} Kernel interface documentation is available at
\href{http://tomoyo.osdn.jp/2.5/policy-specification/index.html}{http://tomoyo.osdn.jp/2.5/policy-specification/index.html} .

Materials we prepared for seminars and symposiums are available at
\href{http://osdn.jp/projects/tomoyo/docs/?category\_id=532\&language\_id=1}{http://osdn.jp/projects/tomoyo/docs/?category\_id=532\&language\_id=1} .
Below lists are chosen from three aspects.
\begin{description}
\item[{What is TOMOYO?}] \leavevmode\begin{description}
\item[{TOMOYO Linux Overview}] \leavevmode
\href{http://osdn.jp/projects/tomoyo/docs/lca2009-takeda.pdf}{http://osdn.jp/projects/tomoyo/docs/lca2009-takeda.pdf}

\item[{TOMOYO Linux: pragmatic and manageable security for Linux}] \leavevmode
\href{http://osdn.jp/projects/tomoyo/docs/freedomhectaipei-tomoyo.pdf}{http://osdn.jp/projects/tomoyo/docs/freedomhectaipei-tomoyo.pdf}

\item[{TOMOYO Linux: A Practical Method to Understand and Protect Your Own Linux Box}] \leavevmode
\href{http://osdn.jp/projects/tomoyo/docs/PacSec2007-en-no-demo.pdf}{http://osdn.jp/projects/tomoyo/docs/PacSec2007-en-no-demo.pdf}

\end{description}

\item[{What can TOMOYO do?}] \leavevmode\begin{description}
\item[{Deep inside TOMOYO Linux}] \leavevmode
\href{http://osdn.jp/projects/tomoyo/docs/lca2009-kumaneko.pdf}{http://osdn.jp/projects/tomoyo/docs/lca2009-kumaneko.pdf}

\item[{The role of ``pathname based access control'' in security.}] \leavevmode
\href{http://osdn.jp/projects/tomoyo/docs/lfj2008-bof.pdf}{http://osdn.jp/projects/tomoyo/docs/lfj2008-bof.pdf}

\end{description}

\item[{History of TOMOYO?}] \leavevmode\begin{description}
\item[{Realities of Mainlining}] \leavevmode
\href{http://osdn.jp/projects/tomoyo/docs/lfj2008.pdf}{http://osdn.jp/projects/tomoyo/docs/lfj2008.pdf}

\end{description}

\end{description}


\subsection{What is future plan?}
\label{admin-guide/LSM/tomoyo:what-is-future-plan}
We believe that inode based security and name based security are complementary
and both should be used together. But unfortunately, so far, we cannot enable
multiple LSM modules at the same time. We feel sorry that you have to give up
SELinux/SMACK/AppArmor etc. when you want to use TOMOYO.

We hope that LSM becomes stackable in future. Meanwhile, you can use non-LSM
version of TOMOYO, available at \href{http://tomoyo.osdn.jp/1.8/}{http://tomoyo.osdn.jp/1.8/} .
LSM version of TOMOYO is a subset of non-LSM version of TOMOYO. We are planning
to port non-LSM version's functionalities to LSM versions.


\section{Yama}
\label{admin-guide/LSM/Yama:yama}\label{admin-guide/LSM/Yama::doc}
Yama is a Linux Security Module that collects system-wide DAC security
protections that are not handled by the core kernel itself. This is
selectable at build-time with \code{CONFIG\_SECURITY\_YAMA}, and can be controlled
at run-time through sysctls in \code{/proc/sys/kernel/yama}:


\subsection{ptrace\_scope}
\label{admin-guide/LSM/Yama:ptrace-scope}
As Linux grows in popularity, it will become a larger target for
malware. One particularly troubling weakness of the Linux process
interfaces is that a single user is able to examine the memory and
running state of any of their processes. For example, if one application
(e.g. Pidgin) was compromised, it would be possible for an attacker to
attach to other running processes (e.g. Firefox, SSH sessions, GPG agent,
etc) to extract additional credentials and continue to expand the scope
of their attack without resorting to user-assisted phishing.

This is not a theoretical problem. SSH session hijacking
(\href{http://www.storm.net.nz/projects/7}{http://www.storm.net.nz/projects/7}) and arbitrary code injection
(\href{http://c-skills.blogspot.com/2007/05/injectso.html}{http://c-skills.blogspot.com/2007/05/injectso.html}) attacks already
exist and remain possible if ptrace is allowed to operate as before.
Since ptrace is not commonly used by non-developers and non-admins, system
builders should be allowed the option to disable this debugging system.

For a solution, some applications use \code{prctl(PR\_SET\_DUMPABLE, ...)} to
specifically disallow such ptrace attachment (e.g. ssh-agent), but many
do not. A more general solution is to only allow ptrace directly from a
parent to a child process (i.e. direct ``gdb EXE'' and ``strace EXE'' still
work), or with \code{CAP\_SYS\_PTRACE} (i.e. ``gdb --pid=PID'', and ``strace -p PID''
still work as root).

In mode 1, software that has defined application-specific relationships
between a debugging process and its inferior (crash handlers, etc),
\code{prctl(PR\_SET\_PTRACER, pid, ...)} can be used. An inferior can declare which
other process (and its descendants) are allowed to call \code{PTRACE\_ATTACH}
against it. Only one such declared debugging process can exists for
each inferior at a time. For example, this is used by KDE, Chromium, and
Firefox's crash handlers, and by Wine for allowing only Wine processes
to ptrace each other. If a process wishes to entirely disable these ptrace
restrictions, it can call \code{prctl(PR\_SET\_PTRACER, PR\_SET\_PTRACER\_ANY, ...)}
so that any otherwise allowed process (even those in external pid namespaces)
may attach.

The sysctl settings (writable only with \code{CAP\_SYS\_PTRACE}) are:
\begin{description}
\item[{0 - classic ptrace permissions:}] \leavevmode
a process can \code{PTRACE\_ATTACH} to any other
process running under the same uid, as long as it is dumpable (i.e.
did not transition uids, start privileged, or have called
\code{prctl(PR\_SET\_DUMPABLE...)} already). Similarly, \code{PTRACE\_TRACEME} is
unchanged.

\item[{1 - restricted ptrace:}] \leavevmode
a process must have a predefined relationship
with the inferior it wants to call \code{PTRACE\_ATTACH} on. By default,
this relationship is that of only its descendants when the above
classic criteria is also met. To change the relationship, an
inferior can call \code{prctl(PR\_SET\_PTRACER, debugger, ...)} to declare
an allowed debugger PID to call \code{PTRACE\_ATTACH} on the inferior.
Using \code{PTRACE\_TRACEME} is unchanged.

\item[{2 - admin-only attach:}] \leavevmode
only processes with \code{CAP\_SYS\_PTRACE} may use ptrace
with \code{PTRACE\_ATTACH}, or through children calling \code{PTRACE\_TRACEME}.

\item[{3 - no attach:}] \leavevmode
no processes may use ptrace with \code{PTRACE\_ATTACH} nor via
\code{PTRACE\_TRACEME}. Once set, this sysctl value cannot be changed.

\end{description}

The original children-only logic was based on the restrictions in grsecurity.



\renewcommand{\indexname}{Index}
\printindex
\end{document}
